<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam Foreman</title>
<link>https://samforeman.me/qmd/blog/</link>
<atom:link href="https://samforeman.me/qmd/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Sam Foreman</description>
<generator>quarto-1.4.554</generator>
<lastBuildDate>Sat, 15 Jun 2024 19:38:13 GMT</lastBuildDate>
<item>
  <title>🦜 Recent Talks</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/talks/</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section">📆 2024</h4>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Parallel Training Techniques**](https://github.com/saforem2/parallel-training-slides) @ [_AI-4-Science Training Series_](https://github.com/argonne-lcf/ai-science-training-series/tree/main/06_parallel_training) [03/2024]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://github.com/saforem2/parallel-training-slides"><strong>Parallel Training Techniques</strong></a> @ <a href="https://github.com/argonne-lcf/ai-science-training-series/tree/main/06_parallel_training"><em>AI-4-Science Training Series</em></a> [03/2024]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/parallel-training-slides" title="Parallel Training Techniques" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**LLMs from Scratch**](https://saforem2.github.io/llm-workshop-talk) @ [LLM Tutorial Workshop](https://github.com/argonne-lcf/llm-workshop) [02/2024]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/llm-workshop-talk"><strong>LLMs from Scratch</strong></a> @ <a href="https://github.com/argonne-lcf/llm-workshop">LLM Tutorial Workshop</a> [02/2024]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/llm-workshop-talk" title="LLMs from Scratch" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
</section>
<section id="section-1" class="level4">
<h4 class="anchored" data-anchor-id="section-1">📆 2023</h4>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Creating Small(-ish) LLMs**](https://saforem2.github.io/LLM-tutorial) @ [LLM Tutorial Workshop (1)](https://github.com/brettin/llm_tutorial) [11/2023]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/LLM-tutorial"><strong>Creating Small(-ish) LLMs</strong></a> @ <a href="https://github.com/brettin/llm_tutorial">LLM Tutorial Workshop (1)</a> [11/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/LLM-tutorial" title="Creating Small(-ish) LLMs" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Exascale Science on Aurora**](https://samforeman.me/oneapi-talk/index.html#0) @ [Intel oneAPI Workshop @ UIC](https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop) [10/2023]]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://samforeman.me/oneapi-talk/index.html#0"><strong>Exascale Science on Aurora</strong></a> @ <a href="https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop">Intel oneAPI Workshop @ UIC</a> [10/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/oneapi-talk" title="Exascale Science on Aurora" width="100%" align="center" height="500" frameborder="0" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<!---->
<!-- ::: {.callout-tip icon="false" title="[[**LLM Lunch Talk**](https://saforem2.github.io/llm-lunch-talk) @ [ALCF HPC Workshop](https://github.com/argonne-lcf/ALCF_Hands_on_HPC_Workshop)]{.dim-text}" collapse="true" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;"}: -->
<!---->
<!-- <iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/llm-lunch-talk/#/section" title="LLMs on Polaris" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen style="border-radius:0.25rem;border:none;align:center;"> -->
<!--   <p>Your browser does not support iframes.</p> -->
<!-- </iframe> -->
<!---->
<!-- ::: -->
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**LLM Lunch Talk**](https://saforem2.github.io/llm-lunch-talk) @ [ALCF Hands On HPC Workshop](https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop) [10/2023]]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/llm-lunch-talk"><strong>LLM Lunch Talk</strong></a> @ <a href="https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop">ALCF Hands On HPC Workshop</a> [10/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/llm-lunch-talk/#/section" title="LLMs on Polaris" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Scaling LLMs for Science**](https://saforem2.github.io/scaling4science) @ [Data-Intensive Computing + AI/ML at Scale](https://events.cels.anl.gov/event/426/overview) [08/2023]]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/scaling4science"><strong>Scaling LLMs for Science</strong></a> @ <a href="https://events.cels.anl.gov/event/426/overview">Data-Intensive Computing + AI/ML at Scale</a> [08/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/scaling4science/#/section" title="Scaling LLMs for Science and Ongoing Collaborations" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**MLMC: Machine Learning Monte Carlo**](https://saforem2.github.io/lattice23) @ [Lattice 2023](https://indico.fnal.gov/event/57249/contributions/271305/) [07/2023]]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/lattice23"><strong>MLMC: Machine Learning Monte Carlo</strong></a> @ <a href="https://indico.fnal.gov/event/57249/contributions/271305/">Lattice 2023</a> [07/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/lattice23/#/title-slide" title="MLMC: Machine Learning Monte Carlo" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Generative Modeling and Efficient Sampling**](https://saforem2.github.io/lqcd-pasc23/) @ [PASC23](https://pasc23.pasc-conference.org/) [07/2023]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/lqcd-pasc23/"><strong>Generative Modeling and Efficient Sampling</strong></a> @ <a href="https://pasc23.pasc-conference.org/">PASC23</a> [07/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/lqcd-pasc23/" title="Generative Modeling and Efficient Sampling" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Efficient Sampling for LGT**](https://saforem2.github.io/deep-fridays) @ [Deep Fridays @ U. Bologna](https://www.cs.unibo.it/~asperti/deep_fridays.html) [04/2023]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/deep-fridays"><strong>Efficient Sampling for LGT</strong></a> @ <a href="https://www.cs.unibo.it/~asperti/deep_fridays.html">Deep Fridays @ U. Bologna</a> [04/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/deep-fridays/" title="Efficient Sampling for LGT" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
</section>
<section id="section-2" class="level4">
<h4 class="anchored" data-anchor-id="section-2">📆 2022</h4>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Large Scale Training**](https://saforem2.github.io/ai4sci-large-scale-training) @ [AI4Science on Supercomputers (ALCF)](https://github.com/argonne-lcf/ai-science-training-series) (11/2022)]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/ai4sci-large-scale-training"><strong>Large Scale Training</strong></a> @ <a href="https://github.com/argonne-lcf/ai-science-training-series">AI4Science on Supercomputers (ALCF)</a> (11/2022)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/ai4sci-large-scale-training/#" title="Large Scale Training" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Hyperparameter Management**](https://saforem2.github.io/hparam-management-sdl2022/) @ [ALCF SDL Workshop](https://www.alcf.anl.gov/events/2022-alcf-simulation-data-and-learning-workshop) (10/2022)]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/hparam-management-sdl2022/"><strong>Hyperparameter Management</strong></a> @ <a href="https://www.alcf.anl.gov/events/2022-alcf-simulation-data-and-learning-workshop">ALCF SDL Workshop</a> (10/2022)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/hparam-management-sdl2022" title="Hyperparameter Management" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Statistical Learning**](https://saforem2.github.io/ATPESC-StatisticalLearning) @ [ATPESC 2022](https://extremecomputingtraining.anl.gov/) (08/2022)]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/ATPESC-StatisticalLearning"><strong>Statistical Learning</strong></a> @ <a href="https://extremecomputingtraining.anl.gov/">ATPESC 2022</a> (08/2022)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://github.com/argonne-lcf/ATPESC_MachineLearning/blob/master/00_statisticalLearning/src/atpesc/notebooks/statistical_learning.ipynb">📕 accompanying notebook</a></li>
</ul>
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/ATPESC-StatisticalLearning/#/" title="Statistical Learning" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Scientific Data Science: An Emerging Symbiosis**](https://saforem2.github.io/anl-job-talk/) @ ANL (05/2022)]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/anl-job-talk/"><strong>Scientific Data Science: An Emerging Symbiosis</strong></a> @ ANL (05/2022)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/anl-job-talk" title="Scientific Data Science" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Machine Learning in HEP**](https://saforem2.github.io/physicsSeminar) @ UNC Greensboro (03/2022)]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/physicsSeminar"><strong>Machine Learning in HEP</strong></a> @ UNC Greensboro (03/2022)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://saforem2.github.io/physicsSeminar"><strong>Machine Learning in HEP</strong></a>, at UNC Greensboro, March 2022</li>
</ul>
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/physicsSeminar" title="Machine Learning in HEP" width="100%" align="center" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border:none;border-radius:0.25rem;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
</section>
<section id="section-3" class="level4">
<h4 class="anchored" data-anchor-id="section-3">📆 2021</h4>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Accelerated Sampling Methods for LGT**](https://saforem2.github.io/l2hmc-dwq25/), @ [DWQ @ 25 [BNL]](https://indico.bnl.gov/event/13576/) (12/2021)]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/l2hmc-dwq25/"><strong>Accelerated Sampling Methods for LGT</strong></a>, @ <a href="https://indico.bnl.gov/event/13576/">DWQ @ 25 [BNL]</a> (12/2021)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/l2hmc-dwq25/" title="Accelerated Sampling Methods for LGT" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Training Topological Samplers for LGT**](https://saforem2.github.io/l2hmc_talk_ect2021) @ [ML4HEP, ECT* Trento](https://indico.ectstar.eu/event/77/contributions/2349/) (09/2021)]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://saforem2.github.io/l2hmc_talk_ect2021"><strong>Training Topological Samplers for LGT</strong></a> @ <a href="https://indico.ectstar.eu/event/77/contributions/2349/">ML4HEP, ECT* Trento</a> (09/2021)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/l2hmc_talk_ect2021" title="Training Topological Samplers for LGT" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**l2hmc-qcd**](https://github.com/saforem2/l2hmc-qcd) @ MIT Lattice Group Seminar (2021)]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://github.com/saforem2/l2hmc-qcd"><strong>l2hmc-qcd</strong></a> @ MIT Lattice Group Seminar (2021)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://github.com/saforem2/l2hmc-qcd"><strong>l2hmc-qcd</strong></a> at the <em>MIT Lattice Group Seminar</em>, 2021</p>
</div>
</div>
</div>
<!-- -   [**Deep Learning HMC for Improved Gauge Generation**](https://bit.ly/mainz21) to the [*Machine Learning Techniques in Lattice QCD Workshop*](https://bit.ly/mainz21_overview), 2021 -->
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Deep Learning HMC for Improved Gauge Generation**](https://bit.ly/mainz21) @ [ML in LQCD Workshop](https://bit.ly/mainz21_overview) (2021)]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);border:none!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://bit.ly/mainz21"><strong>Deep Learning HMC for Improved Gauge Generation</strong></a> @ <a href="https://bit.ly/mainz21_overview">ML in LQCD Workshop</a> (2021)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://bit.ly/mainz21" title="Deep Learning HMC for Improved Gauge Generation" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
</section>
<section id="section-4" class="level4">
<h4 class="anchored" data-anchor-id="section-4">📆 2020</h4>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[**Machine Learning for Lattice QCD**](https://slides.com/samforeman/l2hmc-qcd-93bc0c) @ U. Iowa (2020)]{.dim-text}" style="width:100%; background-color: rgba(0,0,0,0.0);">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><a href="https://slides.com/samforeman/l2hmc-qcd-93bc0c"><strong>Machine Learning for Lattice QCD</strong></a> @ U. Iowa (2020)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://slides.com/samforeman/l2hmc-qcd-93bc0c" title="Machine Learning for Lattice QCD" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Personal {Website}},
  date = {2024-06-15},
  url = {https://samforeman.me},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“Personal Website.”</span> June 15, 2024. <a href="https://samforeman.me">https://samforeman.me</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/talks/</guid>
  <pubDate>Sat, 15 Jun 2024 19:38:13 GMT</pubDate>
</item>
<item>
  <title>💅 How to Make Dope Slides</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/dope-slides/</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="quarto-reveal.js" class="level2">
<h2 class="anchored" data-anchor-id="quarto-reveal.js">Quarto 🤝 Reveal.js</h2>
<p>So, after making a promise some time ago on <a href="https://twitter.com/saforem2/status/1689676452235759616?s=20">twitter <i class="fa-brands fa-twitter" aria-label="twitter"></i></a><sup>1</sup>, and having many questions following my talk on <a href="https://github.com/saforem2/parallel-training-slides:">Parallel Training Techniques</a> last week, I’m finally getting around to writing this up.</p>
<p>The slides are written using <a href="https://quarto.org/">Quarto</a>, a <em>flavor</em> of Markdown, and uses the built-in <a href="https://quarto.org/docs/presentations/revealjs">Quarto + Reveal.js</a> functionality.</p>
<p>For this post, I’ll focus on the slides I presented at last years <a href="https://indico.fnal.gov/event/57249/contributions/271305/">Lattice 2023</a>, shown below:</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="🪧 [[**MLMC: Machine Learning Monte Carlo**](https://saforem2.github.io/lattice23) @ [_Lattice 2023_](https://indico.fnal.gov/event/57249/contributions/271305/) [07/2023]]{.dim-text}" style="width:100%; background-color: var(--bg-transparent); border-color: var(--bg-border)!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🪧 <span class="dim-text"><a href="https://saforem2.github.io/lattice23"><strong>MLMC: Machine Learning Monte Carlo</strong></a> @ <a href="https://indico.fnal.gov/event/57249/contributions/271305/"><em>Lattice 2023</em></a> [07/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/lattice23/#/title-slide" title="🪧 MLMC: Machine Learning Monte Carlo" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[🏃‍♂️ Follow Along...]{.dim-text}" style="width:100%; background-color: var(--bg-transparent); border-color: var(--bg-border)!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text">🏃‍♂️ Follow Along…</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Once you’ve <a href="https://quarto.org/docs/download/">Installed Quarto</a>, you can build these slides yourself by:</p>
<ol type="1">
<li><code>git clone</code> <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/lattice23"><code>saforem2/lattice23</code></a></li>
<li><code>cd lattice23 &amp;&amp; quarto preview</code></li>
</ol>
<p>This will create a <code>docs/</code> directory with the following structure:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">📂</span> docs/</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📂 assets/</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📂 css/</span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📄 index.html</span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📄 lattice23.md</span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📄 search.json</span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> 📂 site_libs/</span></code></pre></div>
<p>Once you’ve created this, and the <code>docs/index.html</code> file looks how you want, you can add the <code>docs/</code> directory to your GitHub repo:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git add docs</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Create site'</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git push</span></code></pre></div>
<p>Once you’ve enabled the GitHub page, the site will be automatically built and updated alongside the repo.</p>
</div>
</div>
</div>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>Whenever I give a talk, my workflow is typically:</p>
<ol type="1">
<li><p>Create new GitHub repo for it</p></li>
<li><p>Hunt down the GitHub repo from my <em>last</em> talk and<sup>2</sup>:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cp <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> old_talk/<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{_quarto.yml</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">index.qmd</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">references.bib</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">css/</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span> new_talk/</span></code></pre></div></li>
</ol>
<p>Honestly, other than that, 90% of the work is done automatically by <a href="https://quarto.org/">Quarto</a>. The remaining 10% consists of figuring out why my css is broken (see CSS).</p>
<p>The best place to start for learning to make slides with Quarto and Reveal.js is the official documentation:</p>
<ol type="1">
<li><a href="https://quarto.org/docs/presentations/revealjs/">Quarto / Presentations / Revealjs</a>:
<ol type="1">
<li><a href="https://quarto.org/docs/presentations/revealjs/">Reveal Basics</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/presenting.html">Presenting Slides</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/advanced.html">Advanced Reveal</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/themes.html">Reveal Themes</a></li>
</ol></li>
</ol>
<ul>
<li><p>The slides are written in <del>markdown</del> <a href="https://quarto.org/">Quarto (<code>.qmd</code>)</a><sup>3</sup>, a <a href="https://pandoc.org/">pandoc</a>-compliant based markup language.</p></li>
<li><p>For a single slide deck, the content will be placed in <code>index.qmd</code> and our directory structure will look something like:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">📂</span> lattice23/</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📂 assets/            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for images, etc.</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   └── 🖼️ thumbnail.png  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># can be used as social preview image</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📂 css/</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   ├── 📄 callouts.css</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   ├── 📄 dark.scss</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   └── 📄 default.css</span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 🛠️ _quarto.yml        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Configuration goes here</span></span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> 📄 index.qmd          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quarto document containing slides content</span></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> 📜 references.bib     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BibTex references</span></span></code></pre></div></li>
<li><p>Equations are rendered using <code>$</code> delimiters for inline math and <code>$$</code> for display math<sup>4</sup>.</p></li>
<li><p>We can use <a href="https://pandoc.org/chunkedhtml-demo/8.18-divs-and-spans.html">Divs and Spans</a> from Pandoc.</p>
<ul>
<li><p><strong><code>&lt;span&gt;</code></strong>’s: are created by wrapping text in square brackets, and will be treated as a <code>&lt;span&gt;</code> with attributes if it is followed immediately by attributes, e.g.:</p>
<ul>
<li><p>Example: <code>[This is *some text*]{.class key="val"}</code></p></li>
<li><p>idk what I’m doing really, so I mostly find myself doing things like <code>[blue   text]{style="color:#1E88E5;"}</code> which produces <span style="color:#1E88E5;">blue text</span>.</p></li>
</ul></li>
<li><p><strong><code>&lt;div&gt;</code></strong>’s: are created by wrapping text with a line consisting of at least three colons <code>:::</code>.</p>
<ul>
<li><p>Example:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1">::: {#special .sidebar}</span>
<span id="cb5-2">Here is a paragraph.</span>
<span id="cb5-3"></span>
<span id="cb5-4">And another.</span>
<span id="cb5-5">:::</span></code></pre></div></li>
<li><p>We can use either attributes in curly braces or a single unbraced word, which will be treated as a class name.</p></li>
</ul></li>
</ul></li>
</ul>
<section id="install-extensions" class="level3">
<h3 class="anchored" data-anchor-id="install-extensions">🎁 Install Extensions</h3>
<p>Find the full list of available extensions at <a href="https://quarto.org/docs/extensions/">Quarto Extensions</a></p>
<p>To install various icon sets used in the example slides, we can install the following extensions:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension mcanouil/quarto-iconify      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://icones.js.org/ [&lt;-- Contains rest of icon sets ??]</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension shafayetShafee/bsicons       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bootstrap icons</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension schochastics/academicicons   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OrcID, Google Scholar, ...</span></span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension quarto-ext/fontawesome       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font Awesome icons</span></span></code></pre></div>
<p>note that these aren’t necessary for functionality, but provide additional icons that I like to use 🤷🏻‍♂️</p>
</section>
</section>
<section id="metadata" class="level2">
<h2 class="anchored" data-anchor-id="metadata">Metadata</h2>
<p>The first section of our <a href="https://github.com/saforem2/lattice23/blob/main/index.qmd"><code>index.qmd</code></a> contains the YAML metadata for the Quarto document.</p>
<p>Explicitly, we see this consists of:</p>
<details closed="">
<summary>
Expand for <code>yaml</code>
</summary>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb7-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">revealjs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title-block-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> none</span></span>
<span id="cb7-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slide-number</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> c</span></span>
<span id="cb7-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title-slide-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> default</span></span>
<span id="cb7-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chalkboard</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">buttons</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto-animate</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reference-location</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> section</span></span>
<span id="cb7-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pause</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnotes-hover</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citations-hover</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">preview-links</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">controls-tutorial</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">controls</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logo</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/saforem2/anl-job-talk/main/docs/assets/anl.svg"</span></span>
<span id="cb7-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">history</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dark</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> css/dark.scss</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css/default.css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> css/callouts.css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">self-contained</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">embed-resources</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">self-contained-math</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">center</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">highlight-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"atom-one"</span></span>
<span id="cb7-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">default-image-extension</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> svg</span></span>
<span id="cb7-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">code-line-numbers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">code-overflow</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> scroll</span></span>
<span id="cb7-30"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html-math-method</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> katex</span></span>
<span id="cb7-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fig-align</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> center</span></span>
<span id="cb7-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mermaid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-33"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> dark</span></span>
<span id="cb7-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gfm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-35"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">output-file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lattice23.md"</span></span>
<span id="cb7-36"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
</details>
<p>The complete list of Reveal.js options are listed, with descriptions at: <a href="https://quarto.org/docs/reference/formats/presentations/revealjs.html">Quarto – Revealjs Options</a></p>
</section>
<section id="title-slide" class="level2">
<h2 class="anchored" data-anchor-id="title-slide">Title Slide</h2>
<ul>
<li><p>Starting with the title slide<sup>5</sup>:</p>
<div id="fig-title" class="quarto-figure quarto-figure-center quarto-float anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/title-slide.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="https://samforeman.me/qmd/dope-slides/assets/title-slide.png" class="img-fluid figure-img" style="width:66.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <a href="https://saforem2.github.io/lattice23/#/section">Title Slide</a>
</figcaption>
</figure>
</div>
<ul>
<li><p>The full slide contents are included below:</p>
<details closed="">
<summary>
<p>Expand for <code>quarto</code></p>
</summary>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># {.title-slide .centeredslide background-iframe="https://saforem2.github.io/grid-worms-animation/" loading="lazy"}</span></span>
<span id="cb8-2"></span>
<span id="cb8-3">::: {style="background-color: rgba(22,22,22,0.75); border-radius: 10px; text-align:center; padding: 0px; padding-left: 1.5em; padding-right: 1.5em; max-width: min-content; min-width: max-content; margin-left: auto; margin-right: auto; padding-top: 0.2em; padding-bottom: 0.2em; line-height: 1.5em!important;"}</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">MLMC: Machine Learning Monte Carlo</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.style="color:#939393; font-size:1.5em; font-weight:bold;}  </span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">for Lattice Gauge Theory</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{style="color:#777777; font-size:1.2em; font-weight: bold;"}</span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;br&gt;&amp;nbsp;</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{style="padding-bottom: 0.5rem;"}  </span>
<span id="cb8-8">[](https://samforeman.me) Sam Foreman  </span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Xiao-Yong Jin, James C. Osborn</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.dim-text style="font-size:0.8em;"}  </span>
<span id="cb8-10">[[<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> `saforem2/`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/)</span>]{style="border-bottom: 0.5px solid #00ccff;"}<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`{`</span>[<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">`lattice23`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/lattice23)</span>]{style="border-bottom: 0.5px solid #00ccff;"}, [<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">`l2hmc-qcd`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/l2hmc-qcd)</span>]{style="border-bottom: 0.5px solid #00ccff;"}<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`}`</span>]{style="font-size:0.8em;"}</span>
<span id="cb8-11"></span>
<span id="cb8-12">:::</span>
<span id="cb8-13"></span>
<span id="cb8-14">::: footer</span>
<span id="cb8-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">2023-07-31 @ [Lattice 2023](https://indico.fnal.gov/event/57249/contributions/271305/)</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.dim-text style="text-align:left;'}</span>
<span id="cb8-16">:::</span></code></pre></div>
</details></li>
<li><p>For the background, I made a simple animation <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/grid-worms-animation"><code>saforem2/grid-worms-animation</code></a> that is hosted on GitHub pages as a simple html website</p></li>
<li><p>This static GitHub page is then used as an <a href="https://quarto.org/docs/presentations/revealjs/#iframe-backgrounds">IFrame Background</a> natively in Quarto with Reveal.js</p></li>
<li><p>This is as simple as:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># {.title-slide .centeredslide background-iframe="https://saforem2.github.io/grid-worms-animation/" loading="lazy"}</span></span></code></pre></div></li>
</ul></li>
</ul>
</section>
<section id="single-column-slides" class="level2">
<h2 class="anchored" data-anchor-id="single-column-slides">Single-Column Slides</h2>
<p>Other than the title slide, the remainder of the slides are all relatively straightforward to construct.</p>
<p>For single-column slides, constructing the content is as simple as writing it in Markdown:</p>
<!-- :::: {layout="[ [50, 50] ]" layout-valign="start" style="display: flex; flex-direction: row; margin-top: -0.0em; align-items: start; overflow: scroll;"} -->
<!-- :::: {.columns} -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Code</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Slide</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Overview</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Background: `{MCMC,HMC}`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#markov-chain-monte-carlo-mcmc)</span></span>
<span id="cb10-4"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Leapfrog Integrator</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#leapfrog-integrator-hmc)</span></span>
<span id="cb10-5"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Issues with HMC</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-issues-with-hmc)</span></span>
<span id="cb10-6"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Can we do better?</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-can-we-do-better)</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">L2HMC: Generalizing MD</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-l2hmc)</span></span>
<span id="cb10-9"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">4D $SU(3)$ Model</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-su3)</span></span>
<span id="cb10-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Results</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-results)</span></span>
<span id="cb10-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">References</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-references)</span></span>
<span id="cb10-12"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Extras</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-extras)</span></span></code></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div style="text-align:center;">
<div id="fig-overview" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/overview.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="https://samforeman.me/qmd/dope-slides/assets/overview.png" class="img-fluid figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: <a href="https://saforem2.github.io/lattice23/#/overview">Overview Slide</a>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="centered-slides" class="level2">
<h2 class="anchored" data-anchor-id="centered-slides">Centered Slides</h2>
<p>We can center all the text on a slide by adding the <code>{.centeredslide}</code> class to the slide header, e.g.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true"><code>index.qmd</code></a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false"><code>style.scss</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb11-2"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">format:</span></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  revealjs:</span></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    theme: [style.scss]</span></span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Title {.centeredslide}</span></span></code></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource scss number-lines code-with-copy"><code class="sourceCode scss"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.centeredslide</span> {</span>
<span id="cb12-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">text-align</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">center</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb12-3">}</span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="multi-column-slides" class="level2">
<h2 class="anchored" data-anchor-id="multi-column-slides">Multi-Column Slides</h2>
<p>Side-by-side content (either text or images)</p>
<div>

</div>
<div class="quarto-layout-panel" style="display: flex; flex-direction: row; margin-top: -0.0em; align-items: start;" data-layout="[ [50,50] ]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mcmc" class="quarto-figure quarto-figure-center quarto-float anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcmc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mcmc.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="https://samforeman.me/qmd/dope-slides/assets/mcmc.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <a href="https://saforem2.github.io/lattice23/#/markov-chain-monte-carlo-mcmc">Markov Chain Monte Carlo</a>
</figcaption>
</figure>
</div>
</div>
<div class="col1 quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>This slide is horizontally centered<sup>6</sup> and the content consists of two rows split as follows:</p>
<div id="tbl-2col" class="striped hover quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-2col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">B</td>
</tr>
<tr class="even">
<td style="text-align: center;">C</td>
<td style="text-align: center;">C</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-2col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Slide layout. First row split into two columns, second row spans full width.
</figcaption>
</figure>
</div>
<ul>
<li><p>In panel A, we have a <code>::: {.callout-note}</code> block followed by a single list element containing a LaTeX equation.</p></li>
<li><p>In panel B we have a standard markdown image</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![](./asets/mcmc.png)</span></span></code></pre></div></li>
<li><p>In panel C we have normal text + math with LaTeX<sup>7</sup> syntax.</p></li>
</ul>
</div>
</div>
</div>
<ul>
<li><p>Note that we additionally have a <code>::: footer</code> element included at the bottom of the slide.</p></li>
<li><p>The code used to generate the slide above is included below:</p>
<details closed="">
<summary>
<p>Expand for<code>quarto</code></p>
</summary>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Markov Chain Monte Carlo (MCMC) {.centeredslide}</span></span>
<span id="cb14-2"></span>
<span id="cb14-3">:::: {.columns}</span>
<span id="cb14-4"></span>
<span id="cb14-5">::: {.column width="50%"}</span>
<span id="cb14-6"></span>
<span id="cb14-7">::: {.callout-note title="Goal" style="text-align:left;!important"}</span>
<span id="cb14-8">Generate **independent** samples $<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\{</span>x_{i}<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\}</span>$, such that<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[^notation]</span></span>
<span id="cb14-9">$$<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\{</span>x_{i}<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\}</span> \sim p(x) \propto e^{-S(x)}$$</span>
<span id="cb14-10">where $S(x)$ is the _action_ (or potential energy)</span>
<span id="cb14-11">:::</span>
<span id="cb14-12"></span>
<span id="cb14-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- </span>Want to calculate observables $\mathcal{O}$:  </span>
<span id="cb14-14">  $\left\langle \mathcal{O}\right\rangle \propto \int \left<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">\mathcal{D}x\right</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>\hspace{4pt} {\mathcal{O}(x)\, p(x)}$</span>
<span id="cb14-15"></span>
<span id="cb14-16">:::</span>
<span id="cb14-17"></span>
<span id="cb14-18">::: {.column width="49%"}</span>
<span id="cb14-19"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![](https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/normal_distribution.dark.svg)</span></span>
<span id="cb14-20">:::</span>
<span id="cb14-21"></span>
<span id="cb14-22">::::</span>
<span id="cb14-23"></span>
<span id="cb14-24">If these were <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">independent</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.style="color:#00CCFF;"}, we could approximate:</span>
<span id="cb14-25">$\left\langle\mathcal{O}\right\rangle \simeq \frac{1}{N}\sum^{N}_{n=1}\mathcal{O}(x_{n})$</span>
<span id="cb14-26">$$\sigma_{\mathcal{O}}^{2} = \frac{1}{N}\mathrm{Var}{\left<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">\mathcal{O} (x) \right</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>}\Longrightarrow</span>
<span id="cb14-27">\sigma_{\mathcal{O}} \propto \frac{1}{\sqrt{N}}$$</span>
<span id="cb14-28"></span>
<span id="cb14-29"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[^notation]: </span>Here, $\sim$ means "is distributed according to"</span>
<span id="cb14-30"></span>
<span id="cb14-31">::: footer</span>
<span id="cb14-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> `saforem2/lattice23`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://saforem2.github.io/lattice23)</span></span>
<span id="cb14-33">:::</span></code></pre></div>
</details></li>
</ul>
</section>
<section id="css" class="level2">
<h2 class="anchored" data-anchor-id="css">💅 CSS</h2>
<p>My web developer friend laughs at me, but when something is broken / doesn’t look right / I want it to look different, I:</p>
<ol type="1">
<li>Pull up Chrome Tools ( ⌘ + ⌥ + I )</li>
<li>Inspect element of interest ( ⌘ + ⇧ + C )</li>
<li>Make changes to the CSS</li>
<li>Save the new rule to my <code>.scss</code> file 🤷🏻‍♂️</li>
</ol>
<p>I’m guessing this might be obvious to some people, but it took me a while to figure out how things worked so maybe its helpful for others.</p>
<details closed="">
<summary>
Expand for <code>css</code>
</summary>
<div id="fig-css" class="quarto-figure quarto-figure-center quarto-float anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-css-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/css.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="https://samforeman.me/qmd/dope-slides/assets/css.png" class="img-fluid figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-css-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Example of selecting an element and making a change to the CSS.
</figcaption>
</figure>
</div>
</details>
</section>
<section id="github-page" class="level2">
<h2 class="anchored" data-anchor-id="github-page">📃 GitHub Page</h2>
<p>To enable your GitHub page, you can do the following:</p>
<div id="fig-github-page" class="quarto-figure quarto-figure-center quarto-float anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-github-page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/github-pages.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5"><img src="https://samforeman.me/qmd/dope-slides/assets/github-pages.png" class="img-fluid figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-github-page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Instructions for building a GitHub page using the <code>docs/</code> directory off the <code>main</code> branch.
</figcaption>
</figure>
</div>
<p>In this case, the repo is:</p>
<p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/lattice23"><code>saforem2/lattice23</code></a></p>
<p>and the site is published at</p>
<p><a href="https://saforem2.github.io/lattice23">https://saforem2.github.io/lattice23</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">📓 References</h2>
<ul>
<li><a href="https://quarto.org/docs/presentations/revealjs/themes.html">Reveal Themes</a></li>
<li>Using <a href="https://thomasmock.quarto.pub/reports-presentations/#/pandoc-fenced-divs">Pandoc fenced divs</a></li>
<li><a href="https://www.emilhvitfeldt.com/post/slidecraft-colors-fonts/">Slidecraft 101: Colors and Fonts</a></li>
<li><a href="https://thomasmock.quarto.pub/reports-presentations/#/title-slide">Beautiful Reports and Presentations with Quarto</a></li>
<li><a href="https://github.com/grantmcdermott/quarto-revealjs-clean"><i class="fa-brands fa-github" aria-label="github"></i> Quarto Clean Theme</a></li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[❤️‍🩹 Status]{style=&quot;color: #FF5252;&quot;}" style="text-align: left!important; width:100%; border: none!important; border-left: 2px solid var(--red-sf)!important; border-radius: 0pt!importtant; background-color: var(--bg-transparent); opacity:100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color: #FF5252;">❤️‍🩹 Status</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="51f0dba2" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f; font-style: italic">Last Updated</span>: <span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">06</span><span style="color: #f06292; text-decoration-color: #f06292">/</span><span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">15</span><span style="color: #f06292; text-decoration-color: #f06292">/</span><span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">2024</span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">@</span> <span style="color: #1a8fff; text-decoration-color: #1a8fff; font-weight: bold">13:16:12</span>
</pre>
</div>
</div>
<p align="center">
<a href="https://hits.seeyoufarm.com"><img align="center" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fsamforeman.me%2Fqmd%2Fdope-slides%2F&amp;count_bg=%2300CCFF&amp;title_bg=%23303030&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=hits&amp;edge_flat=false"></a>
</p>
</div>
</div>
</div>



</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>And countless other people IRL↩︎</p></li>
<li id="fn2"><p>One thing I’ve been meaning to do, is clean up all my <code>css/*</code> files and move them all to a single repository, but I’ll save that for another day.↩︎</p></li>
<li id="fn3"><p><em>An open-source scientific and technical publishing system</em>↩︎</p></li>
<li id="fn4"><p><a href="https://quarto.org/docs/authoring/markdown-basics.html#equations">Equations</a>↩︎</p></li>
<li id="fn5"><p>Quarto comes with lightbox support, so you can click on images to display them full screen.↩︎</p></li>
<li id="fn6"><p>By adding the <code>{.centeredslide}</code> class to the slide header↩︎</p></li>
<li id="fn7"><p>Text surrounded by <code>$</code> will be rendered with LaTeX↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {How to {Make} {Dope} {Slides}},
  date = {2024-06-15},
  url = {https://samforeman.me/qmd/dope-slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“How to Make Dope Slides.”</span> June 15,
2024. <a href="https://samforeman.me/qmd/dope-slides">https://samforeman.me/qmd/dope-slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/dope-slides/</guid>
  <pubDate>Sat, 15 Jun 2024 18:16:08 GMT</pubDate>
</item>
<item>
  <title>📸 flash-attn on Sunspot</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/flash-attn-sunspot/</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="impact-on-loss-bug" class="level2">
<h2 class="anchored" data-anchor-id="impact-on-loss-bug">🐛 Impact on Loss [Bug?]</h2>
<p>In the <code>q4-drop</code>, it was observed that toggling <code>flash-attn</code> on / off seemed to produce different loss curves (with otherwise <em>identical configs</em>)</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>shared-config.yaml</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="shared-config.yaml" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TP</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PP</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GAS</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">OPT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> adamw</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dtype</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> bf16</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NLAYERS</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MICRO_BATCH</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">WORLD_SIZE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span></code></pre></div>
</div>
<p>This can be seen clearly in the figure below:</p>
<p><a href="./assets/flash-attn/flash-attn-bug-q4-drop-sunspot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-bug-q4-drop-sunspot-1.png" class="img-fluid"></a></p>
<p>This was identified, and to be addressed in upcoming release.</p>
</section>
<section id="llm-framework-release" class="level2">
<h2 class="anchored" data-anchor-id="llm-framework-release">📦 LLM Framework Release</h2>
<p>On 05/14/2024, Intel dropped their new LLM frameworks release:</p>
<details closed="">
<summary>
🎁 <code>frameworks_2024_5_v2</code> Announcement:
</summary>
<p>Hi Venkat,</p>
<p>We have shared the official Q2 release in two different forms :</p>
<p>Manual Setup: <code>/gila/Aurora_deployment/anl_24_q2_release.tar.gz</code></p>
<p>and</p>
<p>Module:</p>
<p><code>module use -a /home/jmitche1/anl_release/2024/q2</code></p>
<p><code>module load frameworks_2024_5_v2</code></p>
<p>&nbsp;Instructions on how to use modules with Q2 build are anl_24_q2_release/README</p>
<ul>
<li><strong>The release includes :</strong>
<ul>
<li>Megatron-DeepSpeed 0.14.2 (with patch)</li>
<li>Intel® Extension for PyTorch* v2.1.30+xpu</li>
<li>TorchCCL 2.1.300</li>
<li>ONEAPI 2024.1.0.596.PUBLIC_IDP_2024.1.0_723</li>
<li>Agama driver: 803.29</li>
</ul></li>
<li>The release provides following key features:
<ul>
<li>Scaleup Performance improvement from the <code>TorchCCl</code> prototype feature enabled by <code>TORCH_LLM_ALLREDUCE=1</code> &nbsp;<a href="https://urldefense.us/v3/__https://github.com/intel/torch-ccl/releases/tag/v2.1.300*2Bxpu__;JQ!!G_uCfscf7eWS!ZDMnN0Oxp1sCv06MkdlBqFIq0NMAXaCBOtl3fEtBq8Fn4-3iYY5-kPEKr-q4vZIL_i6f2wQbULxAIFJAthJyu3VvNA$">details</a></li>
<li>Auto TP inference support for more workloads</li>
<li>Flash Attention V2 improvement for 256 head dimension support; MiCS support.</li>
<li>Latest Features and Optimizations from DeepSpeed&nbsp;<a href="https://github.com/microsoft/DeepSpeed/releases/tag/v0.14.2">0.14.2</a>&nbsp;and Intel® Extension for PyTorch*&nbsp;<a href="https://github.com/intel/intel-extension-for-pytorch/tree/v2.1.30*2Bxpu">2.1.30</a>.</li>
</ul></li>
</ul>
<p>Thanks,&nbsp;<br>
Jerome</p>
</details>
<section id="flash-no-flash" class="level3">
<h3 class="anchored" data-anchor-id="flash-no-flash">📸 flash 🤝 📷 no-flash</h3>
<p>With this new release, Intel observed that the loss curves agreed exactly for <code>flash</code> / no-<code>flash</code>, using the learning rate settings below:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00015</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr_warmup_frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr_decay_iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320000</span></span></code></pre></div>
<p>Testing with Jerome’s new release:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /home/jmitche1/anl_release/2024/q2</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks_2024_5_v2</span></code></pre></div>
<p>I was able to independently confirm these results, shown in 📸 <code>flash</code> 🤝 📷 <code>no-flash</code> below.</p>
<details closed="">
<summary>
🔗 <code>wandb</code> links:
</summary>
<ul>
<li>[📸 <code>flash</code>] W&amp;B Run: <a href="https://wandb.ai/aurora_gpt/AuroraGPT/runs/716r5rnq/overview?nw=nwuserforemans">youthful-river-1832</a></li>
<li>[📷 no-<code>flash</code>] W&amp;B Run: <a href="https://wandb.ai/aurora_gpt/AuroraGPT/runs/120ln0b4/overview?nw=nwuserforemans">earthy-wave-1830</a></li>
</ul>
</details>
<details closed="">
<summary>
📸 <code>flash</code> vs.&nbsp;📷 <code>no-flash</code>
</summary>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/flash-attn/flash-attn-sunspot-compare-new-release.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="flash 📸 🤝 📷 no-flash"><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-sunspot-compare-new-release.png" class="img-fluid figure-img" alt="flash 📸 🤝 📷 no-flash"></a></p>
<figcaption><code>flash</code> 📸 🤝 📷 no-<code>flash</code></figcaption>
</figure>
</div>
</details>
</section>
<section id="broken-mpigremlins" class="level3">
<h3 class="anchored" data-anchor-id="broken-mpigremlins">🚧 Broken MPI<sup>1</sup></h3>
<p>For whatever reason, things seemed to have spontaneously broken on the night of 2024-04-14 ??</p>
<p>When trying to run experiments the following day (05/15/2024) I was met with this[^]:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Abort</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Fatal error in internal_Init_thread: Other MPI error</span></code></pre></div>
<p>which was discussed further in <a href="https://github.com/pmodels/mpich/pull/7001">this thread</a> on slack.</p>
<p>It seems Subrata also encountered a similar issue [see: <a href="https://cels-anl.slack.com/archives/C047E7ZTUUF/p1715985162970119">slack thread</a>]</p>
<details closed="">
<summary>
✅ <code>mpi4py</code> fix
</summary>
<!-- `mpi4py` fix -->
<p>To resolve this</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Abort</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Fatal error in internal_Init_thread: Other MPI error</span></code></pre></div>
<p>issue we can simply load the correct modules:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /home/jmitche1/anl_release/2024/q2</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks_2024_5_v2</span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /home/ftartagl/graphics-compute-runtime/modulefiles</span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load graphics-compute-runtime/agama-ci-devel-803.29 </span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load spack-pe-gcc/0.6.1-23.275.2 gcc/12.2.0</span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0</span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load oneapi/release/2024.04.15.001</span></code></pre></div>
<p>For full details see <a href="mpi4py-reproducer.md">mpi4py-reproducer</a>, and this [<a href="https://cels-anl.slack.com/archives/C05V0SRAVB6/p1715867557424879">slack thread</a>].</p>
<!-- ::: -->
</details>
</section>
</section>
<section id="framework-comparison" class="level2">
<h2 class="anchored" data-anchor-id="framework-comparison">🕵🏻‍ Framework Comparison ??</h2>
<p>As I was re-building MPI, and after talking to Jerome, I realized that <em>most</em> of the dependencies are already present in the provided <code>frameworks/</code> modules on Sunspot.</p>
<p>As a simple test, I tried building a new environment built on the base <code>conda</code> environment<sup>2</sup> provided by the<code>frameworks/2023.12.15.001</code> module, which worked without modification and had ) <em>most</em> of what I needed already installed:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb7-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> torch.__version__</span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.0a0+cxx11.abi'</span></span>
<span id="cb7-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span>
<span id="cb7-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> ipex.__version__</span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.10+xpu'</span></span>
<span id="cb7-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpi4py <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MPI</span></code></pre></div>
<p>The remaining dependencies were installed according to the instructions from the <strong>new</strong> release <code>frameworks_2024_5_v2</code>.</p>
<p>Details included below.</p>
<details closed="">
<summary>
📦 <code>pip</code> Install Dependencies
</summary>
<p>Unfortunately, the <code>frameworks/**</code> don’t appear to provide DeepSpeed.</p>
<p>We can create a virtual environment on top of the base conda by</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use frameworks/2023.12.15.001</span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ALCF/helpers.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">setup_venv_from_conda</span></span></code></pre></div>
<p>Once the <code>venv</code> has been created and activated, we can install the remaining dependencies:</p>
<p>To build / install DeepSpeed, along with its required dependencies:</p>
<ul>
<li><p><code>intel-extension-for-deepspeed</code>:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install intel_extension_for_pytorch_deepspeed<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\=\=</span>2.1.30 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://pytorch-extension.intel.com/release-whl/stable/xpu/us/intel-extension-for-pytorch-deepspeed/"</span></span></code></pre></div></li>
<li><p><code>DeepSpeed</code>:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"build deepspeed"</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/microsoft/DeepSpeed.git</span>
<span id="cb10-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> DeepSpeed</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add yizhou_ds https://github.com/YizhouZ/DeepSpeed.git</span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> fetch yizhou_ds</span>
<span id="cb10-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout yizhou/kernel_path</span>
<span id="cb10-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements/requirements.txt</span>
<span id="cb10-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> setup.py develop <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span></code></pre></div></li>
<li><p>Extras:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install transformers datasets python-etcd tensorboardX packaging sentencepiece bitsandbytes tiktoken neural-speed einops intel-extension-for-transformers</span></code></pre></div></li>
</ul>
</details>
<p>Looking around the available modules a bit, I noticed a newer frameworks release (<code>frameworks/2024.04.15.002</code>) that had a newer version of both <code>torch</code> and <code>ipex</code>:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0</span>
<span id="cb12-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks/2024.04.15.002.lua</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI; print(MPI.__file__)'</span></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /soft/datascience/aurora_nre_models_frameworks-2024.1_preview_u1/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so</span></span></code></pre></div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb13-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> torch.__version__</span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.0.post2+cxx11.abi'</span></span>
<span id="cb13-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span>
<span id="cb13-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> ipex.__version__</span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.30+xpu'</span></span>
<span id="cb13-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpi4py <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MPI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(MPI.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__file__</span>)</span>
<span id="cb13-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>soft<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>datascience<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>aurora_nre_models_frameworks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2024.1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">_preview_u1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>lib<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>python3<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>site<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>mpi4py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>MPI.cpython<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x86_64<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>linux<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gnu.so</span></code></pre></div>
<p>The remaining dependencies were installed identically to what was just done previously for the <code>frameworks/2023.12.15.001</code> module.</p>
<p><strong>NOTE</strong>: In the figures below, we denote these two environments as:</p>
<ul>
<li><code>2024.0</code>:
<ul>
<li><code>module load frameworks/2023.12.15.001</code></li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li><code>module use /soft/preview-modulefiles/24.086.0</code></li>
<li><code>module load frameworks/2024.04.15.002.lua</code></li>
</ul></li>
<li><code>anl_24_q2_release</code>:
<ul>
<li><code>eval "$(~/miniconda3/bin/conda shell.zsh hook)"</code></li>
<li><code>conda activate anl_24_q2_release</code></li>
</ul></li>
</ul>
<section id="fix-in-disguise" class="level3">
<h3 class="anchored" data-anchor-id="fix-in-disguise">🥸 Fix in Disguise</h3>
<p>Armed now with functional environment(s) for <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a>, I was able to resume my previous experiments.</p>
<p>From the discussion with Intel, it was hard to understand / reason about <em>why</em> the <code>flash-attn</code> fix would have <em>any</em> dependence on the learning rate schedule (warmup + decay).</p>
<p>If the <code>flash-attn</code> fix works for a particular learning rate schedule, you would reasonably expect that it should work for <em>any</em> learning rate schedule.</p>
<p>An additional source of confusion for me was that the discrepancy in the loss curves (seemingly) disappeared when using the learning rate settings provided by Intel<sup>3</sup>, but not when using the ALCF defaults<sup>4</sup>.</p>
<p>After thinking about it for a bit and trying to reason about possible causes, I wondered if it might not be a mix of multiple different factors:</p>
<ol type="1">
<li>Small learning rate</li>
<li>Very long decay</li>
<li>[maybe ?] somehow dependent on the learning rate warmup fraction
<ol type="1">
<li>preliminary experiments seemed to suggest this was not the case</li>
</ol></li>
</ol>
<p>So, I was curious what would happen if I used the (larger) learning rate value from the ALCF defaults (<code>lr=0.003</code>) with the very long <code>lr-decay-iters: 320000</code> from Intel.</p>
<p>These results are shown below.</p>
<p>In particular, for all three experiments the following learning rate settings were used:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource yml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0003</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-warmup-frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-decay-iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320000</span></span></code></pre></div>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay10000-1.png" class="img-fluid" alt="flash-attn-disguise-decay10000-1"> Looking at this figure ^, it appears that up until the very very end, all three loss curves agree <em>identically</em>.</p>
<p>However, if we look closely at the very end, it looks like there <em>might</em> be a <em>slight</em> difference beginning to appear between the <code>2024.0</code> (brown line) and <code>{anl_24_q2_release, 2024.1}</code> ({dark, light} blue lines, respectively).</p>
<p>Thinking that I might be onto something, I then tried again with a smaller <code>lr-decay-iters: 5000</code>.</p>
<p>This result is shown below:</p>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay5000.png" class="img-fluid" alt="flash-attn-disguise-decay5000"> In particular, we can now more clearly see the difference beginning to appear between the <code>2024.0</code> and <code>2024.1</code> loss curves.</p>
<p>Continuing on, we see this effect become increasingly dramatic with even smaller values of <code>lr-decay-iters</code>:</p>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay-2000.png" class="img-fluid" alt="flash-attn-disguise-decay-2000"> <img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay1500.png" class="img-fluid" alt="flash-attn-disguise-decay1500"></p>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay1000-1.png" class="img-fluid" alt="flash-attn-disguise-decay1000-1"> In each of these experiments, it appears that:</p>
<ul>
<li><code>2024.0</code>:
<ul>
<li>Not impacted by this <code>lr-decay-iters</code> dependence</li>
<li>Continue to decrease for the duration of training</li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li>Impacted by the <code>lr-decay-iters</code> dependence</li>
<li>Plateaus towards the end of training</li>
</ul></li>
</ul>
<details closed="">
<summary>
Older Figs
</summary>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/disguised-fix-2.png" class="img-fluid" alt="disguised-fix-2"> <img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/disguised-fix-1.png" class="img-fluid" alt="disguised-fix-1"></p>
</details>
</section>
<section id="fix" class="level3">
<h3 class="anchored" data-anchor-id="fix">✅ <code>2024.0</code> Fix</h3>
<p><strong>Everything</strong> seems to work with</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks/2023.12.15.001</span></code></pre></div>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-2024-0-fix.png" class="img-fluid"> <img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/flash-attn-fix-frameworks-comparison.png" class="img-fluid"></p>
</section>
<section id="lr-decay-iters-comparison" class="level3">
<h3 class="anchored" data-anchor-id="lr-decay-iters-comparison">📊 <code>lr-decay-iters</code> Comparison</h3>
<ul>
<li><code>2024.0</code>:
<ul>
<li><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/decay-experiment-2024-0-1.png" class="img-fluid"></li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/flash-attn/decay-experiment-2024-1.png" class="img-fluid"></li>
</ul></li>
</ul>
</section>
</section>
<section id="lr-decay-iters-dependence" class="level2">
<h2 class="anchored" data-anchor-id="lr-decay-iters-dependence">📈 <code>lr-decay-iters</code> dependence</h2>
<p><a href="./assets/lr-decay-iters-dependence-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/lr-decay-iters-dependence-2.png" class="img-fluid"></a></p>
<p><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/lr-schedule-dependence.png" class="img-fluid"> <img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/lr-decay-iters-dependence-1.png" class="img-fluid"></p>
</section>
<section id="performance-improvement-in-2024.1" class="level2">
<h2 class="anchored" data-anchor-id="performance-improvement-in-2024.1">🏎️ Performance Improvement in <code>2024.1</code></h2>
<p><a href="./assets/performance-2024-0.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/performance-2024-0.png" class="img-fluid"></a></p>
<p><a href="./assets/performance-2024-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://samforeman.me/qmd/flash-attn-sunspot/assets/performance-2024-1.png" class="img-fluid"></a></p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource yml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0003</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-warmup-frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-decay-iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">null</span></span></code></pre></div>



</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Gremlin">Gremlins</a>, likely↩︎</p></li>
<li id="fn2"><p>Explicitly, <code>aurora_nre_models_frameworks-2024.0</code>, abbreviated as <code>2024.0</code>↩︎</p></li>
<li id="fn3"><p>Intel used the following learning rate schedule in their experiments <code>yml   lr: 0.00015   lr-warmup-frac: 0.01   lr-decay-iters: 320000</code>↩︎</p></li>
<li id="fn4"><p>ALCF used the following learning rate schedule in their experiments↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Personal {Website}},
  date = {2024-06-15},
  url = {https://samforeman.me},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“Personal Website.”</span> June 15, 2024. <a href="https://samforeman.me">https://samforeman.me</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/flash-attn-sunspot/</guid>
  <pubDate>Sat, 15 Jun 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title></title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/mpi4py-reproducer/</link>
  <description><![CDATA[ <div class="quarto-title-block"><div class="quarto-title-tools-only"><h1></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="https://github.com/saforem2/personal_site/blob/main/qmd/mpi4py-reproducer/index.qmd"><i class="bi"></i></button></div></div>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="mpi4py-bug-on-sunspot" class="level1">
<h1>🐛 <code>mpi4py</code> bug on Sunspot</h1>
<p>Simple reproducer:</p>
<ol type="1">
<li><p>Load my <code>anl_24_q2_release</code> conda environment:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:42:38 AM][foremans@x1922c2s3b0n0][~]</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> eval <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">~/miniconda3/bin/conda</span> shell.zsh hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate anl_24_q2_release</span></code></pre></div></li>
<li><p>Try <code>python3 -c 'from mpi4py import MPI'</code></p>
<ul>
<li>fails ❌</li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:44:41 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI'</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Traceback</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb2-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;string&gt;"</span>, line 1, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ImportError:</span> /home/foremans/miniconda3/envs/anl_24_q2_release/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so: undefined symbol: MPI_Message_c2f</span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    14910 exit 1     python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI'</span></span></code></pre></div></li>
<li><p>Load correct modules:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:44:58 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use /home/ftartagl/graphics-compute-runtime/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load graphics-compute-runtime/agama-ci-devel-803.29 spack-pe-gcc/0.6.1-23.275.2 gcc/12.2.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load oneapi/release/2024.04.15.001</span>
<span id="cb3-3">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> agama-ci-devel-803.29 successfully loaded:</span>
<span id="cb3-4">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> graphics-compute-runtime/agama-ci-devel-803.29</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb3-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich-config/collective-tuning/1024</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">The</span> following have been reloaded with a version change:</span>
<span id="cb3-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">intel_compute_runtime/release/agama-devel-736.25</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> intel_compute_runtime/release/775.20     2<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich/icc-all-pmix-gpu/52.2</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> mpich/icc-all-pmix-gpu/20231026     3<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneapi/eng-compiler/2023.12.15.002</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> oneapi/release/2024.04.15.001</span></code></pre></div></li>
<li><p>Retry with new modules:</p>
<ul>
<li>works ✅</li>
</ul>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:45:01 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI; print(MPI.__file__)'</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_24_q2_release/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so</span></span></code></pre></div></li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Personal {Website}},
  date = {2024-05-25},
  url = {https://samforeman.me},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“Personal Website.”</span> May 25, 2024. <a href="https://samforeman.me">https://samforeman.me</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/mpi4py-reproducer/</guid>
  <pubDate>Sat, 25 May 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>🎲 MCMC + Diffusion Sampling</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/l2hmc-qcd/diffusion/diffusion.html</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="denoising-diffusion-probabilistic-models" class="level2">
<h2 class="anchored" data-anchor-id="denoising-diffusion-probabilistic-models">Denoising Diffusion Probabilistic Models</h2>
</section>
<section id="imports--setup" class="level2">
<h2 class="anchored" data-anchor-id="imports--setup">Imports / Setup</h2>
<div id="f924fcb4-d11e-44c4-acc5-caf9f50ea803" class="cell code" data-execution_count="1" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:25.674067Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:25.673461Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:26.976641Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:26.976187Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:25.674029Z&quot;}" data-jukit_cell_id="ZlqRKELWeh">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> __future__ <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> absolute_import, print_function, annotations, division</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dataclasses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dataclass</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scipy</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> random <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> randrange</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span></code></pre></div>
</div>
<div id="707c54d9-1cee-4452-a9e8-beab67f6bb5e" class="cell code" data-execution_count="2" data-execution="{'iopub.execute_input':'2023-09-21T17:23:27.398552Z','iopub.status.busy':'2023-09-21T17:23:27.398037Z','iopub.status.idle':'2023-09-21T17:23:29.370420Z','shell.execute_reply':'2023-09-21T17:23:29.370048Z','shell.execute_reply.started':'2023-09-21T17:23:27.398512Z'}">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ezpz.dist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> setup_torch</span>
<span id="cb2-2"></span>
<span id="cb2-3">port <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6000</span>)</span>
<span id="cb2-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Using port: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>port<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6">RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_torch(</span>
<span id="cb2-7">    backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb2-8">    port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>port<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-9">)</span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
    Using port: 5561
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Using DDP for distributed training
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Global Rank: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #800080; text-decoration-color: #800080">/</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
</pre>
</div>
<p>:::</p>
<div id="b55dfeab-27a1-4322-af80-44380adbaadf" class="cell code" data-execution_count="3" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:29.371628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:29.371422Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:30.756041Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:30.755862Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:29.371616Z&quot;}" data-jukit_cell_id="ZlqRKELWeh">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib_inline</span>
<span id="cb3-3">matplotlib_inline.backend_inline.set_matplotlib_formats(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'svg'</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.main <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> build_experiment</span>
<span id="cb3-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.rich <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_console</span>
<span id="cb3-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.plot_helpers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_plot_style</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> opinionated</span>
<span id="cb3-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PureMH, MH_Diffusion</span>
<span id="cb3-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.plot_helpers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_plot_style</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pandas.io.formats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> style</span>
<span id="cb3-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scipy</span>
<span id="cb3-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb3-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> random <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> randrange</span>
<span id="cb3-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PureMH, MH_Diffusion</span>
<span id="cb3-18"></span>
<span id="cb3-19">set_plot_style()</span>
<span id="cb3-20">console <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_console()</span>
<span id="cb3-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(console.is_jupyter)</span>
<span id="cb3-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> console.is_jupyter:</span>
<span id="cb3-23">    console.is_jupyter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb3-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(console.is_jupyter)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Using device: cpu
</pre>
</div>
<div class="cell-output cell-output-display">
<p>Failed to download font: Source Sans Pro, skipping! Failed to download font: Titillium WebRoboto Condensed, skipping!</p>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">True
</pre>
</div>
<div class="cell-output cell-output-display">
<p>False</p>
</div>
</div>
<div id="a6523472-488a-49e9-bfd6-6ca8fb953650" class="cell code" data-execution_count="5" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:30.954621Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:30.954289Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:31.061599Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:31.058688Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:30.954598Z&quot;}">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1">plt.style.use(opinionated.STYLES[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'opinionated_min'</span>])</span>
<span id="cb4-2">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span></code></pre></div>
</div>
</section>
<div id="3c521572" class="cell markdown">
<section id="2d-u1" class="level2">
<h2 class="anchored" data-anchor-id="2d-u1">2D <img src="https://latex.codecogs.com/png.latex?U(1)"></h2>
</section>
</div>
<div id="b853ba57" class="cell code" data-execution_count="6" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:46.575842Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:46.575002Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:46.644400Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:46.644215Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:46.575810Z&quot;}" data-jukit_cell_id="x8zCEYjYIg">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.configs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dict_to_list_of_overrides</span>
<span id="cb5-2"></span>
<span id="cb5-3">seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb5-4">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"seed = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>seed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6">overrides <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb5-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>seed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"float32"</span>,</span>
<span id="cb5-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_wandb"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_aim"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dynamics"</span>: {</span>
<span id="cb5-13">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latvolume"</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>],</span>
<span id="cb5-14">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nleapfrog"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb5-15">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nchains"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb5-16">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eps"</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,</span>
<span id="cb5-17">    },</span>
<span id="cb5-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"network"</span>: {</span>
<span id="cb5-19">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_batch_norm"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-20">    },</span>
<span id="cb5-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'annealing_schedule'</span>: {</span>
<span id="cb5-22">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta_init'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb5-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta_final'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb5-24">    },</span>
<span id="cb5-25"></span>
<span id="cb5-26">}</span>
<span id="cb5-27">OVERRIDES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dict_to_list_of_overrides(overrides)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>seed = 1675333995</code></pre>
</div>
</div>
<div id="5ae7bc5d" class="cell code" data-execution_count="7" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:53.284515Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:53.284077Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:53.362789Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:53.362643Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:53.284485Z&quot;}" data-jukit_cell_id="iKzpP0xANE">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_timestamp</span>
<span id="cb7-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> enrich.console <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_theme, Console</span>
<span id="cb7-4">console <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Console(theme<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_theme())</span>
<span id="cb7-5"></span>
<span id="cb7-6">OUTDIR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(</span>
<span id="cb7-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l2hmc-diffusion-2dU1'</span></span>
<span id="cb7-8">).joinpath(get_timestamp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb7-9">OUTDIR.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb7-10">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"OUTDIR: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>OUTDIR<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb7-11"></span>
<span id="cb7-12">date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_timestamp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%Y-%m-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb7-13">PLOTS_DIR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OUTDIR.joinpath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plots'</span>)</span>
<span id="cb7-14">PLOTS_DIR.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb7-15">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving figures to: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>PLOTS_DIR<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">OUTDIR: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Saving figures to: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>/plots
</pre>
</div>
</div>
<div id="4ca95dea" class="cell code" data-execution_count="8" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:55.013350Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:55.012634Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:24:09.645580Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:24:09.645178Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:55.013316Z&quot;}" data-jukit_cell_id="lHICETmP7j">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#os.environ['MASTER_PORT'] = '5436'</span></span>
<span id="cb8-2"></span>
<span id="cb8-3">exp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> build_experiment(</span>
<span id="cb8-4">    overrides<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb8-5">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>OVERRIDES,</span>
<span id="cb8-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'framework=pytorch'</span>,</span>
<span id="cb8-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'backend=DDP'</span></span>
<span id="cb8-8">    ]</span>
<span id="cb8-9">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">[09/21/23 12:23:55][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:23:55][INFO][dist.py:338] - Global Rank: 0 / 0
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/train
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/eval
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/hmc
[09/21/23 12:23:58][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:23:58][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:24:06][INFO][trainer.py:441] - Looking for checkpoints in:
 /Users/samforeman/projects/saforem2/l2hmc-qcd/src/l2hmc/checkpoints/U1/2-32-32/nlf-10/xsplit-True/sepnets-True/merge-True/conv-8-16-32-64-128_5-3-3-3-2_2-2-2-2-2/net-16-16-16-16_dp-0.2_bn-False/pytorch
[09/21/23 12:24:06][WARNING][trainer.py:437] - No checkpoints found to load from
[09/21/23 12:24:06][WARNING][trainer.py:437] - Restoring global step from ckpt! self._gstep: 0
[09/21/23 12:24:06][WARNING][trainer.py:437] - Using `torch.optim.Adam` optimizer
[09/21/23 12:24:06][INFO][trainer.py:284] - num_params in model: 958628260
[09/21/23 12:24:09][WARNING][trainer.py:250] - logging with freq 50 for wandb.watch
</pre>
</div>
</div>
<div id="de33e6c7" class="cell code" data-execution_count="10" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:24:11.069316Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:24:11.067417Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:24:11.148435Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:24:11.148240Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:24:11.069247Z&quot;}" data-jukit_cell_id="9XP3KbsEEH">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1">state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>)</span>
<span id="cb9-2">xdim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.x.flatten().shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb9-3"></span>
<span id="cb9-4">dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xdim</span>
<span id="cb9-5">low_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.ones(dim)</span>
<span id="cb9-6">high_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.ones(dim)</span>
<span id="cb9-7">sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span></span>
<span id="cb9-8">retrains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb9-9">samples_per_retrain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb9-10">diffusion_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span></code></pre></div>
</div>
<div id="292fced2" class="cell code" data-execution_count="11" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:24:21.526369Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:24:21.525718Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:25:01.413937Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:25:01.413545Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:24:21.526320Z&quot;}" data-jukit_cell_id="KCwuqXXGds" data-scrolled="true">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb10-2"></span>
<span id="cb10-3">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb10-4">outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>(</span>
<span id="cb10-5">    job_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>,</span>
<span id="cb10-6">    beta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb10-7">    nprint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb10-8">    nchains<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb10-9">    eval_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb10-10">)</span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#hdset = exp.save_dataset(job_type='hmc', nchains=1)</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[09/21/23 12:24:21][WARNING][trainer.py:437] - Step size `eps` not specified for HMC! Using default: 0.1000 for generic HMC
[09/21/23 12:24:21][WARNING][trainer.py:437] - x.shape (original): torch.Size([16, 2, 32, 32])
[09/21/23 12:24:21][WARNING][trainer.py:437] - x[:nchains].shape: torch.Size([16, 2, 32, 32])
[09/21/23 12:24:21][INFO][trainer.py:1058] - eps=0.1
beta=6.0
nlog=10
table=&lt;rich.table.Table object at 0x2e1b98520&gt;
nprint=100
eval_steps=1000
nleapfrog=20</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/fa5ecb88f2753cbd4123a5c4bd20a87fbfd4d143.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/fa5ecb88f2753cbd4123a5c4bd20a87fbfd4d143.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>[09/21/23 12:24:24][INFO][trainer.py:1188] - hstep=0 dt=0.024 beta=6.000 loss=3.410 dQsin=0.125 dQint=0.000 energy=1586.502 logprob=1586.502 logdet=0.000 acc=0.472 sumlogdet=0.000 acc_mask=0.500 plaqs=0.909 intQ=0.000 sinQ=0.051
[09/21/23 12:24:27][INFO][trainer.py:1188] - hstep=100 dt=0.026 beta=6.000 loss=2.876 dQsin=0.163 dQint=0.000 energy=1555.800 logprob=1555.800 logdet=0.000 acc=0.593 sumlogdet=0.000 acc_mask=0.688 plaqs=0.912 intQ=-0.125 sinQ=-0.159
[09/21/23 12:24:31][INFO][trainer.py:1188] - hstep=200 dt=0.025 beta=6.000 loss=4.678 dQsin=0.088 dQint=0.063 energy=1569.994 logprob=1569.994 logdet=0.000 acc=0.451 sumlogdet=0.000 acc_mask=0.250 plaqs=0.912 intQ=-0.187 sinQ=-0.149
[09/21/23 12:24:34][INFO][trainer.py:1188] - hstep=300 dt=0.024 beta=6.000 loss=14.041 dQsin=0.094 dQint=0.000 energy=1554.118 logprob=1554.118 logdet=0.000 acc=0.438 sumlogdet=0.000 acc_mask=0.438 plaqs=0.914 intQ=-0.125 sinQ=-0.114
[09/21/23 12:24:38][INFO][trainer.py:1188] - hstep=400 dt=0.024 beta=6.000 loss=-0.739 dQsin=0.199 dQint=0.000 energy=1566.516 logprob=1566.516 logdet=0.000 acc=0.509 sumlogdet=0.000 acc_mask=0.562 plaqs=0.912 intQ=-0.437 sinQ=-0.452
[09/21/23 12:24:41][INFO][trainer.py:1188] - hstep=500 dt=0.045 beta=6.000 loss=1.545 dQsin=0.100 dQint=0.000 energy=1570.837 logprob=1570.837 logdet=0.000 acc=0.448 sumlogdet=0.000 acc_mask=0.562 plaqs=0.911 intQ=0.125 sinQ=0.189
[09/21/23 12:24:45][INFO][trainer.py:1188] - hstep=600 dt=0.025 beta=6.000 loss=3.780 dQsin=0.094 dQint=0.000 energy=1568.012 logprob=1568.012 logdet=0.000 acc=0.463 sumlogdet=0.000 acc_mask=0.500 plaqs=0.913 intQ=0.438 sinQ=0.466
[09/21/23 12:24:50][INFO][trainer.py:1188] - hstep=700 dt=0.023 beta=6.000 loss=-0.902 dQsin=0.113 dQint=0.000 energy=1563.778 logprob=1563.778 logdet=0.000 acc=0.475 sumlogdet=0.000 acc_mask=0.375 plaqs=0.913 intQ=0.688 sinQ=0.628
[09/21/23 12:24:53][INFO][trainer.py:1188] - hstep=800 dt=0.024 beta=6.000 loss=11.416 dQsin=0.061 dQint=0.000 energy=1561.427 logprob=1561.427 logdet=0.000 acc=0.339 sumlogdet=0.000 acc_mask=0.438 plaqs=0.913 intQ=0.813 sinQ=0.755
[09/21/23 12:24:57][INFO][trainer.py:1188] - hstep=900 dt=0.028 beta=6.000 loss=1.114 dQsin=0.127 dQint=0.000 energy=1564.465 logprob=1564.465 logdet=0.000 acc=0.699 sumlogdet=0.000 acc_mask=0.625 plaqs=0.913 intQ=0.938 sinQ=0.893</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/4291d2280ebb3b7d7fd410b6fbd5a7999b28d1e6.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/4291d2280ebb3b7d7fd410b6fbd5a7999b28d1e6.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="a62b5515-1fbe-4a78-9330-a4e675adc55d" class="cell code" data-execution_count="12" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:25:05.409303Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:25:05.408268Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:25:33.378971Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:25:33.378687Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:25:05.409256Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %matplotlib inline</span></span>
<span id="cb13-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot_dataset</span>
<span id="cb13-3">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb13-4">hdataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'history'</span>].get_dataset()</span>
<span id="cb13-5">plot_dataset(hdataset, outdir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PLOTS_DIR, job_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[09/21/23 12:25:06][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/energy_ridgeplot.svg
[09/21/23 12:25:09][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/logprob_ridgeplot.svg
[09/21/23 12:25:11][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/logdet_ridgeplot.svg</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/68eb7a87933506e4ea9f017913c8f1eb3d474f82.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/68eb7a87933506e4ea9f017913c8f1eb3d474f82.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/91f9822f7846afea800b646ef6d7f00adbe10a41.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/91f9822f7846afea800b646ef6d7f00adbe10a41.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/c51d8b2dcc6ec0e2de63ff069d3730bb571457b0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/c51d8b2dcc6ec0e2de63ff069d3730bb571457b0.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/f4712af7b26ced3d77075d986993d9ed41e01438.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/f4712af7b26ced3d77075d986993d9ed41e01438.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/52754b8f1d67eb90a526f91bf820f0ab6f00f3e6.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/52754b8f1d67eb90a526f91bf820f0ab6f00f3e6.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/150b885c11a3eb085ac620b73b278b467bf2accf.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/150b885c11a3eb085ac620b73b278b467bf2accf.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/eee837b584211a155df0693c80ab0f74ef3df2d9.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/eee837b584211a155df0693c80ab0f74ef3df2d9.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/d7f0c56ea62b31af4a43a53d6eb9d0e46a0d0979.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/d7f0c56ea62b31af4a43a53d6eb9d0e46a0d0979.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/79d781dfd4250c92dd76a8d8d3185ef5f4bf0edb.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/79d781dfd4250c92dd76a8d8d3185ef5f4bf0edb.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/ba6c79eb08e2df2807d207201f4260fcfb41a55d.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/ba6c79eb08e2df2807d207201f4260fcfb41a55d.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/be9f0e6e22b1f8d41ba35ef1c2e7c53026cdd606.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/be9f0e6e22b1f8d41ba35ef1c2e7c53026cdd606.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/acbf03bb04c361e167eefed84a13de13ef8ee37c.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/acbf03bb04c361e167eefed84a13de13ef8ee37c.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/c919c93d92e6aec85e840c2ad8cb47eb30a8b015.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/c919c93d92e6aec85e840c2ad8cb47eb30a8b015.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/7e5ffe849dbd6a7b8314042e953d762ab9e4286b.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/7e5ffe849dbd6a7b8314042e953d762ab9e4286b.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/713d68e5d1fdd22fb92855cc3e25255035f0770c.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/713d68e5d1fdd22fb92855cc3e25255035f0770c.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/368f5610bb37915389764b0b7392edd577eaf415.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/368f5610bb37915389764b0b7392edd577eaf415.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/86fc3f47b8b4020e2b94ff74e79fdb3558c43f80.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/86fc3f47b8b4020e2b94ff74e79fdb3558c43f80.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/835139501cc9fcf6442be81e0033045b8f33ae74.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/835139501cc9fcf6442be81e0033045b8f33ae74.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="80a4cca0-19fd-43aa-83a5-8bd9c18da011" class="cell code" data-execution_count="13" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:26:40.599785Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:26:40.598293Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:07.102561Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:07.101951Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:26:40.599694Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb15-2"></span>
<span id="cb15-3">initial_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-4">state_init <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>)</span>
<span id="cb15-5">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state_init.x</span>
<span id="cb15-6">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state_init.beta</span>
<span id="cb15-7"></span>
<span id="cb15-8">NSAMPLES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb15-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(NSAMPLES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> NSAMPLES)):</span>
<span id="cb15-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb15-11">        console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"step: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb15-12">        </span>
<span id="cb15-13">    x, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((x, beta))</span>
<span id="cb15-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> NSAMPLES)):</span>
<span id="cb15-15">        initial_states.append(x)</span>
<span id="cb15-16"></span>
<span id="cb15-17">initial_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(initial_states).squeeze()</span>
<span id="cb15-18">initial_states_np <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.detach().cpu().numpy()</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">100</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">200</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">300</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">400</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">500</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">600</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">700</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">800</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">900</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">1000</span>
</pre>
</div>
</div>
<div id="b3874832-0782-4b49-a025-742be370675d" class="cell code" data-execution_count="14" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:27:37.023220Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:27:37.022568Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:37.170197Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:37.169976Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:27:37.023184Z&quot;}">
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1">initial_states_np.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>(999, 16, 2048)</code></pre>
</div>
</div>
<div id="46eea215-ac24-46ed-b334-648ab0f082b0" class="cell code" data-execution_count="15" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:27:45.524060Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:27:45.523874Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:45.610750Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:45.610562Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:27:45.524045Z&quot;}">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1">x_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states_np.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb18-2">tmp_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ...]</span>
<span id="cb18-3">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>x_<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb18-4">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tmp_<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="font-weight: bold">(</span><span style="color: #2094f3; text-decoration-color: #2094f3">999</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">)</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="font-weight: bold">(</span><span style="color: #2094f3; text-decoration-color: #2094f3">999</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">)</span>
</pre>
</div>
</div>
<div id="00862566-256a-4e1b-b96f-b289e146ed65" class="cell code" data-execution_count="16" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:28:23.005041Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:28:23.004835Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:28:41.019060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:28:41.018864Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:28:23.005025Z&quot;}">
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> savefig</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#x_ = initial_states_np[:100].reshape(-1, 2, 32, 32)</span></span>
<span id="cb19-4">tmp_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ...]</span>
<span id="cb19-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb19-6">sns.kdeplot(</span>
<span id="cb19-7">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tmp_[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].flatten(),</span>
<span id="cb19-8">    y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tmp_[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].flatten(),</span>
<span id="cb19-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax=ax,</span></span>
<span id="cb19-10">    cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>,</span>
<span id="cb19-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax=axes[0],</span></span>
<span id="cb19-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cmap="Blues",</span></span>
<span id="cb19-13">    shade<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb19-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bw_adjust=0.5,</span></span>
<span id="cb19-15">    thresh<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb19-16">)</span>
<span id="cb19-17">ax.set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb19-18">ax.set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb19-19">savefig(</span>
<span id="cb19-20">    <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'hmc_samples-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>NSAMPLES<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb19-21">    Path(PLOTS_DIR),</span>
<span id="cb19-22">    tstamp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb19-23">)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Saving hmc_samples-1000-2023-09-21-122840 to l2hmc-diffusion-2dU1/2023-09-21/plots</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/70234c6bf6df3cbd32f9de96e36e740eda0ed20d.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/70234c6bf6df3cbd32f9de96e36e740eda0ed20d.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="544a477a-05cd-4e1f-b11f-5f9d29c61918" class="cell code" data-execution_count="28" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:03:31.911850Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:03:31.910702Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:03:32.065942Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:03:32.065721Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:03:31.911790Z&quot;}">
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Diffusion:</span>
<span id="cb21-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb21-3">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb21-4">            noise_steps: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb21-5">            beta_start: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>,</span>
<span id="cb21-6">            beta_end: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>,</span>
<span id="cb21-7">            nchannels: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb21-8">            img_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,</span>
<span id="cb21-9">            device: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span></span>
<span id="cb21-10">    ):</span>
<span id="cb21-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_steps</span>
<span id="cb21-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta_start</span>
<span id="cb21-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta_end</span>
<span id="cb21-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> img_size</span>
<span id="cb21-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> device</span>
<span id="cb21-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.nchannels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nchannels</span>
<span id="cb21-17"></span>
<span id="cb21-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.prepare_noise_schedule().to(device)</span>
<span id="cb21-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta</span>
<span id="cb21-20">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cumprod(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb21-21"></span>
<span id="cb21-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> prepare_noise_schedule(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb21-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.linspace(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_start, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_end, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps)</span>
<span id="cb21-24"></span>
<span id="cb21-25">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> noise_images(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x, t):</span>
<span id="cb21-26">        sqrt_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t])[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb21-27">        sqrt_one_minus_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(</span>
<span id="cb21-28">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t]</span>
<span id="cb21-29">        )[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb21-30">        eps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(x)</span>
<span id="cb21-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> sqrt_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sqrt_one_minus_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> eps, eps</span>
<span id="cb21-32"></span>
<span id="cb21-33">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sample_timesteps(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n):</span>
<span id="cb21-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.randint(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,))</span>
<span id="cb21-35"></span>
<span id="cb21-36">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> sample(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, model, n):</span>
<span id="cb21-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># console.print(f"Sampling {n} new images....")</span></span>
<span id="cb21-38">        model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb21-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb21-40">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(</span>
<span id="cb21-41">                (n, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.nchannels, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size)</span>
<span id="cb21-42">            ).to(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device)</span>
<span id="cb21-43">            sample_bar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(</span>
<span id="cb21-44">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">reversed</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps)),</span>
<span id="cb21-45">                position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb21-46">                total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb21-47">                dynamic_ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb21-48">            )</span>
<span id="cb21-49">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> sample_bar:</span>
<span id="cb21-50">                t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (torch.ones(n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> i).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>().to(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device)</span>
<span id="cb21-51">                predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x, t)</span>
<span id="cb21-52">                alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb21-53">                alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb21-54">                beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb21-55">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb21-56">                    noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(x)</span>
<span id="cb21-57">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb21-58">                    noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros_like(x)</span>
<span id="cb21-59">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb21-60">                    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> torch.sqrt(alpha))</span>
<span id="cb21-61">                    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (</span>
<span id="cb21-62">                        x </span>
<span id="cb21-63">                        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (torch.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha_hat)))</span>
<span id="cb21-64">                        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> predicted_noise</span>
<span id="cb21-65">                    ) </span>
<span id="cb21-66">                    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (torch.sqrt(beta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> noise)</span>
<span id="cb21-67">                )</span>
<span id="cb21-68">        model.train()</span>
<span id="cb21-69">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.pi</span>
<span id="cb21-70">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> x</span></code></pre></div>
</div>
<div id="f49c6213-2274-45e5-bc10-01a46e19d7c6" class="cell code" data-execution_count="29" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:03:32.936448Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:03:32.936214Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:03:33.006979Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:03:33.006767Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:03:32.936420Z&quot;}">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1">initial_states.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<pre><code>torch.Size([999, 16, 2048])</code></pre>
</div>
</div>
<div id="dcfb6322-b8d5-4f4a-8c74-6a9e1f9eb2c3" class="cell markdown">
<section id="train-diffusion-model" class="level2">
<h2 class="anchored" data-anchor-id="train-diffusion-model">Train Diffusion Model</h2>
</section>
</div>
<div id="24658ef0-6421-465a-aee3-45cbaa84fe16" class="cell code" data-execution_count="19" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:05.270957Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:05.270198Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:29:05.643233Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:29:05.643039Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:05.270924Z&quot;}">
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision</span>
<span id="cb24-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb24-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb24-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb24-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb24-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision</span>
<span id="cb24-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> T</span>
<span id="cb24-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb24-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb24-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#from fastdownload import FastDownload</span></span>
<span id="cb24-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb24-12"></span>
<span id="cb24-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> save_images(images, path, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb24-14">    grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torchvision.utils.make_grid(images, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb24-15">    ndarr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid.permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>).numpy()</span>
<span id="cb24-16">    im <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Image.fromarray(ndarr)</span>
<span id="cb24-17">    im.save(path)</span></code></pre></div>
</div>
<div id="bf6c6419-6d67-4e82-800f-19b896dc6a1b" class="cell markdown">
<section id="build-diffusion-model-with-unet-architecure" class="level2">
<h2 class="anchored" data-anchor-id="build-diffusion-model-with-unet-architecure">Build Diffusion Model with UNet Architecure</h2>
</section>
</div>
<div id="d7adbbf1-9a17-459c-ba2b-144605576790" class="cell code" data-execution_count="20" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:33.246111Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:33.245275Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:29:33.647190Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:29:33.646950Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:33.246094Z&quot;}">
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nn</span>
<span id="cb25-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> optim</span>
<span id="cb25-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn.functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> F</span>
<span id="cb25-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tqdm.auto <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm</span>
<span id="cb25-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb25-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TensorDataset</span>
<span id="cb25-7"></span>
<span id="cb25-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> savefig</span>
<span id="cb25-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.modules <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> NoiseScheduler, UNet</span>
<span id="cb25-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ddpm</span>
<span id="cb25-11"></span>
<span id="cb25-12">DEVICE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span></span>
<span id="cb25-13"></span>
<span id="cb25-14">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb25-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channels_in'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb25-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channels_out'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb25-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_batch_size'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb25-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>,</span>
<span id="cb25-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb25-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'noise_steps'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb25-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb25-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img_size'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb25-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'retrains'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb25-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'samples_per_retrain'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb25-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion_prob'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb25-26">}</span>
<span id="cb25-27"></span>
<span id="cb25-28">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> UNet(c_in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, c_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb25-29"></span>
<span id="cb25-30">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>))</span>
<span id="cb25-31">dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(</span>
<span id="cb25-32">    dataset,</span>
<span id="cb25-33">    batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>],</span>
<span id="cb25-34">    shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb25-35">    drop_last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb25-36">)</span>
<span id="cb25-37"></span>
<span id="cb25-38"></span>
<span id="cb25-39">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> optim.AdamW(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>])</span>
<span id="cb25-40">mse <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.MSELoss()</span>
<span id="cb25-41">diffusion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Diffusion(</span>
<span id="cb25-42">    noise_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb25-43">    img_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb25-44">    device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>DEVICE,</span>
<span id="cb25-45">    nchannels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb25-46">)</span>
<span id="cb25-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#logger = SummaryWriter(os.path.join("runs", args.run_name))</span></span>
<span id="cb25-48">l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span>
<span id="cb25-49"></span>
<span id="cb25-50">run_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion2dU1'</span></span></code></pre></div>
</div>
<div id="5aed3b53-6261-4e0c-938d-07b0616d0a44" class="cell markdown">
<section id="perform-initial-training-on-hmc-samples" class="level3">
<h3 class="anchored" data-anchor-id="perform-initial-training-on-hmc-samples">Perform initial training on HMC samples</h3>
</section>
</div>
<div id="27fcd372-259b-4be5-830d-167a396aeac1" class="cell code" data-execution_count="21" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:54.637896Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:54.634898Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:45:06.940844Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:45:06.940627Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:54.637847Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> optim</span>
<span id="cb26-2">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span></span>
<span id="cb26-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#dataloader = get_data(args)</span></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model = UNet().to(device)</span></span>
<span id="cb26-5"></span>
<span id="cb26-6">sampled_images_history <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-7"></span>
<span id="cb26-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>]):</span>
<span id="cb26-9">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Starting epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span>)</span>
<span id="cb26-10">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(dataloader)</span>
<span id="cb26-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, images <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(pbar):</span>
<span id="cb26-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(images, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(images) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb26-13">            images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb26-14">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb26-15">        x_t, noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.noise_images(images, t)</span>
<span id="cb26-16">        predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x_t, t)</span>
<span id="cb26-17">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mse(noise, predicted_noise)</span>
<span id="cb26-18"></span>
<span id="cb26-19">        optimizer.zero_grad()</span>
<span id="cb26-20">        loss.backward()</span>
<span id="cb26-21">        optimizer.step()</span>
<span id="cb26-22"></span>
<span id="cb26-23">        pbar.set_postfix({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: epoch, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'batch'</span>: i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MSE'</span>: loss.item()})</span>
<span id="cb26-24">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'epoch: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb26-25">    sampled_images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample(model, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb26-26">    sampled_images_history.append(sampled_images)</span>
<span id="cb26-27">    sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb26-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#tmp = initial_states.reshape(-1, 2, 32, 32)</span></span>
<span id="cb26-29">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-30">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(sampled_images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :, :])</span>
<span id="cb26-31">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(sampled_images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :, :])</span>
<span id="cb26-32">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb26-33">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb26-34">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb26-35">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb26-36">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb26-37">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb26-38">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb26-39">    plt.show()</span>
<span id="cb26-40">    savefig(fname<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sampled_image_epoch</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, outdir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PLOTS_DIR, tstamp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb26-41">    MODEL_FILE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OUTDIR.joinpath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"models"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"unet-diffusion-epoch</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pt"</span>)</span>
<span id="cb26-42">    MODEL_FILE.parent.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb26-43">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving model checkpoint to: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>MODEL_FILE<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-44">    torch.save(model.state_dict(), MODEL_FILE)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Starting epoch <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>:
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"19b415c346b24bef8b60336d7f7bc355"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">epoch: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>, loss: <span style="color: #2094f3; text-decoration-color: #2094f3">0.6023472547531128</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eea24504754f4cb9ab4d9925a6225c10"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/e90001ab4bbbe38f50cca429a69bc2b212ed8a4d.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/e90001ab4bbbe38f50cca429a69bc2b212ed8a4d.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>Saving sampled_image_epoch0-2023-09-21-124506 to l2hmc-diffusion-2dU1/2023-09-21/plots</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Saving model checkpoint to: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>/models/unet-diffusion-epoch0.pt
</pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
</div>
<div id="c4ae942b-4617-4f1e-a837-68e95d6ddabc" class="cell code" data-execution_count="22" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:01:57.860377Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:01:57.859019Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:01:58.250584Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:01:58.250409Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:01:57.860309Z&quot;}">
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb31-2">tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb31-3">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb31-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(tmp[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :, :])</span>
<span id="cb31-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(tmp[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :, :])</span>
<span id="cb31-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb31-7">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb31-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb31-9">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb31-10">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb31-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb31-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/85261feb8c9ba70c38f9f40eb69b7b3bc4c670b0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/85261feb8c9ba70c38f9f40eb69b7b3bc4c670b0.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="2637733d-1da9-42e9-b00f-630b6b5d8269" class="cell code" data-execution_count="23" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:10.910463Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:10.910215Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:10.982520Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:10.982237Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:10.910447Z&quot;}">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1">sampled_images_history_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(sampled_images_history)</span></code></pre></div>
</div>
<div id="2afaff5c-a946-4080-90d7-bbb1af973ce0" class="cell code" data-execution_count="24" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:11.478836Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:11.478478Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:11.546438Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:11.546257Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:11.478818Z&quot;}">
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1">sampled_images_history_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>torch.Size([1, 5, 2, 32, 32])</code></pre>
</div>
</div>
<div id="c9397f4d-fbad-4332-b909-c671469b1f7d" class="cell code" data-execution_count="25" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:13.627514Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:13.627140Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:13.825037Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:13.824814Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:13.627490Z&quot;}">
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb35-2">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb35-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(sampled_images_history_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb35-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(sampled_images_history_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb35-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb35-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb35-7">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb35-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb35-9">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb35-10">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb35-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/b2807643bf74b33689a17754209e56554bfe1f52.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/b2807643bf74b33689a17754209e56554bfe1f52.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="70324363-7315-4c3f-9304-24c0509bdd6c" class="cell code" data-execution_count="27" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:25.159709Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:25.158545Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:25.258988Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:25.258835Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:25.159655Z&quot;}">
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(sampled_images_history_.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]):</span>
<span id="cb36-2">    q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.lattice.charges(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sampled_images_history_[idx])</span>
<span id="cb36-3">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>q<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #2094f3; text-decoration-color: #2094f3">0</span>: <span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">Charges</span><span style="font-weight: bold">(</span><span style="color: #7d8697; text-decoration-color: #7d8697">intQ</span>=<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">tensor</span><span style="font-weight: bold">([</span> <span style="color: #2094f3; text-decoration-color: #2094f3">5.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-6.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.5535e-07</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">1.0000e+00</span><span style="font-weight: bold">])</span>, <span style="color: #7d8697; text-decoration-color: #7d8697">sinQ</span>=<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">tensor</span><span style="font-weight: bold">([</span> <span style="color: #2094f3; text-decoration-color: #2094f3">1.6426</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-1.7244</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.4651</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">0.5680</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">0.7046</span><span style="font-weight: bold">]))</span>
</pre>
</div>
</div>
<div id="e8f0fae1-63eb-4522-8342-2d051f4705c4" class="cell markdown">
<section id="hmc-sampling-with-diffusion" class="level2">
<h2 class="anchored" data-anchor-id="hmc-sampling-with-diffusion">HMC Sampling with Diffusion</h2>
</section>
</div>
<div id="1b571b62-b713-4481-a328-fe3d1bcc0030" class="cell code" data-execution_count="32" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:08:36.186462Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:08:36.185269Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:08:36.391707Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:08:36.391500Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:08:36.186399Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for retrain_iter in range(config['retrains']):</span></span>
<span id="cb37-2">state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb37-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.x</span>
<span id="cb37-4"></span>
<span id="cb37-5">histories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb37-6">samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb37-7">hmc_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb37-8">diffusion_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb37-9"></span>
<span id="cb37-10">global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb37-11">watcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb37-12">update_types <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb37-13">combined_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span></code></pre></div>
</div>
<div id="4deb9af0-c9ca-4314-a393-7a206c15d1e6" class="cell code" data-execution_count="33" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:08:40.518616Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:08:40.518438Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:08:40.627283Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:08:40.625908Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:08:40.518604Z&quot;}">
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1">global_step</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>0</code></pre>
</div>
</div>
<div id="d3d35fc8-5067-4d51-8cc0-8136b34669a3" class="cell code" data-execution_count="35" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:09:58.481960Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:09:58.480609Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:28.387917Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:28.387487Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:09:58.481905Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> retrain_iter <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb40-2">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'retrain_iter: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>retrain_iter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb40-3">    ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb40-4">    ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb40-5">    histories[retrain_iter] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb40-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [],</span>
<span id="cb40-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [],</span>
<span id="cb40-8">    }</span>
<span id="cb40-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for idx in range(config['samples_per_retrain']):</span></span>
<span id="cb40-10">    sbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb40-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> sbar:</span>
<span id="cb40-12">        t0_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb40-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb40-14">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sample idx: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb40-15">        rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb40-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (retrain_iter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> diffusion_prob:</span>
<span id="cb40-17">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'rand: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rand<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> &lt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>diffusion_prob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb40-18">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample from diffusion model</span></span>
<span id="cb40-19">            x_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample(model, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb40-20">            ll_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.potential_energy(x_, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb40-21">            ll <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.potential_energy(x, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb40-22">            ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ll_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ll</span>
<span id="cb40-23">            a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(torch.ones_like(ratio), ratio)</span>
<span id="cb40-24">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(a.shape)</span>
<span id="cb40-25">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#u = np.random.uniform()</span></span>
<span id="cb40-26">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for jdx in range(u.shape[0]):</span></span>
<span id="cb40-27">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    if u[jdx] &lt; a[jdx]:</span></span>
<span id="cb40-28">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#        samples.append(x_[jdx])</span></span>
<span id="cb40-29">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#        diffusion_samples.append(x_[jdx])</span></span>
<span id="cb40-30">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#x = torch.where((u &lt; a), x_, x.reshape_as(x_)).reshape_as(x)</span></span>
<span id="cb40-31">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.where((u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> a)[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>], x_, x.reshape_as(x_))</span>
<span id="cb40-32">            samples.append(x)</span>
<span id="cb40-33">            diffusion_samples.append(x)</span>
<span id="cb40-34">            combined_samples[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x</span>
<span id="cb40-35">            watcher[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span></span>
<span id="cb40-36">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#diffusion_samples.extend(x)</span></span>
<span id="cb40-37">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#samples.extend(x)</span></span>
<span id="cb40-38">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ndiff_acc += </span></span>
<span id="cb40-39">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#if u &lt; a:</span></span>
<span id="cb40-40">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    console.print('Accepted diffusion sample!')</span></span>
<span id="cb40-41">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    console.print(f'{ndiff_acc} / {ndiff_proposed}')</span></span>
<span id="cb40-42">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    ndiff_acc += 1</span></span>
<span id="cb40-43">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    x = x_</span></span>
<span id="cb40-44">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    diffusion_samples.append(x)</span></span>
<span id="cb40-45">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    samples.append(x)</span></span>
<span id="cb40-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb40-47">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Oherwise, HMC</span></span>
<span id="cb40-48">            x, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((x, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>]))</span>
<span id="cb40-49">            hmc_samples.append(x)</span>
<span id="cb40-50">            samples.append(x)</span>
<span id="cb40-51">            combined_samples[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x</span>
<span id="cb40-52">            watcher[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span></span>
<span id="cb40-53">        smetrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb40-54">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'idx'</span>: idx,</span>
<span id="cb40-55">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'global_step'</span>: global_step,</span>
<span id="cb40-56">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dt'</span>: time.perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0_,</span>
<span id="cb40-57">        }</span>
<span id="cb40-58">        global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb40-59">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#smetrics |= {</span></span>
<span id="cb40-60">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    f'{k}': {torch.tensor(v).mean().item()} for k, v in metrics.items()</span></span>
<span id="cb40-61">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#}</span></span>
<span id="cb40-62">        sbar.set_postfix(smetrics)</span>
<span id="cb40-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train loop</span></span>
<span id="cb40-64">    dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(</span>
<span id="cb40-65">        torch.stack(hmc_samples).reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb40-66">    )</span>
<span id="cb40-67">    dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(</span>
<span id="cb40-68">        dataset,</span>
<span id="cb40-69">        shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb40-70">        drop_last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb40-71">        batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>],</span>
<span id="cb40-72">    )</span>
<span id="cb40-73">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(dataloader)</span>
<span id="cb40-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(pbar):</span>
<span id="cb40-75">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb40-76">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Retraining...'</span>)</span>
<span id="cb40-77">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(batch, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(batch) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb40-78">            batch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch</span>
<span id="cb40-79">        batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb40-80">        t0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb40-81">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(batch.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb40-82">        x_t, noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.noise_images(batch, t)</span>
<span id="cb40-83">        predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x_t, t)</span>
<span id="cb40-84">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mse(noise, predicted_noise)</span>
<span id="cb40-85">        optimizer.zero_grad()</span>
<span id="cb40-86">        loss.backward()</span>
<span id="cb40-87">        optimizer.step()</span>
<span id="cb40-88">        t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb40-89">        pbar.set_postfix(</span>
<span id="cb40-90">            {</span>
<span id="cb40-91">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'global_step'</span>: global_step,</span>
<span id="cb40-92">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'retrain_iter'</span>: retrain_iter,</span>
<span id="cb40-93">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'batch'</span>: i,</span>
<span id="cb40-94">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dt'</span>: t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0,</span>
<span id="cb40-95">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MSE'</span>: loss.item()</span>
<span id="cb40-96">            }</span>
<span id="cb40-97">        )</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">retrain_iter: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"17132d7ca8624fa387ee9467e4f1fa4d"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">sample idx: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb42-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0ed1080fdebd4f7b9aae80db0d36b96b"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Retraining<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">retrain_iter: <span style="color: #2094f3; text-decoration-color: #2094f3">1</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d0346019e21b4d2a9b624dc59e84015b"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">sample idx: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">rand: <span style="color: #2094f3; text-decoration-color: #2094f3">0.05506106760134255</span> &lt; <span style="color: #2094f3; text-decoration-color: #2094f3">0.1</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c02b09d53ada46a194a47921f0ab3cba"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">rand: <span style="color: #2094f3; text-decoration-color: #2094f3">0.07860283644524213</span> &lt; <span style="color: #2094f3; text-decoration-color: #2094f3">0.1</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"184df3f1c9714ece9756866b2617ed02"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eaa0d84229c04618b7a2bffe2a4b1739"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Retraining<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>
</div>
<div id="a83cf9fb-9c2c-430e-957a-d42eaed79401" class="cell code" data-execution_count="36" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:32.389697Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:32.389127Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:32.627601Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:32.627412Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:32.389644Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>.join([<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> samples[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">])</span>
</pre>
</div>
</div>
<div id="4b0e9e7c-9585-4f50-81c7-4c9dd37e18ce" class="cell code" data-execution_count="37" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:38.701814Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:38.699745Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:38.789521Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:38.789359Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:38.701745Z&quot;}">
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1">samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> samples])</span>
<span id="cb48-2">samples_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<pre><code>torch.Size([30, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="bef6ff41-1561-40ce-980c-29014f7efad5" class="cell code" data-execution_count="38" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:40.804170Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:40.803208Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:40.896475Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:40.896319Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:40.804119Z&quot;}">
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hmc_samples)</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<pre><code>28</code></pre>
</div>
</div>
<div id="a2279e49-e463-4a3a-a08e-14b1a636222f" class="cell code" data-execution_count="41" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:00.841115Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:00.840869Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:00.912440Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:00.912247Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:00.841101Z&quot;}">
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(diffusion_samples)</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<pre><code>2</code></pre>
</div>
</div>
<div id="13d3d5cd-df10-40e0-8dff-b1625a3ead57" class="cell code" data-execution_count="43" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:04.231527Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:04.231202Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:04.328804Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:04.328067Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:04.231509Z&quot;}">
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1">hmc_samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> hmc_samples])</span>
<span id="cb54-2">diffusion_samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(</span>
<span id="cb54-3">    [i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> diffusion_samples]</span>
<span id="cb54-4">)</span></code></pre></div>
</div>
<div id="7b58ba9e-4a8d-4cdb-a14e-87695db13ec3" class="cell code" data-execution_count="44" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:04.966106Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:04.965159Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:05.068570Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:05.067781Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:04.966070Z&quot;}">
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1">hmc_samples_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">
<pre><code>torch.Size([28, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="21c844ca-b9dd-4dd4-96cb-c5bb83ad93b5" class="cell code" data-execution_count="45" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:12.549057Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:12.548060Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:12.726595Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:12.726410Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:12.549036Z&quot;}">
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1">diffusion_samples_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<pre><code>torch.Size([2, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="bee61425-74d1-4faa-9447-ef4c6c71a8ba" class="cell code" data-execution_count="46" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:15.683862Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:15.683665Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:15.753128Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:15.752924Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:15.683847Z&quot;}">
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1">samples_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>torch.Size([30, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="c637a290-4dc3-42f6-abeb-ee807b991ffd" class="cell code" data-execution_count="47" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:29.661939Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:29.661388Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:29.751394Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:29.751170Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:29.661915Z&quot;}">
<div class="sourceCode" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> calc_plaqs(x):</span>
<span id="cb61-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb61-3">        exp.trainer.lattice.plaqs(</span>
<span id="cb61-4">            x[:, idx]</span>
<span id="cb61-5">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb61-6">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb61-7"></span>
<span id="cb61-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> calc_intQ(x):</span>
<span id="cb61-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb61-10">        exp.trainer.lattice.int_charges(</span>
<span id="cb61-11">            x[:, idx]</span>
<span id="cb61-12">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb61-13">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb61-14">    </span>
<span id="cb61-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> calc_sinQ(x):</span>
<span id="cb61-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb61-17">        exp.trainer.lattice.sin_charges(</span>
<span id="cb61-18">            x[:, idx]</span>
<span id="cb61-19">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb61-20">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div id="be21453d-5bd3-4f17-b9eb-294adcdf2e6b" class="cell code" data-execution_count="64" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:17:29.078038Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:17:29.076956Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:17:29.288381Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:17:29.288242Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:17:29.077980Z&quot;}">
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1">samples_init_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, initial_states.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb62-2">samples_init_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<pre><code>torch.Size([999, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="8542582c-65ae-40b5-b5b9-70292acc2c81" class="cell code" data-execution_count="65" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:17:43.351050Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:17:43.347957Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:17:43.699383Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:17:43.699177Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:17:43.350913Z&quot;}">
<div class="sourceCode" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1">metrics_init_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb64-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(samples_init_),</span>
<span id="cb64-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(samples_init_),</span>
<span id="cb64-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(samples_init_)</span>
<span id="cb64-5">}</span>
<span id="cb64-6">    </span>
<span id="cb64-7">metrics_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb64-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(samples_),</span>
<span id="cb64-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(samples_),</span>
<span id="cb64-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(samples_)</span>
<span id="cb64-11">}</span>
<span id="cb64-12"></span>
<span id="cb64-13">metrics_hmc_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb64-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(hmc_samples_),</span>
<span id="cb64-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(hmc_samples_),</span>
<span id="cb64-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(hmc_samples_)</span>
<span id="cb64-17">}</span>
<span id="cb64-18"></span>
<span id="cb64-19">metrics_diffusion_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb64-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(diffusion_samples_),</span>
<span id="cb64-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(diffusion_samples_),</span>
<span id="cb64-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(diffusion_samples_)</span>
<span id="cb64-23">}</span></code></pre></div>
</div>
<div id="21bfb626-a2c1-46db-8f1a-7eb86d81eafc" class="cell code" data-execution_count="49" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:32.364043Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:32.363212Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:32.470577Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:32.470322Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:32.364002Z&quot;}">
<div class="sourceCode" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1">metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="49">
<pre><code>torch.Size([30, 16])</code></pre>
</div>
</div>
<div id="59f33ef8-cfad-41d5-bfdd-0717c8700376" class="cell code" data-execution_count="52" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:14:16.986650Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:14:16.985673Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:14:17.106591Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:14:17.105464Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:14:16.986586Z&quot;}">
<div class="sourceCode" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>.join([<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> k, v <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> watcher.items()]))</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #2094f3; text-decoration-color: #2094f3">0</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">1</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">2</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">3</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">4</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">5</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">6</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">7</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">8</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">9</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">10</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">11</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">12</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">13</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">14</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">15</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">16</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">17</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">18</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">19</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">20</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">22</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">23</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">24</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">25</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">26</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">27</span>: diffusion
<span style="color: #2094f3; text-decoration-color: #2094f3">28</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">29</span>: diffusion
</pre>
</div>
</div>
<div id="4e5d7c22-e454-4368-ba7e-599f1d68fa19" class="cell code" data-execution_count="54" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:14:41.427638Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:14:41.427237Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:14:41.629492Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:14:41.629312Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:14:41.427623Z&quot;}">
<div class="sourceCode" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb68-2"></span>
<span id="cb68-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>)</span>
<span id="cb68-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb68-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb68-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax.plot(metrics_hmc1['plaqs'], label='HMC 1')</span></span>
<span id="cb68-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax.plot(metrics_diff_['plaqs'], label='Diffusion')</span></span>
<span id="cb68-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>, bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/4509936f2dbb7e69226f3d2851bc462cf8046e8e.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/4509936f2dbb7e69226f3d2851bc462cf8046e8e.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="ce6ca162-689d-4673-b093-261e465eefc7" class="cell code" data-execution_count="66" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:18:08.961955Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:18:08.961699Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:18:10.065123Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:18:10.064912Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:18:08.961923Z&quot;}">
<div class="sourceCode" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb69-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_init_.items()):</span>
<span id="cb69-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC (Initial Samples)'</span>)</span>
<span id="cb69-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb69-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb69-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax[idx].legend(loc='best', frameon=True, edgecolor="#838383")</span></span>
<span id="cb69-7"></span>
<span id="cb69-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Initial HMC States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/9d36e3726eb2a63bcae157590b44c3710847442f.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/9d36e3726eb2a63bcae157590b44c3710847442f.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="333d6fce-2124-46c7-809b-e584e2efc057" class="cell code" data-execution_count="68" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:18:30.709489Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:18:30.708639Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:18:31.422559Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:18:31.422402Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:18:30.709448Z&quot;}">
<div class="sourceCode" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb70-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_.items()):</span>
<span id="cb70-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>)</span>
<span id="cb70-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb70-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb70-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax[idx].legend(loc='best', frameon=True, edgecolor="#838383")</span></span>
<span id="cb70-7"></span>
<span id="cb70-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Combined Samples"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/6ba854aa0d42fd2eae98f6d82c0d6566005c421b.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/6ba854aa0d42fd2eae98f6d82c0d6566005c421b.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="c348510d-9ec3-41c7-b04e-654b5ba0bd3d" class="cell code" data-execution_count="71" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:01.490764Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:01.490310Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:01.844808Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:01.844643Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:01.490733Z&quot;}">
<div class="sourceCode" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb71-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_hmc_.items()):</span>
<span id="cb71-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb71-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb71-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb71-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Generated HMC States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/9d3a4133b6d0c2bf60da7558af21452baab7d5c3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/9d3a4133b6d0c2bf60da7558af21452baab7d5c3.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="20a16129-4648-4c62-9ed4-d6753d425f89" class="cell code" data-execution_count="73" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:03.884288Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:03.884107Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:04.146335Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:04.146166Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:03.884273Z&quot;}">
<div class="sourceCode" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb72-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_diffusion_.items()):</span>
<span id="cb72-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb72-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb72-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb72-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Generated Diffusion States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/02d2b941bf240ac2a6659c37519a6e2ebec63b41.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/02d2b941bf240ac2a6659c37519a6e2ebec63b41.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="9f329885-fa42-4e13-bd2c-e6fff4418cdb" class="cell code" data-execution_count="74" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:05.363396Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:05.363028Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:05.494802Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:05.494503Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:05.363383Z&quot;}">
<div class="sourceCode" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.lattice.u1.pytorch.lattice <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plaq_exact</span>
<span id="cb73-2">plaq_exact(torch.tensor(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>tensor(0.9124)</code></pre>
</div>
</div>
<div id="0646c637-546c-49df-876b-4dfb7abb9497" class="cell code" data-execution_count="78" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:41.898242Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:41.898063Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:42.092250Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:42.092113Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:41.898226Z&quot;}">
<div class="sourceCode" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb75-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = plt.hist(metrics_['intQ'].flatten(), color='C0', alpha=0.6, label='Combined', edgecolor='none')</span></span>
<span id="cb75-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb75-4">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb75-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb75-6">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb75-7">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>,</span>
<span id="cb75-8">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb75-9">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb75-10">)</span>
<span id="cb75-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb75-12">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb75-13">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb75-14">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb75-15">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>,</span>
<span id="cb75-16">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb75-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb75-18">)</span>
<span id="cb75-19">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#666666'</span>)</span>
<span id="cb75-20">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$Q$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb75-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Topological Charge ($Q$) Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/3f9d006e6a51dac62b80daab5d4bb4ac70596db2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/3f9d006e6a51dac62b80daab5d4bb4ac70596db2.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="f44d12ff-37f7-452e-94d7-6c3f0b28205e" class="cell code" data-execution_count="79" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:47.593614Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:47.593330Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:47.769152Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:47.768975Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:47.593598Z&quot;}">
<div class="sourceCode" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb76-2">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb76-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb76-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#666666'</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb76-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\left\langle U_{\mu\nu}\right\rangle $"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb76-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Draw"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/88b5366a0686ecb675259d3e1459d08d6c39e750.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/88b5366a0686ecb675259d3e1459d08d6c39e750.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="c0574a41-5d7e-45d9-97e9-0d81a0a6fa84" class="cell code" data-execution_count="80" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:53.009094Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:53.008705Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:53.084368Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:53.084175Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:53.009076Z&quot;}">
<div class="sourceCode" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1">wloops <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb77-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [</span>
<span id="cb77-3">        exp.trainer.lattice.wilson_loops(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> hmc_samples_</span>
<span id="cb77-4">    ],</span>
<span id="cb77-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [</span>
<span id="cb77-6">        exp.trainer.lattice.wilson_loops(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> diffusion_samples_</span>
<span id="cb77-7">    ],</span>
<span id="cb77-8">}</span>
<span id="cb77-9"></span>
<span id="cb77-10">plaqs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb77-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [</span>
<span id="cb77-12">        exp.trainer.lattice.plaqs(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> hmc_samples_</span>
<span id="cb77-13">    ],</span>
<span id="cb77-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [</span>
<span id="cb77-15">        exp.trainer.lattice.plaqs(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> diffusion_samples_</span>
<span id="cb77-16">    ],</span>
<span id="cb77-17">}</span></code></pre></div>
</div>
<div id="a7659697-40bd-489f-9445-1b27a5c79d8e" class="cell code" data-execution_count="81" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:53.670229Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:53.669768Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:53.757525Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:53.757339Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:53.670188Z&quot;}">
<div class="sourceCode" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1">wlhmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(wloops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>]).squeeze()</span>
<span id="cb78-2">wldiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(wloops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>]).squeeze()</span></code></pre></div>
</div>
<div id="63818acf-ed67-4f87-a2c2-065edebd94ba" class="cell code" data-execution_count="82" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:54.068148Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:54.067480Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:54.181682Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:54.181151Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:54.068106Z&quot;}">
<div class="sourceCode" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1">wlhmc.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="82">
<pre><code>torch.Size([28, 16, 32, 32])</code></pre>
</div>
</div>
<div id="3e408fed-abb8-486c-a560-3af19f121179" class="cell code" data-execution_count="85" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:23.993243Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:23.992854Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:24.334498Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:24.334319Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:23.993216Z&quot;}">
<div class="sourceCode" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.tight_layout()</span>
<span id="cb81-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb81-3">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb81-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(wlhmc[idx, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb81-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HMC"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb81-6">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(wldiff[idx, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb81-7">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diffusion"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb81-8">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_{\mu\nu}$"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb81-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ax_ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ax:</span>
<span id="cb81-10">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax_.set_xticklabels([])</span>
<span id="cb81-11">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax_.set_yticklabels([])</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/292acc374ca58b3045c07221e75d5ad20d83a646.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/292acc374ca58b3045c07221e75d5ad20d83a646.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/3b6a02bc8d6489b5a0147b59009b8a3be270ba14.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/3b6a02bc8d6489b5a0147b59009b8a3be270ba14.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="ff7b6cca-0327-4be2-aab6-aaa8df6ce2bc" class="cell code" data-execution_count="87" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:36.056148Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:36.055543Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:36.149377Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:36.149190Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:36.056103Z&quot;}">
<div class="sourceCode" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1">qhmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>]</span>
<span id="cb83-2">qdiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>]</span>
<span id="cb83-3">qhmc.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="87">
<pre><code>torch.Size([28, 16])</code></pre>
</div>
</div>
<div id="5230a441-1e1b-4901-b4d0-aacf5413ff35" class="cell code" data-execution_count="88" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:39.115417Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:39.114730Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:39.197664Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:39.197492Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:39.115373Z&quot;}">
<div class="sourceCode" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1">phmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(plaqs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>]).squeeze()</span>
<span id="cb85-2">pdiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(plaqs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>]).squeeze()</span>
<span id="cb85-3">phmc.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="88">
<pre><code>torch.Size([28, 16])</code></pre>
</div>
</div>
<div id="1af88db9-f706-4b58-8e81-a54cf92f144d" class="cell code" data-execution_count="89" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:39.947370Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:39.946997Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:40.026391Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:40.026205Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:39.947336Z&quot;}">
<div class="sourceCode" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1">pdiff.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="89">
<pre><code>torch.Size([2, 16])</code></pre>
</div>
</div>
<div id="1eeaeb30-abd1-47e9-8752-42d26873629b" class="cell code" data-execution_count="90" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:40.855087Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:40.854732Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:41.041979Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:41.041831Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:40.855068Z&quot;}">
<div class="sourceCode" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb89-2"></span>
<span id="cb89-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb89-4">    metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb89-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb89-6">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb89-7">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-8">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-9">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb89-10">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb89-11">)</span>
<span id="cb89-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb89-13">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb89-14">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb89-15">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb89-16">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-18">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb89-19">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb89-20">)</span>
<span id="cb89-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb89-22">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb89-23">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>,</span>
<span id="cb89-24">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb89-25">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-26">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-27">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>,</span>
<span id="cb89-28">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb89-29">)</span>
<span id="cb89-30">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$U_{\mu\nu}$"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb89-31">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(</span>
<span id="cb89-32">    loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>,</span>
<span id="cb89-33">    frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb89-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ncols=2,</span></span>
<span id="cb89-35">    bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>),</span>
<span id="cb89-36">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#838383"</span>,</span>
<span id="cb89-37">)</span>
<span id="cb89-38">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Plaquette Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/b8adc3f97c471460069de45c953d36d2a16fc858.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/b8adc3f97c471460069de45c953d36d2a16fc858.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="b40d5264-8818-40d6-9b6f-1a8e5c62f8a0" class="cell code" data-execution_count="92" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:21:00.286255Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:21:00.285869Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:21:00.480910Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:21:00.480726Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:21:00.286225Z&quot;}">
<div class="sourceCode" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb90-2"></span>
<span id="cb90-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb90-4">    metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb90-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb90-6">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb90-7">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-8">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-9">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb90-10">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb90-11">)</span>
<span id="cb90-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb90-13">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb90-14">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb90-15">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb90-16">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-18">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb90-19">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb90-20">)</span>
<span id="cb90-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb90-22">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb90-23">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>,</span>
<span id="cb90-24">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb90-25">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-26">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-27">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>,</span>
<span id="cb90-28">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb90-29">)</span>
<span id="cb90-30">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$Q_{\mathbb</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{Z}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}$'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb90-31">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(</span>
<span id="cb90-32">    loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>,</span>
<span id="cb90-33">    frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb90-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ncols=2,</span></span>
<span id="cb90-35">    bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>),</span>
<span id="cb90-36">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#838383"</span>,</span>
<span id="cb90-37">)</span>
<span id="cb90-38">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Charge Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/4b3eef08cf385e5b80c7fc02de9bb1764f32f9f8.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="https://samforeman.me/qmd/l2hmc-qcd/diffusion/assets/diffusion/4b3eef08cf385e5b80c7fc02de9bb1764f32f9f8.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="667c0f58-fbcf-4268-9193-4d475fbbe01b" class="cell code">
<div class="sourceCode" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1">global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb91-2">frames <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb91-3">losses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb91-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Training model..."</span>)</span>
<span id="cb91-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_epochs"</span>]):</span>
<span id="cb91-6">    model.train()</span>
<span id="cb91-7">    progress_bar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader))</span>
<span id="cb91-8">    progress_bar.set_description(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb91-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> step, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(dataloader):</span>
<span id="cb91-10">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb91-11"></span>
<span id="cb91-12">        noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(batch.shape)</span>
<span id="cb91-13">        timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randint(</span>
<span id="cb91-14">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, noise_scheduler.num_timesteps, (batch.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],)</span>
<span id="cb91-15">        ).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb91-16"></span>
<span id="cb91-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#noisy = noise_scheduler.add_noise(batch, noise, timesteps)</span></span>
<span id="cb91-18">        noisy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.noise_images(batch, timesteps)</span>
<span id="cb91-19">        noise_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(noisy, timesteps)</span>
<span id="cb91-20">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.mse_loss(noise_pred, noise)</span>
<span id="cb91-21">        loss.backward(loss)</span>
<span id="cb91-22"></span>
<span id="cb91-23">        nn.utils.clip_grad_norm_(model.parameters(), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>)</span>
<span id="cb91-24">        optimizer.step()</span>
<span id="cb91-25">        optimizer.zero_grad()</span>
<span id="cb91-26"></span>
<span id="cb91-27">        progress_bar.update(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb91-28">        logs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loss"</span>: loss.detach().item(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"step"</span>: global_step}</span>
<span id="cb91-29">        losses.append(loss.detach().item())</span>
<span id="cb91-30">        progress_bar.set_postfix(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>logs)</span>
<span id="cb91-31">        global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb91-32">    progress_bar.close()</span>
<span id="cb91-33"></span>
<span id="cb91-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"save_images_step"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_epochs"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb91-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate data with the model to later visualize the learning process</span></span>
<span id="cb91-36">        model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb91-37">        sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_batch_size"</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb91-38">        timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(noise_scheduler)))[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb91-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(timesteps)):</span>
<span id="cb91-40">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_batch_size"</span>])).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb91-41">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb91-42">                residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb91-43">            sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb91-44">        frames.append(sample.numpy())</span></code></pre></div>
</div>
<div id="bca44d4c-aecd-4348-8ad8-be9a404c8946" class="cell code">
<div class="sourceCode" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1">dataset[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
</div>
<div id="169c00d5-8ef2-42df-8f21-7ce08837ede4" class="cell code">
<div class="sourceCode" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span></code></pre></div>
</div>
<div id="8d47bdc2-41a1-4236-8674-090e98f2cd49" class="cell code">
<div class="sourceCode" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1">eval_batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb94-2">num_timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb94-3">plot_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb94-4">noise_scheduler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ddpm.NoiseScheduler(num_timesteps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_timesteps)</span>
<span id="cb94-5">sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(eval_batch_size, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb94-6">timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_timesteps))[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb94-7">samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb94-8">steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb94-9"></span>
<span id="cb94-10">retrains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb94-11">diffusion_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb94-12">samples_per_retrain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span></code></pre></div>
</div>
<div id="11ce1f12-beb8-4d8b-9475-d27c1b91beee" class="cell code">
<div class="sourceCode" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1">eval_batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb95-2">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(timesteps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb95-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb95-4">    residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb95-5">sample_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span></code></pre></div>
</div>
<div id="7db39b1f-807d-4656-a473-fcc818f2d157" class="cell code">
<div class="sourceCode" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1">sample.shape</span></code></pre></div>
</div>
<div id="b7118647-55d6-4605-87cf-c43fbe8d735c" class="cell code">
<div class="sourceCode" id="cb97" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1">residual.shape</span></code></pre></div>
</div>
<div id="77a6735b-f21f-4bc3-adc5-35c075f61bdd" class="cell code">
<div class="sourceCode" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1">sample_.shape</span></code></pre></div>
</div>
<div id="2648c025-75c8-4555-9d75-3c1c6426f3a1" class="cell code">
<div class="sourceCode" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1">diffusion_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb99-2">hmc_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb99-3">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span></span>
<span id="cb99-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> retrain_iter <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(retrains):</span>
<span id="cb99-5">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'retrain_iter: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>retrain_iter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb99-6">    ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb99-7">    ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb99-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(samples_per_retrain):</span>
<span id="cb99-9">        console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sample idx: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb99-10">        rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb99-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> diffusion_prob:</span>
<span id="cb99-12">            ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb99-13">            rand_pick <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> randrange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader))</span>
<span id="cb99-14">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#theta_prime = dataset[rand_pick]</span></span>
<span id="cb99-15">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb99-16">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb99-17">                residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb99-18">            sample_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb99-19">            ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb99-20">                log_likelihood_2dU1(sample_, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb99-21">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> log_likelihood_2dU1(sample, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb99-22">            )</span>
<span id="cb99-23">            a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ratio)</span>
<span id="cb99-24">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb99-25">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> a:</span>
<span id="cb99-26">                ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb99-27">                sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_</span>
<span id="cb99-28">                diffusion_samples.append(sample)</span>
<span id="cb99-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb99-30">            sample_, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((sample_, beta))</span>
<span id="cb99-31">            hmc_samples.append(sample)</span></code></pre></div>
</div>
<div id="8333621a-2fee-4736-a66c-bc42650d72aa" class="cell code">
<div class="sourceCode" id="cb100" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(timesteps)):</span>
<span id="cb100-2">    t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb100-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb100-4">        residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb100-5">    sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb100-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> plot_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb100-7">        samples.append(sample.numpy())</span>
<span id="cb100-8">        steps.append(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div id="d7d4b80b-17e1-4e3a-b642-ba2bc1f83e9c" class="cell code">
<div class="sourceCode" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>
<div id="014d60bf-7f4b-48f6-a0e0-20b73392446d" class="cell markdown" data-jp-markdownheadingcollapsed="true">
<section id="alternate" class="level2">
<h2 class="anchored" data-anchor-id="alternate">Alternate</h2>
</section>
</div>
<div id="385670d3-4c8a-40e6-abd8-7adf803d0042" class="cell code">
<div class="sourceCode" id="cb102" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1">diffusion_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionAlt(img_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span></code></pre></div>
</div>
<div id="a3916da7-d377-460c-8334-61ac3eb806f9" class="cell code">
<div class="sourceCode" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1">unet</span></code></pre></div>
</div>
<div id="88d31f53-1808-4a91-b26d-61b6328b824f" class="cell code">
<div class="sourceCode" id="cb104" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1">image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb104-2">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion_.sample_timesteps(image.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span>
<span id="cb104-3">unet(image, t)</span></code></pre></div>
</div>
<div id="eb1d6b2b-dc4b-4325-882f-f10f44a40faf" class="cell code">
<div class="sourceCode" id="cb105" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1">diffusion_.sample(</span></code></pre></div>
</div>
<div id="62370eb1-36eb-4d46-ae21-62f5c740b809" class="cell code">
<div class="sourceCode" id="cb106" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>
<div id="1d2e9f49-59d0-4a5b-8bdd-74b1af09f7e5" class="cell code">
<div class="sourceCode" id="cb107" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>
<div id="8f45bcd5-8b41-4c45-8bd7-6c4a1c6253fe" class="cell code">
<div class="sourceCode" id="cb108" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>
<div id="c9596b30-6030-4034-8ad0-2a254289153d" class="cell code">
<div class="sourceCode" id="cb109" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>
<div id="831cbe57-69ea-43af-aa23-f4e880ec4659" class="cell code">
<div class="sourceCode" id="cb110" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>



<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {MCMC + {Diffusion} {Sampling}},
  date = {2024-04-15},
  url = {https://samforeman.me/qmd/l2hmc-qcd/diffusion},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“MCMC + Diffusion Sampling.”</span> April 15,
2024. <a href="https://samforeman.me/qmd/l2hmc-qcd/diffusion">https://samforeman.me/qmd/l2hmc-qcd/diffusion</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/l2hmc-qcd/diffusion/diffusion.html</guid>
  <pubDate>Mon, 15 Apr 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>⏰ Starting Up Distributed Training</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/startup-times/</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="initialization-times" class="level2">
<h2 class="anchored" data-anchor-id="initialization-times">Initialization Times</h2>
<!-- ::: {.callout-info title='[ Startup Times (Perlmutter)]{.dim-text}' collapse="True"} -->
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[[]{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;iconify&quot; data-raw=&quot;iconify&quot;} []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;material-symbols&quot; data-raw=&quot;material-symbols&quot;} []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;attach-email-outline-rounded&quot; data-raw=&quot;attach-email-outline-rounded&quot;} ]{.quarto-shortcode__ data-is-shortcode=&quot;1&quot; data-raw=&quot;{{< iconify material-symbols attach-email-outline-rounded >}}&quot;} Application Startup Time]{.dim-text}" style="text-align: left!important; width:100%; border-color: var(--dim-color)!important; background-color: var(--bg-transparent); opacity:100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><span class="quarto-shortcode__" data-is-shortcode="1" data-raw="{{< iconify material-symbols attach-email-outline-rounded >}}"><span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="iconify" data-raw="iconify"></span> <span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="material-symbols" data-raw="material-symbols"></span> <span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="attach-email-outline-rounded" data-raw="attach-email-outline-rounded"></span></span> Application Startup Time</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>From Tanima:</p>
<blockquote class="blockquote">
<p>Hi Sam and Corey,</p>
<p>Thanks for your comments on measuring the application start up time last week.</p>
<p>Typically, we report the throughput performance after the start-up and warm-up during the “steady” state of the training.</p>
<p>We have a few follow-up questions so that we establish a methodology to address the issue brought up by Argonne.</p>
<ol type="1">
<li><p>We can set a few timestamps in the model scripts and job scripts used for the queue submission: Job script:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp A:  </span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>actual <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> command using mpiexec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Inside</span> the model script:  </span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span>  </span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Timestamp</span> B:  </span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[...]</span></span>
<span id="cb1-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Timestamp</span> C:  </span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">First</span> training steps and onwards.  </span></code></pre></div>
<p>By startup time, do you mean measuring time difference between A and C or B and C?</p></li>
</ol>
</blockquote>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Will the measurement methodology be the same for distributed training?<br>
For examples, we can measure the start-up time for the <code>rank0</code>?</li>
</ol>
</blockquote>
<blockquote class="blockquote">
<ol start="3" type="1">
<li><p>If we need to report the startup time for the DL applications, do we need to collect measurements using the actual Aurora NRE workloads or some small benchmarking test cases?</p>
<p>For example, we can try to recreate the typical start-up scenarios, like library imports, and measure those separately as shown below.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> script:</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp A:</span>
<span id="cb2-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>actual <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> command using mpiexec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp B:</span>
<span id="cb2-6"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb2-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp C</span>
<span id="cb2-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> IPEX</span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp D</span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Etc...</span></span></code></pre></div>
<p>If you have any other scenarios, please feel free to suggest.</p></li>
</ol>
<p>Thanks, Tanima.</p>
</blockquote></li>
</ul>
</div>
</div>
</div>
<ol type="1">
<li><p>In Measuring / Calculating Startup Time,I provide a summary of how the startup time is identified and calculated.</p></li>
<li><p>I’m not sure exactly I understand</p>
<blockquote class="blockquote">
<p>Will the measurement methodology be the same for distributed training? For examples, we can measure the start-up time for the rank0?</p>
</blockquote>
<p>The startup time is being measured for distributed training (logs only created on <code>RANK = 0</code>)</p></li>
<li><p>I discuss in Minimal Working Example a minimal example that can be used to measure the startup times.</p>
<ul>
<li>This is using a library I’ve been working on, <a href="https://github.com/saforem2/ezpz"><code>ezpz</code></a> that is designed to help simplify the process of setting up / initializing distributed training across many GPUs.</li>
</ul></li>
</ol>
<section id="sec-measurements" class="level3">
<h3 class="anchored" data-anchor-id="sec-measurements">Measuring / Calculating Startup Time</h3>
<ul>
<li><p>The startup timing was identified by parsing the logfiles from existing runs and calculating the difference <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20t%20=%20t_%7B1%7D%20-%20t_%7B0%7D">,</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B0%7D"> is the time stamp at the <em>very</em> beginning of the shell script (defined <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/657bb3e312e793d7b503f475b59e44c1aee44205/ALCF/train-gpt3.sh#L3">here</a>) which then launches <code>mpiexec &lt;mpi-args&gt; python3 [...]</code>.</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B0%7D"> appears in the logfile as:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-183323 on x3004c0s13b0n0</span></code></pre></div></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B1%7D"> is identified as the timestamp associated with the completion of the first training step</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B1%7D"> appears in the logfile as:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:34:13,122] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div></li>
</ul></li>
</ul></li>
<li><p>Below is an example of the bash script use to parse the logfiles and identify these timestamps:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> for f in <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-5</span> logfiles<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job started|step=0\,"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb5-2">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_actCkpt_GPT1T_4L_z1_seqlen2048_mp8_pp2_sp1_nl4_hs25600_gb16_mb1/logs/foremans-x3004c0s13b0n0-nhosts4-ngpu16-2023-11-02-183323.log</span></span>
<span id="cb5-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-183323 on x3004c0s13b0n0</span>
<span id="cb5-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:34:13,122] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-5"></span>
<span id="cb5-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3015c0s37b0n0-nhosts4-ngpu16-2023-11-02-184240.log</span></span>
<span id="cb5-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184240 on x3015c0s37b0n0</span>
<span id="cb5-8"></span>
<span id="cb5-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3015c0s37b0n0-nhosts4-ngpu16-2023-11-02-184259.log</span></span>
<span id="cb5-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184259 on x3015c0s37b0n0</span>
<span id="cb5-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:43:23,385] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-12"></span>
<span id="cb5-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3004c0s13b0n0-nhosts4-ngpu16-2023-11-02-184407.log</span></span>
<span id="cb5-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184407 on x3004c0s13b0n0</span>
<span id="cb5-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:44:32,804] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-16"></span>
<span id="cb5-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_actCkpt_GPT1T_4L_z1_seqlen2048_mp8_pp2_sp1_nl4_hs25600_gb16_mb2/logs/foremans-x3108c0s25b1n0-nhosts2-ngpu8-2023-11-02-192739.log</span></span>
<span id="cb5-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-192739 on x3108c0s25b1n0</span></code></pre></div></li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[[[]{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;iconify&quot; data-raw=&quot;iconify&quot;} []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;octicon&quot; data-raw=&quot;octicon&quot;} []{.quarto-shortcode__-param data-is-shortcode=&quot;1&quot; data-value=&quot;stopwatch-16&quot; data-raw=&quot;stopwatch-16&quot;} ]{.quarto-shortcode__ data-is-shortcode=&quot;1&quot; data-raw=&quot;{{< iconify octicon stopwatch-16 >}}&quot;} Startup Times (Perlmutter)]{.dim-text}" style="text-align: left!important; width:100%; border-color: var(--dim-color)!important; background-color: var(--bg-transparent); opacity:100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="dim-text"><span class="quarto-shortcode__" data-is-shortcode="1" data-raw="{{< iconify octicon stopwatch-16 >}}"><span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="iconify" data-raw="iconify"></span> <span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="octicon" data-raw="octicon"></span> <span class="quarto-shortcode__-param" data-is-shortcode="1" data-value="stopwatch-16" data-raw="stopwatch-16"></span></span> Startup Times (Perlmutter)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="tbl-perlmutter-init" class="quarto-float anchored" style="font-size: 0.8em;">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-perlmutter-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Startup times on Perlmutter
</figcaption>
<div aria-describedby="tbl-perlmutter-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 42%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">****</th>
<th style="text-align: center;"><strong>model_size</strong></th>
<th style="text-align: center;"><strong>world_size</strong></th>
<th style="text-align: center;"><strong>start</strong></th>
<th style="text-align: center;"><strong>stop</strong></th>
<th style="text-align: center;"><strong>t0</strong></th>
<th style="text-align: center;"><strong>t1</strong></th>
<th style="text-align: center;"><strong>dt</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191101.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191101</td>
<td style="text-align: center;">2023-10-05-191215</td>
<td style="text-align: center;">191101</td>
<td style="text-align: center;">191215</td>
<td style="text-align: center;">114</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191400.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191400</td>
<td style="text-align: center;">2023-10-05-191511</td>
<td style="text-align: center;">191400</td>
<td style="text-align: center;">191511</td>
<td style="text-align: center;">111</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191707.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191707</td>
<td style="text-align: center;">2023-10-05-191817</td>
<td style="text-align: center;">191707</td>
<td style="text-align: center;">191817</td>
<td style="text-align: center;">110</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008553-nhosts2-ngpu8-2023-10-15-114506.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-114506</td>
<td style="text-align: center;">2023-10-15-114616</td>
<td style="text-align: center;">114506</td>
<td style="text-align: center;">114616</td>
<td style="text-align: center;">110</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-133531.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-133531</td>
<td style="text-align: center;">2023-10-15-133745</td>
<td style="text-align: center;">133531</td>
<td style="text-align: center;">133745</td>
<td style="text-align: center;">214</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-135041.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-135041</td>
<td style="text-align: center;">2023-10-15-135255</td>
<td style="text-align: center;">135041</td>
<td style="text-align: center;">135255</td>
<td style="text-align: center;">214</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-140806.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-140806</td>
<td style="text-align: center;">2023-10-15-141236</td>
<td style="text-align: center;">140806</td>
<td style="text-align: center;">141236</td>
<td style="text-align: center;">430</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-143120.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-143120</td>
<td style="text-align: center;">2023-10-15-143655</td>
<td style="text-align: center;">143120</td>
<td style="text-align: center;">143655</td>
<td style="text-align: center;">535</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-154337.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-154337</td>
<td style="text-align: center;">2023-10-15-154446</td>
<td style="text-align: center;">154337</td>
<td style="text-align: center;">154446</td>
<td style="text-align: center;">109</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-154943.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-154943</td>
<td style="text-align: center;">2023-10-15-155317</td>
<td style="text-align: center;">154943</td>
<td style="text-align: center;">155317</td>
<td style="text-align: center;">374</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-162315.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-162315</td>
<td style="text-align: center;">2023-10-15-162441</td>
<td style="text-align: center;">162315</td>
<td style="text-align: center;">162441</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-180714.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-180714</td>
<td style="text-align: center;">2023-10-15-180805</td>
<td style="text-align: center;">180714</td>
<td style="text-align: center;">180805</td>
<td style="text-align: center;">91</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-181733.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-181733</td>
<td style="text-align: center;">2023-10-15-181834</td>
<td style="text-align: center;">181733</td>
<td style="text-align: center;">181834</td>
<td style="text-align: center;">101</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-182228.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-182228</td>
<td style="text-align: center;">2023-10-15-183031</td>
<td style="text-align: center;">182228</td>
<td style="text-align: center;">183031</td>
<td style="text-align: center;">803</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-183345.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-183345</td>
<td style="text-align: center;">2023-10-15-183750</td>
<td style="text-align: center;">183345</td>
<td style="text-align: center;">183750</td>
<td style="text-align: center;">405</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-184442.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-184442</td>
<td style="text-align: center;">2023-10-15-184727</td>
<td style="text-align: center;">184442</td>
<td style="text-align: center;">184727</td>
<td style="text-align: center;">285</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-185952.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-185952</td>
<td style="text-align: center;">2023-10-15-190046</td>
<td style="text-align: center;">185952</td>
<td style="text-align: center;">190046</td>
<td style="text-align: center;">4094</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-191508.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-191508</td>
<td style="text-align: center;">2023-10-15-191608</td>
<td style="text-align: center;">191508</td>
<td style="text-align: center;">191608</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-192404.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-192404</td>
<td style="text-align: center;">2023-10-15-192504</td>
<td style="text-align: center;">192404</td>
<td style="text-align: center;">192504</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-193041.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-193041</td>
<td style="text-align: center;">2023-10-15-193137</td>
<td style="text-align: center;">193041</td>
<td style="text-align: center;">193137</td>
<td style="text-align: center;">96</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-193448.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-193448</td>
<td style="text-align: center;">2023-10-15-193540</td>
<td style="text-align: center;">193448</td>
<td style="text-align: center;">193540</td>
<td style="text-align: center;">92</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-195802.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-195802</td>
<td style="text-align: center;">2023-10-15-195904</td>
<td style="text-align: center;">195802</td>
<td style="text-align: center;">195904</td>
<td style="text-align: center;">102</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-200019.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-200019</td>
<td style="text-align: center;">2023-10-15-200258</td>
<td style="text-align: center;">200019</td>
<td style="text-align: center;">200258</td>
<td style="text-align: center;">239</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-200902.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-200902</td>
<td style="text-align: center;">2023-10-15-201239</td>
<td style="text-align: center;">200902</td>
<td style="text-align: center;">201239</td>
<td style="text-align: center;">337</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-201524.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-201524</td>
<td style="text-align: center;">2023-10-15-201612</td>
<td style="text-align: center;">201524</td>
<td style="text-align: center;">201612</td>
<td style="text-align: center;">88</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-201834.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-201834</td>
<td style="text-align: center;">2023-10-15-201923</td>
<td style="text-align: center;">201834</td>
<td style="text-align: center;">201923</td>
<td style="text-align: center;">89</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-202402.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-202402</td>
<td style="text-align: center;">2023-10-15-202501</td>
<td style="text-align: center;">202402</td>
<td style="text-align: center;">202501</td>
<td style="text-align: center;">99</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-202606.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-202606</td>
<td style="text-align: center;">2023-10-15-202713</td>
<td style="text-align: center;">202606</td>
<td style="text-align: center;">202713</td>
<td style="text-align: center;">107</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-084033.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-084033</td>
<td style="text-align: center;">2023-10-16-084212</td>
<td style="text-align: center;">84033</td>
<td style="text-align: center;">84212</td>
<td style="text-align: center;">179</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-084628.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-084628</td>
<td style="text-align: center;">2023-10-16-084728</td>
<td style="text-align: center;">84628</td>
<td style="text-align: center;">84728</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-085401.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-085401</td>
<td style="text-align: center;">2023-10-16-085505</td>
<td style="text-align: center;">85401</td>
<td style="text-align: center;">85505</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-090142.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-090142</td>
<td style="text-align: center;">2023-10-16-090305</td>
<td style="text-align: center;">90142</td>
<td style="text-align: center;">90305</td>
<td style="text-align: center;">163</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-093404.log</code></td>
<td style="text-align: center;">actCkpt_GPT13B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-093404</td>
<td style="text-align: center;">2023-10-16-093504</td>
<td style="text-align: center;">93404</td>
<td style="text-align: center;">93504</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts4-ngpu16-2023-10-16-101437.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-101437</td>
<td style="text-align: center;">2023-10-16-101549</td>
<td style="text-align: center;">101437</td>
<td style="text-align: center;">101549</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-101512.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-101512</td>
<td style="text-align: center;">2023-10-16-101615</td>
<td style="text-align: center;">101512</td>
<td style="text-align: center;">101615</td>
<td style="text-align: center;">103</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-102217.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-102217</td>
<td style="text-align: center;">2023-10-16-102452</td>
<td style="text-align: center;">102217</td>
<td style="text-align: center;">102452</td>
<td style="text-align: center;">235</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-102750.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-102750</td>
<td style="text-align: center;">2023-10-16-103243</td>
<td style="text-align: center;">102750</td>
<td style="text-align: center;">103243</td>
<td style="text-align: center;">493</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts4-ngpu16-2023-10-16-103113.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-103113</td>
<td style="text-align: center;">2023-10-16-103237</td>
<td style="text-align: center;">103113</td>
<td style="text-align: center;">103237</td>
<td style="text-align: center;">124</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-104037.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-104037</td>
<td style="text-align: center;">2023-10-16-104148</td>
<td style="text-align: center;">104037</td>
<td style="text-align: center;">104148</td>
<td style="text-align: center;">111</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-104819.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-104819</td>
<td style="text-align: center;">2023-10-16-110002</td>
<td style="text-align: center;">104819</td>
<td style="text-align: center;">110002</td>
<td style="text-align: center;">5183</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-110119.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-110119</td>
<td style="text-align: center;">2023-10-16-110225</td>
<td style="text-align: center;">110119</td>
<td style="text-align: center;">110225</td>
<td style="text-align: center;">106</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-113715.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-113715</td>
<td style="text-align: center;">2023-10-16-113824</td>
<td style="text-align: center;">113715</td>
<td style="text-align: center;">113824</td>
<td style="text-align: center;">109</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114236.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114236</td>
<td style="text-align: center;">2023-10-16-114338</td>
<td style="text-align: center;">114236</td>
<td style="text-align: center;">114338</td>
<td style="text-align: center;">102</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114610.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114610</td>
<td style="text-align: center;">2023-10-16-114711</td>
<td style="text-align: center;">114610</td>
<td style="text-align: center;">114711</td>
<td style="text-align: center;">101</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114819.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114819</td>
<td style="text-align: center;">2023-10-16-114953</td>
<td style="text-align: center;">114819</td>
<td style="text-align: center;">114953</td>
<td style="text-align: center;">134</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-131058.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-131058</td>
<td style="text-align: center;">2023-10-16-131203</td>
<td style="text-align: center;">131058</td>
<td style="text-align: center;">131203</td>
<td style="text-align: center;">145</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008576-nhosts1-ngpu4-2023-10-16-151427.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-151427</td>
<td style="text-align: center;">2023-10-16-151600</td>
<td style="text-align: center;">151427</td>
<td style="text-align: center;">151600</td>
<td style="text-align: center;">173</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008576-nhosts1-ngpu4-2023-10-16-152528.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-152528</td>
<td style="text-align: center;">2023-10-16-152640</td>
<td style="text-align: center;">152528</td>
<td style="text-align: center;">152640</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-175717.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-175717</td>
<td style="text-align: center;">2023-10-16-175829</td>
<td style="text-align: center;">175717</td>
<td style="text-align: center;">175829</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-180457.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-180457</td>
<td style="text-align: center;">2023-10-16-180605</td>
<td style="text-align: center;">180457</td>
<td style="text-align: center;">180605</td>
<td style="text-align: center;">148</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-183116.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-183116</td>
<td style="text-align: center;">2023-10-16-183216</td>
<td style="text-align: center;">183116</td>
<td style="text-align: center;">183216</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-183921.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-183921</td>
<td style="text-align: center;">2023-10-16-184033</td>
<td style="text-align: center;">183921</td>
<td style="text-align: center;">184033</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008237-nhosts1-ngpu4-2023-10-16-215614.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-215614</td>
<td style="text-align: center;">2023-10-16-215815</td>
<td style="text-align: center;">215614</td>
<td style="text-align: center;">215815</td>
<td style="text-align: center;">201</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-052944.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-052944</td>
<td style="text-align: center;">2023-10-17-053139</td>
<td style="text-align: center;">52944</td>
<td style="text-align: center;">53139</td>
<td style="text-align: center;">195</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-053529.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-053529</td>
<td style="text-align: center;">2023-10-17-053650</td>
<td style="text-align: center;">53529</td>
<td style="text-align: center;">53650</td>
<td style="text-align: center;">121</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-053910.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-053910</td>
<td style="text-align: center;">2023-10-17-054120</td>
<td style="text-align: center;">53910</td>
<td style="text-align: center;">54120</td>
<td style="text-align: center;">210</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-054238.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-054238</td>
<td style="text-align: center;">2023-10-17-054346</td>
<td style="text-align: center;">54238</td>
<td style="text-align: center;">54346</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-060418.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-060418</td>
<td style="text-align: center;">2023-10-17-060600</td>
<td style="text-align: center;">60418</td>
<td style="text-align: center;">60600</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-061514.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-061514</td>
<td style="text-align: center;">2023-10-17-061653</td>
<td style="text-align: center;">61514</td>
<td style="text-align: center;">61653</td>
<td style="text-align: center;">139</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-062102.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-062102</td>
<td style="text-align: center;">2023-10-17-062252</td>
<td style="text-align: center;">62102</td>
<td style="text-align: center;">62252</td>
<td style="text-align: center;">150</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-062445.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-062445</td>
<td style="text-align: center;">2023-10-17-062720</td>
<td style="text-align: center;">62445</td>
<td style="text-align: center;">62720</td>
<td style="text-align: center;">275</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-064643.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-064643</td>
<td style="text-align: center;">2023-10-17-064848</td>
<td style="text-align: center;">64643</td>
<td style="text-align: center;">64848</td>
<td style="text-align: center;">205</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-065806.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-065806</td>
<td style="text-align: center;">2023-10-17-070003</td>
<td style="text-align: center;">65806</td>
<td style="text-align: center;">70003</td>
<td style="text-align: center;">4197</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-075152.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-075152</td>
<td style="text-align: center;">2023-10-17-075502</td>
<td style="text-align: center;">75152</td>
<td style="text-align: center;">75502</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-080059.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-080059</td>
<td style="text-align: center;">2023-10-17-080434</td>
<td style="text-align: center;">80059</td>
<td style="text-align: center;">80434</td>
<td style="text-align: center;">375</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-081404.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-081404</td>
<td style="text-align: center;">2023-10-17-081920</td>
<td style="text-align: center;">81404</td>
<td style="text-align: center;">81920</td>
<td style="text-align: center;">516</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008228-nhosts1-ngpu4-2023-10-17-090344.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-090344</td>
<td style="text-align: center;">2023-10-17-090714</td>
<td style="text-align: center;">90344</td>
<td style="text-align: center;">90714</td>
<td style="text-align: center;">370</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008228-nhosts1-ngpu4-2023-10-17-100759.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-100759</td>
<td style="text-align: center;">2023-10-17-100957</td>
<td style="text-align: center;">100759</td>
<td style="text-align: center;">100957</td>
<td style="text-align: center;">198</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-182501.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-182501</td>
<td style="text-align: center;">2023-10-17-184001</td>
<td style="text-align: center;">182501</td>
<td style="text-align: center;">184001</td>
<td style="text-align: center;">1500</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-193736.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-193736</td>
<td style="text-align: center;">2023-10-17-193856</td>
<td style="text-align: center;">193736</td>
<td style="text-align: center;">193856</td>
<td style="text-align: center;">120</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-195432.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-195432</td>
<td style="text-align: center;">2023-10-17-195536</td>
<td style="text-align: center;">195432</td>
<td style="text-align: center;">195536</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-201659.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-201659</td>
<td style="text-align: center;">2023-10-17-201823</td>
<td style="text-align: center;">201659</td>
<td style="text-align: center;">201823</td>
<td style="text-align: center;">164</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-202949.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-202949</td>
<td style="text-align: center;">2023-10-17-203054</td>
<td style="text-align: center;">202949</td>
<td style="text-align: center;">203054</td>
<td style="text-align: center;">105</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-205848.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-205848</td>
<td style="text-align: center;">2023-10-17-205952</td>
<td style="text-align: center;">205848</td>
<td style="text-align: center;">205952</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-213244.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-213244</td>
<td style="text-align: center;">2023-10-17-213406</td>
<td style="text-align: center;">213244</td>
<td style="text-align: center;">213406</td>
<td style="text-align: center;">162</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-213558.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-213558</td>
<td style="text-align: center;">2023-10-17-213720</td>
<td style="text-align: center;">213558</td>
<td style="text-align: center;">213720</td>
<td style="text-align: center;">162</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-214900.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-214900</td>
<td style="text-align: center;">2023-10-17-214959</td>
<td style="text-align: center;">214900</td>
<td style="text-align: center;">214959</td>
<td style="text-align: center;">59</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215201.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215201</td>
<td style="text-align: center;">2023-10-17-215309</td>
<td style="text-align: center;">215201</td>
<td style="text-align: center;">215309</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215612.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215612</td>
<td style="text-align: center;">2023-10-17-215726</td>
<td style="text-align: center;">215612</td>
<td style="text-align: center;">215726</td>
<td style="text-align: center;">114</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215938.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215938</td>
<td style="text-align: center;">2023-10-17-220044</td>
<td style="text-align: center;">215938</td>
<td style="text-align: center;">220044</td>
<td style="text-align: center;">4106</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-110001.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-110001</td>
<td style="text-align: center;">2023-10-18-110143</td>
<td style="text-align: center;">110001</td>
<td style="text-align: center;">110143</td>
<td style="text-align: center;">142</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-110424.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-110424</td>
<td style="text-align: center;">2023-10-18-110550</td>
<td style="text-align: center;">110424</td>
<td style="text-align: center;">110550</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-110821.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-110821</td>
<td style="text-align: center;">2023-10-18-110952</td>
<td style="text-align: center;">110821</td>
<td style="text-align: center;">110952</td>
<td style="text-align: center;">131</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-111345.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-111345</td>
<td style="text-align: center;">2023-10-18-111458</td>
<td style="text-align: center;">111345</td>
<td style="text-align: center;">111458</td>
<td style="text-align: center;">113</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008197-nhosts16-ngpu64-2023-10-18-112531.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-112531</td>
<td style="text-align: center;">2023-10-18-112728</td>
<td style="text-align: center;">112531</td>
<td style="text-align: center;">112728</td>
<td style="text-align: center;">197</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-113119.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-113119</td>
<td style="text-align: center;">2023-10-18-113343</td>
<td style="text-align: center;">113119</td>
<td style="text-align: center;">113343</td>
<td style="text-align: center;">224</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-113131.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-113131</td>
<td style="text-align: center;">2023-10-18-113257</td>
<td style="text-align: center;">113131</td>
<td style="text-align: center;">113257</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-113920.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-113920</td>
<td style="text-align: center;">2023-10-18-114157</td>
<td style="text-align: center;">113920</td>
<td style="text-align: center;">114157</td>
<td style="text-align: center;">237</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008197-nhosts16-ngpu64-2023-10-18-114549.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-114549</td>
<td style="text-align: center;">2023-10-18-114721</td>
<td style="text-align: center;">114549</td>
<td style="text-align: center;">114721</td>
<td style="text-align: center;">172</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-114636.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-114636</td>
<td style="text-align: center;">2023-10-18-114805</td>
<td style="text-align: center;">114636</td>
<td style="text-align: center;">114805</td>
<td style="text-align: center;">169</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-115808.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-115808</td>
<td style="text-align: center;">2023-10-18-120146</td>
<td style="text-align: center;">115808</td>
<td style="text-align: center;">120146</td>
<td style="text-align: center;">4338</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-123039.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-123039</td>
<td style="text-align: center;">2023-10-18-123221</td>
<td style="text-align: center;">123039</td>
<td style="text-align: center;">123221</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008389-nhosts2-ngpu8-2023-10-18-123135.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-18-123135</td>
<td style="text-align: center;">2023-10-18-123300</td>
<td style="text-align: center;">123135</td>
<td style="text-align: center;">123300</td>
<td style="text-align: center;">165</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-123206.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-123206</td>
<td style="text-align: center;">2023-10-18-123352</td>
<td style="text-align: center;">123206</td>
<td style="text-align: center;">123352</td>
<td style="text-align: center;">146</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-125022.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-125022</td>
<td style="text-align: center;">2023-10-18-125146</td>
<td style="text-align: center;">125022</td>
<td style="text-align: center;">125146</td>
<td style="text-align: center;">124</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-122736.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-122736</td>
<td style="text-align: center;">2023-10-22-122844</td>
<td style="text-align: center;">122736</td>
<td style="text-align: center;">122844</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-123824.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-123824</td>
<td style="text-align: center;">2023-10-22-123945</td>
<td style="text-align: center;">123824</td>
<td style="text-align: center;">123945</td>
<td style="text-align: center;">121</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-130148.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-130148</td>
<td style="text-align: center;">2023-10-22-130256</td>
<td style="text-align: center;">130148</td>
<td style="text-align: center;">130256</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-131746.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-131746</td>
<td style="text-align: center;">2023-10-22-131909</td>
<td style="text-align: center;">131746</td>
<td style="text-align: center;">131909</td>
<td style="text-align: center;">163</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-132700.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-132700</td>
<td style="text-align: center;">2023-10-22-132817</td>
<td style="text-align: center;">132700</td>
<td style="text-align: center;">132817</td>
<td style="text-align: center;">117</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-133459.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-133459</td>
<td style="text-align: center;">2023-10-22-133708</td>
<td style="text-align: center;">133459</td>
<td style="text-align: center;">133708</td>
<td style="text-align: center;">249</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008380-nhosts4-ngpu16-2023-10-22-175049.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-22-175049</td>
<td style="text-align: center;">2023-10-22-175230</td>
<td style="text-align: center;">175049</td>
<td style="text-align: center;">175230</td>
<td style="text-align: center;">181</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008649-nhosts4-ngpu16-2023-10-22-192352.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-22-192352</td>
<td style="text-align: center;">2023-10-22-192530</td>
<td style="text-align: center;">192352</td>
<td style="text-align: center;">192530</td>
<td style="text-align: center;">178</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008212-nhosts16-ngpu64-2023-10-23-081527.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-23-081527</td>
<td style="text-align: center;">2023-10-23-081702</td>
<td style="text-align: center;">81527</td>
<td style="text-align: center;">81702</td>
<td style="text-align: center;">175</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-23-091436.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-23-091436</td>
<td style="text-align: center;">2023-10-23-091610</td>
<td style="text-align: center;">91436</td>
<td style="text-align: center;">91610</td>
<td style="text-align: center;">174</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008197-nhosts32-ngpu128-2023-10-24-102617.log</code></td>
<td style="text-align: center;">GPT1T_32L</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">2023-10-24-102617</td>
<td style="text-align: center;">2023-10-24-102826</td>
<td style="text-align: center;">102617</td>
<td style="text-align: center;">102826</td>
<td style="text-align: center;">209</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts64-ngpu256-2023-10-24-191748.log</code></td>
<td style="text-align: center;">GPT1T_64L</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">2023-10-24-191748</td>
<td style="text-align: center;">2023-10-24-192021</td>
<td style="text-align: center;">191748</td>
<td style="text-align: center;">192021</td>
<td style="text-align: center;">273</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-10-24-201243.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-10-24-201243</td>
<td style="text-align: center;">2023-10-24-201629</td>
<td style="text-align: center;">201243</td>
<td style="text-align: center;">201629</td>
<td style="text-align: center;">386</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-10-26-005401.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-10-26-005401</td>
<td style="text-align: center;">2023-10-26-005811</td>
<td style="text-align: center;">5401</td>
<td style="text-align: center;">5811</td>
<td style="text-align: center;">410</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008192-nhosts32-ngpu128-2023-10-26-082710.log</code></td>
<td style="text-align: center;">GPT1T_32L</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">2023-10-26-082710</td>
<td style="text-align: center;">2023-10-26-083049</td>
<td style="text-align: center;">82710</td>
<td style="text-align: center;">83049</td>
<td style="text-align: center;">339</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008585-nhosts2-ngpu8-2023-10-31-044203.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-31-044203</td>
<td style="text-align: center;">2023-10-31-044533</td>
<td style="text-align: center;">44203</td>
<td style="text-align: center;">44533</td>
<td style="text-align: center;">330</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008272-nhosts4-ngpu16-2023-10-31-072717.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-31-072717</td>
<td style="text-align: center;">2023-10-31-073131</td>
<td style="text-align: center;">72717</td>
<td style="text-align: center;">73131</td>
<td style="text-align: center;">414</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008221-nhosts8-ngpu32-2023-10-31-083055.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-31-083055</td>
<td style="text-align: center;">2023-10-31-083545</td>
<td style="text-align: center;">83055</td>
<td style="text-align: center;">83545</td>
<td style="text-align: center;">490</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008196-nhosts16-ngpu64-2023-10-31-100336.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-31-100336</td>
<td style="text-align: center;">2023-10-31-100848</td>
<td style="text-align: center;">100336</td>
<td style="text-align: center;">100848</td>
<td style="text-align: center;">512</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008285-nhosts2-ngpu8-2023-11-01-200430.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-11-01-200430</td>
<td style="text-align: center;">2023-11-01-200829</td>
<td style="text-align: center;">200430</td>
<td style="text-align: center;">200829</td>
<td style="text-align: center;">399</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008193-nhosts8-ngpu32-2023-11-01-201702.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-11-01-201702</td>
<td style="text-align: center;">2023-11-01-202131</td>
<td style="text-align: center;">201702</td>
<td style="text-align: center;">202131</td>
<td style="text-align: center;">429</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008240-nhosts16-ngpu64-2023-11-01-210454.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-11-01-210454</td>
<td style="text-align: center;">2023-11-01-211007</td>
<td style="text-align: center;">210454</td>
<td style="text-align: center;">211007</td>
<td style="text-align: center;">553</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008321-nhosts2-ngpu8-2023-11-02-154438.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-11-02-154438</td>
<td style="text-align: center;">2023-11-02-154949</td>
<td style="text-align: center;">154438</td>
<td style="text-align: center;">154949</td>
<td style="text-align: center;">511</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-11-04-001717.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-11-04-001717</td>
<td style="text-align: center;">2023-11-04-002124</td>
<td style="text-align: center;">1717</td>
<td style="text-align: center;">2124</td>
<td style="text-align: center;">407</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="minimal-working-example" class="level2">
<h2 class="anchored" data-anchor-id="minimal-working-example">Minimal Working Example</h2>
<ul>
<li><p>As for 3:</p>
<blockquote class="blockquote">
<p>If we need to report the startup time for the DL applications, do we need to collect measurements using the actual Aurora NRE workloads or some small benchmarking test cases? For example, we can try to recreate the typical start-up scenarios, like library imports, and measure those separately as shown below.</p>
</blockquote>
<ul>
<li><p>I’ve been working on a library to help simplify this:</p>
<p><a href="https://github.com/saforem2/ezpz"><iconify-icon inline="" icon="tabler:brand-github"></iconify-icon> <code>ezpz</code></a><br>
<span class="dim-text"><em>Minimal library that handles the initialization of distributed training</em></span></p></li>
</ul></li>
<li><p><label><input type="checkbox" checked="">&nbsp; Working on Aurora, example:</label></p>
<ul>
<li><p>Setup / Install:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># launch job</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> qsub <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> EarlyAppAccess <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> Aurora_Deployment <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> walltime=2:00:00 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> select=4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span></span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load frameworks</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /soft/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ignore_cache</span> load frameworks</span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module load frameworks/.2023.12.15.001</span>
<span id="cb6-7"></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install `ezpz`</span></span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/saforem2/ezpz</span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ezpz</span>
<span id="cb6-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> mkdir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> venvs/aurora/2023.12.15.001</span>
<span id="cb6-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv venvs/aurora/2023.12.15.001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span></span>
<span id="cb6-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source venvs/aurora/2023.12.15.001/bin/activate</span>
<span id="cb6-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> .</span>
<span id="cb6-15"></span>
<span id="cb6-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print job info and define `launch` alias</span></span>
<span id="cb6-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source ezpz/src/ezpz/bin/savejobenv</span>
<span id="cb6-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">┌──────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Hosts</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb6-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • x4415c6s5b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span>
<span id="cb6-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c6s6b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb6-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c6s7b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb6-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c7s0b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">┌──────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> [DIST INFO]:</span>
<span id="cb6-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • Loading job env from: /home/foremans/.pbsenv</span>
<span id="cb6-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • HOSTFILE: /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb6-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • NHOSTS: 4</span>
<span id="cb6-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • NGPU_PER_HOST: 12</span>
<span id="cb6-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • NGPUS <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS</span> x NGPU_PER_HOST<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 48</span>
<span id="cb6-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • DIST_LAUNCH: mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb6-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>     • Defining alias: launch: aliased to mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb6-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──────────────────────────────────────────────────────────────────</span></span></code></pre></div></li>
<li><p>Launch with <code>framework=pytorch</code>, <code>backend=DDP</code>:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># launch + startup on all workers with</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># • `framework` ∈ {`pytorch`, `tensorflow`}</span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># • `backend` ∈ {`horovod`, `deepspeed`, `DDP`}</span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where `deepspeed` and `DDP` only available for `pytorch`</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------</span></span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz framework=pytorch backend=DDP</span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:25]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:243</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using DDP for distributed training</span>
<span id="cb7-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:27]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:28]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:28]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:29]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:29]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:29]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:30]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:34]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb7-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb7-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 1 / 47</span>
<span id="cb7-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 2 / 47</span>
<span id="cb7-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 3 / 47</span>
<span id="cb7-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 4 / 47</span>
<span id="cb7-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 0 / 47</span>
<span id="cb7-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 5 / 47</span>
<span id="cb7-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__.py:49</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> {</span>
<span id="cb7-112">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_target_"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ezpz.configs.TrainConfig"</span>,</span>
<span id="cb7-113">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"framework"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pytorch"</span>,</span>
<span id="cb7-114">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"backend"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb7-115">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ds_config_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-116">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"port"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-117">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-118">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-119">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wandb_project_name"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-120">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-121">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ngpus"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb7-122"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 9 / 47</span>
<span id="cb7-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 10 / 47</span>
<span id="cb7-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 11 / 47</span>
<span id="cb7-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 7 / 47</span>
<span id="cb7-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 8 / 47</span>
<span id="cb7-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 6 / 47</span>
<span id="cb7-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 12 / 47</span>
<span id="cb7-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 13 / 47</span>
<span id="cb7-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 14 / 47</span>
<span id="cb7-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 15 / 47</span>
<span id="cb7-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 18 / 47</span>
<span id="cb7-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 19 / 47</span>
<span id="cb7-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 20 / 47</span>
<span id="cb7-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 21 / 47</span>
<span id="cb7-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 22 / 47</span>
<span id="cb7-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 23 / 47</span>
<span id="cb7-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 24 / 47</span>
<span id="cb7-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 25 / 47</span>
<span id="cb7-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 26 / 47</span>
<span id="cb7-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 27 / 47</span>
<span id="cb7-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 30 / 47</span>
<span id="cb7-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 16 / 47</span>
<span id="cb7-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 17 / 47</span>
<span id="cb7-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 28 / 47</span>
<span id="cb7-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 32 / 47</span>
<span id="cb7-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 33 / 47</span>
<span id="cb7-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 36 / 47</span>
<span id="cb7-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 37 / 47</span>
<span id="cb7-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 38 / 47</span>
<span id="cb7-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 39 / 47</span>
<span id="cb7-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 43 / 47</span>
<span id="cb7-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 46 / 47</span>
<span id="cb7-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 29 / 47</span>
<span id="cb7-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 47 / 47</span>
<span id="cb7-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 31 / 47</span>
<span id="cb7-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 34 / 47</span>
<span id="cb7-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 35 / 47</span>
<span id="cb7-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 42 / 47</span>
<span id="cb7-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 41 / 47</span>
<span id="cb7-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 44 / 47</span>
<span id="cb7-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 45 / 47</span>
<span id="cb7-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 40 / 47</span>
<span id="cb7-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:415</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb7-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:416</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: ezpz</span>
<span id="cb7-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:448</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">flowing</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">wood</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/l2hmc-qcd/ezpz/runs/uya29gm5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:490</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on x4415c6s5b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span>
<span id="cb7-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:506</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Reading hosts from /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__.py:57</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Output dir: /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17</span>
<span id="cb7-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:519</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> 🚀 flowing-wood-8</span>
<span id="cb7-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:520</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> 🔗 https://wandb.ai/l2hmc-qcd/ezpz/runs/uya29gm5</span>
<span id="cb7-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:521</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> 📂/: /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/wandb/run-20231219_133354-uya29gm5/files</span>
<span id="cb7-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/ezpz-pt-DDP-xpu.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb7-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/__main__.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb7-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/main_debug.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb7-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-16/__main__.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span></code></pre></div></li>
</ul></li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Starting {Up} {Distributed} {Training}},
  date = {2024-03-21},
  url = {https://samforeman.me/qmd/ezpz/ezpz},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“Starting Up Distributed Training.”</span>
March 21, 2024. <a href="https://samforeman.me/qmd/ezpz/ezpz">https://samforeman.me/qmd/ezpz/ezpz</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/startup-times/</guid>
  <pubDate>Thu, 21 Mar 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>🚂 Loooooooong Sequence Lengths</title>
  <dc:creator>Sam Foreman [[{{&lt; ai orcid &gt;}}]{.orcid-green}](https://orcid.org/0000-0002-9981-0876)</dc:creator>
  <link>https://samforeman.me/qmd/long-sequences/</link>
  <description><![CDATA[ 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div id="fig-ds4sci" class="quarto-figure quarto-figure-center quarto-float anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ds4sci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><span class="stretch"><a href="https://raw.githubusercontent.com/saforem2/llm-lunch-talk/main/docs/assets/ds4sci.svg" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="https://raw.githubusercontent.com/saforem2/llm-lunch-talk/main/docs/assets/ds4sci.svg" class="img-fluid figure-img"></a></span></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ds4sci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This work was done as part of the DeepSpeed4Science project, in collaboration with Microsoft.
</figcaption>
</figure>
</div>
<p>The new <a href="https://github.com/microsoft/Megatron-DeepSpeed">Megatron-DeepSpeed</a> release contains a variety of improvements / optimizations to enable pre-training Transformer based architectures with significantly longer sequences than was previously possible.</p>
<!-- > **Note**<br> -->
<!-- > Additional details can be found in the -->
<!-- > [📁 `DeepSpeed4Science`](https://github.com/microsoft/Megatron-DeepSpeed/examples_deepspeed/deepspeed4science/megatron_long_seq_support/README.md) -->
<!-- > folder. -->
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="📓 Note:" style="width:100%; background: none!important; border: none!important; border-left: 2px solid var(--callout-note-color)!important; border-radius: 0pt!important; opacity: 100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📓 Note:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Additional details can be found in the <a href="https://github.com/microsoft/Megatron-DeepSpeed/tree/main/examples_deepspeed/deepspeed4science/megatron_long_seq_support">📁 <code>DeepSpeed4Science</code></a> folder.</p>
</div>
</div>
</div>
<section id="deepspeed4science-092023" class="level2">
<h2 class="anchored" data-anchor-id="deepspeed4science-092023"><a href="https://ai4science.azurewebsites.net/2023/09/18/model-showcase-genslms/">DeepSpeed4Science</a> (09/2023)</h2>
<section id="new-features" class="level3">
<h3 class="anchored" data-anchor-id="new-features">New Features</h3>
<ul>
<li><p>Enabled Megatron-LM’s sequence parallel.</p></li>
<li><p>Enabled rotary positional embedding.</p></li>
<li><p>Enabled FlashAttention v1 and v2.</p></li>
<li><p>Enabled new fused kernels from NVIDIA.</p></li>
</ul>
</section>
<section id="new-optimizations" class="level3">
<h3 class="anchored" data-anchor-id="new-optimizations">New optimizations</h3>
<ul>
<li><p>Enabled attention map memory optimization, where we first generated attention mask on CPU memory and then moved it into GPU memory to avoid out-of-memory errors when training with very large sequence lengths.</p></li>
<li><p>Position embedding partitioning, where we split weights of position encoding across all GPUs when enabling sequence parallel to further reduce the memory footprint.</p></li>
</ul>
</section>
<section id="initial-results" class="level3">
<h3 class="anchored" data-anchor-id="initial-results">Initial Results</h3>
<div id="tbl-results" class="striped hover quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Long sequence length support<sup>1</sup> from <a href="https://github.com/microsoft/Megatron-DeepSpeed"><code>microsoft/Megatron-DeepSpeed</code></a>
</figcaption>
<div aria-describedby="tbl-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Sequence Length</th>
<th style="text-align: center;">Old Megatron-DeepSpeed (TFLOPS)</th>
<th style="text-align: center;">New Megatron-DeepSpeed (TFLOPS)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2k</td>
<td style="text-align: center;"><span style="text-weight:600;">25</span></td>
<td style="text-align: center;"><span style="text-weight:600;">68</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">4k</td>
<td style="text-align: center;"><span style="text-weight:600;">28</span></td>
<td style="text-align: center;"><span style="text-weight:600;">80</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">8k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">86</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">16k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">92</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">32k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">100</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">64k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">106</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">128k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">119</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">256k</td>
<td style="text-align: center;"><span class="red-text">OOM</span></td>
<td style="text-align: center;"><span style="text-weight:600;">94</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="851758fc" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Data</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1">gpus <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'32'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'64'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'128'</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Old Megatron-DS'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#FF5252'</span>,</span>
<span id="cb1-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Megatron-LM'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#76b900'</span>,</span>
<span id="cb1-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'New Megatron-DS'</span>:  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#1A8FFF'</span>,</span>
<span id="cb1-7">}</span>
<span id="cb1-8"></span>
<span id="cb1-9">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'25B'</span>: {</span>
<span id="cb1-11">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Old Megatron-DS'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>]),</span>
<span id="cb1-12">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Megatron-LM'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">52</span>]),</span>
<span id="cb1-13">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'New Megatron-DS'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">192</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">448</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>]),</span>
<span id="cb1-14">    },</span>
<span id="cb1-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'33B'</span>: {</span>
<span id="cb1-16">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Old Megatron-DS'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>]),</span>
<span id="cb1-17">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Megatron-LM'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">46</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">52</span>]),</span>
<span id="cb1-18">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'New Megatron-DS'</span>: np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">384</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">448</span>]),</span>
<span id="cb1-19">    },</span>
<span id="cb1-20">}</span></code></pre></div>
</details>
</div>
<details class="code-fold">
<summary>Make the plots</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(gpus))</span>
<span id="cb2-2">width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb2-3">multiplier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-4"></span>
<span id="cb2-5">outdir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(os.getcwd()).joinpath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'assets'</span>)</span>
<span id="cb2-6">outdir.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-7"></span>
<span id="cb2-8">improvement <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb2-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, (model_size, d) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(data.items()):</span>
<span id="cb2-10">    multiplier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-11">    figure, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb2-12">    fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.gcf()</span>
<span id="cb2-13">    ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.gca()</span>
<span id="cb2-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> label, value <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> d.items():</span>
<span id="cb2-15">        offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> multiplier</span>
<span id="cb2-16">        rects <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.barh(</span>
<span id="cb2-17">          x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> offset,</span>
<span id="cb2-18">          value,</span>
<span id="cb2-19">          width,</span>
<span id="cb2-20">          label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label,</span>
<span id="cb2-21">          color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>colors[label],</span>
<span id="cb2-22">          alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb2-23">        )</span>
<span id="cb2-24">        ax.bar_label(</span>
<span id="cb2-25">          rects,</span>
<span id="cb2-26">          padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-27">          color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>colors[label],</span>
<span id="cb2-28">          family<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'monospace'</span>,</span>
<span id="cb2-29">          weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bold'</span></span>
<span id="cb2-30">        )</span>
<span id="cb2-31">        multiplier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-32">    ax.set_ylabel(</span>
<span id="cb2-33">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GPUs'</span>,</span>
<span id="cb2-34">        fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb2-35">        family<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sans-serif'</span>,</span>
<span id="cb2-36">        loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,</span>
<span id="cb2-37">    )</span>
<span id="cb2-38">    ax.set_yticks(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, gpus)</span>
<span id="cb2-39">    plt.figtext(</span>
<span id="cb2-40">        <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.93</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model_size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bold'</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span></span>
<span id="cb2-41">    )</span>
<span id="cb2-42">    ax.set_xlabel(</span>
<span id="cb2-43">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sequence Length (k)'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span></span>
<span id="cb2-44">    )</span>
<span id="cb2-45">    ax.legend(</span>
<span id="cb2-46">        bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.04</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.098</span>),</span>
<span id="cb2-47">        alignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>,</span>
<span id="cb2-48">        edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#83838320"</span>,</span>
<span id="cb2-49">        frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb2-50">        ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-51">        fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb2-52">        mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"expand"</span>,</span>
<span id="cb2-53">        borderaxespad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span></span>
<span id="cb2-54">    )</span>
<span id="cb2-55">    save_figure(fname<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model_size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, outdir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>outdir)</span>
<span id="cb2-56">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.show()</span></code></pre></div>
</details>
<div id="fig-seq-len" class="quarto-figure quarto-figure-center quarto-float anchored" style="background-color:none;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seq-len-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>

</div>
<div id="dedeaaf5" class="cell quarto-layout-panel" data-layout-nrow="1" data-execution_count="3" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-1.svg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="GPT-25B Model"><img src="https://samforeman.me/qmd/long-sequences/index_files/figure-html/cell-4-output-1.svg" class="img-fluid figure-img"></a></p>
<figcaption>GPT-<code>25B</code> Model</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-2.svg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3" title="GPT-33B Model"><img src="https://samforeman.me/qmd/long-sequences/index_files/figure-html/cell-4-output-2.svg" class="img-fluid figure-img"></a></p>
<figcaption>GPT-<code>33B</code> Model</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seq-len-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Pre-training with long sequence support across different model sizes and numbers of GPUs. In each case, the <code>new</code> (current) implementation <strong>significantly</strong> outperforms both NVIDIA/Megatron-LM as well as our previous implementation.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<section id="using-install.sh" class="level3">
<h3 class="anchored" data-anchor-id="using-install.sh">Using <a href="https://github.com/ramanathanlab/genslm/blob/foremans/ds4sci/examples/long-sequences/install.sh"><code>install.sh</code></a></h3>
<div class="callout callout-style-simple callout-tip callout-titled" title="Installation" style="width:100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Installation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>Important</strong><br> To install, simply:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/ramanthanlab/GenSLM/</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> GenSLM/examples/long-sequences/</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./install.sh</span></span></code></pre></div>
<p>Explicitly, <a href="https://github.com/ramanathanlab/genslm/blob/foremans/ds4sci/examples/long-sequences/install.sh"><code>./install.sh</code></a> will:</p>
<ol type="1">
<li><strong>Automatically</strong> create a virtual environment <em>on top of</em> the latest <code>conda</code> module</li>
<li>Install (+ update<sup>2</sup>) / build all the required dependencies into this virtual environment</li>
</ol>
</div>
</div>
</div>
</section>
<section id="step-by-step" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step">Step-by-Step</h3>
<p>For completeness, we describe below the steps for installing and building each of the dependencies.</p>
<ol type="1">
<li><p>Clone GitHub repo:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/ramanthanlab/GenSLM</span></code></pre></div></li>
<li><p>Load <code>conda</code> module:</p>
<ul>
<li><p>ThetaGPU:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ThetaGPU:</span></span>
<span id="cb5-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">==theta*"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb5-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MACHINE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ThetaGPU"</span></span>
<span id="cb5-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CONDA_DATE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-01-10"</span></span>
<span id="cb5-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load conda/2023-01-11</span>
<span id="cb5-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate base</span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span></code></pre></div></li>
<li><p>Polaris:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Polaris:</span></span>
<span id="cb6-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">==x3*"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb6-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MACHINE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polaris"</span></span>
<span id="cb6-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CONDA_DATE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-01-10"</span></span>
<span id="cb6-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load conda/2023-01-10-unstable</span>
<span id="cb6-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate base</span>
<span id="cb6-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span></code></pre></div></li>
</ul></li>
<li><p>Setup Virtual Environment<sup>3</sup>:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ./genslm/examples/long-sequences</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a new virtual environment</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"venvs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${MACHINE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_DATE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"venvs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${MACHINE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_DATE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span></span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"venvs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${MACHINE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_DATE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin/activate"</span></span></code></pre></div></li>
<li><p>Create a new folder (<code>genslm/examples/long-sequences/deps/${MACHINE}</code>) where we’ll installing dependencies locally:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deps/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${MACHINE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deps/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${MACHINE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div></li>
</ol>
<section id="dependencies" class="level4">
<h4 class="anchored" data-anchor-id="dependencies">Dependencies</h4>
<p>We provide below the details needed to install each of the required dependencies.</p>
<details>
<summary>
<a href="https://github.com/saforem2/ezpz"><i class="fa-brands fa-github" aria-label="github"></i> <code>saforem2/ezpz</code></a>
</summary>
<ol type="1">
<li><p><a href="https://github.com/saforem2/ezpz"><i class="fa-brands fa-github" aria-label="github"></i> <code>saforem2/ezpz</code></a></p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz.git#egg=ezpz"</span></span></code></pre></div></li>
</ol>
</details>
<details>
<summary>
<a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-github" aria-label="github"></i> <code>Microsoft/DeepSpeed</code></a>
</summary>
<ol start="2" type="1">
<li><p><a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-github" aria-label="github"></i> <code>Microsoft/DeepSpeed</code></a></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/microsoft/DeepSpeed.git</span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> DeepSpeed</span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> .</span></code></pre></div></li>
</ol>
</details>
<details>
<summary>
<a href="https://github.com/microsoft/Megatron-DeepSpeed"><i class="fa-brands fa-github" aria-label="github"></i> <code>Microsoft/Megatron-DeepSpeed</code></a>
</summary>
<ol start="3" type="1">
<li><p><a href="https://github.com/microsoft/Megatron-DeepSpeed"><i class="fa-brands fa-github" aria-label="github"></i> <code>Microsoft/Megatron-DeepSpeed</code></a>:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/microsoft/Megatron-DeepSpeed.git</span></code></pre></div></li>
</ol>
</details>
<details>
<summary>
<a href="https://github.com/NVIDIA/apex"><i class="fa-brands fa-github" aria-label="github"></i> <code>NVIDIA/apex</code></a>
</summary>
<ol start="4" type="1">
<li><p><a href="https://github.com/NVIDIA/apex"><i class="fa-brands fa-github" aria-label="github"></i> <code>NVIDIA/apex</code></a></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/NVIDIA/apex</span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../apex/</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-pip-version-check</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-cache-dir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-build-isolation</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-option</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--cpp_ext"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-option</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--cuda_ext"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ./</span></code></pre></div></li>
</ol>
</details>
<details>
<summary>
<a href="https://github.com/pybind/pybind11"><i class="fa-brands fa-github" aria-label="github"></i> <code>pybind/PyBind11</code></a>
</summary>
<ol start="5" type="1">
<li><p><a href="https://github.com/pybind/pybind11"><i class="fa-brands fa-github" aria-label="github"></i> <code>pybind/PyBind11</code></a></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install pybind11</span></code></pre></div></li>
</ol>
</details>
<details>
<summary>
<a href="https://github.com/Dao-AILab/flash-attention"><i class="fa-brands fa-github" aria-label="github"></i> <code>Dao-AILab/flash-attention</code></a>
</summary>
<ol start="6" type="1">
<li><p><a href="https://github.com/Dao-AILab/flash-attention"><i class="fa-brands fa-github" aria-label="github"></i> <code>Dao-AILab/flash-attention</code></a>:</p>
<div class="callout callout-style-simple callout-caution callout-titled" title="Flash Attention" style="font-size:0.8em; width:100%;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Flash Attention
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The new release supports three different implementations of FlashAttention: (<code>v1.0.4</code>, <code>v2.x</code>, <code>triton</code>)</li>
<li>FlashAttention <code>v2.x</code> may have numerical instability issues. For the best performance, we recommend using FlashAttention + Triton</li>
</ul>
</div>
</div>
</div>
<ul>
<li><p><code>v1.0.4</code>:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install flash-attn==1.0.4</span></code></pre></div></li>
<li><p><code>v2.x</code>:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/Dao-AILab/flash-attention</span>
<span id="cb15-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> flash-attention</span>
<span id="cb15-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py install</span></code></pre></div></li>
<li><p><code>openai/triton</code>:</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> legacy-backend https://github.com/openai/triton</span>
<span id="cb16-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> triton/python</span>
<span id="cb16-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install cmake</span>
<span id="cb16-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install .</span></code></pre></div></li>
</ul></li>
</ol>
</details>
</section>
</section>
</section>
<section id="running" class="level2">
<h2 class="anchored" data-anchor-id="running">Running</h2>
<p>The <a href="./ALCF/"><code>ALCF/</code></a> directory contains shell scripts for setting up the environment and specifying the options to be used when launching.</p>
<p>Various options can be specified dynamically at runtime by setting them in your environment, e.g.:</p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MODEL_SIZE_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPT25B"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SEQ_LEN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128000 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_FLASH_ATTN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MICRO_BATCH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GAS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SP_TYPE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"megatron"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ZERO_STAGE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./ALCF/train-gpt3.sh</span></span></code></pre></div>
<p>Explicitly:</p>
<ul>
<li><a href="./ALCF/train-gpt3.sh"><code>ALCF/train-gpt3.sh</code></a>: <strong>Main entry point for training</strong>
<ul>
<li>This script will <strong>automatically</strong> source the rest of the required <a href="./ALCF/"><code>ALCF/*.sh</code></a> scripts below</li>
</ul></li>
<li><a href="./ALCF/models.sh"><code>ALCF/models.sh</code></a>: Contains some example model architectures for GPT3-style models</li>
<li><a href="./ALCF/args.sh"><code>ALCF/args.sh</code></a>: Logic for parsing / setting up runtime options for Megatron and DeepSpeed</li>
<li><a href="./ALCF/args.sh"><code>ALCF/setup.sh</code></a>: Locate and activate virtual environment to be used, ensure MPI variables are set properly</li>
<li><a href="./ALCF/launch.sh"><code>ALCF/launch.sh</code></a>: Identify available resources and build the command to be executed
<ul>
<li>i.e.&nbsp;figure out how many: <code>{nodes, GPUs per node, GPUs total}</code>, to pass to <code>mpi{run,exec}</code></li>
<li>then, use this to build <code>mpiexec &lt;mpiexec-args&gt; python3 pretrain_gpt.py</code></li>
</ul></li>
</ul>
</section>
<section id="zero-offloading" class="level2">
<h2 class="anchored" data-anchor-id="zero-offloading">ZeRO Offloading</h2>
<p><a href="https://wandb.ai/l2hmc-qcd/Megatron-DS-Benchmarking/reports/Looooooong-Sequences--Vmlldzo1MzI2NjA1">🚀 <strong>W&amp;B Report</strong>: <em>Looooooooong Sequences</em></a></p>
<p>These newly introduced optimizations, in combination with <a href="https://www.deepspeed.ai/tutorials/zero-offload/">ZeRO-Offload</a> allows us to go even further.</p>
<p>By employing ZeRO-Offloading, we are able to free up additional memory which can be used for <em>even longer</em> sequences.</p>
<p>Though work is still ongoing, this is a promising direction that will allow us to consider significantly larger genomes than previously possible.</p>
<p>We use <a href="https://wandb.ai">Weights &amp; Biases</a> to track these experiments, and have aggregated our initial results in the <a href="https://wandb.ai/l2hmc-qcd/Megatron-DS-Benchmarking/reports/Looooooong-Sequences--Vmlldzo1MzI2NjA1">W&amp;B Report</a> below.</p>
<p>We can evaluate the performance of our model by looking at two different metrics for throughput: <code>samples_per_sec</code> and <code>TFLOPS</code>.</p>
<p>Explicitly, we see that we are able to scale up to significantly longer sequences (<code>420k / 128k ~ 3.3x</code>) with only a minimal impact on throughput performance (<code>81 / 105 ~ 77\%</code>)<sup>4</sup>.</p>
<div id="tbl-seqlen" class="striped hover quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-seqlen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Impact on TFLOPS as a function of increasing sequence length. Table from: <a href="https://api.wandb.ai/links/l2hmc-qcd/awklywn7"><code>throughput/TFLOPS</code></a>
</figcaption>
<div aria-describedby="tbl-seqlen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 9%">
<col style="width: 25%">
<col style="width: 29%">
<col style="width: 11%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Name</th>
<th style="text-align: center;">Sequence Length (k)</th>
<th style="text-align: center;">(<code>seq_len / min_seq_len</code>)</th>
<th style="text-align: center;">TFLOPS</th>
<th style="text-align: center;">TFLOPS (% of peak)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">420</td>
<td style="text-align: center;"><span class="blue-text"><strong>3.28125</strong></span></td>
<td style="text-align: center;">81.77225</td>
<td style="text-align: center;"><span class="blue-text"><strong>77.867</strong></span></td>
</tr>
<tr class="even">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">400</td>
<td style="text-align: center;">3.125</td>
<td style="text-align: center;">90.62</td>
<td style="text-align: center;">86.297</td>
</tr>
<tr class="odd">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">360</td>
<td style="text-align: center;">2.8125</td>
<td style="text-align: center;">81.6325</td>
<td style="text-align: center;">77.7348</td>
</tr>
<tr class="even">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">360</td>
<td style="text-align: center;">2.8125</td>
<td style="text-align: center;">82.6824</td>
<td style="text-align: center;">78.7346</td>
</tr>
<tr class="odd">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">192</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">115.8228</td>
<td style="text-align: center;">110.2927</td>
</tr>
<tr class="even">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">106.672</td>
<td style="text-align: center;">101.5788</td>
</tr>
<tr class="odd">
<td style="text-align: center;">GPT25B</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">105.014</td>
<td style="text-align: center;">100.00</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!-- [^config]: Using: `{model_size: 25B, WORLD_SIZE: 32, micro_batch: 1}` -->
<!-- <iframe src="https://wandb.ai/l2hmc-qcd/Megatron-DS-Benchmarking?workspace=user-saforem2" style="border:none;height:1024px;width:100%"> -->
<div id="fig-wandb" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wandb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div style="padding:0.5rem; border: 1px solid var(--dim-text); border-radius: 0.2rem;">
<iframe src="https://wandb.ai/l2hmc-qcd/Megatron-DS-Benchmarking/reports/Looooooong-Sequences--Vmlldzo1MzI2NjA1" style="border:none;height:1024px;width:100%">
</iframe>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wandb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Weights &amp; Biases Report
</figcaption>
</figure>
</div>



</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The described experiments were performed on 4 NVIDIA DGX A100-40GB nodes, all using <code>TPSIZE=32</code>[^tpsize], connected through 8 HDR InfiniBand (200Gb/s per HDR).↩︎</p></li>
<li id="fn2"><div class="line-block"></div>
<ol start="2" type="1">
<li><code>deepspeed-0.10.3</code></li>
<li><code>pytorch==2.0.0+cu118</code></li>
</ol>
↩︎</li>
<li id="fn3"><p>Where <code>"${MACHINE}"</code> <img src="https://latex.codecogs.com/png.latex?%5Cin"> <code>{"ThetaGPU", "Polaris"}</code> and <code>"${CONDA_DATE}"</code> <img src="https://latex.codecogs.com/png.latex?%5Cin"> <code>{"2023-01-10", "2023-01-11"}</code>↩︎</p></li>
<li id="fn4"><p><a href="https://api.wandb.ai/links/l2hmc-qcd/awklywn7"><code>throughput/TFLOPS</code></a>↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Personal {Website}},
  date = {2024-02-12},
  url = {https://samforeman.me},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>“Personal Website.”</span> February 12, 2024.
<a href="https://samforeman.me">https://samforeman.me</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/qmd/long-sequences/</guid>
  <pubDate>Mon, 12 Feb 2024 06:00:00 GMT</pubDate>
</item>
</channel>
</rss>
