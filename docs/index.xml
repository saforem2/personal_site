<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam Foreman</title>
<link>https://samforeman.me/</link>
<atom:link href="https://samforeman.me/index.xml" rel="self" type="application/rss+xml"/>
<description>Sam Foreman&#39;s personal website</description>
<image>
<url>https://samforeman.me/assets/thumbnail.png</url>
<title>Sam Foreman</title>
<link>https://samforeman.me/</link>
<height>78</height>
<width>144</width>
</image>
<generator>quarto-1.8.16</generator>
<lastBuildDate>Sat, 14 Jun 2025 05:00:00 GMT</lastBuildDate>
<item>
  <title>üèóÔ∏è Building PyTorch 2.8 from Source on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/14/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="shell-environment" class="level2">
<h2 class="anchored" data-anchor-id="shell-environment">üèñÔ∏è Shell Environment</h2>
<ol type="1">
<li><p>Helper function to get timestamp:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tstamp()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> +<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d-%H%M%S"</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span></code></pre></div></div></li>
<li><p>Load <code>frameworks</code> module:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks</span></code></pre></div></div></li>
<li><p>Deactivate <code>conda</code> environment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> deactivate</span></code></pre></div></div></li>
<li><p>Create new <code>conda</code> environment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ENV_PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/datascience/foremans/miniconda/2025-06-15"</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--prefix</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ENV_PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--y</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--solver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>libmamba <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> python=3.12</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ENV_PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div></div></li>
</ol>
</section>
<section id="build-libraries" class="level2">
<h2 class="anchored" data-anchor-id="build-libraries">üî® Build Libraries</h2>
<section id="pytorch" class="level3">
<h3 class="anchored" data-anchor-id="pytorch">PyTorch</h3>
<ol type="1">
<li><p>Clone <a href="https://github.com/pytorch/pytorch">pytorch/<code>pytorch</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/pytorch</span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> pytorch</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span></code></pre></div></div></li>
<li><p>Install dependencies:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install cmake ninja</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install mkl-static mkl-include</span></code></pre></div></div></li>
<li><p>Make triton:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for Intel GPU support</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> triton</span></code></pre></div></div></li>
<li><p>Set environment variables for PyTorch build:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span></span>
<span id="cb8-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span></span>
<span id="cb8-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKLDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_FBGEMM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_QNNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_CAFFE2_OPS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_TEST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_DISTRIBUTED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NUMA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MPI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTEL_MKL_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$MKLROOT</span></span>
<span id="cb8-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_AOT_DEVLIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb8-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TORCH_XPU_ARCH_LIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb8-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OCLOC_VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24.39.1</span>
<span id="cb8-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> gcc</span>
<span id="cb8-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> g++</span></code></pre></div></div></li>
<li><p>Build PyTorch (takes ~ 30 mins):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></div></li>
<li><p>[Optional] Install {<code>torchvision</code>, <code>torchaudio</code>, <code>torchdata</code>} with no dependencies:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install torchvision torchaudio <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-deps</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--index-url</span> https://download.pytorch.org/whl/xpu</span>
<span id="cb10-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install torchdata <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-deps</span></span></code></pre></div></div></li>
</ol>
</section>
<section id="intel-libraries" class="level3">
<h3 class="anchored" data-anchor-id="intel-libraries">Intel Libraries</h3>
<ol type="1">
<li><p><a href="https://github.com/intel/intel-extension-for-pytorch">intel/<code>intel-extension-for-pytorch</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/intel/intel-extension-for-pytorch</span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> intel-extension-for-pytorch</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout xpu-main</span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb11-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span> pip setuptools wheel build black flake8</span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MAX_JOBS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>48 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTELONEAPIROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ONEAPI_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ipex-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb11-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb11-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></div></li>
<li><p><a href="https://github.com/intel/torch-ccl">intel/<code>torch-ccl</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/intel/torch-ccl</span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> torch-ccl</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout c27ded5</span>
<span id="cb12-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb12-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span>
<span id="cb12-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># see:</span></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/intel/torch-ccl/blob/c27ded5190a6b115ec68c7a8c28f40cfe7f0a32a/version.txt</span></span>
<span id="cb12-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ONECCL_BINDINGS_FOR_PYTORCH_BACKEND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>xpu <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTELONEAPIROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ONEAPI_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_SYSTEM_ONECCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ON <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">COMPUTE_BACKEND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dpcpp <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch-ccl-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb12-10"></span>
<span id="cb12-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb12-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></div></li>
</ol>
</section>
<section id="mpi4py" class="level3">
<h3 class="anchored" data-anchor-id="mpi4py"><code>mpi4py</code></h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/mpi4py/mpi4py</span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> mpi4py</span>
<span id="cb13-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicc <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicxx <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py build <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span>
<span id="cb13-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicc <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicxx <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py install <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> install.log</span>
<span id="cb13-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></div>
</section>
<section id="h5py" class="level3">
<h3 class="anchored" data-anchor-id="h5py"><code>h5py</code></h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load hdf5</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/h5py/h5py</span>
<span id="cb14-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> h5py</span>
<span id="cb14-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicc <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicxx <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HDF5_MPI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ON"</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-binary</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>h5py .</span>
<span id="cb14-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">h5cc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-showconfig</span></span></code></pre></div></div>
</section>
<section id="torch-ao" class="level3">
<h3 class="anchored" data-anchor-id="torch-ao">torch / <code>ao</code></h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/ao</span>
<span id="cb15-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ao</span>
<span id="cb15-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torchao-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb15-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb15-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../</span></code></pre></div></div>
</section>
<section id="torchtune" class="level3">
<h3 class="anchored" data-anchor-id="torchtune">TorchTune</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/torchtune</span>
<span id="cb16-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> torchtune</span>
<span id="cb16-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span></span>
<span id="cb16-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tune</span> download meta-llama/Meta-Llama-3.1-8B-Instruct <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output-dir</span> ~/torchtune_anl2/out_dir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ignore-patterns</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original/consolidated.00.pth"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hf-token</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>hf-token<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb16-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../</span></code></pre></div></div>
</section>
</section>
<section id="verify-installation" class="level2">
<h2 class="anchored" data-anchor-id="verify-installation">‚úÖ Verify Installation</h2>
<ul>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import torch; print(torch.__file__); print(*torch.__config__.show().split("\n"), sep="\n") ; print(f"{torch.__version__=}"); print(f"{torch.xpu.is_available()=}"); print(f"{torch.xpu.device_count()=}") ; import torch.distributed; print(f"{torch.distributed.is_xccl_available()=}"); import torch; import intel_extension_for_pytorch as ipex; print(f"{torch.__version__=}"); print(f"{ipex.__version__=}"); import oneccl_bindings_for_pytorch as oneccl_bpt; print(f"{oneccl_bpt.__version__=}") ; [print(f"[{i}]: {torch.xpu.get_device_properties(i)}") for i in range(torch.xpu.device_count())]'</span></span></code></pre></div></div></li>
<li><p>Output:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import torch; print(torch.__file__); print(*torch.__config__.show().split("\n"), sep="\n") ; print(f"{torch.__version__=}"); print(f"{torch.xpu.is_available()=}"); print(f"{torch.xpu.device_count()=}") ; import torch.distributed; print(f"{torch.distributed.is_xccl_available()=}"); import torch; import intel_extension_for_pytorch as ipex; print(f"{torch.__version__=}"); print(f"{ipex.__version__=}"); import oneccl_bindings_for_pytorch as oneccl_bpt; print(f"{oneccl_bpt.__version__=}") ; [print(f"[{i}]: {torch.xpu.get_device_properties(i)}") for i in range(torch.xpu.device_count())]'</span></span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/flare/datascience/foremans/miniconda/2025-06-15/lib/python3.12/site-packages/torch/__init__.py</span></span>
<span id="cb18-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PyTorch</span> built with:</span>
<span id="cb18-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> GCC 13.3</span>
<span id="cb18-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> C++ Version: 201703</span>
<span id="cb18-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneAPI</span> Math Kernel Library Version 2025.0.1-Product Build 20241031 for Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">64</span> architecture applications</span>
<span id="cb18-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MKL-DNN</span> v3.7.1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Git</span> Hash 8d263e693366ef8db40acc569cc7d8edf644556d<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> OpenMP 201511 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a.k.a.</span> OpenMP 4.5<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> LAPACK is enabled <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">usually</span> provided by MKL<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> NNPACK is enabled</span>
<span id="cb18-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> CPU capability usage: AVX512</span>
<span id="cb18-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> backend  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Build settings: BLAS_INFO=mkl, BUILD_TYPE=Debug, COMMIT_SHA=655b3b14ffba4ae73e26a63b4289329e8d160a6f, CXX_COMPILER=/opt/aurora/24.347.0/spack/unified/0.9.2/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/g++, CXX_FLAGS= <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fvisibility-inlines-hidden</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_PTHREADPOOL</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_KINETO</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOCUPTI</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOROCTRACER</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOXPUPTI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>OFF <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_FBGEMM</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_PYTORCH_QNNPACK</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_XNNPACK</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DSYMBOLICATE_MOBILE_DEBUG_HANDLE</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DC10_NODEPRECATED</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wextra</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>return-type <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>non-virtual-dtor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>range-loop-construct <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>bool-operation <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wnarrowing</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-missing-field-initializers</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unknown-pragmas</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unused-parameter</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-strict-overflow</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-strict-aliasing</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-stringop-overflow</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wsuggest-override</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-psabi</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-error</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>old-style-cast <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fdiagnostics-color</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>always <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-faligned-new</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-maybe-uninitialized</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fno-math-errno</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fno-trapping-math</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>format <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-dangling-reference</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-error</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dangling-reference <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_XPU</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-stringop-overflow,</span> LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, TORCH_VERSION=2.8.0, USE_CUDA=0, USE_CUDNN=OFF, USE_CUSPARSELT=OFF, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=1, USE_MPI=1, USE_NCCL=OFF, USE_NNPACK=1,USE_OPENMP=ON, USE_ROCM=0, USE_ROCM_KERNEL_ASSERT=OFF, USE_XCCL=1, USE_XPU=1,</span>
<span id="cb18-13"></span>
<span id="cb18-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0a0+git655b3b1'</span></span>
<span id="cb18-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.xpu.is_available()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=True</span></span>
<span id="cb18-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.xpu.device_count()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=12</span></span>
<span id="cb18-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.distributed.is_xccl_available()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=True</span></span>
<span id="cb18-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W615</span> 14:52:10.420018164 OperatorEntry.cpp:217] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb18-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb18-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::geometric_<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> float p, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>, Generator<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> generator=None<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-15/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb18-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb18-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-15/pytorch/aten/src/ATen/VmapModeRegistrations.cpp:37</span>
<span id="cb18-24">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-15/intel-extension-for-pytorch/build/Release/csrc/gpu/csrc/gpu/xpu/ATen/RegisterXPU_0.cpp:186 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0a0+git655b3b1'</span></span>
<span id="cb18-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ipex.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.10+git57bb68a'</span></span>
<span id="cb18-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneccl_bpt.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0+xpu'</span></span>
<span id="cb18-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[0]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[3]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[5]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[6]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[7]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[8]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[9]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:21s</span></code></pre></div></div></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üèóÔ∏è {Building} {PyTorch} 2.8 from {Source} on {Aurora}},
  date = {2025-06-14},
  url = {https://samforeman.me/posts/2025/06/14/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúüèóÔ∏è Building PyTorch 2.8 from Source on
Aurora.‚Äù</span> June 14, 2025. <a href="https://samforeman.me/posts/2025/06/14/">https://samforeman.me/posts/2025/06/14/</a>.
</div></div></section></div> ]]></description>
  <category>pytorch</category>
  <category>Aurora</category>
  <guid>https://samforeman.me/posts/2025/06/14/</guid>
  <pubDate>Sat, 14 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üìÜ 2025</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div id="listing-listing-posts" class="quarto-listing quarto-listing-container-table">
<table class="quarto-listing-table table table-striped table-hover">
<thead>
<tr>

<th>
What
</th>

<th>
When
</th>

</tr>
</thead>
<tbody class="list">

<tr data-index="0" data-categories="cHl0b3JjaCUyQ0F1cm9yYQ==" data-listing-date-sort="1749877200000" data-listing-file-modified-sort="1750262052930" data-listing-date-modified-sort="1750262052000" data-listing-reading-time-sort="7" data-listing-word-count-sort="1301" data-listing-title-sort="üèóÔ∏è Building PyTorch 2.8 from Source on Aurora" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../posts/2025/06/14/index.html" class="title listing-title">üèóÔ∏è Building PyTorch 2.8 from Source on Aurora</a>
</td>
<td>
<span class="listing-date">2025-06-14</span>
</td>

</tr>

<tr data-index="1" data-categories="c3R5bGUlMkNwZXJzb25hbA==" data-listing-date-sort="1748840400000" data-listing-file-modified-sort="1748927917548" data-listing-date-modified-sort="1748927917000" data-listing-reading-time-sort="3" data-listing-word-count-sort="444" data-listing-title-sort="üßú‚Äç‚ôÄÔ∏è Mermaid" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../posts/2025/06/02/index.html" class="title listing-title">üßú‚Äç‚ôÄÔ∏è Mermaid</a>
</td>
<td>
<span class="listing-date">2025-06-02</span>
</td>

</tr>

<tr data-index="2" data-categories="c3R5bGUlMkNwZXJzb25hbA==" data-listing-date-sort="1748754000000" data-listing-file-modified-sort="1748808239601" data-listing-date-modified-sort="1748808239000" data-listing-reading-time-sort="1" data-listing-word-count-sort="54" data-listing-title-sort="üì∞ Nice Headings" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../posts/2025/06/01/index.html" class="title listing-title">üì∞ Nice Headings</a>
</td>
<td>
<span class="listing-date">2025-06-01</span>
</td>

</tr>

<tr data-index="3" data-categories="ZnJhbWV3b3JrcyUyQ0F1cm9yYSUyQ3B5dG9yY2glMkNidWc=" data-listing-date-sort="1746248400000" data-listing-file-modified-sort="1749352839709" data-listing-date-modified-sort="1749352839000" data-listing-reading-time-sort="7" data-listing-word-count-sort="1264" data-listing-title-sort="üöß Frameworks Issue with <code>numpy > 2</code>" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../posts/2025/05/03/index.html" class="title listing-title">üöß Frameworks Issue with <code>numpy &gt; 2</code></a>
</td>
<td>
<span class="listing-date">2025-05-03</span>
</td>

</tr>

<tr data-index="4" data-categories="cHl0b3JjaCUyQ0F1cm9yYQ==" data-listing-date-sort="1745816400000" data-listing-file-modified-sort="1749927591458" data-listing-date-modified-sort="1749927591000" data-listing-reading-time-sort="1" data-listing-word-count-sort="112" data-listing-title-sort="üî• Building PyTorch 2.6 from Source on Aurora" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../posts/2025/04/28/index.html" class="title listing-title">üî• Building PyTorch 2.6 from Source on Aurora</a>
</td>
<td>
<span class="listing-date">2025-04-28</span>
</td>

</tr>

</tbody>
</table>
<div class="listing-no-matching d-none">No matching items</div>
</div>





<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üìÜ 2025},
  date = {2025-06-14},
  url = {https://samforeman.me/posts/2025/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúüìÜ 2025.‚Äù</span> June 14, 2025. <a href="https://samforeman.me/posts/2025/">https://samforeman.me/posts/2025/</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/posts/2025/</guid>
  <pubDate>Sat, 14 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üßú‚Äç‚ôÄÔ∏è Mermaid</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/02/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph D["`Data`"]
        direction TB
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    direction LR
    subgraph G0["`GPU0`"]
        direction LR
        subgraph N0["`NN`"]
        end
        L0["`L0`"]
    end
    subgraph G1["`GPU1`"]
        direction LR
        subgraph N1["`NN`"]
        end
        L1["`L1`"]
    end
    subgraph G2["`GPU2`"]
        direction LR
        subgraph N2["`NN`"]
        end
        L2["`L2`"]
    end
    %%subgraph AR["`Average Grads`"]
    %%    direction LR
    %%    ar("`(1/N) ‚àë g‚Çô`")
    %%    %%ar --&gt; bc
    %%end
    subgraph AR["`&amp;nbsp;`"]
        direction TB
        ar("`Avg Grads&lt;br&gt;(1/N) ‚àë g‚Çô`")
        %% bc("`Update Weights`")
    end
    %%subgraph UW["Update Weights"]
    %%    bc("`Update Weights`")
    %%end
    x --&gt; G0
    x1 --&gt; G1
    x2 --&gt; G2
    N0 --&gt; L0
    N1 --&gt; L1
    N2 --&gt; L2
    L0 -.-&gt; ar
    L1 -.-&gt; ar
    L2 -.-&gt; ar
    %% ar -.-&gt; bc
    %% bc -.-&gt; 
    %%bc -.-&gt; G1
    %%bc -.-&gt; G2
    %%G0 -.-&gt; ar
    %%G1 -.-&gt; ar
    %%G2 -.-&gt; ar
    %%G0 &lt;-.- bc
    %%bc -.-&gt; G0
    %%bc -.-&gt; G1
    %%bc -.-&gt; G2
    %%G2 -.-&gt; ar
    %%X1 --&gt;|"`x‚ÇÄ W‚ÇÄ &lt;br&gt;+ x‚ÇÅ W‚ÇÅ`"|X2

classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class AR block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üßú‚Äç‚ôÄÔ∏è {Mermaid}},
  date = {2025-06-02},
  url = {https://samforeman.me/posts/2025/06/02/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüßú‚Äç‚ôÄÔ∏è Mermaid.‚Äù</span> June 2, 2025. <a href="https://samforeman.me/posts/2025/06/02/">https://samforeman.me/posts/2025/06/02/</a>.
</div></div></section></div> ]]></description>
  <category>style</category>
  <category>personal</category>
  <guid>https://samforeman.me/posts/2025/06/02/</guid>
  <pubDate>Mon, 02 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üì∞ Nice Headings</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/01/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>I like headings. They help organize content and make it easier to read.</p>
<p>Inspired by my neovim config, I wanted to recreate a similar style for headings in my website.</p>
<div id="fig-headings-neovim" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-headings-neovim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-headings-neovim" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-light-theme" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-light-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../../assets/nvim-headings-light.png" class="lightbox" data-gallery="fig-headings-neovim" title="Figure&nbsp;1&nbsp;(a): Light Theme"><img src="https://samforeman.me/assets/nvim-headings-light.png" class="img-fluid figure-img" data-ref-parent="fig-headings-neovim"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-light-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Light Theme
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-headings-neovim" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-dark-theme" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-dark-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../../assets/nvim-headings-dark.png" class="lightbox" data-gallery="fig-headings-neovim" title="Figure&nbsp;1&nbsp;(b): Dark Theme"><img src="https://samforeman.me/assets/nvim-headings-dark.png" class="img-fluid figure-img" data-ref-parent="fig-headings-neovim"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-dark-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Dark Theme
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-headings-neovim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: My neovim headings in light and dark themes.
</figcaption>
</figure>
</div>
<p>I think they turned out pretty well!</p>
<section id="heading-1" class="level1">
<h1>Heading 1</h1>
<section id="heading-2" class="level2">
<h2 class="anchored" data-anchor-id="heading-2">Heading 2</h2>
<section id="heading-3" class="level3">
<h3 class="anchored" data-anchor-id="heading-3">Heading 3</h3>
<section id="heading-4" class="level4">
<h4 class="anchored" data-anchor-id="heading-4">Heading 4</h4>
<section id="heading-5" class="level5">
<h5 class="anchored" data-anchor-id="heading-5">Heading 5</h5>
<section id="heading-6" class="level6">
<h6 class="anchored" data-anchor-id="heading-6">Heading 6</h6>



</section>
</section>
</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üì∞ {Nice} {Headings}},
  date = {2025-06-01},
  url = {https://samforeman.me/posts/2025/06/01/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüì∞ Nice Headings.‚Äù</span> June 1, 2025. <a href="https://samforeman.me/posts/2025/06/01/">https://samforeman.me/posts/2025/06/01/</a>.
</div></div></section></div> ]]></description>
  <category>style</category>
  <category>personal</category>
  <guid>https://samforeman.me/posts/2025/06/01/</guid>
  <pubDate>Sun, 01 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>06</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div id="listing-listing-posts" class="quarto-listing quarto-listing-container-table">
<table class="quarto-listing-table table table-striped table-hover">
<thead>
<tr>

<th>
What
</th>

<th>
When
</th>

</tr>
</thead>
<tbody class="list">

<tr data-index="0" data-categories="cHl0b3JjaCUyQ0F1cm9yYQ==" data-listing-date-sort="1749877200000" data-listing-file-modified-sort="1750262052930" data-listing-date-modified-sort="1750262052000" data-listing-reading-time-sort="7" data-listing-word-count-sort="1301" data-listing-title-sort="üèóÔ∏è Building PyTorch 2.8 from Source on Aurora" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../../posts/2025/06/14/index.html" class="title listing-title">üèóÔ∏è Building PyTorch 2.8 from Source on Aurora</a>
</td>
<td>
<span class="listing-date">2025-06-14</span>
</td>

</tr>

<tr data-index="1" data-categories="c3R5bGUlMkNwZXJzb25hbA==" data-listing-date-sort="1748840400000" data-listing-file-modified-sort="1748927917548" data-listing-date-modified-sort="1748927917000" data-listing-reading-time-sort="3" data-listing-word-count-sort="444" data-listing-title-sort="üßú‚Äç‚ôÄÔ∏è Mermaid" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../../posts/2025/06/02/index.html" class="title listing-title">üßú‚Äç‚ôÄÔ∏è Mermaid</a>
</td>
<td>
<span class="listing-date">2025-06-02</span>
</td>

</tr>

<tr data-index="2" data-categories="c3R5bGUlMkNwZXJzb25hbA==" data-listing-date-sort="1748754000000" data-listing-file-modified-sort="1748808239601" data-listing-date-modified-sort="1748808239000" data-listing-reading-time-sort="1" data-listing-word-count-sort="54" data-listing-title-sort="üì∞ Nice Headings" data-listing-filename-sort="index.qmd" onclick="href = this.querySelector('a').getAttribute('href');
 if (href) { window.location=href ; return false; }">
<td>
<a href="../../../posts/2025/06/01/index.html" class="title listing-title">üì∞ Nice Headings</a>
</td>
<td>
<span class="listing-date">2025-06-01</span>
</td>

</tr>

</tbody>
</table>
<div class="listing-no-matching d-none">No matching items</div>
</div>





<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {06},
  date = {2025-06-01},
  url = {https://samforeman.me/posts/2025/06/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äú06.‚Äù</span> June 1, 2025. <a href="https://samforeman.me/posts/2025/06/">https://samforeman.me/posts/2025/06/</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/posts/2025/06/</guid>
  <pubDate>Sun, 01 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>LLMs on Aurora: Overview</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="alcf-incite-hackathon-2025" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="alcf-incite-hackathon-2025">ALCF Incite Hackathon 2025</h2>
<ul>
<li><a href="https://www.alcf.anl.gov/events/alcf-incite-gpu-hackathon">2025 ALCF INCITE GPU Hackathon (20-May 22, 2025)</a></li>
<li>LLMs on Aurora<sup>1</sup>:
<ul>
<li><a href="https://samforeman.me/talks/incite-hackathon-2025/ezpz/slides">üçã Hands-On: ezpz</a></li>
<li><a href="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT">üåå Overview: AuroraGPT</a></li>
</ul></li>
</ul>
</section>
<section id="auroragpt-goals" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="auroragpt-goals">üéØ AuroraGPT: Goals</h2>
<div class="flex-container" style="justify-content: space-around;">
<div class="column" style="width: 55%">
<div class="blue-card">
<p><a href="https://auroragpt.anl.gov"><strong>AuroraGPT</strong></a>: <em>General purpose scientific LLM</em><br>
Broadly trained on a general corpora plus scientific<br>
{papers, texts, data}</p>
</div>
<ul>
<li><strong>Explore pathways</strong> towards a ‚ÄúScientific Assistant‚Äù model</li>
<li><strong>Build with international partners</strong> (RIKEN, BSC, others)</li>
<li><strong>Multilingual</strong> English, Êó•Êú¨Ë™û, French, German, Spanish</li>
<li><strong>Multimodal</strong>: images, tables, equations, proofs, time series, graphs, fields, sequences, etc</li>
</ul>
</div>
<div class="column" style="text-align: center;">
<div id="fig-awesome-llm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Image from  Hannibal046 / Awesome-LLM"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/llms.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Image from <iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/Hannibal046/Awesome-LLM">Hannibal046 / <code>Awesome-LLM</code></a>
</figcaption>
</figure>
</div>
</div>
</div>
<div id="fig-timeline" class="quarto-float quarto-figure quarto-figure-center anchored" style="margin-left:auto;margin-right:auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/timelines.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Credit to the entire AuroraGPT team for slides."><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/timelines.png" class="img-fluid figure-img" style="margin-left:auto;margin-right:auto;;width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Credit to the entire AuroraGPT team for slides.
</figcaption>
</figure>
</div>
<div class="notes">
<ul>
<li>Here to talk about AuroraGPT, Argonne‚Äôs internal effort to build a general purpose scientific LLM, broadly trained on a general corpora of text + scientific {papers, text, data}</li>
<li>As part of this effort, we plan to‚Ä¶
<ul>
<li>Explore pathways, build with international partners, multi-{lingual, modal}</li>
</ul></li>
<li>Rough timeline of the project and deliverables:
<ul>
<li>202{3,4}: text-only models, plan to release a series of {7B, 70B, 1T} models</li>
<li>202{4,5}: Basic multi-modal models</li>
<li>202{5,6}: Advanced scientific multimodal models</li>
</ul></li>
</ul>
</div>
</section>
<section id="issues-with-publicly-available-llms" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="issues-with-publicly-available-llms">ü¶ô Issues with ‚ÄúPublicly Available‚Äù LLMs</h2>
<ul>
<li><strong>Trust</strong> and <strong>Safety</strong>:
<ul>
<li>Skepticism about deployment in critical infrastructure</li>
<li>Correctness and reliability of model outputs</li>
</ul></li>
<li><strong>Transparency</strong>:
<ul>
<li>Data governance, <em>what was used for pre-training</em>? fine-tuning?
<ul>
<li><strong>generally unknown</strong></li>
</ul></li>
<li>What is <em>open source</em>?
<ul>
<li>Model weights?</li>
<li>Pre-training {code, logs, metrics} ?</li>
</ul></li>
</ul></li>
</ul>
<div class="notes">
<ul>
<li>Why are we doing this?</li>
<li>What is the issue with current LLMs?
<ul>
<li><strong>Trust and safety</strong>
<ul>
<li>Hallucinations, false confidence</li>
<li>Can this be reliably mitigated?</li>
<li>Scaling up inference compute seems to help
<ul>
<li>reasoning models, TTT, etc.</li>
</ul></li>
</ul></li>
<li><strong>Transparency</strong>
<ul>
<li>Different frontier labs have different definitions of ‚Äúopen source‚Äù</li>
<li>e.g.&nbsp;Llama no longer releases base models
<ul>
<li>Libgen ??</li>
</ul></li>
<li>AllenAI institute, olmo models good example</li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-open-science-foundation-model" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-open-science-foundation-model">üß™ AuroraGPT: Open Science Foundation Model</h2>
<div id="fig-aurora-gpt" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored" style="vertical-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/AuroraGPT.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: High-level overview of AuroraGPT project"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/AuroraGPT.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: High-level overview of AuroraGPT project
</figcaption>
</figure>
</div>
<div class="notes">
<ul>
<li>AuroraGPT will be a publicly distributed, open source foundation model for open science</li>
<li>Is being trained on:
<ul>
<li>Scientific / engineering structured data</li>
<li>General text, media, news, etc.</li>
<li>Large amounts of low to medium quality data</li>
<li>Much less high quality data (that is publicly available for use)</li>
</ul></li>
<li>This data is then cleaned, processed, de-duplicated and used for the initial pre-training phase of the model</li>
<li>The vast majority of the overall compute is spent during this initial pre-training phase
<ul>
<li>This is the group I help to lead and will be talking a bit about today</li>
</ul></li>
<li>The initial pre-training phase is currently underway
<ul>
<li>Eventually, given a bit of time, effort and magic, the model will be ready for fine-tuning and additional training for a variety of downstream tasks</li>
</ul></li>
<li>The pretrained model will then be handed off for additional fine-tuning on a variety of downstream tasks
<ul>
<li>Scientific discovery</li>
<li>Accelerate scientific tasks</li>
<li>Digital twins</li>
<li>Inverse design</li>
<li>Code optimization</li>
<li>Accelerated simulations</li>
<li>Autonomous experiments</li>
<li>Co-design</li>
</ul></li>
<li>Becoming increasingly clear that LLMs have the potential to drastically accelerate computational science
<ul>
<li>We‚Äôve seen this already for {GenSLMs, Weather / Climate / Earth Systems Modeling, Particle Physics, etc.}</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-outcomes" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-outcomes">üìä AuroraGPT: Outcomes</h2>
<ul>
<li><p><strong>Datasets and data pipelines</strong> for preparing science training data</p></li>
<li><p><strong>Software infrastructure and workflows</strong> to train, evaluate and deploy LLMs at scale for scientific resarch purposes</p>
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf/Megatron-DeepSpeed</a><br>
<span class="dim-text">End-to-end training and inference, on <em>any</em> GPU cluster</span></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/inference-endpoints">argonne-lcf/inference-endpoints</a><br>
<span class="dim-text">Inference endpoints for LLMs, hosted @ ALCF</span></li>
</ul></li>
<li><p><strong>Evaluation of state-of-the-art LLM Models</strong>:</p>
<ul>
<li>Determine where they fall short in deep scientific tasks</li>
<li>Where deep data may have an impact</li>
</ul></li>
</ul>
</section>
<section id="what-do-we-hope-to-get" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="what-do-we-hope-to-get">üìö What do we hope to get?</h2>
<ul>
<li><strong>Assessment of the approach</strong> of augmenting web training data with two forms of data specific to science:
<ul>
<li>Full text scientific papers</li>
<li>Structured scientific datasets (suitably mapped to narrative form)</li>
</ul></li>
<li><strong>Research grade artifacts</strong> (<strong>models</strong>) for scientific community for adaptation for downstream uses<sup>2</sup></li>
<li><strong>Promotion of responsible AI</strong> best practices where we can figure them out</li>
<li><strong>International Collaborations</strong> around the long term goal of <em>AGI for science</em></li>
</ul>
<div class="notes">
<ul>
<li>Deliverables:
<ul>
<li>datasets, pipelines</li>
<li>software infrastructure, workflows to interface with science applications</li>
<li>checkpoints, models, logs, workbook, insights, etc.</li>
</ul></li>
<li>Hope to understand:
<ul>
<li>How different state-of-the-art models perform at different scientific tasks</li>
<li>where deep data may have an impact</li>
<li>feasibility of generically augmenting text with scientific structured data</li>
</ul></li>
<li>Huge undertaking that will require large international collaborations around long term goal of AGI for science</li>
<li>Extra points:
<ul>
<li>Well known that LLMs are good for non-consequential tasks</li>
<li>Known to ‚Äúhallucinate‚Äù and create false information</li>
<li>Can this be mitigated reliably ??</li>
</ul></li>
</ul>
</div>
</section>
<section id="aurora" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="aurora">üåå Aurora</h2>
<div class="flex-container" style="align-items: center;">
<div class="column" style="width:5%;">
<div id="tbl-aurora" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Aurora Specs
</figcaption>
<div aria-describedby="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Racks</td>
<td style="text-align: left;">166</td>
</tr>
<tr class="even">
<td style="text-align: right;">Nodes</td>
<td style="text-align: left;">10,624</td>
</tr>
<tr class="odd">
<td style="text-align: right;">CPUs</td>
<td style="text-align: left;">21,248</td>
</tr>
<tr class="even">
<td style="text-align: right;">GPUs</td>
<td style="text-align: left;">63,744</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NICs</td>
<td style="text-align: left;">84,992</td>
</tr>
<tr class="even">
<td style="text-align: right;">HBM</td>
<td style="text-align: left;">8 PB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">DDR5c</td>
<td style="text-align: left;">10 PB</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="column" style="text-align:center">
<div id="fig-aurora" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/aurora.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Aurora: Fact Sheet."><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/aurora.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Aurora: <a href="https://www.alcf.anl.gov/sites/default/files/2024-07/Aurora_FactSheet_2024.pdf">Fact Sheet</a>.
</figcaption>
</figure>
</div>
<p>üèÜ <a href="https://www.intel.com/content/www/us/en/newsroom/news/intel-powered-aurora-supercomputer-breaks-exascale-barrier.html">Fastest AI system in the world</a></p>
</div>
</div>
</section>
<section id="alcf-ai-testbed" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="alcf-ai-testbed">ü§ñ ALCF AI Testbed</h2>
<ul>
<li>ALCF AI Testbed Systems are in production and <a href="https://accounts.alcf.anl.gov/#/allocationRequests">available for allocations</a> to the research community</li>
<li>Significant improvement in time-to-solution and energy-efficiency for diverse AI for science applications.</li>
<li><a href="https://nairrpilot.org/">NAIRR Pilot</a></li>
</ul>
<div class="red-card" style="color: #FF5252; font-size:90%;">
<p>Up to <img src="https://latex.codecogs.com/png.latex?%E2%89%88"> <strong>25</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> throughput improvement for genomic FMs with <strong>6.5</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> energy efficiency</p>
</div>
<div class="flex-container" style="align-items: flex-start; gap: 2pt; text-align:left;">
<div id="fig-sambanova" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align: left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/sambanova.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: SambaNova SN-30 2nd Gen, 8 nodes with 64 AI Accelerators"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/sambanova.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: <strong>SambaNova SN-30</strong> 2nd Gen, 8 nodes with 64 AI Accelerators
</figcaption>
</figure>
</div>
<div id="fig-graphcore" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/graphcore.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Graphcore Bow: Pod-64 configuration with 64 accelerators"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/graphcore.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>Graphcore Bow</strong>: Pod-64 configuration with 64 accelerators
</figcaption>
</figure>
</div>
<div id="fig-cerebras" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/cerebras.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Cerebras: 2x CS-2 WSE with Memory-X and Swarm-X technologies"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/cerebras.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: <strong>Cerebras</strong>: 2x CS-2 WSE with Memory-X and Swarm-X technologies
</figcaption>
</figure>
</div>
<div id="fig-groq" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/groq.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: GroqRack: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/groq.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: <strong>GroqRack</strong>: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node
</figcaption>
</figure>
</div>
</div>
</section>
<section id="team-leads" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="team-leads">üë• Team Leads</h2>
<div style="font-size: 90%;">
<div class="flex-container" style="text-align: center; align-items: center;">
<p><strong>Planning</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rick-stevens.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rick Stevens"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/rick-stevens.png" style="height:1.04167in" alt="Rick Stevens" class="figure-img"></a></p>
<figcaption>Rick Stevens<sup>3</sup></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Ian Foster"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rinku-gupta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rinku Gupta"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/rinku-gupta.png" style="height:1.04167in" alt="Rinku Gupta" class="figure-img"></a></p>
<figcaption>Rinku Gupta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/mike-papka.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Mike Papka"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/mike-papka.png" style="height:1.04167in" alt="Mike Papka" class="figure-img"></a></p>
<figcaption>Mike Papka</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/arvind-ramanathan.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Arvind Ramanathan"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/arvind-ramanathan.png" style="height:1.04167in" alt="Arvind Ramanathan" class="figure-img"></a></p>
<figcaption>Arvind Ramanathan</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/fangfang-xia.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Fangfang Xia"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/fangfang-xia.png" style="height:1.04167in" alt="Fangfang Xia" class="figure-img"></a></p>
<figcaption>Fangfang Xia</figcaption>
</figure>
</div>
</div>
<div class="flex-container" style="text-align: center;">
<div class="col">
<p><strong>Data</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Ian Foster"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/robert-underwood.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Robert Underwood"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/robert-underwood.png" style="height:1.04167in" alt="Robert Underwood" class="figure-img"></a></p>
<figcaption>Robert Underwood</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Training</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/venkat-vishwanath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Venkat Vishwanath"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/venkat-vishwanath.png" style="height:1.04167in" alt="Venkat Vishwanath" class="figure-img"></a></p>
<figcaption>Venkat Vishwanath</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sam-foreman.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Sam Foreman"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/sam-foreman.png" style="height:1.04167in" alt="Sam Foreman" class="figure-img"></a></p>
<figcaption><span style="color: #ff1a8f; background-color: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); font-weight: 500;">Sam Foreman</span></figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Evaluation</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/franck-cappello.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Franck Cappello"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/franck-cappello.png" style="height:1.04167in" alt="Franck Cappello" class="figure-img"></a></p>
<figcaption>Franck Cappello</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sandeep-madireddy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Sandeep Madireddy"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/sandeep-madireddy.png" style="height:1.04167in" alt="Sandeep Madireddy" class="figure-img"></a></p>
<figcaption>Sandeep Madireddy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/bo-li.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Bo Li"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/bo-li.png" style="height:1.04167in" alt="Bo Li" class="figure-img"></a></p>
<figcaption>Bo Li</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Post</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/eliu-huerta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Eliu Huerta"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/eliu-huerta.png" style="height:1.04167in" alt="Eliu Huerta" class="figure-img"></a></p>
<figcaption>Eliu Huerta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/azton-wells.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Azton Wells"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/azton-wells.png" style="height:1.04167in" alt="Azton Wells" class="figure-img"></a></p>
<figcaption>Azton Wells</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Inference</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rajeev-thakur.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Rajeev Thakur"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/rajeev-thakur.png" style="height:1.04167in" alt="Rajeev Thakur" class="figure-img"></a></p>
<figcaption>Rajeev Thakur</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Comms</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/charlie-catlett.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Charlie Catlett"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/charlie-catlett.png" style="height:1.04167in" alt="Charlie Catlett" class="figure-img"></a></p>
<figcaption>Charlie Catlett</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/david-martin.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="David Martin"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/david-martin.png" style="height:1.04167in" alt="David Martin" class="figure-img"></a></p>
<figcaption>David Martin</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Distribution</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/brad-ullrich.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Brad Ullrich"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/team/brad-ullrich.png" style="height:1.04167in" alt="Brad Ullrich" class="figure-img"></a></p>
<figcaption>Brad Ullrich</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="teams" class="level2" data-auto-animate="true" data-background-color="white">
<h2 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="teams">ü§ù Teams</h2>
<div class="flex-container">
<div class="column">
<ul>
<li><strong>Planning</strong></li>
<li><strong>Data Prep</strong>
<ul>
<li>Accumulate 20+ T tokens of high-quality scientific text and structured data</li>
</ul></li>
<li><span style="background: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); border: 1px solid #ff1a8f; border-radius: 0.25px;"><strong>Models / Training</strong></span><sup>4</sup>
<ul>
<li>Train (entirely from scratch) a series of models on publicly available data</li>
</ul></li>
<li><strong>Evaluation</strong>
<ul>
<li>Skills, trustworthiness, safety, robustness, privacy, machine ethics</li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li><strong>Post-Training</strong>
<ul>
<li>Fine-tuning, alignment</li>
</ul></li>
<li><strong>Inference</strong>
<ul>
<li>Model serving, API development / public-facing web services</li>
</ul></li>
<li><strong>Distribution</strong>
<ul>
<li>Licensing, generating and distributing artifacts for public consumption</li>
</ul></li>
<li><strong>Communication</strong></li>
</ul>
</div>
</div>
</section>
<section id="data" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="data">üìö Data</h2>
<div class="green-card">
<p>‚úÖ <strong>Goal</strong>: Assemble a large corpus of documents (general and scientific) to train and fine-tune AuroraGPT models</p>
</div>
<ul>
<li><strong>Challenges</strong>: Avoid / detect contamination with benchmarks
<ul>
<li>Respect copyright (ACM Digital Library), privacy, and ethical considerations</li>
</ul></li>
<li><strong>Performance Challenges</strong>: <em>High throughput</em> data processing
<ul>
<li>Converting PDF <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> text (math formula, figures)</li>
<li>Convert science information (data) into text (narratives)</li>
<li>De-duplication (syntactic and semantic) of scientific documents (to avoid memorization, bias)</li>
</ul></li>
<li><strong>Quantity</strong>: Considering 20+ Trillion tokens <img src="https://latex.codecogs.com/png.latex?%5Crightarrow%5Capprox"> 100M papers</li>
<li><strong>Domains</strong>: All (long-term) scientific domains, starting with:
<ul>
<li>Material science, Physics, Biology, Computer Science, Climate Science</li>
</ul></li>
</ul>
</section>
<section id="dataset-processing" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="dataset-processing">‚è±Ô∏è Dataset Processing</h2>
<ul>
<li>To train a fixed model on trillions of tokens requires:
<ol type="1">
<li><strong>Aggregating</strong> data from multiple different <em>corpora</em><br>
(e.g.&nbsp;ArXiv, Reddit, StackExchange, GitHub, Wikipedia, etc.)</li>
<li><strong>Sampling</strong> <em>each training batch</em> according to a fixed distribution across corpora</li>
<li><strong>Building</strong> indices that map batches of tokens into these files (indexing)</li>
</ol>
<div class="red-card">
<p>The original implementation was <em>slow</em>:</p>
<ul>
<li>Designed to run <em>serially</em> on a <strong>single device</strong></li>
<li><strong>Major bottleneck</strong> when debugging data pipeline at scale</li>
</ul>
</div></li>
</ul>
</section>
<section id="accelerating-dataset-processing-results" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-results">üöÄ Accelerating Dataset Processing: Results</h2>
<div class="flex-container" style="padding: 10pt; justify-content: space-around; align-items: flex-start;">
<div class="column" style="width:25%;">
<ul>
<li>Original implementation:
<ul>
<li><strong>Slow</strong>!</li>
<li><span class="dim-text">üêå ~ 1 hr</span>/2T tokens</li>
</ul></li>
<li><label><input type="checkbox" checked="">Fix:</label>
<ul>
<li>Wrote <em>asynchronous</em>, <strong>distributed</strong> implementation</li>
<li><em>significantly</em> improves performance (<strong>30x</strong> !!)</li>
<li>üèéÔ∏èüí® <span style="color:#2296F3;">~ <strong>2 min</strong></span>/2T tokens</li>
</ul></li>
</ul>
</div>
<div class="column">
<div id="fig-data-processing" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-processing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/data-processing.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;9: Time spent preparing 2T tokens"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/data-processing.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-processing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Time spent preparing 2T tokens
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-training" class="level2 smaller page-columns page-full" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="model-training">ü¶ú Model Training</h2>
<div class="flex-container" style="text-align: left; width: 100%; justify-content: space-around; line-height: 1em; gap: 5pt;">
<div class="column green-card" style="margin:unset;">
<p>‚úÖ <span style="color: var(--green-fg);"><strong>Goals</strong></span></p>
<ul>
<li>Want training runs at scale to be:
<ul>
<li>efficient</li>
<li>stable</li>
<li>reproducible</li>
</ul></li>
<li>This requires:
<ul>
<li>robust data pipelines / file IO</li>
<li>effectively overlapping compute with communication</li>
<li>stability across {network, filesystem, machine}</li>
</ul></li>
<li>3D / Multi-dimensional Parallelism strategies</li>
<li>Large batch training</li>
<li>Second order optimizers</li>
<li>Sub-quadratic attention</li>
<li>State space models</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
<div class="column red-card">
<p>‚ùå <span style="color: var(--quarto-scss-export-re);"><strong>Challenges</strong></span></p>
<ul>
<li><em>Looong time</em> to train, can be:
<ul>
<li>weeks (even months) of continuous training</li>
<li>order of magnitude longer than typical NN training jobs</li>
</ul></li>
<li>Stability issues:
<ul>
<li>failures are expensive (but inevitable)</li>
<li>stragglers common at scale</li>
</ul></li>
<li>Individual jobs are:
<ul>
<li><strong>fragile</strong></li>
<li>only as good as the worst rank</li>
<li>one hang or bad worker can crash job</li>
<li>network / filesystem / other-user(s) dependent</li>
</ul></li>
<li>Cost / benefits of different collective communication algorithms
<ul>
<li>depend on optimized / efficient implementations</li>
</ul></li>
<li>Network performance</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / Megatron-DeepSpeed</a></p>
</div></div></section>
<section id="loss-curve-training-auroragpt-7b-on-2t-tokens" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="loss-curve-training-auroragpt-7b-on-2t-tokens">üìâ Loss Curve: Training AuroraGPT-7B on 2T Tokens</h2>
<div id="fig-loss-curve" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-loss-curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/train-val-loss-vs-tokens-wide.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;10: Loss curve during training on 2T tokens."><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/train-val-loss-vs-tokens-wide.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-loss-curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Loss curve during training on 2T tokens.
</figcaption>
</figure>
</div>
</section>
<section id="evaluating-fm-skills-for-science" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="evaluating-fm-skills-for-science">ü§î Evaluating FM Skills for Science</h2>
<ul>
<li>What to measure?
<ul>
<li><strong>Knowledge Extraction, Retrieval, Distillation, Synthesis</strong>: LLM is provided a question or instruction and a truthful answer is expected</li>
<li><strong>Text Grounded</strong>: Answers are expected to be fully grounded on peer-reviewed references to support responses</li>
<li><strong>Reasoning</strong>: LLMs are expected to solve deductive (prove a theory or hypothesis from formal logic and observations), inductive (validate / explain observations from theories) problems</li>
<li><strong>Creativity</strong>: A creative answer is expected from a question or instruction
<ul>
<li>thoughtful dialogue, coding, etc.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="evaluating-fm-skills-for-science-criteria" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="evaluating-fm-skills-for-science-criteria">‚öñÔ∏è Evaluating FM Skills for Science: Criteria</h2>
<ul>
<li>Criteria for all of the above:
<ul>
<li><strong>Correctness</strong> of facts</li>
<li><strong>Accuracy</strong> of solutions and inferences</li>
<li><strong>Reliability</strong> consistently good in quality or performance</li>
<li><strong>Speed</strong> how fast to produce a response</li>
<li><strong># shots</strong> how many examples are needed for good quality
<ul>
<li>Extent of <em>prompt engineering</em></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="mprot-dpo-scaling-results" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="mprot-dpo-scaling-results">üß¨ MProt-DPO: Scaling Results</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="flex-container" style="align-items: center; text-align: center; margin-left: auto; margin-right: auto;">
<div id="fig-mprot-3p5B-scaling0" class="quarto-float quarto-figure quarto-figure-center anchored" style="margin:0; padding-unset;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-3p5B-scaling0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-3p5B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;11: Scaling results for 3.5B model across ~38,400 GPUs"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/mprot-3p5B-scaling-2.svg" class="img-fluid figure-img" style="margin:0; padding-unset;;width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-3p5B-scaling0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Scaling results for <code>3.5B</code> model across ~38,400 GPUs
</figcaption>
</figure>
</div>
</div>
</div><div class="column" style="width:30%;">
<ul>
<li><p>~ <span class="highlight-blue">4 EFLOPS</span> @ Aurora</p></li>
<li><p>38,400 XPUs<br>
= 3200 [node] x 12 [XPU / node]</p></li>
<li><p>üîî Gordon Bell Finalist<sup>5</sup>:</p>
<ul>
<li><a href="https://dl.acm.org/doi/10.1109/SC41406.2024.00013">MProt-DPO: Breaking the ExaFLOPS Barrier for Multimodal Protein Design Workflows</a></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="references" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="references">üìì References</h2>
<div class="flex-container" style="gap: 2pt;">
<div class="column">
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / <code>Megatron-DeepSpeed</code></a><br>
<span class="dim-text">For the largest of large language models.</span></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2 / <code>ezpz</code></a><br>
<span class="dim-text">Distributed training, ezpz. üçã</span></li>
<li>üìä See my other slides at <a href="https://samforeman.me/talks">samforeman.me/talks</a>:
<ul>
<li><a href="https://saforem2.github.io/llm-workshop-talk">LLMs from Scratch</a></li>
<li><a href="https://saforem2.github.io/LLM-tutorial">Creating Small(~ish) LLMs</a></li>
<li><a href="https://saforem2.github.io/parallel-training-slides">Parallel Training Techniques</a></li>
<li><a href="https://samforeman.me/talks/llms-on-polaris/#/title-slide">LLMs on Polaris</a></li>
<li><a href="https://samforeman.me/talks/llms-at-scale/">Training LLMs at Scale</a></li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li>üëÄ See also:
<ul>
<li><a href="https://www.anl.gov/article/new-international-consortium-formed-to-create-trustworthy-and-reliable-generative-ai-models-for">New international consortium for generative AI models for science</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/dist_overview.html">PyTorch Distributed Overview</a></li>
<li><a href="https://huggingface.co/docs/transformers/en/perf_train_gpu_many">ü§ó Efficient Training on Multiple GPUs</a></li>
<li><a href="https://www.deepspeed.ai/getting-started/">Getting Started - DeepSpeed</a></li>
<li>üï∏Ô∏è <a href="https://openreview.net/forum?id=8bjspmAMBk">Quality Measures for Dynamic Graph Generative Models</a><br>
<span class="citation" data-cites="hosseini2025quality">(Hosseini et al. 2025)</span></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="thank-you" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h2>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:///foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üôè Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üôè Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</div>
</div>
</div>
</section>
<section id="bibliography" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="bibliography">üìë Bibliography</h2>
<ul>
<li>Refs:
<ul>
<li><span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span></li>
<li>Animations from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></li>
</ul></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-mprot-dpo2024" class="csl-entry">
Dharuman, Gautham, Kyle Hippe, Alexander Brace, Sam Foreman, V√§in√∂ Hatanp√§√§, Varuni K. Sastry, Huihuo Zheng, et al. 2024. <span>‚ÄúMProt-DPO: Breaking the ExaFLOPS Barrier for Multimodal Protein Design Workflows with Direct Preference Optimization.‚Äù</span> In <em>Proceedings of the International Conference for High Performance Computing, Networking, Storage, and Analysis</em>. SC ‚Äô24. Atlanta, GA, USA: IEEE Press. <a href="https://doi.org/10.1109/SC41406.2024.00013">https://doi.org/10.1109/SC41406.2024.00013</a>.
</div>
<div id="ref-hosseini2025quality" class="csl-entry">
Hosseini, Ryien, Filippo Simini, Venkatram Vishwanath, Rebecca Willett, and Henry Hoffmann. 2025. <span>‚ÄúQuality Measures for Dynamic Graph Generative Models.‚Äù</span> In <em>The Thirteenth International Conference on Learning Representations</em>. <a href="https://openreview.net/forum?id=8bjspmAMBk">https://openreview.net/forum?id=8bjspmAMBk</a>.
</div>
<div id="ref-song2023ds4sci" class="csl-entry">
Song, Shuaiwen Leon, Bonnie Kruft, Minjia Zhang, Conglong Li, Shiyang Chen, Chengming Zhang, Masahiro Tanaka, et al. 2023. <span>‚ÄúDeepSpeed4Science Initiative: Enabling Large-Scale Scientific Discovery Through Sophisticated AI System Technologies.‚Äù</span> <a href="https://arxiv.org/abs/2310.04610">https://arxiv.org/abs/2310.04610</a>.
</div>
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yang2023harnessing" class="csl-entry">
Yang, Jingfeng, Hongye Jin, Ruixiang Tang, Xiaotian Han, Qizhang Feng, Haoming Jiang, Bing Yin, and Xia Hu. 2023. <span>‚ÄúHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond.‚Äù</span> <a href="https://arxiv.org/abs/2304.13712">https://arxiv.org/abs/2304.13712</a>.
</div>
</div>
</section>
<section id="mprot-dpo-scaling-results-1" class="level2 smaller" data-background-color="#1c1c1c">
<h2 class="smaller anchored" data-background-color="#1c1c1c" data-anchor-id="mprot-dpo-scaling-results-1">üß¨ MProt-DPO: Scaling Results</h2>
<div class="columns">
<div id="fig-mprot-3p5B-scaling" class="column quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-3p5B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-3p5B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;12: 3.5B model"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/mprot-3p5B-scaling-2.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-3p5B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: <code>3.5B</code> model
</figcaption>
</figure>
</div><div id="fig-mprot-7B-scaling" class="column quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-7B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-7B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Figure&nbsp;13: 7B model"><img src="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/mprot-7B-scaling-2.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-7B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: <code>7B</code> model
</figcaption>
</figure>
</div>
</div>
</section>
<section id="loooooooooong-sequence-lengths" class="level2 smaller page-columns page-full" data-background-color="#1c1c1c">
<h2 class="smaller anchored" data-background-color="#1c1c1c" data-anchor-id="loooooooooong-sequence-lengths">üöÇ Loooooooooong Sequence Lengths</h2>
<div class="flex-container" style="align-items: center; justify-content: center;">
<p><a href="../../../assets/anl.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="https://samforeman.me/assets/anl.svg" class="img-fluid" style="height:50pt; margin: unset; padding: 0"></a></p>
<p><span class="dim-text" style="font-size: 2.0em;"><iconify-icon inline="" icon="ic:baseline-plus" aria-label="Icon baseline-plus from ic Iconify.design set." title="Icon baseline-plus from ic Iconify.design set."></iconify-icon></span></p>
<p><a href="../../../assets/deepspeed-logo-transparent.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="https://samforeman.me/assets/deepspeed-logo-transparent.svg" class="img-fluid" style="height:50pt; margin: unset; padding: 0;"></a></p>
</div>
<ul>
<li>Working with <a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-microsoft" aria-label="microsoft"></i> Microsoft/DeepSpeed</a> team to enable longer sequence lengths (context windows) for LLMs
<ul>
<li>See my <a href="https://samforeman.me/posts/auroragpt/long-sequences/">blog post</a> for additional details</li>
</ul></li>
</ul>
<div id="fig-long-seq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="flex-container">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="25B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="img-fluid figure-img"></a></p>
<figcaption>25B</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="33B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="img-fluid figure-img"></a></p>
<figcaption>33B</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Maximum (achievable) <code>SEQ_LEN</code> for both <code>25B</code> and <code>33B</code> models (See: <span class="citation" data-cites="song2023ds4sci">Song et al. (2023)</span>)
</figcaption>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><a href="https://github.com/saforem2/scaling4science"><i class="fa-brands fa-github" aria-label="github"></i> <code>scaling4science</code></a><br>
<a href="https://github.com/saforem2/Megatron-DS-Benchmarking"><i class="fa-brands fa-github" aria-label="github"></i> <code>Megatron-DS-Benchmarking</code></a></p>
</div></div></section>
<section id="life-cycle-of-the-llm" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">‚ôªÔ∏è Life Cycle of the LLM</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset" style="text-align:center">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">üìù Pre-training</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">üéÄ Fine-Tuning</a></li></ul>
<div class="tab-content" style="text-align:center">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div id="fig-pretraining" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;15: Pre-training: Virtually all of the compute used during pretraining phase"><img src="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: <strong>Pre-training</strong>: Virtually all of the compute used during pretraining phase
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div id="fig-fine-tuning" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Figure&nbsp;16: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-llms" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="training-llms">üçé Training LLMs</h2>
<div class="flex-container" style="align-items: flex-end;">
<div class="column" style="width:221pt;">
<div id="fig-it-hungers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;17: It‚Äôs hungry!"><img src="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: It‚Äôs hungry!
</figcaption>
</figure>
</div>
</div>
<div class="column" style="width:60%;">
<div id="fig-evolution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-40" title="Figure&nbsp;18: Visualization from @yang2023harnessing"><img src="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Visualization from <span class="citation" data-cites="yang2023harnessing">Yang et al. (2023)</span>
</figcaption>
</figure>
</div>
</div>
</div>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><em>my</em> talks can be found at: <a href="https://samforeman.me/talks/incite-hackathon-2025">https://samforeman.me/talks/incite-hackathon-2025</a>‚Ü©Ô∏é</p></li>
<li id="fn2"><p><span class="citation" data-cites="mprot-dpo2024">(Dharuman et al. 2024)</span>‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Lead‚Ü©Ô∏é</p></li>
<li id="fn4"><p>Co-led by: Venkat Vishwanath, <strong>Sam Foreman</strong>‚Ü©Ô∏é</p></li>
<li id="fn5"><p><span class="citation" data-cites="mprot-dpo2024">(Dharuman et al. 2024)</span>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2025,
  author = {Foreman, Sam},
  title = {LLMs on {Aurora:} {Overview}},
  date = {2025-05-21},
  url = {https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/slides.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúLLMs on Aurora: Overview.‚Äù</span> May 21. <a href="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/slides.html">https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/slides.html</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/</guid>
  <pubDate>Wed, 21 May 2025 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/incite-hackathon-2025/AuroraGPT/assets/thumbnail.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>LLMs on Aurora: Hands-On</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/incite-hackathon-2025/ezpz/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="currently" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="currently">üìç Currently</h2>
<div id="fig-pretraining-infrastructure" class="quarto-float quarto-figure quarto-figure-center anchored" style="width: 60%; margin: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretraining-infrastructure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/modern-pretraining.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Current state of LLM Pretraining. [Source]"><img src="https://samforeman.me/talks/incite-hackathon-2025/ezpz/assets/modern-pretraining.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretraining-infrastructure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Current state of LLM Pretraining. [<a href="https://x.com/Dorialexander/status/1918822518804132085">Source</a>]
</figcaption>
</figure>
</div>
</section>
<section id="llms-on-aurora" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="llms-on-aurora">üí¨ LLMs on Aurora</h2>
<ul>
<li>üçã <a href="https://github.com/saforem2/ezpz"><code>ezpz</code></a></li>
<li>ü§ó <a href="https://github.com/huggingface/transformers"><code>transformers</code></a></li>
<li>üèéÔ∏è <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>Megatron-DeepSpeed</code></a></li>
</ul>
</section>
<section id="ezpz" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="ezpz">üçã <code>ezpz</code></h2>
<blockquote class="blockquote">
<p>Write once, run anywhere</p>
</blockquote>
</section>
<section id="getting-started" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="getting-started">üê£ Getting Started</h2>
<ol type="1">
<li><p>Submit interactive job:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">qsub</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> select=2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> walltime=01:00:00 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> filesystems=home:flare <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> gpu_hack <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> gpu_hack_prio</span></code></pre></div></div></li>
<li><p>Source<sup>1</sup> the <a href="https://github.com/saforem2/ezpz/blob/main/bin/utils.sh"><code>ezpz/bin/utils.sh</code></a> script (using <code>curl</code> to download it<sup>2</sup>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div></div></li>
</ol>
</section>
<section id="shell-environment" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="shell-environment">üèñÔ∏è Shell Environment</h2>
<ol type="1">
<li><p>Setup environment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span></code></pre></div></div>
<ul>
<li><details closed="">
<summary>
Output:
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][W]</span> PBS_O_WORKDIR is not set! Setting it to current working directory</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][I]</span> Exporting PBS_O_WORKDIR=/lus/flare/projects/datascience/foremans/projects/saforem2/ezpz</span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][I]</span>  ===== Running Full Environment Setup =====</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">PYTHON</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> No conda_prefix OR virtual_env found in environment. Setting up conda...</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072645][I]</span> Setting up conda on aurora</span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span> List of active modules:</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Currently</span> Loaded Modules:</span>
<span id="cb4-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gcc-runtime/13.3.0-ghotoln</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">libiconv/1.17-jjpb4sl</span>         <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-pals/1.4.0</span></span>
<span id="cb4-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gmp/6.3.0-mtokfaw</span>          <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">libxml2/2.13.5</span>                     14<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-libpals/1.4.0</span></span>
<span id="cb4-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpfr/4.2.1-gkcdl5w</span>         <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hwloc/2.11.3-mpich-level-zero</span>      15<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pti-gpu/0.11.0</span></span>
<span id="cb4-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpc/1.3.1-rdrlvsl</span>          <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">yaksa/0.3-7ks5f26</span>             <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">frameworks/2025.0.0</span></span>
<span id="cb4-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gcc/13.3.0</span>                      11<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich/opt/develop-git.6037a7a</span></span>
<span id="cb4-16">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneapi/release/2025.0.5</span>         12<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">libfabric/1.22.0</span></span>
<span id="cb4-17"></span>
<span id="cb4-18">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Where:</span></span>
<span id="cb4-19">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">H:</span>  Hidden Module</span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up venv from conda=/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0...</span>
<span id="cb4-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Found conda at /opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0</span>
<span id="cb4-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> No VIRTUAL_ENV found in environment!</span>
<span id="cb4-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Looking for venv in VENV_DIR=./venvs/aurora_nre_models_frameworks-2025.0.0...</span>
<span id="cb4-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Activating existing venv in VENV_DIR=venvs/aurora_nre_models_frameworks-2025.0.0</span>
<span id="cb4-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using python from: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/python3</span>
<span id="cb4-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">JOB</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up job for foremans</span>
<span id="cb4-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Machine: aurora</span>
<span id="cb4-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Hostname: x4318c6s6b0n0</span>
<span id="cb4-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz_get_pbs_env</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> hostfile=/var/spool/pbs/aux/4671985.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb4-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072647][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> jobenv_file=/home/foremans/.pbsenv</span>
<span id="cb4-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">HOSTS</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> HOSTFILE=/var/spool/pbs/aux/4671985.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb4-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> NHOSTS=2</span>
<span id="cb4-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> HOSTS:</span>
<span id="cb4-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x4318c6s5b0n0.hostmgmt2318.cm.aurora.alcf.anl.gov</span>
<span id="cb4-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x4318c6s6b0n0.hostmgmt2318.cm.aurora.alcf.anl.gov</span>
<span id="cb4-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">DIST_INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> HOSTFILE=/var/spool/pbs/aux/4671985.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb4-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> NHOSTS=2</span>
<span id="cb4-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> NGPU_PER_HOST=12</span>
<span id="cb4-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> NGPUS=24</span>
<span id="cb4-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">LAUNCH</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To launch across all available GPUs, use: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch'</span></span>
<span id="cb4-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>     launch = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/4671985.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-vni</span></span>
<span id="cb4-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span>   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Run <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'which launch'</span> to ensure that the alias is set correctly</span>
<span id="cb4-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05-072648][I]</span> ===== Environment Setup Complete =====</span>
<span id="cb4-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:03s</span></code></pre></div></div></details></li>
</ul>
</li>
</ol>
<p>&nbsp;</p>
</section>
<section id="environment-setup-with-ezpz_setup_env" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="environment-setup-with-ezpz_setup_env">üîç Environment Setup with <code>ezpz_setup_env</code></h2>
<ul>
<li>Wrapper around <code>ezpz_setup_job</code> <code>&amp;&amp;</code> <code>ezpz_setup_python</code></li>
</ul>
<ol type="1">
<li><p><code>ezpz_setup_job</code>: Determine the specifics of our active (PBS, SLURM) job<sup>3</sup></p></li>
<li><p><code>ezpz_setup_python</code>:</p>
<ul>
<li><strong>if @ ALCF</strong>:
<ul>
<li>Load the appropriate modules and activate base <code>conda</code> env</li>
</ul></li>
<li><strong>else</strong>:
<ul>
<li>Look for an active <code>conda</code> environment
<ul>
<li>If found, use it to build a new virtual environment</li>
</ul></li>
</ul></li>
<li>Activate the newly created <code>venvs/$(basename ${CONDA_PREFIX})</code> environment</li>
</ul></li>
</ol>
</section>
<section id="working-with-job-schedulers" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="working-with-job-schedulers">‚è±Ô∏è Working with Job Scheduler(s)</h2>
<ul>
<li><code>ezpz</code> integrates directly with the ALCF job scheduler<sup>4</sup>
<ul>
<li>has mechanisms for getting information about our currently running jobs</li>
</ul></li>
<li>ü™Ñ <em>Automagically</em>:
<ul>
<li>Determine the specifics of our active (PBS, SLURM) job<br>
(e.g.&nbsp;<code>${NHOSTS}</code>, <code>${NGPU_PER_HOST}</code>, <code>${NGPUS}</code>, ‚Ä¶)</li>
<li>Load the appropriate modules<sup>5</sup></li>
<li>Create (or activate) a virtual environment <em>on top</em> of a base conda environment</li>
</ul></li>
</ul>
</section>
<section id="use-custom-node-lists" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="use-custom-node-lists">üîÑ Use Custom Node Lists</h2>
<ul>
<li><p>Experiment<sup>6</sup> with custom <code>hostfile</code>(s), e.g.:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. If no `hostfile` specified, find and use `$PBS_NODEFILE` </span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_job</span></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Grab a subset of nodes:</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 2 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PBS_NODEFILE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> nodefile-0-1</span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Pass custom `nodefile-0-1`:</span></span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_job</span> nodefile-0-1  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># will use `nodefile-0-1`</span></span></code></pre></div></div></li>
</ul>
</section>
<section id="python-environments" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="python-environments">üêç Python Environments</h2>
<ul>
<li><strong>ALWAYS</strong> work inside a virtual environment
<ul>
<li>best practice is to maintain separate virtual environments for:
<ul>
<li>each project you work on</li>
<li>different versions of a specific package you‚Äôre working with<br>
e.g you would want different envs for <code>torch==2.X</code> vs <code>torch==2.Y</code></li>
</ul></li>
<li><em>Mangled python environments are one of the most common issues faced by users</em></li>
</ul></li>
</ul>
</section>
<section id="install-ezpz" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="install-ezpz">üì¶ Install <code>ezpz</code></h2>
<ol type="1">
<li><p>Install<sup>7</sup>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz"</span></span></code></pre></div></div></li>
<li><p>Run distributed test:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-test</span></span></code></pre></div></div></li>
<li><p>Launch <em>any</em> python <em>from</em> python</p>
<ul>
<li><p>Launch a module:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.test_dist</span></code></pre></div></div></li>
<li><p>Launch a python string:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'import ezpz; ezpz.setup_torch()'"</span></span></code></pre></div></div></li>
</ul></li>
</ol>
</section>
<section id="how-to-modify-existing-code" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="how-to-modify-existing-code">‚ûï How to Modify Existing Code</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource diff number-lines code-with-copy"><code class="sourceCode diff"><span id="cb10-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+ import ezpz</span></span>
<span id="cb10-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+ _ = ezpz.setup_torch()</span></span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- model.to('cuda')</span></span>
<span id="cb10-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+ model.to(ezpz.get_torch_device_type())</span></span></code></pre></div></div>
</section>
<section id="features" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="features">‚ú® Features</h2>
<ul>
<li><p>Initializing PyTorch across multiple processes</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz</span>
<span id="cb11-2">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.setup_torch()</span>
<span id="cb11-3">rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_rank()</span>
<span id="cb11-4">world_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_world_size()</span>
<span id="cb11-5">local_rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_local_rank()</span></code></pre></div></div></li>
<li><p>Automatic device detection (<code>xpu</code>, <code>cuda</code>, <code>mps</code>, <code>cpu</code>, ‚Ä¶)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).to(ezpz.get_torch_device_type())</span></code></pre></div></div></li>
<li><p>Automatic (single-process) logging</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_logger(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span></code></pre></div></div></li>
<li><p>Distributed debugger:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb14-2">    buggy_code()</span>
<span id="cb14-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>:</span>
<span id="cb14-4">    ezpz.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">breakpoint</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div></div></li>
</ul>
</section>
<section id="experiment-tracking" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="experiment-tracking">üß™ Experiment Tracking</h2>
<div class="block-code">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz</span>
<span id="cb15-2">rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.setup_torch()</span>
<span id="cb15-3">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_logger(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -- [1.] --</span></span>
<span id="cb15-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb15-6">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.setup_wandb(</span>
<span id="cb15-7">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ezpz.examples.minimal"</span></span>
<span id="cb15-8">        )</span>
<span id="cb15-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>:</span>
<span id="cb15-10">        logger.exception(</span>
<span id="cb15-11">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to initialize wandb, continuing without it"</span></span>
<span id="cb15-12">        )</span>
<span id="cb15-13"></span>
<span id="cb15-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...build {model, optimizer}, etc...</span></span>
<span id="cb15-15"></span>
<span id="cb15-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(train_iters):</span>
<span id="cb15-17">    metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_step(...)</span>
<span id="cb15-18">    logger.info(                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -- [2.] --</span></span>
<span id="cb15-19">        history.update(metrics)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -- [3.] --</span></span>
<span id="cb15-20">    )</span>
<span id="cb15-21"></span>
<span id="cb15-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb15-23">    history.finalize()</span></code></pre></div></div>
<ol type="1">
<li>Initialize W&amp;B (if <code>WANDB_DISABLED</code> is not set)</li>
<li>Log summary of metrics to stdout</li>
<li>Update <code>history.history</code> with metrics<sup>8</sup></li>
</ol>
</div>
</section>
<section id="minimal-example" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="minimal-example">ü§è Minimal Example</h2>
<ul>
<li>See <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/examples/minimal.py"><code>ezpz/examples/minimal.py</code></a></li>
</ul>
<div class="block-code">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb16-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb16-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz</span>
<span id="cb16-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb16-5"></span>
<span id="cb16-6">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_logger(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span>
<span id="cb16-7"></span>
<span id="cb16-8"></span>
<span id="cb16-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Network(torch.nn.Module):</span>
<span id="cb16-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb16-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb16-12">        input_dim: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb16-13">        output_dim: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb16-14">        sizes: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb16-15">    ):</span>
<span id="cb16-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>(Network, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>).<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb16-17">        nh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> output_dim <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sizes <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> sizes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb16-18">        layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [torch.nn.Linear(input_dim, nh), torch.nn.ReLU()]</span>
<span id="cb16-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sizes <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sizes) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb16-20">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, size <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sizes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]):</span>
<span id="cb16-21">                layers.extend(</span>
<span id="cb16-22">                    [torch.nn.Linear(sizes[idx], size), torch.nn.ReLU()]</span>
<span id="cb16-23">                )</span>
<span id="cb16-24">            layers.append(torch.nn.Linear(sizes[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], output_dim))</span>
<span id="cb16-25">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.Sequential(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>layers)</span>
<span id="cb16-26"></span>
<span id="cb16-27">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x: torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb16-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers(x)</span>
<span id="cb16-29"></span>
<span id="cb16-30"></span>
<span id="cb16-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@ezpz.timeitlogit</span>(rank<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ezpz.get_rank())</span>
<span id="cb16-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> train(</span>
<span id="cb16-33">    model: torch.nn.Module, optimizer: torch.optim.Optimizer</span>
<span id="cb16-34">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> ezpz.History:</span>
<span id="cb16-35">    unwrapped_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb16-36">        model.module</span>
<span id="cb16-37">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(model, torch.nn.parallel.DistributedDataParallel)</span>
<span id="cb16-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> model</span>
<span id="cb16-39">    )</span>
<span id="cb16-40">    history <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.History()</span>
<span id="cb16-41">    device_type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_torch_device_type()</span>
<span id="cb16-42">    dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> unwrapped_model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].weight.dtype</span>
<span id="cb16-43">    bsize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BATCH_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>))</span>
<span id="cb16-44">    isize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> unwrapped_model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].in_features</span>
<span id="cb16-45">    warmup <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WARMUP_ITERS"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb16-46">    log_freq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LOG_FREQ"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb16-47">    model.train()</span>
<span id="cb16-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> step <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRAIN_ITERS"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>))):</span>
<span id="cb16-49">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.autocast(</span>
<span id="cb16-50">            device_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>device_type,</span>
<span id="cb16-51">            dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dtype,</span>
<span id="cb16-52">        ):</span>
<span id="cb16-53">            t0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb16-54">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand((bsize, isize), dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dtype).to(device_type)</span>
<span id="cb16-55">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x)</span>
<span id="cb16-56">            loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb16-57">            dtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:=</span> time.perf_counter()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0</span>
<span id="cb16-58">            loss.backward()</span>
<span id="cb16-59">            optimizer.step()</span>
<span id="cb16-60">            optimizer.zero_grad()</span>
<span id="cb16-61">            dtb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t1</span>
<span id="cb16-62">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> log_freq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> warmup:</span>
<span id="cb16-63">                logger.info(</span>
<span id="cb16-64">                    history.update(</span>
<span id="cb16-65">                        {</span>
<span id="cb16-66">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iter"</span>: step,</span>
<span id="cb16-67">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loss"</span>: loss.item(),</span>
<span id="cb16-68">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dt"</span>: dtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dtb,</span>
<span id="cb16-69">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dtf"</span>: dtf,</span>
<span id="cb16-70">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dtb"</span>: dtb,</span>
<span id="cb16-71">                        }</span>
<span id="cb16-72">                    )</span>
<span id="cb16-73">                )</span>
<span id="cb16-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> history</span>
<span id="cb16-75"></span>
<span id="cb16-76"></span>
<span id="cb16-77"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@ezpz.timeitlogit</span>(rank<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ezpz.get_rank())</span>
<span id="cb16-78"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> setup():</span>
<span id="cb16-79">    rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.setup_torch()</span>
<span id="cb16-80">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WANDB_DISABLED"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb16-81">        logger.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WANDB_DISABLED is set, not initializing wandb"</span>)</span>
<span id="cb16-82">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb16-83">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb16-84">            _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.setup_wandb(</span>
<span id="cb16-85">                project_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.environ.get(</span>
<span id="cb16-86">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PROJECT_NAME"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ezpz.examples.minimal"</span></span>
<span id="cb16-87">                )</span>
<span id="cb16-88">            )</span>
<span id="cb16-89">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>:</span>
<span id="cb16-90">            logger.exception(</span>
<span id="cb16-91">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to initialize wandb, continuing without it"</span></span>
<span id="cb16-92">            )</span>
<span id="cb16-93">    device_type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ezpz.get_torch_device_type()</span>
<span id="cb16-94">    model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Network(</span>
<span id="cb16-95">        input_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"INPUT_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>))),</span>
<span id="cb16-96">        output_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTPUT_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>)),</span>
<span id="cb16-97">        sizes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb16-98">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(x)</span>
<span id="cb16-99">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LAYER_SIZES"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1024,512,256,128"</span>).split(</span>
<span id="cb16-100">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span>
<span id="cb16-101">            )</span>
<span id="cb16-102">        ],</span>
<span id="cb16-103">    )</span>
<span id="cb16-104">    model.to(device_type)</span>
<span id="cb16-105">    model.to((os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DTYPE"</span>, torch.bfloat16)))</span>
<span id="cb16-106">    logger.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-107">    optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam(model.parameters())</span>
<span id="cb16-108">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ezpz.get_world_size() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb16-109">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.nn.parallel <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DistributedDataParallel <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> DDP</span>
<span id="cb16-110"></span>
<span id="cb16-111">        model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DDP(model, device_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[ezpz.get_local_rank()])</span>
<span id="cb16-112"></span>
<span id="cb16-113">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> model, optimizer</span>
<span id="cb16-114"></span>
<span id="cb16-115"></span>
<span id="cb16-116"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main():</span>
<span id="cb16-117">    model, optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup()</span>
<span id="cb16-118">    history <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train(model, optimizer)</span>
<span id="cb16-119">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ezpz.get_rank() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb16-120">        dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> history.finalize()</span>
<span id="cb16-121">        logger.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-122"></span>
<span id="cb16-123"></span>
<span id="cb16-124"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb16-125">    main()</span></code></pre></div></div>
</div>
</section>
<section id="running-the-minimal-example" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="running-the-minimal-example">üèÉ‚Äç‚ôÇÔ∏è Running the Minimal Example</h2>
<p>To run the previous example we:</p>
<ol type="1">
<li><p>Source the <code>ezpz</code> utils script:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Setup our environment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span></code></pre></div></div></li>
<li><p>Run the example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.examples.minimal</span></code></pre></div></div></li>
</ol>
<ol type="1">
<li><details closed="">
<summary>
Output:
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb20-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[/f/d/f/p/s/ezpz][üå± update-utils][üì¶üìùü§∑‚úì] [‚è±Ô∏è 5m23s]</span></span>
<span id="cb20-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/06/25 @ 09:06:04][x4000c2s6b0n0]</span></span>
<span id="cb20-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.examples.minimal</span>
<span id="cb20-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W506</span> 09:06:14.877537382 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb20-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb20-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb20-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb20-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb20-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:18,965] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:239:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Job ID: 4673761</span>
<span id="cb20-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:163</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Node file: /var/spool/pbs/aux/4673761.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb20-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:178</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Building command to execute by piecing together:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch_cmd'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'python'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cmd_to_launch'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:182</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch_cmd'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span> mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--np</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/var/spool/pbs/aux/4673761.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--depth</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8</span>
<span id="cb20-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:183</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'python'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span> /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/python3</span>
<span id="cb20-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:184</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cmd_to_launch'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.examples.minimal</span>
<span id="cb20-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:189</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Took: 0.43 seconds to build command.</span>
<span id="cb20-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:192</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Executing: mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--np</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/var/spool/pbs/aux/4673761.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--depth</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8 /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.examples.minimal</span>
<span id="cb20-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:119</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Filtering for Aurora-specific messages. To view list of filters, run with <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">EZPZ_LOG_LEVEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>DEBUG<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span></span>
<span id="cb20-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:199</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Execution started @ 2025-05-06-090621...</span>
<span id="cb20-23"></span>
<span id="cb20-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Disabling</span> local launch: multi-node application</span>
<span id="cb20-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x4000c2s6b0n0.hostmgmt2000.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb20-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application 9237e362-f53a-4401-8cab-78cc0b54ab87</span>
<span id="cb20-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:567</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using get_torch_device_type<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb20-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 4/23]</span>
<span id="cb20-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 8/23]</span>
<span id="cb20-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 9/23]</span>
<span id="cb20-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">10/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 5/23]</span>
<span id="cb20-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 1/23]</span>
<span id="cb20-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 2/23]</span>
<span id="cb20-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 3/23]</span>
<span id="cb20-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 6/23]</span>
<span id="cb20-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 7/23]</span>
<span id="cb20-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">12/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">13/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">16/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">14/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">21/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">20/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">22/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">19/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">18/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:947</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ddp'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb20-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:46]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4000c2s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 0/23]</span>
<span id="cb20-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:05:06-09:06:46:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19763</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOG_LEVEL changed to be error <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:warn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1217</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting up wandb from rank=0</span>
<span id="cb20-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1218</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using WB_PROJECT=ezpz.examples.minimal</span>
<span id="cb20-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Currently logged in as: foremans <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aurora_gpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> https://api.wandb.ai. Use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>wandb <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">login</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--relogin</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to force relogin</span>
<span id="cb20-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Tracking run with wandb version 0.19.10</span>
<span id="cb20-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run data is saved locally in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/wandb/run-20250506_090647-q9u196rq</span>
<span id="cb20-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> offline<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to turn off syncing.</span>
<span id="cb20-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Syncing run pretty-paper-29</span>
<span id="cb20-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ‚≠êÔ∏è View project at https://wandb.ai/aurora_gpt/ezpz.examples.minimal</span>
<span id="cb20-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run at https://wandb.ai/aurora_gpt/ezpz.examples.minimal/runs/q9u196rq</span>
<span id="cb20-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1246</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> wandb.run=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretty</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">paper</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">29</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/ezpz.examples.minimal/runs/q9u196rq</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1286</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Aurora'</span></span>
<span id="cb20-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:104:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> model=Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-66"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-67">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-68">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-69">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-70">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-71">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-72">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-73">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-74">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-75">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-76"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-77"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">setup</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> took: dt=13.7828s</span>
<span id="cb20-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=0 loss=2701.321045 dt=0.623345 dtf=0.381410 dtb=0.241935</span>
<span id="cb20-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=1 loss=2527.130371 dt=0.151625 dtf=0.002179 dtb=0.149447</span>
<span id="cb20-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=2 loss=2318.325195 dt=0.003961 dtf=0.000944 dtb=0.003016</span>
<span id="cb20-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=3 loss=1952.584473 dt=0.003688 dtf=0.000970 dtb=0.002718</span>
<span id="cb20-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=4 loss=1793.388062 dt=0.003742 dtf=0.001064 dtb=0.002677</span>
<span id="cb20-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=5 loss=1555.838867 dt=0.003606 dtf=0.000944 dtb=0.002662</span>
<span id="cb20-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=6 loss=1234.822510 dt=0.003723 dtf=0.000970 dtb=0.002753</span>
<span id="cb20-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=7 loss=1117.542969 dt=0.003695 dtf=0.000956 dtb=0.002739</span>
<span id="cb20-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=8 loss=1010.627075 dt=0.003899 dtf=0.000984 dtb=0.002915</span>
<span id="cb20-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=9 loss=907.192017 dt=0.003738 dtf=0.000963 dtb=0.002775</span>
<span id="cb20-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=10 loss=911.176147 dt=0.003876 dtf=0.000940 dtb=0.002936</span>
<span id="cb20-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=11 loss=826.104065 dt=0.003670 dtf=0.000904 dtb=0.002766</span>
<span id="cb20-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=12 loss=768.030396 dt=0.003839 dtf=0.000900 dtb=0.002940</span>
<span id="cb20-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=13 loss=754.958557 dt=0.003710 dtf=0.000906 dtb=0.002804</span>
<span id="cb20-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=14 loss=750.200745 dt=0.003722 dtf=0.000885 dtb=0.002837</span>
<span id="cb20-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=15 loss=727.392395 dt=0.003824 dtf=0.000897 dtb=0.002928</span>
<span id="cb20-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=16 loss=721.139099 dt=0.003677 dtf=0.000923 dtb=0.002754</span>
<span id="cb20-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=17 loss=715.588501 dt=0.003681 dtf=0.000923 dtb=0.002758</span>
<span id="cb20-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=18 loss=711.832520 dt=0.004013 dtf=0.000902 dtb=0.003110</span>
<span id="cb20-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=19 loss=712.932617 dt=0.003716 dtf=0.000922 dtb=0.002794</span>
<span id="cb20-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=20 loss=702.517212 dt=0.003796 dtf=0.000895 dtb=0.002901</span>
<span id="cb20-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=21 loss=698.924438 dt=0.003716 dtf=0.000901 dtb=0.002815</span>
<span id="cb20-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=22 loss=697.166931 dt=0.003972 dtf=0.001139 dtb=0.002832</span>
<span id="cb20-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=23 loss=706.649780 dt=0.003700 dtf=0.000909 dtb=0.002791</span>
<span id="cb20-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=24 loss=703.272400 dt=0.003783 dtf=0.000901 dtb=0.002882</span>
<span id="cb20-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=25 loss=709.477356 dt=0.003557 dtf=0.000896 dtb=0.002661</span>
<span id="cb20-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=26 loss=722.453125 dt=0.003578 dtf=0.000899 dtb=0.002679</span>
<span id="cb20-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=27 loss=708.771179 dt=0.003554 dtf=0.000886 dtb=0.002668</span>
<span id="cb20-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=28 loss=702.787598 dt=0.003620 dtf=0.000922 dtb=0.002698</span>
<span id="cb20-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=29 loss=688.691895 dt=0.003543 dtf=0.000890 dtb=0.002653</span>
<span id="cb20-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=30 loss=677.675781 dt=0.003570 dtf=0.000887 dtb=0.002683</span>
<span id="cb20-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=31 loss=705.331299 dt=0.003538 dtf=0.000896 dtb=0.002643</span>
<span id="cb20-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=32 loss=686.603394 dt=0.003586 dtf=0.000915 dtb=0.002671</span>
<span id="cb20-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=33 loss=686.867798 dt=0.003723 dtf=0.000902 dtb=0.002821</span>
<span id="cb20-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=34 loss=691.201904 dt=0.004015 dtf=0.000893 dtb=0.003122</span>
<span id="cb20-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=35 loss=689.949707 dt=0.003646 dtf=0.000904 dtb=0.002741</span>
<span id="cb20-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=36 loss=668.631348 dt=0.003907 dtf=0.000918 dtb=0.002989</span>
<span id="cb20-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=37 loss=684.760254 dt=0.003613 dtf=0.000895 dtb=0.002718</span>
<span id="cb20-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=38 loss=666.486328 dt=0.003729 dtf=0.000903 dtb=0.002826</span>
<span id="cb20-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=39 loss=680.438721 dt=0.003700 dtf=0.000890 dtb=0.002810</span>
<span id="cb20-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=40 loss=668.775513 dt=0.003776 dtf=0.000916 dtb=0.002860</span>
<span id="cb20-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=41 loss=673.034912 dt=0.003967 dtf=0.000952 dtb=0.003015</span>
<span id="cb20-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=42 loss=674.066772 dt=0.003890 dtf=0.000963 dtb=0.002927</span>
<span id="cb20-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=43 loss=673.859985 dt=0.003640 dtf=0.000909 dtb=0.002730</span>
<span id="cb20-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=44 loss=667.940552 dt=0.003580 dtf=0.000901 dtb=0.002679</span>
<span id="cb20-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=45 loss=678.843750 dt=0.003621 dtf=0.000913 dtb=0.002708</span>
<span id="cb20-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=46 loss=687.354187 dt=0.003796 dtf=0.000898 dtb=0.002898</span>
<span id="cb20-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=47 loss=685.980774 dt=0.003620 dtf=0.000911 dtb=0.002708</span>
<span id="cb20-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=48 loss=669.822632 dt=0.003582 dtf=0.000905 dtb=0.002677</span>
<span id="cb20-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=49 loss=681.426880 dt=0.003730 dtf=0.000945 dtb=0.002785</span>
<span id="cb20-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=50 loss=682.930542 dt=0.003701 dtf=0.000946 dtb=0.002756</span>
<span id="cb20-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=51 loss=676.441895 dt=0.003657 dtf=0.000931 dtb=0.002726</span>
<span id="cb20-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=52 loss=664.631531 dt=0.003676 dtf=0.000946 dtb=0.002730</span>
<span id="cb20-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=53 loss=669.697571 dt=0.003805 dtf=0.000913 dtb=0.002892</span>
<span id="cb20-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=54 loss=665.016602 dt=0.003814 dtf=0.000946 dtb=0.002867</span>
<span id="cb20-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=55 loss=672.755981 dt=0.003617 dtf=0.000912 dtb=0.002705</span>
<span id="cb20-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=56 loss=676.824341 dt=0.003804 dtf=0.000924 dtb=0.002880</span>
<span id="cb20-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=57 loss=676.435181 dt=0.003807 dtf=0.000937 dtb=0.002870</span>
<span id="cb20-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=58 loss=680.153992 dt=0.003991 dtf=0.000937 dtb=0.003054</span>
<span id="cb20-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=59 loss=675.248108 dt=0.003597 dtf=0.000892 dtb=0.002705</span>
<span id="cb20-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=60 loss=673.595093 dt=0.003694 dtf=0.000911 dtb=0.002783</span>
<span id="cb20-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=61 loss=686.233032 dt=0.003583 dtf=0.000900 dtb=0.002683</span>
<span id="cb20-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=62 loss=682.671265 dt=0.003702 dtf=0.000908 dtb=0.002793</span>
<span id="cb20-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=63 loss=673.332092 dt=0.003626 dtf=0.000896 dtb=0.002731</span>
<span id="cb20-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=64 loss=678.947998 dt=0.003721 dtf=0.000903 dtb=0.002818</span>
<span id="cb20-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=65 loss=664.849792 dt=0.003625 dtf=0.000912 dtb=0.002713</span>
<span id="cb20-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=66 loss=671.088013 dt=0.003731 dtf=0.000893 dtb=0.002837</span>
<span id="cb20-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=67 loss=676.324768 dt=0.003726 dtf=0.000937 dtb=0.002789</span>
<span id="cb20-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=68 loss=664.155518 dt=0.003764 dtf=0.000973 dtb=0.002791</span>
<span id="cb20-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=69 loss=674.292114 dt=0.003703 dtf=0.000935 dtb=0.002769</span>
<span id="cb20-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=70 loss=668.928772 dt=0.003908 dtf=0.000936 dtb=0.002972</span>
<span id="cb20-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=71 loss=675.064697 dt=0.003670 dtf=0.000921 dtb=0.002748</span>
<span id="cb20-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=72 loss=677.371338 dt=0.003632 dtf=0.000964 dtb=0.002667</span>
<span id="cb20-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=73 loss=685.282959 dt=0.003582 dtf=0.000894 dtb=0.002688</span>
<span id="cb20-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=74 loss=669.304443 dt=0.003767 dtf=0.000908 dtb=0.002859</span>
<span id="cb20-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=75 loss=676.679932 dt=0.003779 dtf=0.000904 dtb=0.002875</span>
<span id="cb20-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=76 loss=678.548462 dt=0.004022 dtf=0.000921 dtb=0.003101</span>
<span id="cb20-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:06:59]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=77 loss=673.683105 dt=0.003715 dtf=0.000910 dtb=0.002805</span>
<span id="cb20-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=78 loss=676.570129 dt=0.003722 dtf=0.000921 dtb=0.002801</span>
<span id="cb20-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=79 loss=681.414795 dt=0.003569 dtf=0.000907 dtb=0.002662</span>
<span id="cb20-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=80 loss=680.041992 dt=0.003691 dtf=0.000918 dtb=0.002773</span>
<span id="cb20-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=81 loss=675.775024 dt=0.003611 dtf=0.000897 dtb=0.002714</span>
<span id="cb20-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=82 loss=670.443359 dt=0.003796 dtf=0.000910 dtb=0.002886</span>
<span id="cb20-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=83 loss=660.718018 dt=0.003568 dtf=0.000900 dtb=0.002669</span>
<span id="cb20-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=84 loss=672.146912 dt=0.003607 dtf=0.000923 dtb=0.002684</span>
<span id="cb20-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=85 loss=676.868896 dt=0.003542 dtf=0.000918 dtb=0.002624</span>
<span id="cb20-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=86 loss=678.217529 dt=0.003735 dtf=0.000898 dtb=0.002838</span>
<span id="cb20-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=87 loss=665.618103 dt=0.003579 dtf=0.000909 dtb=0.002670</span>
<span id="cb20-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=88 loss=668.519287 dt=0.003574 dtf=0.000903 dtb=0.002671</span>
<span id="cb20-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=89 loss=664.486694 dt=0.003928 dtf=0.000942 dtb=0.002985</span>
<span id="cb20-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=90 loss=677.690918 dt=0.003746 dtf=0.000966 dtb=0.002780</span>
<span id="cb20-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=91 loss=668.240601 dt=0.003564 dtf=0.000894 dtb=0.002670</span>
<span id="cb20-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=92 loss=660.485474 dt=0.003608 dtf=0.000909 dtb=0.002700</span>
<span id="cb20-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=93 loss=664.691772 dt=0.003570 dtf=0.000913 dtb=0.002657</span>
<span id="cb20-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=94 loss=656.607910 dt=0.003601 dtf=0.000910 dtb=0.002691</span>
<span id="cb20-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=95 loss=670.816650 dt=0.003555 dtf=0.000904 dtb=0.002652</span>
<span id="cb20-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=96 loss=663.897339 dt=0.003560 dtf=0.000895 dtb=0.002665</span>
<span id="cb20-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=97 loss=659.260620 dt=0.003908 dtf=0.000941 dtb=0.002967</span>
<span id="cb20-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=98 loss=660.536499 dt=0.003615 dtf=0.000897 dtb=0.002718</span>
<span id="cb20-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">examples/minimal:61:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> iter=99 loss=661.475586 dt=0.003756 dtf=0.000946 dtb=0.002809</span>
<span id="cb20-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:00]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DistributedDataParallel</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-180"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-181">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-182">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-183">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-184">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-185">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-186">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-187">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-188">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-189">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ReLU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-190">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-191">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-192"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-193"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> Adam <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb20-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Parameter</span> Group 0</span>
<span id="cb20-195">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">amsgrad:</span> False</span>
<span id="cb20-196">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">betas:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb20-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">capturable:</span> False</span>
<span id="cb20-198">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">differentiable:</span> False</span>
<span id="cb20-199">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eps:</span> 1e-08</span>
<span id="cb20-200">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foreach:</span> None</span>
<span id="cb20-201">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> None</span>
<span id="cb20-202">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 0.001</span>
<span id="cb20-203">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maximize:</span> False</span>
<span id="cb20-204">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay:</span> 0</span>
<span id="cb20-205"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)))</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> dt=1.2669s</span>
<span id="cb20-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:721</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving iter plot to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/mplot</span>
<span id="cb20-207"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:721</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving loss plot to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/mplot</span>
<span id="cb20-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:721</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving dt plot to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/mplot</span>
<span id="cb20-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:721</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving dtf plot to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/mplot</span>
<span id="cb20-210"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:721</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving dtb plot to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/mplot</span>
<span id="cb20-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/history:618</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving tplots to /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot</span>
<span id="cb20-212">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-213">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2701.3‚î§‚ñå</span>                                                   ‚îÇ</span>
<span id="cb20-215">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                   ‚îÇ</span>
<span id="cb20-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2360.5‚î§‚ñù‚ññ</span>                                                  ‚îÇ</span>
<span id="cb20-217">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñå                                                  ‚îÇ</span>
<span id="cb20-218">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñå                                                  ‚îÇ</span>
<span id="cb20-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2019.8‚î§</span> ‚ñö                                                  ‚îÇ</span>
<span id="cb20-220">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù‚ññ                                                 ‚îÇ</span>
<span id="cb20-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1679.0‚î§</span>  ‚ñå                                                 ‚îÇ</span>
<span id="cb20-222">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚ñê                                                 ‚îÇ</span>
<span id="cb20-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1338.2‚î§</span>  ‚ñê                                                 ‚îÇ</span>
<span id="cb20-224">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚ñù‚ññ                                                ‚îÇ</span>
<span id="cb20-225">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñê                                                ‚îÇ</span>
<span id="cb20-226"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">997.4‚î§</span>    ‚ñö‚ññ                                              ‚îÇ</span>
<span id="cb20-227">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚ñö‚ññ                                             ‚îÇ</span>
<span id="cb20-228"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">656.6‚î§</span>      ‚ñù‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÑ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚îÇ</span>
<span id="cb20-229">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb20-230">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> 3 7 13 19  27 33 37   47   57 64  70 77  84 91  98</span>
<span id="cb20-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss</span>                           iter</span>
<span id="cb20-232"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/loss.txt</span>
<span id="cb20-233">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-234">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.62‚î§‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-236">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.52‚î§‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-238">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-239">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.42‚î§‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-241">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.31‚î§‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-243">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.21‚î§‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-245">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                     ‚îÇ</span>
<span id="cb20-246">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                     ‚îÇ</span>
<span id="cb20-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.11‚î§‚ñê</span>                                                     ‚îÇ</span>
<span id="cb20-248">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                     ‚îÇ</span>
<span id="cb20-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00‚î§‚ñù‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚îÇ</span></span>
<span id="cb20-250">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb20-251">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> 3 7 13  19  27 33   42 47   57 62  70  77 84  91  98</span>
<span id="cb20-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dt</span>                            iter</span>
<span id="cb20-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dt.txt</span>
<span id="cb20-254">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-255">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">98.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-257">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">81.7‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-259">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-260">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65.3‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-262">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">49.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-264">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32.7‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-266">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-267">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16.3‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-269">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-270"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>      ‚ñà‚ñà‚ñà‚ñà‚ñà                                 ‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ</span>
<span id="cb20-271">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb20-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-0.02</span>        0.14          0.31         0.48        0.65</span>
<span id="cb20-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">freq</span>                           dt</span>
<span id="cb20-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dt-hist.txt</span>
<span id="cb20-275">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-276">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.381‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-278">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.318‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-280">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-281">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.255‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-283">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-284"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.191‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-285">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.128‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-287">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-288">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-289"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.064‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-290">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.001‚î§‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚îÇ</span></span>
<span id="cb20-292">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb20-293">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> 3 7 13 19   27 33 39  47   57 62  70  77  84 91  98</span>
<span id="cb20-294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtf</span>                           iter</span>
<span id="cb20-295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dtf.txt</span>
<span id="cb20-296">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-297">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">99.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-299">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82.5‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-301">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-302">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">66.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-304">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">49.5‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-306">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-308">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-309">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-310"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16.5‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-311">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-312"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ</span>
<span id="cb20-313">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb20-314"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-0.02</span>        0.09          0.19         0.29        0.40</span>
<span id="cb20-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">freq</span>                           dtf</span>
<span id="cb20-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dtf-hist.txt</span>
<span id="cb20-317">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-318">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-319"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.242‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-320">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-321"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.202‚î§‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-322">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-323">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                    ‚îÇ</span>
<span id="cb20-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.162‚î§‚ñö</span>                                                    ‚îÇ</span>
<span id="cb20-325">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-326"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.122‚î§‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-327">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-328"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.082‚î§‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-329">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-330">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-331"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.043‚î§‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-332">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                    ‚îÇ</span>
<span id="cb20-333"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.003‚î§‚ñù‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚îÇ</span></span>
<span id="cb20-334">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb20-335">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> 3 7 13 19   27 33 39  47   57 62  70  77  84 91  98</span>
<span id="cb20-336"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtb</span>                           iter</span>
<span id="cb20-337"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dtb.txt</span>
<span id="cb20-338">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2025</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">05</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">06</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">090703</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb20-339">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb20-340"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">98.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-341">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-342"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">81.7‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-343">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-344">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-345"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65.3‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-346">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-347"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">49.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-348">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32.7‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-350">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-351">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-352"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16.3‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-353">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà</span>                                                 ‚îÇ</span>
<span id="cb20-354"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0‚î§‚ñà‚ñà‚ñà‚ñà‚ñà</span>                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           ‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ</span>
<span id="cb20-355">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb20-356"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-0.008</span>        0.057         0.122        0.187      0.253</span>
<span id="cb20-357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">freq</span>                           dtb</span>
<span id="cb20-358"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/plots/tplot/dtb-hist.txt</span>
<span id="cb20-359"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/utils:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Saving dataset to: /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/outputs/History-2025-05-06-090700/2025-05-06-090700/History-2025-05-06-090700/dataset_dataset.h5</span>
<span id="cb20-360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span></span>
<span id="cb20-361"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run pretty-paper-29 at: https://wandb.ai/aurora_gpt/ezpz.examples.minimal/runs/q9u196rq</span>
<span id="cb20-362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Find logs at: ../../../../../../lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/wandb/run-20250506_090647-q9u196rq/logs</span>
<span id="cb20-363"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Application</span> 9237e362 resources: utime=843s stime=176s maxrss=4006656KB inblock=668002 oublock=1640 minflt=11466255 majflt=45004 nvcsw=498142 nivcsw=5295709</span>
<span id="cb20-364"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:06]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:201</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Execution finished @ 2025-05-06-090706</span>
<span id="cb20-365"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 09:07:06]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:202</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Command took 44.95 seconds to run. Exiting.</span>
<span id="cb20-366"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:56s</span></code></pre></div></div>
</details></li>
</ol>
</section>
<section id="ezpz-test" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="ezpz-test">üìù <code>ezpz-test</code></h2>
<ul>
<li><p><code>ezpz-test</code> is a simple test script that trains a small model using DDP across all available GPUs</p>
<ul>
<li>It will automatically detect the number of GPUs and launch an appropriate <code>mpiexec</code> command to run the training script across all GPUs</li>
</ul></li>
<li><p>See: <a href="https://github.com/ezpz/ezpz/blob/main/ezpz/test.py">ezpz/test.py</a></p></li>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb21-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/05/25 @ 07:41:35][x4520c1s0b0n0][/f/d/f/p/s/ezpz][üå± update-utils][üì¶ü§∑‚úì] [‚è±Ô∏è 54s]</span></span>
<span id="cb21-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-test</span></span></code></pre></div></div></li>
</ul>
</section>
<section id="generate-text" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="generate-text">ü¶ú Generate Text</h2>
<ul>
<li><p>See: <a href="https://github.com/ezpz/ezpz/blob/main/ezpz/generate.py">ezpz/generate.py</a></p></li>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.generate <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name</span> meta-llama/Llama-3.1-8B</span></code></pre></div></div></li>
</ul>
<ul>
<li><details closed="">
<summary>
Output
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">```</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span></span>
<span id="cb23-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.</span></span>
<span id="cb23-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/05/25 @ 08:00:04][x4520c1s0b0n0][/f/d/f/p/s/ezpz][üå± update-utils][üì¶ü§∑</span></span>
<span id="cb23-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.generate <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name</span> meta-llama/Llama-3.1-8B</span>
<span id="cb23-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W505</span> 08:00:08.677116983 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb23-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb23-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb23-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb23-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb23-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-05</span> 08:00:13,430] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:239:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">config.json:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">826/826</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 8.31MB/s]</span>
<span id="cb23-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model.safetensors.index.json:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23.9k/23.9k</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 171MB/s]</span>
<span id="cb23-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Fetching</span> 4 files:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/4</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb23-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00004-of-00004.safetensors:</span>  52%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">608M/1.17G</span> [00:29<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:27, 20.2MB/s]</span>
<span id="cb23-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00003-of-00004.safetensors:</span>  12%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">598M/4.92G</span> [00:29<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>03:20, 21.5MB/s]</span>
<span id="cb23-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00002-of-00004.safetensors:</span>  34%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.72G/5.00G</span> [00:30<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:57, 57.0MB/s]</span>
<span id="cb23-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00004-of-00004.safetensors:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.17G/1.17G</span> [00:57<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 20.4MB/s]</span>
<span id="cb23-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00002-of-00004.safetensors:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.00G/5.00G</span> [01:27<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 57.1MB/s]</span>
<span id="cb23-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00001-of-00004.safetensors:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.98G/4.98G</span> [02:14<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 37.0MB/s]</span>
<span id="cb23-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model-00003-of-00004.safetensors:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.92G/4.92G</span> [02:16<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 35.9MB/s]</span>
<span id="cb23-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Fetching</span> 4 files: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4/4</span> [02:16<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.23s/it]</span>
<span id="cb23-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4/4</span> [00:06<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00,  1.67s/it]</span>
<span id="cb23-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">generation_config.json:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">185/185</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 2.06MB/s]</span>
<span id="cb23-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a prompt: What day is it<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb23-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> max length: 64</span>
<span id="cb23-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb23-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&lt;|begin_of_text|&gt;What day is it? It‚Äôs Friday, which means it‚Äôs time to look at the top five most read stories on the site this week.\n5. The 10 Most </span></span>
<span id="cb23-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Expensive Homes in America\nWith the average home price in the U.S. rising above $300,000 for the first time ever,'</span></span>
<span id="cb23-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb23-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a prompt: Who are you<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> </span>
<span id="cb23-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> max length: 64</span>
<span id="cb23-34"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb23-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&lt;|begin_of_text|&gt;Who are you? What do you do? What is your purpose in life? What is your mission? How do you measure success? What is the meaning of </span></span>
<span id="cb23-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">life? What is the meaning of your life?\nI‚Äôm a student of life. I‚Äôm a student of the human condition. I‚Äôm a student of'</span></span>
<span id="cb23-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb23-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a prompt: What is it like in there<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb23-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> max length: 64</span>
<span id="cb23-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb23-41">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&lt;|begin_of_text|&gt;What is it like in there? The question is asked by many, but the answer is often hard to find. It is not just the physical conditions </span></span>
<span id="cb23-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">that make the experience of prison a difficult one. It is also the psychological and emotional impact that it has on the prisoners themselves. In this blog </span></span>
<span id="cb23-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">post, we will'</span></span>
<span id="cb23-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb23-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a prompt: </span></code></pre></div></div>
</details></li>
</ul>
</section>
<section id="huggingface-trainer" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="huggingface-trainer">ü§ó Huggingface Trainer</h2>
<ul>
<li><p>See <a href="https://github.com/ezpz/ezpz/blob/main/ezpz/hf_trainer.py">ezpz/hf_trainer.py</a></p></li>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.hf_trainer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--dataset_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eliplutchok/fineweb-small-sample <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--streaming</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name_or_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meta-llama/Llama-3.2-1B <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_train</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--report-to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wandb <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-tokens-per-second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-num-input-tokens-seen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auto_find_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--gradient_checkpointing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>adamw_torch <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--overwrite-output-dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-first-step</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-for-metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inputs,loss'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-eval-samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>50 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ddp-backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ccl</span></code></pre></div></div></li>
</ul>
<ul>
<li><details closed="">
<summary>
Output:
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb25-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[/f/d/f/p/s/ezpz][üå± update-utils][üì¶üìùü§∑‚úì] [‚è±Ô∏è 1m54s]</span></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/06/25 @ 22:25:54][x4505c5s7b0n0]</span></span>
<span id="cb25-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-launch</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.hf_trainer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--dataset_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eliplutchok/fineweb-small-sample <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--streaming</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name_or_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meta-llama/Llama-3.2-1B <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_train</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--report-to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wandb <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-tokens-per-second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-num-input-tokens-seen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auto_find_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--gradient_checkpointing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>adamw_torch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--overwrite-output-dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-first-step</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-for-metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inputs,loss'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-eval-samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>50 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ddp-backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ccl <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --fsdp=shard_grad_op</span></span>
<span id="cb25-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W506</span> 22:25:56.901078167 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb25-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb25-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb25-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb25-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb25-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:00,816] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:239:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/__init__:278:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb25-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:02]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/__init__:279:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb25-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Job ID: 4675836</span>
<span id="cb25-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:163</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Node file: /var/spool/pbs/aux/4675836.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb25-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:178</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Building command to execute by piecing together:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch_cmd'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'python'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span> + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cmd_to_launch'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:182</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch_cmd'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span> mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--np</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/var/spool/pbs/aux/4675836.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--depth</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8</span>
<span id="cb25-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:183</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'python'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span> /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/python3</span>
<span id="cb25-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:184</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cmd_to_launch'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]:</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.hf_trainer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--dataset_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eliplutchok/fineweb-small-sample <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--streaming</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name_or_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meta-llama/Llama-3.2-1B <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_train</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--report-to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wandb <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-tokens-per-second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-num-input-tokens-seen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auto_find_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--gradient_checkpointing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>adamw_torch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--overwrite-output-dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-first-step</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-for-metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inputs,loss <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-eval-samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>50 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ddp-backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ccl</span>
<span id="cb25-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:189</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Took: 0.45 seconds to build command.</span>
<span id="cb25-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:192</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Executing: mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--np</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/var/spool/pbs/aux/4675836.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--depth</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8 /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.hf_trainer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--dataset_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eliplutchok/fineweb-small-sample <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--streaming</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--model_name_or_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meta-llama/Llama-3.2-1B <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_train</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--do_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--report-to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wandb <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-tokens-per-second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--block-size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-num-input-tokens-seen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auto_find_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--gradient_checkpointing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>adamw_torch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--overwrite-output-dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>true <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logging-first-step</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include-for-metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inputs,loss <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-eval-samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>50 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ddp-backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ccl</span>
<span id="cb25-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:119</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Filtering for Aurora-specific messages. To view list of filters, run with <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">EZPZ_LOG_LEVEL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>DEBUG<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span></span>
<span id="cb25-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:03]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:199</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Execution started @ 2025-05-06-222603...</span>
<span id="cb25-26"></span>
<span id="cb25-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Disabling</span> local launch: multi-node application</span>
<span id="cb25-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x4505c5s6b0n0.hostmgmt2505.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb25-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application 3917764c-4dd9-4d75-bed1-dd671fc83cba</span>
<span id="cb25-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:18]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/__init__:278:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb25-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:18]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/__init__:279:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb25-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:567</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using get_torch_device_type<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb25-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 4/23]</span>
<span id="cb25-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 5/23]</span>
<span id="cb25-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 6/23]</span>
<span id="cb25-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 7/23]</span>
<span id="cb25-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">12/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">13/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">16/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">18/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">19/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">22/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">20/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 3/23]</span>
<span id="cb25-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">14/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 1/23]</span>
<span id="cb25-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 8/23]</span>
<span id="cb25-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 2/23]</span>
<span id="cb25-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">10/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s7b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">21/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb25-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 9/23]</span>
<span id="cb25-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:947</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ddp'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb25-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:19]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:994</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4505c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>[ 0/23]</span>
<span id="cb25-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:05:06-22:26:19:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">191240</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOG_LEVEL changed to be error <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:warn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:20]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1217</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting up wandb from rank=0</span>
<span id="cb25-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:20]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1218</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using WB_PROJECT=ezpz-hf_trainer-meta-llama-Llama-3.2-1B</span>
<span id="cb25-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Currently logged in as: foremans <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aurora_gpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> https://api.wandb.ai. Use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>wandb <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">login</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--relogin</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to force relogin</span>
<span id="cb25-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Tracking run with wandb version 0.19.10</span>
<span id="cb25-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run data is saved locally in /lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/wandb/run-20250506_222620-6yl6uks0</span>
<span id="cb25-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> offline<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to turn off syncing.</span>
<span id="cb25-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Syncing run cosmic-meadow-38</span>
<span id="cb25-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ‚≠êÔ∏è View project at https://wandb.ai/aurora_gpt/ezpz-hf_trainer-meta-llama-Llama-3.2-1B</span>
<span id="cb25-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run at https://wandb.ai/aurora_gpt/ezpz-hf_trainer-meta-llama-Llama-3.2-1B/runs/6yl6uks0</span>
<span id="cb25-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1246</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> wandb.run=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">cosmic</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">meadow</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">38</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/ezpz-hf_trainer-meta-llama-Llama-3.2-1B/runs/6yl6uks0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:1286</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Aurora'</span></span>
<span id="cb25-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils/_logger:68:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Process rank: 0, device: xpu:0, n_gpu: 1, distributed training: True</span>
<span id="cb25-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:26:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/hf_trainer:437:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Training/evaluation parameters TrainingArguments<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb25-72">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_n_gpu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1,</span>
<span id="cb25-73">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">accelerator_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'split_batches'</span>: <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">False,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dispatch_batches'</span>: None, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'even_batches'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'use_seedable_sampler'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'non_blocking'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gradient_accumulation_kwargs'</span>: None, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'use_configured_state'</span>: False},</span>
<span id="cb25-74">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adafactor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-75">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adam_beta1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.9,</span>
<span id="cb25-76">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adam_beta2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.999,</span>
<span id="cb25-77">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">adam_epsilon</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1e-08,</span>
<span id="cb25-78">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">auto_find_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-79">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">average_tokens_across_devices</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-80">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">batch_eval_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-81">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bf16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-82">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bf16_full_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-83">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_seed</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-84">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataloader_drop_last</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-85">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataloader_num_workers</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-86">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataloader_persistent_workers</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-87">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataloader_pin_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-88">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataloader_prefetch_factor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-89">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ddp_backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ccl,</span>
<span id="cb25-90">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ddp_broadcast_buffers</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-91">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ddp_bucket_cap_mb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-92">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ddp_find_unused_parameters</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-93">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ddp_timeout</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1800,</span>
<span id="cb25-94">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">debug</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb25-95">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">deepspeed</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-96">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">disable_tqdm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-97">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">do_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-98">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">do_predict</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-99">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">do_train</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-100">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_accumulation_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-101">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_delay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-102">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_do_concat_batches</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-103">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_on_start</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-104">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-105">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_strategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>no,</span>
<span id="cb25-106">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eval_use_gather_object</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-107">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-108">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp16_backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>auto,</span>
<span id="cb25-109">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp16_full_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-110">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp16_opt_level</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>O1,</span>
<span id="cb25-111">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fsdp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb25-112">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fsdp_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_num_params'</span>: <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xla'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xla_fsdp_v2'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xla_fsdp_grad_ckpt'</span>: False},</span>
<span id="cb25-113">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fsdp_min_num_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-114">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fsdp_transformer_layer_cls_to_wrap</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-115">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">full_determinism</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-116">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gradient_accumulation_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1,</span>
<span id="cb25-117">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gradient_checkpointing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-118">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gradient_checkpointing_kwargs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-119">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">greater_is_better</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-120">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">group_by_length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-121">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">half_precision_backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>auto,</span>
<span id="cb25-122">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hub_always_push</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-123">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hub_model_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-124">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hub_private_repo</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-125">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hub_strategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>every_save,</span>
<span id="cb25-126">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hub_token</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=&lt;</span>HUB_TOKEN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>,</span>
<span id="cb25-127">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ignore_data_skip</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-128">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">include_for_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inputs,loss'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>,</span>
<span id="cb25-129">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">include_inputs_for_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-130">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">include_num_input_tokens_seen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-131">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">include_tokens_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-132">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jit_mode_eval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-133">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label_names</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-134">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label_smoothing_factor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0,</span>
<span id="cb25-135">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>5e-05,</span>
<span id="cb25-136">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length_column_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>length,</span>
<span id="cb25-137">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">load_best_model_at_end</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-138">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">local_rank</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-139">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">log_level</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passive,</span>
<span id="cb25-140">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">log_level_replica</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>warning,</span>
<span id="cb25-141">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">log_on_each_node</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-142">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logging_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>trainer_output/runs/May06_22-26-20_x4505c5s6b0n0,</span>
<span id="cb25-143">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logging_first_step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-144">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logging_nan_inf_filter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-145">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logging_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0,</span>
<span id="cb25-146">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logging_strategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>steps,</span>
<span id="cb25-147">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_scheduler_kwargs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{},</span>
<span id="cb25-148">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_scheduler_type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>linear,</span>
<span id="cb25-149">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0,</span>
<span id="cb25-150">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10,</span>
<span id="cb25-151">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">metric_for_best_model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-152">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mp_parameters</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>,</span>
<span id="cb25-153">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">neftune_noise_alpha</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-154">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">num_train_epochs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3.0,</span>
<span id="cb25-155">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">optim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>adamw_torch,</span>
<span id="cb25-156">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">optim_args</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-157">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">optim_target_modules</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-158">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>trainer_output,</span>
<span id="cb25-159">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">overwrite_output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-160">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">past_index</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>-1,</span>
<span id="cb25-161">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">per_device_eval_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8,</span>
<span id="cb25-162">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">per_device_train_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8,</span>
<span id="cb25-163">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_loss_only</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-164">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">push_to_hub</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-165">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">push_to_hub_model_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-166">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">push_to_hub_organization</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-167">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">push_to_hub_token</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=&lt;</span>PUSH_TO_HUB_TOKEN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>,</span>
<span id="cb25-168">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ray_scope</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>last,</span>
<span id="cb25-169">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">remove_unused_columns</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-170">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">report_to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wandb'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>,</span>
<span id="cb25-171">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">restore_callback_states_from_checkpoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-172">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">resume_from_checkpoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-173">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">run_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>trainer_output,</span>
<span id="cb25-174">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_on_each_node</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-175">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_only_model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-176">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_safetensors</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-177">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>500,</span>
<span id="cb25-178">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_strategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>steps,</span>
<span id="cb25-179">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save_total_limit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-180">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seed</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42,</span>
<span id="cb25-181">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">skip_memory_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True,</span>
<span id="cb25-182">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf32</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-183">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">torch_compile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-184">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">torch_compile_backend</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-185">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">torch_compile_mode</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-186">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">torch_empty_cache_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-187">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">torchdynamo</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-188">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tp_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-189">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tpu_metrics_debug</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-190">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tpu_num_cores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None,</span>
<span id="cb25-191">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_cpu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-192">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_ipex</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-193">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_legacy_prediction_loop</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-194">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_liger_kernel</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-195">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_mps_device</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False,</span>
<span id="cb25-196">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">warmup_ratio</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0,</span>
<span id="cb25-197">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">warmup_steps</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0,</span>
<span id="cb25-198">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">weight_decay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0,</span>
<span id="cb25-199"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:693]</span> 2025-05-06 22:26:24,266 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading configuration file config.json from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/config.json</span>
<span id="cb25-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:765]</span> 2025-05-06 22:26:24,267 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Model config LlamaConfig {</span>
<span id="cb25-202"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"architectures"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> [</span>
<span id="cb25-203">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LlamaForCausalLM"</span></span>
<span id="cb25-204"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">],</span></span>
<span id="cb25-205"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"attention_bias"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb25-206"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"attention_dropout"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0,</span>
<span id="cb25-207"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128000,</span>
<span id="cb25-208"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128001,</span>
<span id="cb25-209"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"head_dim"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 64,</span>
<span id="cb25-210"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hidden_act"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"silu"</span>,</span>
<span id="cb25-211"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hidden_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2048,</span>
<span id="cb25-212"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"initializer_range"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.02,</span>
<span id="cb25-213"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intermediate_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 8192,</span>
<span id="cb25-214"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_position_embeddings"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 131072,</span>
<span id="cb25-215"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mlp_bias"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb25-216"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_type"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama"</span>,</span>
<span id="cb25-217"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_attention_heads"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 32,</span>
<span id="cb25-218"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_hidden_layers"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 16,</span>
<span id="cb25-219"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_key_value_heads"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 8,</span>
<span id="cb25-220"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pretraining_tp"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb25-221"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rms_norm_eps"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1e-05,</span>
<span id="cb25-222"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rope_scaling"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb25-223">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factor"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 32.0,</span>
<span id="cb25-224">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"high_freq_factor"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 4.0,</span>
<span id="cb25-225">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"low_freq_factor"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.0,</span>
<span id="cb25-226">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original_max_position_embeddings"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 8192,</span>
<span id="cb25-227">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rope_type"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama3"</span></span>
<span id="cb25-228"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb25-229"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rope_theta"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 500000.0,</span>
<span id="cb25-230"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tie_word_embeddings"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb25-231"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch_dtype"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bfloat16"</span>,</span>
<span id="cb25-232"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transformers_version"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.51.3"</span>,</span>
<span id="cb25-233"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_cache"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb25-234"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vocab_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128256</span>
<span id="cb25-235"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-236"></span>
<span id="cb25-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file tokenizer.json from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/tokenizer.json</span>
<span id="cb25-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file tokenizer.model from cache at None</span>
<span id="cb25-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file added_tokens.json from cache at None</span>
<span id="cb25-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file special_tokens_map.json from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/special_tokens_map.json</span>
<span id="cb25-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file tokenizer_config.json from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/tokenizer_config.json</span>
<span id="cb25-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2060]</span> 2025-05-06 22:26:24,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading file chat_template.jinja from cache at None</span>
<span id="cb25-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2323]</span> 2025-05-06 22:26:24,692 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.</span>
<span id="cb25-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">modeling_utils.py:1124]</span> 2025-05-06 22:26:24,704 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading weights file model.safetensors from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/model.safetensors</span>
<span id="cb25-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:1142]</span> 2025-05-06 22:26:24,708 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Generate config GenerationConfig {</span>
<span id="cb25-246"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128000,</span>
<span id="cb25-247"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128001</span>
<span id="cb25-248"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-249"></span>
<span id="cb25-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">modeling_utils.py:4930]</span> 2025-05-06 22:26:32,810 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> All model checkpoint weights were used when initializing LlamaForCausalLM.</span>
<span id="cb25-251"></span>
<span id="cb25-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">modeling_utils.py:4938]</span> 2025-05-06 22:26:32,810 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> All the weights of LlamaForCausalLM were initialized from the model checkpoint at meta-llama/Llama-3.2-1B.</span>
<span id="cb25-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">If</span> your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.</span>
<span id="cb25-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:1097]</span> 2025-05-06 22:26:32,860 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> loading configuration file generation_config.json from cache at /home/foremans/.cache/huggingface/hub/models--meta-llama--Llama-3.2-1B/snapshots/4e20de362430cd3b72f300e6b0f18e50e7166e08/generation_config.json</span>
<span id="cb25-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:1142]</span> 2025-05-06 22:26:32,860 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Generate config GenerationConfig {</span>
<span id="cb25-256"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128000,</span>
<span id="cb25-257"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"do_sample"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb25-258"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eos_token_id"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 128001,</span>
<span id="cb25-259"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temperature"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.6,</span>
<span id="cb25-260"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top_p"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.9</span>
<span id="cb25-261"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-262"></span>
<span id="cb25-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:698]</span> 2025-05-06 22:26:33,878 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> max_steps is given, it will override any value given in num_train_epochs</span>
<span id="cb25-264"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:748]</span> 2025-05-06 22:26:33,879 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Using auto half precision backend</span>
<span id="cb25-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2414]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*****</span> Running training <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*****</span></span>
<span id="cb25-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2415]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Num examples = 1,920</span>
<span id="cb25-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2416]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Num Epochs = 9,223,372,036,854,775,807</span>
<span id="cb25-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2417]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Instantaneous batch size per device = 8</span>
<span id="cb25-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2420]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Total train batch size <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">w.</span> parallel, distributed <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">accumulation</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=</span> 192</span>
<span id="cb25-270"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2421]</span> 2025-05-06 22:26:52,889 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Gradient Accumulation steps = 1</span>
<span id="cb25-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2422]</span> 2025-05-06 22:26:52,890 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Total optimization steps = 10</span>
<span id="cb25-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2423]</span> 2025-05-06 22:26:52,890 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Number of trainable parameters = 1,235,814,400</span>
<span id="cb25-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">integration_utils.py:831]</span> 2025-05-06 22:26:52,890 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Automatic Weights <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Biases</span> logging enabled, to disable set os.environ<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WANDB_DISABLED"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span></span>
<span id="cb25-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> WARNING The <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">run_name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> is currently set to the same value as <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">TrainingArguments.output_dir</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>. If this was not intended, please specify a different run name by setting the <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">TrainingArguments.run_name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> parameter.</span>
<span id="cb25-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">use_cache</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,121 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,121 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-284"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-289"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_logger.py:68]</span> 2025-05-06 22:26:54,122 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> incompatible with gradient checkpointing. Setting <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>use_cache=False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb25-298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:3984]</span> 2025-05-06 22:27:05,127 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Saving model checkpoint to trainer_output/checkpoint-10</span>
<span id="cb25-299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:419]</span> 2025-05-06 22:27:05,143 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Configuration saved in trainer_output/checkpoint-10/config.json</span>
<span id="cb25-300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:911]</span> 2025-05-06 22:27:05,150 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Configuration saved in trainer_output/checkpoint-10/generation_config.json</span>
<span id="cb25-301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">modeling_utils.py:3572]</span> 2025-05-06 22:27:10,292 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Model weights saved in trainer_output/checkpoint-10/model.safetensors</span>
<span id="cb25-302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2510]</span> 2025-05-06 22:27:10,304 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> tokenizer config file saved in trainer_output/checkpoint-10/tokenizer_config.json</span>
<span id="cb25-303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2519]</span> 2025-05-06 22:27:10,312 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Special tokens file saved in trainer_output/checkpoint-10/special_tokens_map.json</span>
<span id="cb25-304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:2681]</span> 2025-05-06 22:27:20,107 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span></span>
<span id="cb25-305"></span>
<span id="cb25-306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Training</span> completed. Do not forget to share your model on huggingface.co/models =<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb25-307"></span>
<span id="cb25-308"></span>
<span id="cb25-309"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:3984]</span> 2025-05-06 22:27:20,141 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Saving model checkpoint to trainer_output</span>
<span id="cb25-310"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:419]</span> 2025-05-06 22:27:20,149 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Configuration saved in trainer_output/config.json</span>
<span id="cb25-311"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configuration_utils.py:911]</span> 2025-05-06 22:27:20,155 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Configuration saved in trainer_output/generation_config.json</span>
<span id="cb25-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">modeling_utils.py:3572]</span> 2025-05-06 22:27:25,182 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Model weights saved in trainer_output/model.safetensors</span>
<span id="cb25-313"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2510]</span> 2025-05-06 22:27:25,191 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> tokenizer config file saved in trainer_output/tokenizer_config.json</span>
<span id="cb25-314"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenization_utils_base.py:2519]</span> 2025-05-06 22:27:25,197 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> Special tokens file saved in trainer_output/special_tokens_map.json</span>
<span id="cb25-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:4307]</span> 2025-05-06 22:27:25,394 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span></span>
<span id="cb25-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*****</span> Running Evaluation <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*****</span></span>
<span id="cb25-317"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:4311]</span> 2025-05-06 22:27:25,395 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Num examples: Unknown</span>
<span id="cb25-318"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[INFO</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trainer.py:4312]</span> 2025-05-06 22:27:25,395 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span>   Batch size = 8</span>
<span id="cb25-319"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.847, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 3.8245272636413574, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 24576}</span>
<span id="cb25-320"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9574, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 7.945530414581299, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 4.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 49152}</span>
<span id="cb25-321"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.1086, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 7.155135631561279, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 4e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.3, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 73728}</span>
<span id="cb25-322"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9751, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.435009956359863, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 3.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.4, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 98304}</span>
<span id="cb25-323"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.0095, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.177059173583984, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 3e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.5, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 122880}</span>
<span id="cb25-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9153, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.262296676635742, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 2.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.6, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 147456}</span>
<span id="cb25-325"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.8742, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 6.913131237030029, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 2e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.7, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 172032}</span>
<span id="cb25-326"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.2855, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 5.904435157775879, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 1.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.8, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 196608}</span>
<span id="cb25-327"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9934, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.500864028930664, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 1e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.9, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 221184}</span>
<span id="cb25-328"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.8064, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 6.904043197631836, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 5e-06, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-329"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_runtime'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12.4474, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_samples_per_second'</span>: 154.249, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_steps_per_second'</span>: 0.803, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_tokens_per_second'</span>: 822.661, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_loss'</span>: 2.977239990234375, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-330"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.6778849363327026, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_accuracy'</span>: 0.6173228346456693, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_runtime'</span>: 13.2043, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_samples_per_second'</span>: 0.227, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_steps_per_second'</span>: 0.076, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-331"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span></span>
<span id="cb25-332"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run cosmic-meadow-38 at: https://wandb.ai/aurora_gpt/ezpz-hf_trainer-meta-llama-Llama-3.2-1B/runs/6yl6uks0</span>
<span id="cb25-333"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Find logs at: ../../../../../../lus/flare/projects/datascience/foremans/projects/saforem2/ezpz/wandb/run-20250506_222620-6yl6uks0/logs</span>
<span id="cb25-334"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.847, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 3.8245272636413574, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 24576}</span>
<span id="cb25-335"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9574, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 7.945530414581299, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 4.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.2, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 49152}</span>
<span id="cb25-336"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.1086, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 7.155135631561279, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 4e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.3, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 73728}</span>
<span id="cb25-337"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9751, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.435009956359863, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 3.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.4, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 98304}</span>
<span id="cb25-338"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.0095, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.177059173583984, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 3e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.5, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 122880}</span>
<span id="cb25-339"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9153, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.262296676635742, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 2.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.6, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 147456}</span>
<span id="cb25-340"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.8742, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 6.913131237030029, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 2e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.7, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 172032}</span>
<span id="cb25-341"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3.2855, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 5.904435157775879, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 1.5e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.8, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 196608}</span>
<span id="cb25-342"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.9934, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 4.500864028930664, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 1e-05, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 0.9, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 221184}</span>
<span id="cb25-343"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2.8064, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_norm'</span>: 6.904043197631836, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: 5e-06, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-344"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_runtime'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 27.2171, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_samples_per_second'</span>: 70.544, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_steps_per_second'</span>: 0.367, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_tokens_per_second'</span>: 376.234, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_loss'</span>: 2.977239990234375, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-345"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*****</span> train metrics <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*****</span></span>
<span id="cb25-346"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epoch</span>                    =        1.0</span>
<span id="cb25-347"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_input_tokens_seen</span>    =     245760</span>
<span id="cb25-348"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_loss</span>               =     2.9772</span>
<span id="cb25-349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_runtime</span>            = 0:00:27.21</span>
<span id="cb25-350"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_samples</span>            =     726000</span>
<span id="cb25-351"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_samples_per_second</span> =     70.544</span>
<span id="cb25-352"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_steps_per_second</span>   =      0.367</span>
<span id="cb25-353"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_tokens_per_second</span>  =    376.234</span>
<span id="cb25-354"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_loss'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.6778849363327026, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_accuracy'</span>: 0.6173228346456693, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_runtime'</span>: 7.9617, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_samples_per_second'</span>: 0.377, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval_steps_per_second'</span>: 0.126, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: 1.0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_input_tokens_seen'</span>: 245760}</span>
<span id="cb25-355"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*****</span> eval metrics <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*****</span></span>
<span id="cb25-356"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epoch</span>                   =        1.0</span>
<span id="cb25-357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_accuracy</span>           =     0.6173</span>
<span id="cb25-358"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_loss</span>               =     1.6779</span>
<span id="cb25-359"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_runtime</span>            = 0:00:07.96</span>
<span id="cb25-360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_samples</span>            =         50</span>
<span id="cb25-361"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_samples_per_second</span> =      0.377</span>
<span id="cb25-362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_steps_per_second</span>   =      0.126</span>
<span id="cb25-363"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_input_tokens_seen</span>   =     245760</span>
<span id="cb25-364"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">perplexity</span>              =     5.3542</span>
<span id="cb25-365"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Application</span> 3917764c resources: utime=2709s stime=1798s maxrss=15499424KB inblock=959040 oublock=38691080 minflt=31555618 majflt=73083 nvcsw=1288306 nivcsw=2040486</span>
<span id="cb25-366"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:27:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:201</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Execution finished @ 2025-05-06-222737</span>
<span id="cb25-367"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-06</span> 22:27:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/launch:202</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Command took 93.85 seconds to run. Exiting.</span>
<span id="cb25-368"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:01m:45s</span></code></pre></div></div>
</details></li>
</ul>
</section>
<section id="megatron-deepspeed" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="megatron-deepspeed">üèéÔ∏è Megatron-DeepSpeed</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/argonne-lcf/Megatron-DeepSpeed</span>
<span id="cb26-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> Megatron-DeepSpeed</span>
<span id="cb26-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb26-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-5">    deepspeed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz"</span></span>
<span id="cb26-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> train_alcf.sh</span></code></pre></div></div>
</section>
<section id="acknowledgements" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="acknowledgements">üôå Acknowledgements</h2>
<blockquote class="blockquote">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</blockquote>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In <em>general</em>, you should be wary of running random scripts from the internet.‚Ü©Ô∏é</p></li>
<li id="fn2"><p><a href="https://bit.ly/ezpz-utils">https://bit.ly/ezpz-utils</a>, since <a href="https://raw.githubusercontent.com/saforem2/ezpz/main/bin/utils.sh">https://raw.githubusercontent.com/saforem2/ezpz/main/bin/utils.sh</a> is a bit of a pain‚Ü©Ô∏é</p></li>
<li id="fn3"><p>e.g.&nbsp;<code>${NHOSTS}</code>, <code>${NGPU_PER_HOST}</code>, <code>${NGPUS}</code>, ‚Ä¶‚Ü©Ô∏é</p></li>
<li id="fn4"><p><em>Should also work with SLURM</em> (needs further testing)‚Ü©Ô∏é</p></li>
<li id="fn5"><p>On any of the ALCF systems, including: <a href="https://alcf.anl.gov/aurora">Aurora</a>, <a href="https://alcf.anl.gov/polaris">Polaris</a>, ‚Ä¶, etc.‚Ü©Ô∏é</p></li>
<li id="fn6"><p>Or, for example, if you would like to exclude a node you suspect is having issues‚Ü©Ô∏é</p></li>
<li id="fn7"><p>You should <em>always</em> be working in a virtual environment. See: üèñÔ∏è Shell Environment‚Ü©Ô∏é</p></li>
<li id="fn8"><p>Will automatically be reported to W&amp;B if a run is detected‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2025,
  author = {Foreman, Sam},
  title = {LLMs on {Aurora:} {Hands-On}},
  date = {2025-05-07},
  url = {https://samforeman.me/talks/incite-hackathon-2025/ezpz/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúLLMs on Aurora: Hands-On.‚Äù</span> May 7. <a href="https://samforeman.me/talks/incite-hackathon-2025/ezpz/slides">https://samforeman.me/talks/incite-hackathon-2025/ezpz/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/incite-hackathon-2025/ezpz/</guid>
  <pubDate>Wed, 07 May 2025 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/incite-hackathon-2025/ezpz/assets/thumbnail.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>üöß Frameworks Issue with numpy &gt; 2</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/05/03/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>Something I just learned</p>
<p>The TensorFlow that is included in the new frameworks module (<code>aurora_nre_models_frameworks-2025.0.0</code>) was built with <code>numpy==1.26.4 (&lt; 2)</code>.</p>
<p>Unfortunately, if you then (for whatever reason) then tries to install / upgrade a package<sup>1</sup> that has <code>numpy</code> in its dependencies, e.g.:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span> transformers</span></code></pre></div></div>
<p>This will pull in <code>numpy &gt; 2</code>, effectively breaking the frameworks module.</p>
<p>In particular, any application that uses <a href="https://github.com/intel/intel-extension-for-pytorch"><code>intel/extension_for_pytorch</code></a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span></code></pre></div></div>
<p>Will crash with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">A</span> module that was compiled using NumPy 1.x cannot be run in</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NumPy</span> 2.2.5 as it may crash. To support both 1.x and 2.x</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">versions</span> of NumPy, modules must be compiled with NumPy 2.0.</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Some</span> module may need to rebuild instead e.g. with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pybind11&gt;=2.12'</span>.</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> is obviously frustrating for an application that is only using PyTorch.</span></code></pre></div></div>
<p>Following through the stack trace, I see that the error is actually coming from <a href="https://github.com/huggingface/transformers/image_transforms.py#L47">huggingface/transformers/image_transforms.py#L47</a>.</p>
<p>Digging around a bit more I found there is a flag in <code>transformers</code> that allows you to bypass the entire <code>import tensorflow as tf</code> logic:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_TORCH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span></code></pre></div></div>
<p>which not only prevents things from crashing with <code>numpy &gt; 2</code>, but is also noticeably quicker.</p>
<section id="reinstall-modules-built-with-numpy-2" class="level2">
<h2 class="anchored" data-anchor-id="reinstall-modules-built-with-numpy-2">Reinstall Modules built with <code>numpy &lt; 2</code></h2>
<p>In addition to <code>tensorflow</code>, it seems that: { <code>jax</code>, <code>jaxlib</code>, <code>ml-dtypes</code>, <code>opt-einsum</code>, <code>scipy</code> } were <em>all</em> built with <code>numpy &lt; 2</code>, and so need to be rebuilt after upgrading numpy.</p>
<p>To do so:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span>  numpy jax jaxlib ml-dtypes opt-einsum scipy transformers</span></code></pre></div></div>
<p>‚úÖ Now, we‚Äôre able to successfully:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/03/25 @ 12:12:29][x4515c7s4b0n0][/f/d/f/p/s/ezpz][üå± update-utils][üì¶ü§∑‚úì] [‚è±Ô∏è 25s]</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_TORCH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import numpy as np; print(np.__version__) ; import ezpz '</span></span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.2.5</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W503</span> 12:12:34.201673197 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb6-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb6-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb6-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb6-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb6-11">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-03</span> 12:13:18]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils/_logger:68:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Unable to import deepspeed. Please install it to use DeepSpeed features.</span>
<span id="cb6-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:48s</span></code></pre></div></div>
</section>
<section id="profiles-and-timing-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="profiles-and-timing-comparisons">Profiles and Timing Comparisons</h2>
<p>Below we present timing profiles obtained from</p>
<ul>
<li><a href="https://github.com/sharkdp/hyperfine"><code>hyperfine</code></a>: A command-line benchmarking tool</li>
<li><a href="https://github.com/joerick/pyinstrument"><code>pyinstrument</code></a>: A call stack profiler for Python</li>
</ul>
<p>Below we present the profiles obtained by the usual mechanism, i.e.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"venvs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_PREFIX})</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> venvs/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_PREFIX})</span>/bin/activate</span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz"</span></span></code></pre></div></div>
<section id="default-behavior" class="level3">
<h3 class="anchored" data-anchor-id="default-behavior">DEFAULT BEHAVIOR</h3>
<section id="bash-profile-hyperfine" class="level5">
<h5 class="anchored" data-anchor-id="bash-profile-hyperfine">Bash Profile (<code>hyperfine</code>)</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> hyperfine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-runs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--shell</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>zsh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--show-output</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz_init() { $(which python3) -c "import ezpz" }; ezpz_init'</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mean</span> ¬± œÉ<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>     10.754 s ¬±  0.122 s    [User: 14.574 s, System: 12.795 s]</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Range</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min</span> ‚Ä¶ max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>   10.467 s ‚Ä¶ 10.910 s    10 runs</span></code></pre></div></div>
</section>
<section id="python-profile-pyinstrument" class="level4">
<h4 class="anchored" data-anchor-id="python-profile-pyinstrument">Python Profile (<code>pyinstrument</code>)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> pyinstrument <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import ezpz'</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12.021</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/__init__.py:1</span>
<span id="cb9-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 8.624 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/dist.py:1</span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 8.542 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  intel_extension_for_pytorch/__init__.py:1</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [206 frames hidden]  intel_extension_for_pytorch, transfor...</span>
<span id="cb9-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           0.247 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  torch/utils/_sympy/functions.py:1</span>
<span id="cb9-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚îî‚îÄ 0.241 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/__init__.py:1</span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>              ‚îî‚îÄ 0.126 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/polys/__init__.py:1</span></code></pre></div></div>
</section>
</section>
<section id="with-use_torch1-and-numpy2.2.5" class="level3">
<h3 class="anchored" data-anchor-id="with-use_torch1-and-numpy2.2.5">WITH <code>USE_TORCH=1</code> and <code>numpy==2.2.5</code></h3>
<p>Below we present the profiles and timing measurements obtained:</p>
<ol type="1">
<li><p>After upgrading <code>numpy==2.25</code></p></li>
<li><p>Skipping the <code>import tensorflow as tf</code> logic in <code>transformers</code> by specifying <code>USE_TORCH=1</code>, explicitly.</p></li>
</ol>
<section id="bash-profile-hyperfine-1" class="level4">
<h4 class="anchored" data-anchor-id="bash-profile-hyperfine-1">Bash Profile (<code>hyperfine</code>)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> hyperfine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-runs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--shell</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>zsh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--show-output</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz_init() { USE_TORCH=1 $(which python3) -c "import ezpz" }; ezpz_init'</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mean</span> ¬± œÉ<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>      7.491 s ¬±  0.162 s    [User: 12.130 s, System: 11.940 s]</span>
<span id="cb10-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Range</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min</span> ‚Ä¶ max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>    7.311 s ‚Ä¶  7.883 s    10 runs</span></code></pre></div></div>
</section>
<section id="python-profile-pyinstrument-1" class="level4">
<h4 class="anchored" data-anchor-id="python-profile-pyinstrument-1">Python Profile (<code>pyinstrument</code>)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> USE_TORCH=1 pyinstrument <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import ezpz'</span></span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.478</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/__init__.py:1</span>
<span id="cb11-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 5.109 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/dist.py:1</span>
<span id="cb11-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 5.016 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  intel_extension_for_pytorch/__init__.py:1</span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [174 frames hidden]  intel_extension_for_pytorch, transfor...</span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           0.249 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  torch/utils/_sympy/functions.py:1</span>
<span id="cb11-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚îî‚îÄ 0.241 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/__init__.py:1</span>
<span id="cb11-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>              ‚îî‚îÄ 0.124 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/polys/__init__.py:1</span></code></pre></div></div>
</section>
</section>
</section>
<section id="stack-trace-from-numpy-2-issue" class="level2">
<h2 class="anchored" data-anchor-id="stack-trace-from-numpy-2-issue">Stack Trace from <code>numpy &gt; 2</code> issue</h2>
<details closed="">
<summary>
Stack Trace
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/02/25 @ 15:46:43][x4005c2s6b0n0][/f/d/f/p/s/t/2/ezpz][üå± update-utils][‚úì] [‚è±Ô∏è 19s]</span></span>
<span id="cb12-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-test</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--profile</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tp</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pp</span> 4</span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W502</span> 16:00:18.739960487 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb12-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb12-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb12-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb12-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb12-10">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-11"></span>
<span id="cb12-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">A</span> module that was compiled using NumPy 1.x cannot be run in</span>
<span id="cb12-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NumPy</span> 2.2.5 as it may crash. To support both 1.x and 2.x</span>
<span id="cb12-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">versions</span> of NumPy, modules must be compiled with NumPy 2.0.</span>
<span id="cb12-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Some</span> module may need to rebuild instead e.g. with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pybind11&gt;=2.12'</span>.</span>
<span id="cb12-16"></span>
<span id="cb12-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">If</span> you are a user of the module, the easiest solution will be to</span>
<span id="cb12-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">downgrade</span> to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'numpy&lt;2'</span> or try to upgrade the affected module.</span>
<span id="cb12-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">We</span> expect that some modules will need time to support NumPy 2.</span>
<span id="cb12-20"></span>
<span id="cb12-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Traceback</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>  File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/ezpz-test"</span>, line 6, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-22">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz.test import main</span>
<span id="cb12-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/src/ezpz/__init__.py"</span>, line 102, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-24">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz.dist import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/src/ezpz/dist.py"</span>, line 42, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch as ipex  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type:ignore[missingTypeStubs]</span></span>
<span id="cb12-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/__init__.py"</span>, line 128, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> . import xpu</span>
<span id="cb12-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/xpu/__init__.py"</span>, line 20, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-30">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .utils import <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb12-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/xpu/utils.py"</span>, line 7, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .. import frontend</span>
<span id="cb12-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/frontend.py"</span>, line 9, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-34">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .nn import utils</span>
<span id="cb12-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/__init__.py"</span>, line 6, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-36">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .modules import FrozenBatchNorm2d</span>
<span id="cb12-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/modules/__init__.py"</span>, line 11, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-38">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ...cpu.nn.linear_fuse_eltwise import IPEXLinearEltwise</span>
<span id="cb12-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/nn/linear_fuse_eltwise.py"</span>, line 3, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-40">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.nn.utils._weight_prepack import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/utils/__init__.py"</span>, line 1, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.nn.utils import _weight_prepack</span>
<span id="cb12-43">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/utils/_weight_prepack.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.cpu.tpp.utils.blocked_layout import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-45">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/tpp/__init__.py"</span>, line 2, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> . import fused_bert</span>
<span id="cb12-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/tpp/fused_bert.py"</span>, line 16, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-48">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_utils import apply_chunking_to_forward</span>
<span id="cb12-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/modeling_utils.py"</span>, line 69, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-50">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .loss.loss_utils import LOSS_MAPPING</span>
<span id="cb12-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/loss/loss_utils.py"</span>, line 21, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-52">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .loss_deformable_detr import DeformableDetrForObjectDetectionLoss, DeformableDetrForSegmentationLoss</span>
<span id="cb12-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/loss/loss_deformable_detr.py"</span>, line 4, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-54">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ..image_transforms import center_to_corners_format</span>
<span id="cb12-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/image_transforms.py"</span>, line 47, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-56">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> tensorflow as tf</span>
<span id="cb12-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/__init__.py"</span>, line 48, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-58">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow._api.v2 import __internal__</span>
<span id="cb12-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/_api/v2/__internal__/__init__.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-60">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow._api.v2.__internal__ import autograph</span>
<span id="cb12-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/_api/v2/__internal__/autograph/__init__.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-62">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.core.ag_ctx import control_status_ctx <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># line: 34</span></span>
<span id="cb12-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/core/ag_ctx.py"</span>, line 21, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-64">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.utils import ag_logging</span>
<span id="cb12-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/utils/__init__.py"</span>, line 17, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-66">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.utils.context_managers import control_dependency_on_returns</span>
<span id="cb12-67">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/utils/context_managers.py"</span>, line 19, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-68">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.framework import ops</span>
<span id="cb12-69">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/framework/ops.py"</span>, line 41, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-70">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python import pywrap_tfe</span>
<span id="cb12-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/pywrap_tfe.py"</span>, line 25, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-72">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python._pywrap_tfe import <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb12-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AttributeError:</span> _ARRAY_API not found</span>
<span id="cb12-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AttributeError:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MessageFactory'</span> object has no attribute <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetPrototype'</span></span>
<span id="cb12-75"></span>
<span id="cb12-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span></code></pre></div></div>
</details>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This is a lot of packages, including: { <code>torch</code>, <code>jax</code>, <code>tensorflow</code>, <code>scipy</code>, <code>jaxlib</code>, <code>numpy</code>, <code>ml-dtypes</code>, <code>opt-einsum</code>, ‚Ä¶, }.‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üöß {Frameworks} {Issue} with \textless Code\textgreater numpy
    \textgreater{} 2\textless/Code\textgreater{}},
  date = {2025-05-03},
  url = {https://samforeman.me/posts/2025/05/03/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüöß Frameworks Issue with &lt;Code&gt;numpy
&gt; 2&lt;/Code&gt;.‚Äù</span> May 3, 2025. <a href="https://samforeman.me/posts/2025/05/03/">https://samforeman.me/posts/2025/05/03/</a>.
</div></div></section></div> ]]></description>
  <category>frameworks</category>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/2025/05/03/</guid>
  <pubDate>Sat, 03 May 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üî• Building PyTorch 2.6 from Source on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/04/28/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="pytorch-2.6-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="pytorch-2.6-on-aurora">PyTorch 2.6 on Aurora</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKLDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_FBGEMM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_QNNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_CAFFE2_OPS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_TEST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_DISTRIBUTED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-19"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NUMA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MPI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-22"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTEL_MKL_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$MKLROOT</span></span>
<span id="cb1-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_AOT_DEVLIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb1-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TORCH_XPU_ARCH_LIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb1-26"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OCLOC_VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24.39.1</span>
<span id="cb1-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> gcc</span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /opt/aurora/24.347.0/spack/unified/0.9.1/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/gcc</span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/usr/bin/gcc</span></span>
<span id="cb1-30"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> g++</span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/opt/aurora/24.347.0/spack/unified/0.9.1/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/g++</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/usr/bin/g++</span></span>
<span id="cb1-33"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/pytorch.git</span>
<span id="cb1-34"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> pytorch</span>
<span id="cb1-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout v2.6.0</span>
<span id="cb1-36"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force</span></span>
<span id="cb1-37"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> triton</span>
<span id="cb1-38"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DEBUG</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"build_whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NOW}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb1-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/torch-2.6.0a0+git1eba9b3-cp310-cp310-linux_x86_64.whl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force-reinstall</span></span>
<span id="cb1-40"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install intel-extension-for-pytorch==2.6.10+xpu oneccl_bind_pt==2.6.0+xpu <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--extra-index-url</span> https://pytorch-extension.intel.com/release-whl/stable/xpu/us/</span></code></pre></div></div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üî• {Building} {PyTorch} 2.6 from {Source} on {Aurora}},
  date = {2025-04-28},
  url = {https://samforeman.me/posts/2025/04/28/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüî• Building PyTorch 2.6 from Source on
Aurora.‚Äù</span> April 28, 2025. <a href="https://samforeman.me/posts/2025/04/28/">https://samforeman.me/posts/2025/04/28/</a>.
</div></div></section></div> ]]></description>
  <category>pytorch</category>
  <category>Aurora</category>
  <guid>https://samforeman.me/posts/2025/04/28/</guid>
  <pubDate>Mon, 28 Apr 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üë§ R√©sum√©</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/resume/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="sam-foreman" class="level2">
<h2 class="anchored" data-anchor-id="sam-foreman">Sam Foreman</h2>
<p>Computational Scientist<br>
<a href="https://samforeman.me">samforeman.me</a><br>
<a href="https://github.com/saforem2">GitHub</a> ‚Ä¢ <a href="https://scholar.google.com/citations?user=vV_1zDwAAAAJ&amp;hl=en">Google Scholar</a> ‚Ä¢ <a href="https://orcid.org/0000-0002-9981-0876">ORCID</a> ‚Ä¢ <a href="https://twitter.com/saforem2">Twitter</a></p>
<section id="r√©sum√©" class="level3">
<h3 class="anchored" data-anchor-id="r√©sum√©">R√©sum√©</h3>
<section id="education" class="level4">
<h4 class="anchored" data-anchor-id="education">üéì Education</h4>
<ul>
<li><strong>Ph.D., Physics</strong>
<ul>
<li>University of Iowa, 2019<br>
</li>
<li><a href="https://www.proquest.com/openview/95d7f7c12da8da8aa5ead3ac0f6ca0e8/1?cbl=18750&amp;diss=y&amp;pq-origsite=gscholar"><em>Learning Better Physics: A Machine Learning Approach to Lattice Gauge Theory</em></a></li>
</ul></li>
<li><strong>B.S. in Engineering Physics</strong>
<ul>
<li>University of Illinois at Urbana-Champaign, 2015</li>
<li><a href="https://patents.google.com/patent/US9741492B2/en">Energy Storage in Quantum Resonators (US Patent #US9741492B2)</a></li>
</ul></li>
<li><strong>B.S. in Applied Mathematics</strong>
<ul>
<li>University of Illinois at Urbana-Champaign, 2015</li>
</ul></li>
</ul>
</section>
<section id="professional-experience" class="level4">
<h4 class="anchored" data-anchor-id="professional-experience">üßë‚Äçüî¨ Professional Experience</h4>
<ul>
<li><strong>Assistant Computational Scientist</strong>
<ul>
<li>Argonne National Laboratory, Argonne Leadership Computing Facility (ALCF)<br>
</li>
<li><em>Lemont, IL | 2022 ‚Äì Present</em>
<ul>
<li>Research lead on scaling large language models (LLMs) and generative AI for science on supercomputers (Aurora, Frontier, LUMI, Leonardo, ‚Ä¶).
<ul>
<li>Co-lead the Models and Pretraining team of the <a href="https://auroragpt.anl.gov">AuroraGPT</a> project</li>
</ul></li>
<li>Optimize large-scale training of foundation models and language models for scientific applications.<br>
</li>
<li>Collaborate with interdisciplinary teams to enhance simulation efficiency and scalability</li>
<li>Focus on AI and HPC for scientific applications, including:
<ul>
<li>Training large language models on supercomputers</li>
<li>Genome scale language models (GenSLMs) for studying SARS-CoV-2 evolutionary dynamics</li>
<li>Direct Preference Optimization (DPO) for multimodal protein design workflows</li>
<li>Climate modeling and weather forecasting using foundation models</li>
<li>Developing improved sampling algorithms for lattice quantum chromodynamics (QCD)</li>
</ul></li>
<li><a href="https://www.alcf.anl.gov/about/people/sam-foreman">https://www.alcf.anl.gov/about/people/sam-foreman</a></li>
</ul></li>
</ul></li>
<li><strong>Postdoctoral Researcher</strong>
<ul>
<li>Argonne National Laboratory, Argonne Leadership Computing Facility (ALCF)<br>
</li>
<li><em>Lemont, IL | 2019 ‚Äì 2022</em>
<ul>
<li>Applied deep learning to lattice gauge theory and quantum field simulations.</li>
<li>Developed ML-enhanced Monte Carlo methods for QCD.</li>
<li>Engaged in AI-for-Science collaborations with national labs and university partners.</li>
</ul></li>
</ul></li>
<li><strong>Graduate Researcher</strong>
<ul>
<li>Argonne National Laboratory, Math and Computer Sciences (MCS)</li>
<li><em>Lemont, IL | 2018 ‚Äì 2019</em><br>
</li>
<li>Collaborated with ALCF while completing Ph.D., integrating ML into physical sciences workflows.</li>
</ul></li>
</ul>
</section>
<section id="awards-and-honors" class="level4">
<h4 class="anchored" data-anchor-id="awards-and-honors">üèÜ Awards and Honors</h4>
<ul>
<li><strong>ACM Gordon Bell Special Prize for High Performance Computing-Based COVID-19 Research</strong>, 2022
<ul>
<li>Recognized for contributions to the GenSLMs project, which developed genome-scale language models to study SARS-CoV-2 evolutionary dynamics.</li>
<li><a href="https://www.acm.org/media-center/2022/november/gordon-bell-special-prize-covid-research-2022">https://www.acm.org/media-center/2022/november/gordon-bell-special-prize-covid-research-2022</a></li>
</ul></li>
<li><strong>Finalist, ACM Gordon Bell Prize</strong>, 2024
<ul>
<li>Acknowledged for the MProt-DPO project, which achieved over 4 ExaFLOP sustained performance in multimodal protein design workflows using Direct Preference Optimization.</li>
<li><a href="https://sc.cels.anl.gov/gordon-bell-argonne-team-breaks-new-ground-in-ai-driven-protein-design/">https://sc.cels.anl.gov/gordon-bell-argonne-team-breaks-new-ground-in-ai-driven-protein-design/</a></li>
</ul></li>
<li><strong>DOE Office of Science Graduate Student Research Fellow</strong>, 2018
<ul>
<li>Awarded by the Department of Energy for outstanding research contributions during graduate studies.</li>
</ul></li>
</ul>
</section>
<section id="publicationspublications" class="level4">
<h4 class="anchored" data-anchor-id="publicationspublications">üìö Publications<sup>1</sup></h4>
<ul>
<li><a href="https://www.researchgate.net/publication/387390653_MProt-DPO_Breaking_the_ExaFLOPS_Barrier_for_Multimodal_Protein_Design_Workflows_with_Direct_Preference_Optimization"><strong>MProt-DPO: Breaking the ExaFLOPS Barrier for Multimodal Protein Design Workflows with Direct Preference Optimization</strong></a></li>
<li><a href="https://doi.org/10.1177/10943420231184990"><strong>GenSLMs: Genome-Scale Language Models Reveal SARS-CoV-2 Evolutionary Dynamics</strong></a></li>
<li><a href="https://arxiv.org/abs/2202.05838"><strong>Applications of Machine Learning to Lattice Quantum Field Theory</strong></a></li>
<li><a href="https://arxiv.org/abs/2112.01586"><strong>HMC with Normalizing Flows</strong></a></li>
<li><a href="https://arxiv.org/abs/2105.03418"><strong>Deep Learning Hamiltonian Monte Carlo</strong></a></li>
<li><a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.98.052129"><strong>Examples of Renormalization Group Transformations for Image Sets</strong></a></li>
</ul>
</section>
<section id="selected-talkstalks" class="level4">
<h4 class="anchored" data-anchor-id="selected-talkstalks">üé§ Selected Talks<sup>2</sup></h4>
<ul>
<li><a href="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/"><strong>AuroraGPT: Foundation Models for Science</strong></a> @ <a href="https://www.alcf.anl.gov/alcf-ai-science-training-series"><em>Foundation Models for the Electric Grid</em></a> [02/2025]</li>
<li><a href="https://samforeman.me/talks/ai-for-science-2024/"><strong>Parallel Training Methods</strong></a> @ <a href="https://www.alcf.anl.gov/alcf-ai-science-training-series"><em>AI-for-Science on Supercomputers</em></a> [11/2024]</li>
<li><a href="https://samforeman.me/talks/hpc-user-forum/"><strong>AuroraGPT</strong></a> @ <a href="https://www.hpcuserforum.com/hpc-user-forum-fall-2024/"><em>HPC User Forum</em>, 2024</a> [09/2024]</li>
<li><a href="https://samforeman.me/talks/alcf-hpc-workshop-2024/"><strong>Machine Learning and Foundation Models at Scale</strong></a> @ <a href="https://www.alcf.anl.gov/events/2024-alcf-hands-hpc-workshop"><em>2024 ALCF Hands-On HPC Workshop</em></a> [10/2024]</li>
<li><a href="https://samforeman.me/talks/llms-at-scale/"><strong>Training LLMs at Scale</strong></a> @ <a href="https://extremecomputingtraining.anl.gov/atpesc-2024/"><em>ATPESC</em>, 2024</a> [08/2024]</li>
<li><a href="https://saforem2.github.io/llm-workshop-talk"><strong>LLMs from Scratch</strong></a> @ <a href="https://github.com/argonne-lcf/llm-workshop">LLM Tutorial Workshop</a> [02/2024]</li>
<li><a href="https://saforem2.github.io/oneapi-talk"><strong>Exascale Science on Aurora</strong></a> @ <a href="https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop">Intel oneAPI Workshop @ UIC</a> [10/2023]</li>
<li><a href="https://saforem2.github.io/scaling4science"><strong>Scaling LLMs for Science</strong></a> @ <a href="https://events.cels.anl.gov/event/426/overview">Data-Intensive Computing + AI/ML at Scale</a> [08/2023]</li>
<li><a href="https://saforem2.github.io/lattice23"><strong>MLMC: Machine Learning Monte Carlo</strong></a> @ <a href="https://indico.fnal.gov/event/57249/contributions/271305/">Lattice 2023</a> [07/2023]</li>
<li><a href="https://saforem2.github.io/lqcd-pasc23/"><strong>Generative Modeling and Efficient Sampling</strong></a> @ <a href="https://pasc23.pasc-conference.org/">PASC23</a> [07/2023]</li>
</ul>



</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><em>See full list on <a href="https://scholar.google.com/citations?user=vV_1zDwAAAAJ&amp;hl=en">Google Scholar</a></em>‚Ü©Ô∏é</p></li>
<li id="fn2"><p><em>See full list at: <a href="https://samforeman.me/talks/">samforeman.me/talks</a></em>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üë§ {R√©sum√©}},
  date = {2025-04-26},
  url = {https://samforeman.me/posts/resume/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüë§ R√©sum√©.‚Äù</span> April 26, 2025. <a href="https://samforeman.me/posts/resume/">https://samforeman.me/posts/resume/</a>.
</div></div></section></div> ]]></description>
  <category>CV</category>
  <category>personal</category>
  <category>r√©sum√©</category>
  <guid>https://samforeman.me/posts/resume/</guid>
  <pubDate>Sat, 26 Apr 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>ü™õ Torchtune on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/torchtune-aurora/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="patch-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="patch-on-aurora">Patch on Aurora</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource diff number-lines code-with-copy"><code class="sourceCode diff"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">diff --git a/torchtune/training/_distributed.py b/torchtune/training/_distributed.py</span></span>
<span id="cb1-2">index ff959c5f..c3966290 100644</span>
<span id="cb1-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">--- a/torchtune/training/_distributed.py</span></span>
<span id="cb1-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">+++ b/torchtune/training/_distributed.py</span></span>
<span id="cb1-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -14,7 +14,11 @@ import torch</span></span>
<span id="cb1-6"> import torch.distributed as dist</span>
<span id="cb1-7"> from torch import nn</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-from torch.distributed._composable.fsdp import CPUOffloadPolicy, fully_shard</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+try:</span></span>
<span id="cb1-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp import fully_shard</span></span>
<span id="cb1-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp.fully_shard import fully_shard</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15"> from torch.distributed._tensor import distribute_tensor, DTensor</span>
<span id="cb1-16"> from torch.distributed._tensor.placement_types import DTensorSpec, TensorMeta</span>
<span id="cb1-17"> from torch.distributed.checkpoint.state_dict import (</span>
<span id="cb1-18"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -532,6 +536,11 @@ def shard_model(</span></span>
<span id="cb1-19">     """</span>
<span id="cb1-20">     fsdp_kwargs = {"reshard_after_forward": reshard_after_forward}</span>
<span id="cb1-21">     if cpu_offload:</span>
<span id="cb1-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        try:</span></span>
<span id="cb1-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp import CPUOffloadPolicy</span></span>
<span id="cb1-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp._fsdp_api import MixedPrecisionPolicy, CPUOffloadPolicy</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            # from torch.distributed._composable import CPUOffloadPolicy</span></span>
<span id="cb1-27">         fsdp_kwargs["offload_policy"] = CPUOffloadPolicy()</span>
<span id="cb1-28"></span>
<span id="cb1-29">     # Shard the model with FSDP, iterating in reverse to start with</span></code></pre></div></div>
</section>
<section id="using-pytorch-2.5" class="level2">
<h2 class="anchored" data-anchor-id="using-pytorch-2.5">Using PyTorch 2.5</h2>
<p>Using the new enviroment with <code>pytorch==2.5</code> and after applying the above patch, I am almost able to get things working before ultimately crashing with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: Tried to instantiate dummy base class Stream</span></code></pre></div></div>
<p>The full command (and output) are included below:</p>
<ul>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç anl_2024_12_release_2](üëª anl_2024_12_release_2)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:47:46 AM][x4204c5s6b0n0][/f/A/f/p/p/torchtune][üå± main][!?][‚è±Ô∏è 2s]</span></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full optimizer.fused=False</span></code></pre></div></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output:</p>
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W128</span> 08:49:19.162113524 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:823</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gloo'</span> for distributed training.</span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:869</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4204c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config/_utils:28:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running FullFinetuneRecipeDistributed with resolved config:</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">batch_size:</span> 2</span>
<span id="cb4-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpointer:</span></span>
<span id="cb4-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.FullModelHFCheckpointer</span>
<span id="cb4-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_dir:</span> Meta-Llama-3.1-8B-Instruct/</span>
<span id="cb4-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_files:</span></span>
<span id="cb4-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00001-of-00004.safetensors</span>
<span id="cb4-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00002-of-00004.safetensors</span>
<span id="cb4-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00003-of-00004.safetensors</span>
<span id="cb4-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00004-of-00004.safetensors</span>
<span id="cb4-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model_type:</span> LLAMA3</span>
<span id="cb4-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb4-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_checkpoint:</span> null</span>
<span id="cb4-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad_norm:</span> null</span>
<span id="cb4-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compile:</span> false</span>
<span id="cb4-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">custom_sharded_layers:</span></span>
<span id="cb4-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> tok_embeddings</span>
<span id="cb4-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> output</span>
<span id="cb4-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset:</span></span>
<span id="cb4-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.datasets.alpaca_dataset</span>
<span id="cb4-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">packed:</span> false</span>
<span id="cb4-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">device:</span> xpu</span>
<span id="cb4-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtype:</span> bf16</span>
<span id="cb4-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_checkpointing:</span> false</span>
<span id="cb4-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_offloading:</span> false</span>
<span id="cb4-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epochs:</span> 1</span>
<span id="cb4-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_steps:</span> 1</span>
<span id="cb4-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_every_n_steps:</span> 1</span>
<span id="cb4-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_peak_memory_stats:</span> true</span>
<span id="cb4-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span></span>
<span id="cb4-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.modules.loss.CEWithChunkedOutputLoss</span>
<span id="cb4-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_steps_per_epoch:</span> null</span>
<span id="cb4-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">metric_logger:</span></span>
<span id="cb4-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.metric_logging.DiskLogger</span>
<span id="cb4-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_dir:</span> /tmp/torchtune/llama3_1_8B/full/logs</span>
<span id="cb4-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model:</span></span>
<span id="cb4-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3_1.llama3_1_8b</span>
<span id="cb4-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer:</span></span>
<span id="cb4-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torch.optim.AdamW</span>
<span id="cb4-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> false</span>
<span id="cb4-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 2.0e-05</span>
<span id="cb4-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer_in_bwd:</span> false</span>
<span id="cb4-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb4-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profiler:</span></span>
<span id="cb4-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.setup_torch_profiler</span>
<span id="cb4-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">active_steps:</span> 2</span>
<span id="cb4-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu:</span> true</span>
<span id="cb4-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cuda:</span> true</span>
<span id="cb4-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled:</span> false</span>
<span id="cb4-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_cycles:</span> 1</span>
<span id="cb4-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full/profiling_outputs</span>
<span id="cb4-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_memory:</span> false</span>
<span id="cb4-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">record_shapes:</span> true</span>
<span id="cb4-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wait_steps:</span> 5</span>
<span id="cb4-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warmup_steps:</span> 3</span>
<span id="cb4-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_flops:</span> false</span>
<span id="cb4-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_stack:</span> false</span>
<span id="cb4-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume_from_checkpoint:</span> false</span>
<span id="cb4-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed:</span> null</span>
<span id="cb4-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle:</span> true</span>
<span id="cb4-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer:</span></span>
<span id="cb4-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3.llama3_tokenizer</span>
<span id="cb4-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_seq_len:</span> null</span>
<span id="cb4-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path:</span> Meta-Llama-3.1-8B-Instruct/original/tokenizer.model</span>
<span id="cb4-75"></span>
<span id="cb4-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:141:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> log_peak_memory_stats was set to True, however, training does not use cuda. Setting log_peak_memory_stats=False.</span>
<span id="cb4-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/training/checkpointing/_checkpoint_client.py:75:</span> FutureWarning: get_world_size_and_rank is deprecated and will be removed in future versions. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> will move to <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils._device</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> in future releases. Please use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils.get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> instead.</span>
<span id="cb4-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_,</span> self._rank = training.get_world_size_and_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">D</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/seed:60:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting manual seed to local seed 4028640460. Local seed is seed + rank = 4028640460 + 0</span>
<span id="cb4-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Writing</span> logs to /tmp/torchtune/llama3_1_8B/full/logs/log_1738075777.txt</span>
<span id="cb4-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:39]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:499:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> FSDP is enabled. Instantiating model and loading checkpoint on Rank 0 ...</span>
<span id="cb4-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/tensor/_random.py:45:</span> UserWarning: DTensor random operators may not have complete support on cpu device mesh</span>
<span id="cb4-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warnings.warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb4-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:568:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Instantiating model and loading checkpoint took 13.79 secs</span>
<span id="cb4-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/memory:301:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Memory stats after model init:</span>
<span id="cb4-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory allocation: 1.04 GiB</span>
<span id="cb4-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory reserved: 1.14 GiB</span>
<span id="cb4-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory active: 1.04 GiB</span>
<span id="cb4-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:632:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Optimizer is initialized.</span>
<span id="cb4-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:317:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Loss is initialized.</span>
<span id="cb4-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:685:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Dataset and Sampler are initialized.</span>
<span id="cb4-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:382:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> No learning rate scheduler configured. Using constant learning rate.</span>
<span id="cb4-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/_profiler:53:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiling disabled.</span>
<span id="cb4-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:467:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiler config after instantiation: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}</span>
<span id="cb4-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: Traceback <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb4-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/venvs/anl_2024_12_release_2/bin/tune"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb4-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 49, in main</span>
<span id="cb4-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     parser.run<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 43, in run</span>
<span id="cb4-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args.func<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 214, in _run_cmd</span>
<span id="cb4-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._run_single_device<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args,</span> is_builtin=is_builtin<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 108, in _run_single_device</span>
<span id="cb4-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     runpy.run_path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args.recipe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> run_name=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 289, in run_path</span>
<span id="cb4-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return _run_module_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> init_globals, run_name,</span>
<span id="cb4-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 96, in _run_module_code</span>
<span id="cb4-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     _run_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> mod_globals, init_globals,</span>
<span id="cb4-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 86, in _run_code</span>
<span id="cb4-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     exec<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> run_globals<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 928, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb4-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe_main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/config/_parse.py"</span>, line 99, in wrapper</span>
<span id="cb4-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_main</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb4-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 923, in recipe_main</span>
<span id="cb4-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     recipe.train<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 749, in train</span>
<span id="cb4-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     logits = self._model<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">**batch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1736, in _wrapped_call_impl</span>
<span id="cb4-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return self._call_impl<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1844, in _call_impl</span>
<span id="cb4-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return inner<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1769, in inner</span>
<span id="cb4-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args_kwargs_result = hook<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type: ignore[misc]</span></span>
<span id="cb4-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 66, in fsdp_hook_wrapper</span>
<span id="cb4-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return torch._dynamo.disable<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func,</span> recursive=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py"</span>, line 632, in _fn</span>
<span id="cb4-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return fn<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 224, in _pre_forward</span>
<span id="cb4-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args, kwargs = self._root_pre_forward<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 117, in _root_pre_forward</span>
<span id="cb4-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 175, in _lazy_init</span>
<span id="cb4-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._init_shared_state<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 183, in _init_shared_state</span>
<span id="cb4-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._comm_ctx.lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_param_group.py"</span>, line 48, in lazy_init</span>
<span id="cb4-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     raise RuntimeError<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FSDP requires CUDA for streams"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: FSDP requires CUDA for streams</span>
<span id="cb4-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb4-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    135144 exit 1     tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full</span>
<span id="cb4-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:55s</span></code></pre></div></div>
</details></li>
</ul>
</section>
<section id="using-pytorch-2.3" class="level2">
<h2 class="anchored" data-anchor-id="using-pytorch-2.3">Using PyTorch 2.3</h2>
<ul>
<li><p>Command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1](:ghost: aurora_nre_models_frameworks-2024.2.1_u1)</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:07:29 AM][x4204c5s6b0n0][/f/A/f/p/p/torchtune][:seedling: main][!?][:stopwatch: 13s]</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama4_1/8B_full optimizer.fused=False</span></code></pre></div></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output:</p>
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:823</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:869</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4204c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOCAL_RANK changed to be 0 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:-1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOCAL_SIZE changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:-1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_PROCESS_LAUNCHER changed to be none <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:hydra</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config/_utils:28:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running FullFinetuneRecipeDistributed with resolved config:</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">batch_size:</span> 2</span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpointer:</span></span>
<span id="cb6-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.FullModelHFCheckpointer</span>
<span id="cb6-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_dir:</span> Meta-Llama-3.1-8B-Instruct/</span>
<span id="cb6-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_files:</span></span>
<span id="cb6-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00001-of-00004.safetensors</span>
<span id="cb6-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00002-of-00004.safetensors</span>
<span id="cb6-16">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00003-of-00004.safetensors</span>
<span id="cb6-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00004-of-00004.safetensors</span>
<span id="cb6-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model_type:</span> LLAMA3</span>
<span id="cb6-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb6-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_checkpoint:</span> null</span>
<span id="cb6-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad_norm:</span> null</span>
<span id="cb6-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compile:</span> false</span>
<span id="cb6-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">custom_sharded_layers:</span></span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> tok_embeddings</span>
<span id="cb6-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> output</span>
<span id="cb6-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset:</span></span>
<span id="cb6-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.datasets.alpaca_dataset</span>
<span id="cb6-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">packed:</span> false</span>
<span id="cb6-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">device:</span> xpu</span>
<span id="cb6-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtype:</span> bf16</span>
<span id="cb6-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_checkpointing:</span> false</span>
<span id="cb6-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_offloading:</span> false</span>
<span id="cb6-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epochs:</span> 1</span>
<span id="cb6-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_steps:</span> 1</span>
<span id="cb6-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_every_n_steps:</span> 1</span>
<span id="cb6-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_peak_memory_stats:</span> true</span>
<span id="cb6-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span></span>
<span id="cb6-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.modules.loss.CEWithChunkedOutputLoss</span>
<span id="cb6-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_steps_per_epoch:</span> null</span>
<span id="cb6-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">metric_logger:</span></span>
<span id="cb6-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.metric_logging.DiskLogger</span>
<span id="cb6-42">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_dir:</span> /tmp/torchtune/llama3_1_8B/full/logs</span>
<span id="cb6-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model:</span></span>
<span id="cb6-44">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3_1.llama3_1_8b</span>
<span id="cb6-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer:</span></span>
<span id="cb6-46">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torch.optim.AdamW</span>
<span id="cb6-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> false</span>
<span id="cb6-48">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 2.0e-05</span>
<span id="cb6-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer_in_bwd:</span> false</span>
<span id="cb6-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb6-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profiler:</span></span>
<span id="cb6-52">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.setup_torch_profiler</span>
<span id="cb6-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">active_steps:</span> 2</span>
<span id="cb6-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu:</span> true</span>
<span id="cb6-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cuda:</span> true</span>
<span id="cb6-56">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled:</span> false</span>
<span id="cb6-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_cycles:</span> 1</span>
<span id="cb6-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full/profiling_outputs</span>
<span id="cb6-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_memory:</span> false</span>
<span id="cb6-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">record_shapes:</span> true</span>
<span id="cb6-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wait_steps:</span> 5</span>
<span id="cb6-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warmup_steps:</span> 3</span>
<span id="cb6-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_flops:</span> false</span>
<span id="cb6-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_stack:</span> false</span>
<span id="cb6-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume_from_checkpoint:</span> false</span>
<span id="cb6-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed:</span> null</span>
<span id="cb6-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle:</span> true</span>
<span id="cb6-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer:</span></span>
<span id="cb6-69">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3.llama3_tokenizer</span>
<span id="cb6-70">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_seq_len:</span> null</span>
<span id="cb6-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path:</span> Meta-Llama-3.1-8B-Instruct/original/tokenizer.model</span>
<span id="cb6-72"></span>
<span id="cb6-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:141:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> log_peak_memory_stats was set to True, however, training does not use cuda. Setting log_peak_memory_stats=False.</span>
<span id="cb6-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/training/checkpointing/_checkpoint_client.py:75:</span> FutureWarning: get_world_size_and_rank is deprecated and will be removed in future versions. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> will move to <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils._device</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> in future releases. Please use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils.get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> instead.</span>
<span id="cb6-75">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_,</span> self._rank = training.get_world_size_and_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">D</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/seed:60:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting manual seed to local seed 2201534845. Local seed is seed + rank = 2201534845 + 0</span>
<span id="cb6-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Writing</span> logs to /tmp/torchtune/llama3_1_8B/full/logs/log_1738073258.txt</span>
<span id="cb6-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:39]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:499:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> FSDP is enabled. Instantiating model and loading checkpoint on Rank 0 ...</span>
<span id="cb6-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_tensor/random.py:36:</span> UserWarning: DTensor random operators may not have complete support on cpu device mesh</span>
<span id="cb6-80">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warnings.warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb6-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:568:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Instantiating model and loading checkpoint took 5.74 secs</span>
<span id="cb6-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/memory:301:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Memory stats after model init:</span>
<span id="cb6-83">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory allocation: 1.04 GiB</span>
<span id="cb6-84">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory reserved: 1.14 GiB</span>
<span id="cb6-85">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory active: 1.04 GiB</span>
<span id="cb6-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:632:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Optimizer is initialized.</span>
<span id="cb6-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:317:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Loss is initialized.</span>
<span id="cb6-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">README.md:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7.47k/7.47k</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 85.6MB/s]</span>
<span id="cb6-89"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¶</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-00000-of-00001-a09b74b3ef9c3b56.parquet:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24.2M/24.2M</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 105MB/s]</span>
<span id="cb6-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Generating</span> train split: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">52002/52002</span> [00:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 45116.86 examples/s]</span>
<span id="cb6-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:685:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Dataset and Sampler are initialized.</span>
<span id="cb6-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:382:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> No learning rate scheduler configured. Using constant learning rate.</span>
<span id="cb6-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/_profiler:53:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiling disabled.</span>
<span id="cb6-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:467:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiler config after instantiation: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}</span>
<span id="cb6-95">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                                                                                                                       <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: Traceback <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/tune"</span>, line 10, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 49, in main</span>
<span id="cb6-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     parser.run<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 43, in run</span>
<span id="cb6-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args.func<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 214, in _run_cmd</span>
<span id="cb6-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._run_single_device<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args,</span> is_builtin=is_builtin<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 108, in _run_single_device</span>
<span id="cb6-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     runpy.run_path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args.recipe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> run_name=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 289, in run_path</span>
<span id="cb6-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return _run_module_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> init_globals, run_name,</span>
<span id="cb6-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 96, in _run_module_code</span>
<span id="cb6-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     _run_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> mod_globals, init_globals,</span>
<span id="cb6-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 86, in _run_code</span>
<span id="cb6-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     exec<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> run_globals<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 928, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe_main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/config/_parse.py"</span>, line 99, in wrapper</span>
<span id="cb6-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_main</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb6-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 923, in recipe_main</span>
<span id="cb6-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     recipe.train<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 749, in train</span>
<span id="cb6-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     logits = self._model<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">**batch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1532, in _wrapped_call_impl</span>
<span id="cb6-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return self._call_impl<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1561, in _call_impl</span>
<span id="cb6-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args_kwargs_result = hook<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type: ignore[misc]</span></span>
<span id="cb6-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 153, in _pre_forward</span>
<span id="cb6-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args, kwargs = self._root_pre_forward<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 67, in _root_pre_forward</span>
<span id="cb6-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 112, in _lazy_init</span>
<span id="cb6-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._init_shared_state<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 120, in _init_shared_state</span>
<span id="cb6-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._comm_ctx.init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_param_group.py"</span>, line 49, in init</span>
<span id="cb6-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self.all_gather_copy_in_stream = torch.cuda.Stream<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">priority</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>high_priority<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/cuda/streams.py"</span>, line 34, in __new__</span>
<span id="cb6-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return super<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.__new__</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cls,</span> priority=priority, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/_utils.py"</span>, line 907, in err_fn</span>
<span id="cb6-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     raise RuntimeError<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tried to instantiate dummy base class {class_name}"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: Tried to instantiate dummy base class Stream</span>
<span id="cb6-139">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                                                                                                                       <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb6-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    115657 exit 1     tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full</span></code></pre></div></div>
</details></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{foreman2025,
  author = {Foreman, Sam},
  title = {ü™õ {Torchtune} on {Aurora}},
  date = {2025-03-23},
  url = {https://samforeman.me/posts/torchtune-aurora},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúü™õ Torchtune on Aurora,‚Äù</span> March. <a href="https://samforeman.me/posts/torchtune-aurora">https://samforeman.me/posts/torchtune-aurora</a>.
</div></div></section></div> ]]></description>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/torchtune-aurora/</guid>
  <pubDate>Sun, 23 Mar 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üöë Torchtune Patch on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/torchtune-patch-aurora/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="patch-to-get-torchtune-working-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="patch-to-get-torchtune-working-on-aurora">Patch to get <code>torchtune</code> working on Aurora</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource diff number-lines code-with-copy"><code class="sourceCode diff"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">diff --git a/torchtune/training/_distributed.py b/torchtune/training/_distributed.py</span></span>
<span id="cb1-2">index ff959c5f..c3966290 100644</span>
<span id="cb1-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">--- a/torchtune/training/_distributed.py</span></span>
<span id="cb1-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">+++ b/torchtune/training/_distributed.py</span></span>
<span id="cb1-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -14,7 +14,11 @@ import torch</span></span>
<span id="cb1-6"> import torch.distributed as dist</span>
<span id="cb1-7"> from torch import nn</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-from torch.distributed._composable.fsdp import CPUOffloadPolicy, fully_shard</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+try:</span></span>
<span id="cb1-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp import fully_shard</span></span>
<span id="cb1-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp.fully_shard import fully_shard</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15"> from torch.distributed._tensor import distribute_tensor, DTensor</span>
<span id="cb1-16"> from torch.distributed._tensor.placement_types import DTensorSpec, TensorMeta</span>
<span id="cb1-17"> from torch.distributed.checkpoint.state_dict import (</span>
<span id="cb1-18"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -532,6 +536,11 @@ def shard_model(</span></span>
<span id="cb1-19">     """</span>
<span id="cb1-20">     fsdp_kwargs = {"reshard_after_forward": reshard_after_forward}</span>
<span id="cb1-21">     if cpu_offload:</span>
<span id="cb1-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        try:</span></span>
<span id="cb1-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp import CPUOffloadPolicy</span></span>
<span id="cb1-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp._fsdp_api import MixedPrecisionPolicy, CPUOffloadPolicy</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            # from torch.distributed._composable import CPUOffloadPolicy</span></span>
<span id="cb1-27">         fsdp_kwargs["offload_policy"] = CPUOffloadPolicy()</span>
<span id="cb1-28"></span>
<span id="cb1-29">     # Shard the model with FSDP, iterating in reverse to start with</span></code></pre></div></div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üöë {Torchtune} {Patch} on {Aurora}},
  date = {2025-03-23},
  url = {https://samforeman.me/posts/torchtune-patch-aurora/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüöë Torchtune Patch on Aurora.‚Äù</span> March
23, 2025. <a href="https://samforeman.me/posts/torchtune-patch-aurora/">https://samforeman.me/posts/torchtune-patch-aurora/</a>.
</div></div></section></div> ]]></description>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/torchtune-patch-aurora/</guid>
  <pubDate>Sun, 23 Mar 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>AuroraGPT: Foundation Models for Science</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="auroragpt-goals" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="auroragpt-goals">üéØ AuroraGPT: Goals</h2>
<div class="flex-container" style="flex-direction: column; justify-content: space-around;">
<div class="flex-container" style="flex-direction: row; justify-content: space-around; align-items:center;">
<div class="column" style="width: 55%">
<div class="blue-card">
<p><a href="https://auroragpt.anl.gov"><strong>AuroraGPT</strong></a>: <em>General purpose scientific LLM</em><br>
Broadly trained on a general corpora plus scientific {papers, texts, data}</p>
</div>
<ul>
<li><strong>Explore pathways</strong> towards a ‚ÄúScientific Assistant‚Äù model</li>
<li><strong>Build with international partners</strong> (RIKEN, BSC, others)</li>
<li><strong>Multilingual</strong> English, Êó•Êú¨Ë™û, French, German, Spanish</li>
<li><strong>Multimodal</strong>: images, tables, equations, proofs, time series, graphs, fields, sequences, etc</li>
</ul>
</div>
<div class="column" style="text-align: center;">
<div id="fig-awesome-llm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Image from  Hannibal046 / Awesome-LLM"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/llms.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Image from <iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/Hannibal046/Awesome-LLM">Hannibal046 / <code>Awesome-LLM</code></a>
</figcaption>
</figure>
</div>
</div>
</div>
<div id="fig-timeline" class="quarto-float quarto-figure quarto-figure-center anchored" style="margin-left:auto;margin-right:auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/timelines.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Credit to the entire AuroraGPT team for slides."><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/timelines.png" class="img-fluid figure-img" style="margin-left:auto;margin-right:auto;;width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Credit to the entire AuroraGPT team for slides.
</figcaption>
</figure>
</div>
</div>
<div class="notes">
<ul>
<li>Here to talk about AuroraGPT, Argonne‚Äôs internal effort to build a general purpose scientific LLM, broadly trained on a general corpora of text + scientific {papers, text, data}</li>
<li>As part of this effort, we plan to‚Ä¶
<ul>
<li>Explore pathways, build with international partners, multi-{lingual, modal}</li>
</ul></li>
<li>Rough timeline of the project and deliverables:
<ul>
<li>202{3,4}: text-only models, plan to release a series of {7B, 70B, 1T} models</li>
<li>202{4,5}: Basic multi-modal models</li>
<li>202{5,6}: Advanced scientific multimodal models</li>
</ul></li>
</ul>
</div>
</section>
<section id="issues-with-publicly-available-llms" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="issues-with-publicly-available-llms">ü¶ô Issues with ‚ÄúPublicly Available‚Äù LLMs</h2>
<ul>
<li><strong>Trust</strong> and <strong>Safety</strong>:
<ul>
<li>Skepticisim about deployment in critical infrastructure</li>
<li>Correctness and reliability of model outputs</li>
</ul></li>
<li><strong>Transparency</strong>:
<ul>
<li>Data governance, what was used for pre-training? fine-tuning?
<ul>
<li><strong>generally unknown</strong></li>
</ul></li>
<li>What is <em>open source</em>?
<ul>
<li>Model weights?</li>
<li>Pre-training {code, logs, metrics} ?</li>
</ul></li>
</ul></li>
</ul>
<div class="notes">
<ul>
<li>Why are we doing this?</li>
<li>What is the issue with current LLMs?
<ul>
<li><strong>Trust and safety</strong>
<ul>
<li>Hallucinations, false confidence</li>
<li>Can this be reliably mitigated?</li>
<li>Scaling up inference compute seems to help
<ul>
<li>reasoning models, TTT, etc.</li>
</ul></li>
</ul></li>
<li><strong>Transparency</strong>
<ul>
<li>Different frontier labs have different definitions of ‚Äúopen source‚Äù</li>
<li>e.g.&nbsp;Llama no longer releases base models
<ul>
<li>Libgen ??</li>
</ul></li>
<li>AllenAI institute, olmo models good example</li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-open-science-foundation-model" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-open-science-foundation-model">üß™ AuroraGPT: Open Science Foundation Model</h2>
<div id="fig-aurora-gpt" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored" style="vertical-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/AuroraGPT.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: High-level overview of AuroraGPT project"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/AuroraGPT.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: High-level overview of AuroraGPT project
</figcaption>
</figure>
</div>
<div class="notes">
<ul>
<li>AuroraGPT will be a publicly distributed, open source foundation model for open science</li>
<li>Is being trained on:
<ul>
<li>Scientific / engineering structured data</li>
<li>General text, media, news, etc.</li>
<li>Large amounts of low to medium quality data</li>
<li>Much less high quality data (that is publicly available for use)</li>
</ul></li>
<li>This data is then cleaned, processed, de-duplicated and used for the initial pre-training phase of the model</li>
<li>The vast majority of the overall compute is spent during this initial pre-training phase
<ul>
<li>This is the group I help to lead and will be talking a bit about today</li>
</ul></li>
<li>The initial pre-training phase is currently underway
<ul>
<li>Eventually, given a bit of time, effort and magic, the model will be ready for fine-tuning and additional training for a variety of downstream tasks</li>
</ul></li>
<li>The pretrained model will then be handed off for additional fine-tuning on a variety of downstream tasks
<ul>
<li>Scientific discovery</li>
<li>Accelerate scientific tasks</li>
<li>Digital twins</li>
<li>Inverse design</li>
<li>Code optimization</li>
<li>Accelerated simulations</li>
<li>Autonomous experiments</li>
<li>Co-design</li>
</ul></li>
<li>Becoming increasingly clear that LLMs have the potential to drastically accelerate computational science
<ul>
<li>We‚Äôve seen this already for {GenSLMs, Weather / Climate / Earth Systems Modeling, Particle Physics, etc.}</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-outcomes" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-outcomes">üìä AuroraGPT: Outcomes</h2>
<ul>
<li><p><strong>Datasets and data pipelines</strong> for preparing science training data</p></li>
<li><p><strong>Software infrastructure and workflows</strong> to train, evaluate and deploy LLMs at scale for scientific resarch purposes</p>
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf/Megatron-DeepSpeed</a><br>
<span class="dim-text">End-to-end training and inference, on <em>any</em> GPU cluster</span></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/inference-endpoints">argonne-lcf/inference-endpoints</a><sup>1</sup><br>
<span class="dim-text">Inference endpoints for LLMs, hosted @ ALCF</span></li>
</ul></li>
</ul>
<ul>
<li><strong>Evaluation of state-of-the-art LLM Models</strong>:
<ul>
<li>Determine where they fall short in deep scientific tasks</li>
<li>Where deep data may have an impact</li>
</ul></li>
</ul>
</section>
<section id="what-do-we-hope-to-get" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="what-do-we-hope-to-get">üìö What do we hope to get?</h2>
<ul>
<li><strong>Assessment of the approach</strong> of augmenting web training data with two forms of data specific to science:
<ul>
<li>Full text scientific papers</li>
<li>Structured scientific datasets (suitably mapped to narrative form)</li>
</ul></li>
<li><strong>Research grade artifacts</strong> (<strong>models</strong>) for scientific community for adaptation for downstream uses<sup>2</sup></li>
<li><strong>Promotion of responsible AI</strong> best practices where we can figure them out</li>
<li><strong>International Collaborations</strong> around the long term goal of <em>AGI for science</em></li>
</ul>
<div class="notes">
<ul>
<li>Deliverables:
<ul>
<li>datasets, pipelines</li>
<li>software infrastructure, workflows to interface with science applications</li>
<li>checkpoints, models, logs, workbook, insights, etc.</li>
</ul></li>
<li>Hope to understand:
<ul>
<li>How different state-of-the-art models perform at different scientific tasks</li>
<li>where deep data may have an impact</li>
<li>feasibility of generically augmenting text with scientific structured data</li>
</ul></li>
<li>Huge undertaking that will require large international collaborations around long term goal of AGI for science</li>
<li>Extra points:
<ul>
<li>Well known that LLMs are good for non-consequential tasks</li>
<li>Known to ‚Äúhallucinate‚Äù and create false information</li>
<li>Can this be mitigated reliably ??</li>
</ul></li>
</ul>
</div>
</section>
<section id="aurora" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="aurora">üåå Aurora</h2>
<div class="flex-container" style="align-items: center;">
<div class="column" style="width:5%;">
<div id="tbl-aurora" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Aurora Specs
</figcaption>
<div aria-describedby="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Racks</td>
<td style="text-align: left;">166</td>
</tr>
<tr class="even">
<td style="text-align: right;">Nodes</td>
<td style="text-align: left;">10,624</td>
</tr>
<tr class="odd">
<td style="text-align: right;">CPUs</td>
<td style="text-align: left;">21,248</td>
</tr>
<tr class="even">
<td style="text-align: right;">GPUs</td>
<td style="text-align: left;">63,744</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NICs</td>
<td style="text-align: left;">84,992</td>
</tr>
<tr class="even">
<td style="text-align: right;">HBM</td>
<td style="text-align: left;">8 PB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">DDR5c</td>
<td style="text-align: left;">10 PB</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="column" style="text-align:center">
<div id="fig-aurora" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/aurora.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Aurora: Fact Sheet."><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/aurora.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Aurora: <a href="https://www.alcf.anl.gov/sites/default/files/2024-07/Aurora_FactSheet_2024.pdf">Fact Sheet</a>.
</figcaption>
</figure>
</div>
<p>üèÜ <a href="https://www.intel.com/content/www/us/en/newsroom/news/intel-powered-aurora-supercomputer-breaks-exascale-barrier.html">Fastest AI system in the world</a></p>
</div>
</div>
</section>
<section id="alcf-ai-testbed" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="alcf-ai-testbed">ü§ñ ALCF AI Testbed</h2>
<ul>
<li>ALCF AI Testbed Systems are in production and <a href="https://accounts.alcf.anl.gov/#/allocationRequests">available for allocations</a> to the research community</li>
<li>Significant improvement in time-to-solution and energy-efficiency for diverse AI for science applications.</li>
<li><a href="https://nairrpilot.org/">NAIRR Pilot</a></li>
</ul>
<div class="red-card" style="color: #FF5252; font-size:90%;">
<p>Up to <img src="https://latex.codecogs.com/png.latex?%E2%89%88"> <strong>25</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> throughput improvement for genomic FMs with <strong>6.5</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> energy efficiency</p>
</div>
<div class="flex-container" style="align-items: flex-start; gap: 2pt; text-align:left;">
<div id="fig-sambanova" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align: left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/sambanova.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: SambaNova SN-30 2nd Gen, 8 nodes with 64 AI Accelerators"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/sambanova.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: <strong>SambaNova SN-30</strong> 2nd Gen, 8 nodes with 64 AI Accelerators
</figcaption>
</figure>
</div>
<div id="fig-graphcore" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/graphcore.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Graphcore Bow: Pod-64 configuration with 64 accelerators"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/graphcore.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>Graphcore Bow</strong>: Pod-64 configuration with 64 accelerators
</figcaption>
</figure>
</div>
<div id="fig-cerebras" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/cerebras.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Cerebras: 2x CS-2 WSE with Memory-X and Swarm-X technologies"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/cerebras.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: <strong>Cerebras</strong>: 2x CS-2 WSE with Memory-X and Swarm-X technologies
</figcaption>
</figure>
</div>
<div id="fig-groq" class="column quarto-float quarto-figure quarto-figure-center anchored" style="width:22%; text-align:left;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/groq.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: GroqRack: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/groq.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: <strong>GroqRack</strong>: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node
</figcaption>
</figure>
</div>
</div>
</section>
<section id="team-leads" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="team-leads">üë• Team Leads</h2>
<div style="font-size: 100%;">
<div class="flex-container" style="text-align: center; align-items: center;">
<p><strong>Planning</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rick-stevens.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rick Stevens"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/rick-stevens.png" style="height:1.04167in" alt="Rick Stevens" class="figure-img"></a></p>
<figcaption>Rick Stevens<sup>3</sup></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Ian Foster"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rinku-gupta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rinku Gupta"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/rinku-gupta.png" style="height:1.04167in" alt="Rinku Gupta" class="figure-img"></a></p>
<figcaption>Rinku Gupta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/mike-papka.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Mike Papka"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/mike-papka.png" style="height:1.04167in" alt="Mike Papka" class="figure-img"></a></p>
<figcaption>Mike Papka</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/arvind-ramanathan.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Arvind Ramanathan"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/arvind-ramanathan.png" style="height:1.04167in" alt="Arvind Ramanathan" class="figure-img"></a></p>
<figcaption>Arvind Ramanathan</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/fangfang-xia.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Fangfang Xia"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/fangfang-xia.png" style="height:1.04167in" alt="Fangfang Xia" class="figure-img"></a></p>
<figcaption>Fangfang Xia</figcaption>
</figure>
</div>
</div>
<div class="flex-container" style="text-align: center;">
<div class="col">
<p><strong>Data</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Ian Foster"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/robert-underwood.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Robert Underwood"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/robert-underwood.png" style="height:1.04167in" alt="Robert Underwood" class="figure-img"></a></p>
<figcaption>Robert Underwood</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Training</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/venkat-vishwanath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Venkat Vishwanath"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/venkat-vishwanath.png" style="height:1.04167in" alt="Venkat Vishwanath" class="figure-img"></a></p>
<figcaption>Venkat Vishwanath</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sam-foreman.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Sam Foreman"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/sam-foreman.png" style="height:1.04167in" alt="Sam Foreman" class="figure-img"></a></p>
<figcaption><span style="color: #ff1a8f; background-color: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); font-weight: 500;">Sam Foreman</span></figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Evaluation</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/franck-cappello.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Franck Cappello"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/franck-cappello.png" style="height:1.04167in" alt="Franck Cappello" class="figure-img"></a></p>
<figcaption>Franck Cappello</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sandeep-madireddy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Sandeep Madireddy"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/sandeep-madireddy.png" style="height:1.04167in" alt="Sandeep Madireddy" class="figure-img"></a></p>
<figcaption>Sandeep Madireddy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/bo-li.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Bo Li"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/bo-li.png" style="height:1.04167in" alt="Bo Li" class="figure-img"></a></p>
<figcaption>Bo Li</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Post</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/eliu-huerta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Eliu Huerta"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/eliu-huerta.png" style="height:1.04167in" alt="Eliu Huerta" class="figure-img"></a></p>
<figcaption>Eliu Huerta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/azton-wells.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Azton Wells"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/azton-wells.png" style="height:1.04167in" alt="Azton Wells" class="figure-img"></a></p>
<figcaption>Azton Wells</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Inference</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rajeev-thakur.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Rajeev Thakur"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/rajeev-thakur.png" style="height:1.04167in" alt="Rajeev Thakur" class="figure-img"></a></p>
<figcaption>Rajeev Thakur</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Comms</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/charlie-catlett.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Charlie Catlett"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/charlie-catlett.png" style="height:1.04167in" alt="Charlie Catlett" class="figure-img"></a></p>
<figcaption>Charlie Catlett</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/david-martin.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="David Martin"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/david-martin.png" style="height:1.04167in" alt="David Martin" class="figure-img"></a></p>
<figcaption>David Martin</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Distribution</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/brad-ullrich.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Brad Ullrich"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/team/brad-ullrich.png" style="height:1.04167in" alt="Brad Ullrich" class="figure-img"></a></p>
<figcaption>Brad Ullrich</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="teams" class="level2" data-auto-animate="true" data-background-color="white">
<h2 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="teams">ü§ù Teams</h2>
<div class="flex-container">
<div class="column">
<ul>
<li><strong>Planning</strong></li>
<li><strong>Data Prep</strong>
<ul>
<li>Accumulate 20+ T tokens of high-quality scientific text and structured data</li>
</ul></li>
<li><span style="background: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); border: 1px solid #ff1a8f; border-radius: 0.25px;"><strong>Models / Training</strong></span><sup>4</sup>
<ul>
<li>Train (entirely from scratch) a series of models on publicly available data</li>
</ul></li>
<li><strong>Evaluation</strong>
<ul>
<li>Skills, trustworthiness, safety, robustness, privacy, machine ethics</li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li><strong>Post-Training</strong>
<ul>
<li>Fine-tuning, alignment</li>
</ul></li>
<li><strong>Inference</strong>
<ul>
<li>Model serving, API development / public-facing web services</li>
</ul></li>
<li><strong>Distribution</strong>
<ul>
<li>Licensing, generating and distributing artifacts for public consumption</li>
</ul></li>
<li><strong>Communication</strong></li>
</ul>
</div>
</div>
</section>
<section id="data" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="data">üìö Data</h2>
<div class="green-card">
<p>‚úÖ <strong>Goal</strong>: Assemble a large corpus of documents (general and scientific) to train and fine-tune AuroraGPT models</p>
</div>
<ul>
<li><strong>Challenges</strong>: Avoid / detect contamination with benchmarks
<ul>
<li>Respect copyright (ACM Digital Library), privacy, and ethical considerations</li>
</ul></li>
<li><strong>Performance Challenges</strong>: <em>High throughput</em> data processing
<ul>
<li>Converting PDF <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> text (math formula, figures)</li>
<li>Convert science information (data) into text (narratives)</li>
<li>De-duplication (syntactic and semantic) of scientific documents (to avoid memorization, bias)</li>
</ul></li>
<li><strong>Quantity</strong>: Considering 20+ Trillion tokens <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> <img src="https://latex.codecogs.com/png.latex?%5Capprox"> 100M papers</li>
<li><strong>Domains</strong>: All (long-term) scientific domains, starting with:
<ul>
<li>Material science, Physics, Biology, Computer Science, Climate Science</li>
</ul></li>
</ul>
</section>
<section id="dataset-processing" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="dataset-processing">‚è±Ô∏è Dataset Processing</h2>
<ul>
<li>To train a fixed model on trillions of tokens requires:
<ol type="1">
<li><strong>Aggregating</strong> data from multiple different <em>corpora</em><br>
(e.g.&nbsp;ArXiv, Reddit, StackExchange, GitHub, Wikipedia, etc.)</li>
<li><strong>Sampling</strong> <em>each training batch</em> according to a fixed distribution across corpora</li>
<li><strong>Building</strong> indices that map batches of tokens into these files (indexing)</li>
</ol>
<div class="red-card">
<p>The original implementation was <em>slow</em>:</p>
<ul>
<li>Designed to run <em>serially</em> on a <strong>single device</strong></li>
<li><strong>Major bottleneck</strong> when debugging data pipeline at scale</li>
</ul>
</div></li>
</ul>
<section id="accelerating-dataset-processing-results" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-results">üöÄ Accelerating Dataset Processing: Results</h3>
<div class="flex-container" style="padding: 10pt; justify-content: space-around; align-items: flex-start;">
<div class="column" style="width:25%;">
<ul>
<li>Original implementation:
<ul>
<li><strong>Slow</strong>!</li>
<li><span class="dim-text">üêå ~ 1 hr</span>/2T tokens</li>
</ul></li>
<li><label><input type="checkbox" checked="">Fix:</label>
<ul>
<li>Wrote <em>asynchronous</em>, <strong>distributed</strong> implementation</li>
<li><em>significantly</em> improves performance (<strong>30x</strong> !!)</li>
<li>üèéÔ∏èüí® <span style="color:#2296F3;">~ <strong>2 min</strong></span>/2T tokens</li>
</ul></li>
</ul>
</div>
<div class="column">
<div id="fig-data-processing" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-processing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/data-processing.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;9: Time spent preparing 2T tokens"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/data-processing.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-processing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Time spent preparing 2T tokens
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-training" class="level2 smaller page-columns page-full" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="model-training">ü¶ú Model Training</h2>
<div class="flex-container" style="text-align: left; width: 100%; justify-content: space-around; line-height: 1em; gap: 5pt;">
<div class="column" style="background: oklch(from #03BD00 calc(l * 1.15) c h / 0.1); border: 1px solid #03BD00; border-radius: 0.25em; padding: 3pt 8pt;">
<p>‚úÖ <span style="color: #03BD00;"><strong>Goals</strong></span></p>
<ul>
<li>Want training runs at scale to be:
<ul>
<li>efficient</li>
<li>stable</li>
<li>reproducible</li>
</ul></li>
<li>This requires:
<ul>
<li>robust data pipelines / file IO</li>
<li>effectively overlapping compute with communication</li>
<li>stability across {network, filesystem, machine}</li>
</ul></li>
<li>3D / Multi-dimensional Parallelism strategies</li>
<li>Large batch training</li>
<li>Second order optimizers</li>
<li>Sub-quadratic attention</li>
<li>State space models</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
<div class="column" style="background: oklch(from #E90102 calc(l * 1.15) c h / 0.1); border: 1px solid #E90102; border-radius: 0.25em; padding: 3pt 8pt;">
<p>‚ùå <span style="color: #E90102;"><strong>Challenges</strong></span></p>
<ul>
<li><em>Looong time</em> to train, can be:
<ul>
<li>weeks (even months) of continuous training</li>
<li>order of magnitude longer than typical NN training jobs</li>
</ul></li>
<li>Stability issues:
<ul>
<li>failures are expensive (but inevitable)</li>
<li>stragglers common at scale</li>
</ul></li>
<li>Individual jobs are:
<ul>
<li><strong>fragile</strong></li>
<li>only as good as the worst rank</li>
<li>one hang or bad worker can crash job</li>
<li>network / filesystem / other-user(s) dependent</li>
</ul></li>
<li>Cost / benefits of different collective communication algorithms
<ul>
<li>depend on optimized / efficient implementations</li>
</ul></li>
<li>Network performance</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / Megatron-DeepSpeed</a></p>
</div></div></section>
<section id="evaluating-fm-skills-for-science" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="evaluating-fm-skills-for-science">ü§î Evaluating FM Skills for Science</h2>
<ul>
<li>What to measure?
<ul>
<li><strong>Knowledge Extraction, Retrieval, Distillation, Synthesis</strong>: LLM is provided a question or instruction and a truthful answer is expected</li>
<li><strong>Text Grounded</strong>: Answers are expected to be fully grounded on peer-reviewed references to support responses</li>
<li><strong>Reasoning</strong>: LLMs are expected to solve deductive (prove a theory or hypothesis from formal logic and observations), inductive (validate / explain observations from theories) problems</li>
<li><strong>Creativity</strong>: A creative answer is expected from a question or instruction
<ul>
<li>thoughtful dialogue, coding, etc.</li>
</ul></li>
</ul></li>
</ul>
<section id="evaluating-fm-skills-for-science-criteria" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="evaluating-fm-skills-for-science-criteria">‚öñÔ∏è Evaluating FM Skills for Science: Criteria</h3>
<ul>
<li>Criteria for all of the above:
<ul>
<li><strong>Correctness</strong> of facts</li>
<li><strong>Accuracy</strong> of solutions and inferences</li>
<li><strong>Reliability</strong> consistently good in quality or performance</li>
<li><strong>Speed</strong> how fast to produce a response</li>
<li><strong># shots</strong> how many examples are needed for good quality
<ul>
<li>Extent of <em>prompt engineering</em></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="mprot-dpo-scaling-results" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="mprot-dpo-scaling-results">üß¨ MProt-DPO: Scaling Results</h2>
<div class="flex-container" style="align-items: center; text-align: center; max-width: 80%; margin-left: auto; margin-right: auto;">
<div id="fig-mprot-3p5B-scaling1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-3p5B-scaling1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-3p5B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;10: Scaling results for 3.5B Model"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/mprot-3p5B-scaling-2.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-3p5B-scaling1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Scaling results for <code>3.5B</code> Model
</figcaption>
</figure>
</div>
</div>
</section>
<section id="references" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="references">üìì References</h2>
<div class="flex-container" style="gap: 2pt;">
<div class="column">
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / <code>Megatron-DeepSpeed</code></a><br>
<span class="dim-text">For the largest of large language models.</span></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2 / <code>ezpz</code></a><br>
<span class="dim-text">Distributed training, ezpz. üçã</span></li>
<li>üìä See my other slides at <a href="https://samforeman.me/talks">samforeman.me/talks</a>:
<ul>
<li><a href="https://saforem2.github.io/llm-workshop-talk">LLMs from Scratch</a></li>
<li><a href="https://saforem2.github.io/LLM-tutorial">Creating Small(~ish) LLMs</a></li>
<li><a href="https://saforem2.github.io/parallel-training-slides">Parallel Training Techniques</a></li>
<li><a href="https://samforeman.me/talks/llms-on-polaris/#/title-slide">LLMs on Polaris</a></li>
<li><a href="https://samforeman.me/talks/llms-at-scale/">Training LLMs at Scale</a></li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li>üëÄ See also:
<ul>
<li><a href="https://www.anl.gov/article/new-international-consortium-formed-to-create-trustworthy-and-reliable-generative-ai-models-for">New international consortium for generative AI models for science</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/dist_overview.html">PyTorch Distributed Overview</a></li>
<li><a href="https://huggingface.co/docs/transformers/en/perf_train_gpu_many">ü§ó Efficient Training on Multiple GPUs</a></li>
<li><a href="https://www.deepspeed.ai/getting-started/">Getting Started - DeepSpeed</a></li>
<li>üï∏Ô∏è <a href="https://openreview.net/forum?id=8bjspmAMBk">Quality Measures for Dynamic Graph Generative Models</a><br>
<span class="citation" data-cites="hosseini2025quality">(Hosseini et al. 2025)</span></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="thank-you" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h2>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:///foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üôè Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üôè Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</div>
</div>
</div>
</section>
<section id="bibliography" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="bibliography">üìë Bibliography</h2>
<ul>
<li>Refs:
<ul>
<li><span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span></li>
<li>Animations from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></li>
</ul></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-mprot-dpo2024" class="csl-entry">
Dharuman, Gautham, Kyle Hippe, Alexander Brace, Sam Foreman, V√§in√∂ Hatanp√§√§, Varuni K. Sastry, Huihuo Zheng, et al. 2024. <span>‚ÄúMProt-DPO: Breaking the ExaFLOPS Barrier for Multimodal Protein Design Workflows with Direct Preference Optimization.‚Äù</span> In <em>Proceedings of the International Conference for High Performance Computing, Networking, Storage, and Analysis</em>. SC ‚Äô24. Atlanta, GA, USA: IEEE Press. <a href="https://doi.org/10.1109/SC41406.2024.00013">https://doi.org/10.1109/SC41406.2024.00013</a>.
</div>
<div id="ref-hosseini2025quality" class="csl-entry">
Hosseini, Ryien, Filippo Simini, Venkatram Vishwanath, Rebecca Willett, and Henry Hoffmann. 2025. <span>‚ÄúQuality Measures for Dynamic Graph Generative Models.‚Äù</span> In <em>The Thirteenth International Conference on Learning Representations</em>. <a href="https://openreview.net/forum?id=8bjspmAMBk">https://openreview.net/forum?id=8bjspmAMBk</a>.
</div>
<div id="ref-song2023ds4sci" class="csl-entry">
Song, Shuaiwen Leon, Bonnie Kruft, Minjia Zhang, Conglong Li, Shiyang Chen, Chengming Zhang, Masahiro Tanaka, et al. 2023. <span>‚ÄúDeepSpeed4Science Initiative: Enabling Large-Scale Scientific Discovery Through Sophisticated AI System Technologies.‚Äù</span> <a href="https://arxiv.org/abs/2310.04610">https://arxiv.org/abs/2310.04610</a>.
</div>
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yang2023harnessing" class="csl-entry">
Yang, Jingfeng, Hongye Jin, Ruixiang Tang, Xiaotian Han, Qizhang Feng, Haoming Jiang, Bing Yin, and Xia Hu. 2023. <span>‚ÄúHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond.‚Äù</span> <a href="https://arxiv.org/abs/2304.13712">https://arxiv.org/abs/2304.13712</a>.
</div>
</div>
</section>
<section id="extras" class="level2 page-columns page-full" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="extras">üéÅ Extras</h2>
<section id="mprot-dpo-scaling-results-1" class="level3" data-background-color="#1c1c1c">
<h3 data-background-color="#1c1c1c" class="anchored" data-anchor-id="mprot-dpo-scaling-results-1">üß¨ MProt-DPO: Scaling Results</h3>
<div class="columns">
<div id="fig-mprot-3p5B-scaling" class="column quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-3p5B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-3p5B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;11: 3.5B model"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/mprot-3p5B-scaling-2.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-3p5B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: <code>3.5B</code> model
</figcaption>
</figure>
</div><div id="fig-mprot-7B-scaling" class="column quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mprot-7B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mprot-7B-scaling-2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;12: 7B model"><img src="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/mprot-7B-scaling-2.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mprot-7B-scaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: <code>7B</code> model
</figcaption>
</figure>
</div>
</div>
</section>
<section id="loooooooooong-sequence-lengths" class="level3 smaller page-columns page-full" data-background-color="#1c1c1c">
<h3 class="smaller anchored" data-background-color="#1c1c1c" data-anchor-id="loooooooooong-sequence-lengths">üöÇ Loooooooooong Sequence Lengths</h3>
<div class="flex-container" style="align-items: center; justify-content: center;">
<p><a href="../../assets/anl.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="https://samforeman.me/assets/anl.svg" class="img-fluid" style="height:50pt;"></a></p>
<p><span class="dim-text" style="font-size: 2.0em;"><iconify-icon inline="" icon="ic:baseline-plus" aria-label="Icon baseline-plus from ic Iconify.design set." title="Icon baseline-plus from ic Iconify.design set."></iconify-icon></span></p>
<p><a href="../../assets/deepspeed-logo-transparent.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="https://samforeman.me/assets/deepspeed-logo-transparent.svg" class="img-fluid" style="height:50pt;"></a></p>
</div>
<ul>
<li>Working with <a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-microsoft" aria-label="microsoft"></i> Microsoft/DeepSpeed</a> team to enable longer sequence lengths (context windows) for LLMs
<ul>
<li>See my <a href="https://samforeman.me/posts/auroragpt/long-sequences/">blog post</a> for additional details</li>
</ul></li>
</ul>
<div id="fig-long-seq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="flex-container">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="25B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="img-fluid figure-img"></a></p>
<figcaption>25B</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="33B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="img-fluid figure-img"></a></p>
<figcaption>33B</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Maximum (achievable) <code>SEQ_LEN</code> for both <code>25B</code> and <code>33B</code> models (See: <span class="citation" data-cites="song2023ds4sci">Song et al. (2023)</span>)
</figcaption>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><a href="https://github.com/saforem2/scaling4science"><i class="fa-brands fa-github" aria-label="github"></i> <code>scaling4science</code></a><br>
<a href="https://github.com/saforem2/Megatron-DS-Benchmarking"><i class="fa-brands fa-github" aria-label="github"></i> <code>Megatron-DS-Benchmarking</code></a></p>
</div></div></section>
<section id="life-cycle-of-the-llm" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">‚ôªÔ∏è Life Cycle of the LLM</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" style="text-align:center">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">üìù Pre-training</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">üéÄ Fine-Tuning</a></li></ul>
<div class="tab-content" style="text-align:center">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div id="fig-pretraining" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;14: Pre-training: Virtually all of the compute used during pretraining phase"><img src="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: <strong>Pre-training</strong>: Virtually all of the compute used during pretraining phase
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div id="fig-fine-tuning" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;15: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-llms" class="level3 smaller" data-background-color="white">
<h3 class="smaller anchored" data-background-color="white" data-anchor-id="training-llms">üçé Training LLMs</h3>
<div class="flex-container" style="align-items: flex-end;">
<div class="column" style="width:33%;">
<div id="fig-it-hungers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Figure&nbsp;16: It‚Äôs hungry!"><img src="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: It‚Äôs hungry!
</figcaption>
</figure>
</div>
</div>
<div class="column" style="width:60%;">
<div id="fig-evolution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;17: Visualization from @yang2023harnessing"><img src="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Visualization from <span class="citation" data-cites="yang2023harnessing">Yang et al. (2023)</span>
</figcaption>
</figure>
</div>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Relies <em>heavily</em> on <a href="https://globus.org">Globus</a> (next talk!)‚Ü©Ô∏é</p></li>
<li id="fn2"><div class="line-block"></div>
<p>üîî Gordon Bell Finalist: <a href="https://dl.acm.org/doi/10.1109/SC41406.2024.00013">MProt-DPO</a> <span class="citation" data-cites="mprot-dpo2024">(Dharuman et al. 2024)</span>‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Lead‚Ü©Ô∏é</p></li>
<li id="fn4"><p>Co-led by: Venkat Vishwanath, <strong>Sam Foreman</strong>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2025,
  author = {Foreman, Sam},
  title = {AuroraGPT: {Foundation} {Models} for {Science}},
  date = {2025-02-12},
  url = {https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúAuroraGPT: Foundation Models for
Science.‚Äù</span> February 12. <a href="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/slides">https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/</guid>
  <pubDate>Wed, 12 Feb 2025 06:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/assets/thumbnail.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>ü´• svgbob</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/svgbob/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>Playing with <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/ivanceras/svgbob">ivanceras/<code>svgbob</code></a> as an alternative to Mermaid</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="456" height="304" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="456" height="304"></rect>
  <rect x="156" y="40" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="60">Network</text>
  <rect x="332" y="40" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="60">Loss</text>
  <path d="M 384,48 A 16,16 0,0,0 384,64" class="nofill"></path>
  <text x="386" y="60">x0</text>
  <path d="M 400,48 A 16,16 0,0,1 400,64" class="nofill"></path>
  <rect x="156" y="136" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="156">Network</text>
  <rect x="332" y="136" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="156">Loss</text>
  <path d="M 384,144 A 16,16 0,0,0 384,160" class="nofill"></path>
  <text x="386" y="156">x1</text>
  <path d="M 400,144 A 16,16 0,0,1 400,160" class="nofill"></path>
  <rect x="156" y="232" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="252">Network</text>
  <rect x="332" y="232" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="252">Loss</text>
  <path d="M 384,240 A 16,16 0,0,0 384,256" class="nofill"></path>
  <text x="386" y="252">x2</text>
  <path d="M 400,240 A 16,16 0,0,1 400,256" class="nofill"></path>
  <text x="34" y="28">Data</text>
  <text x="138" y="28">GPU0</text>
  <text x="42" y="60">x0</text>
  <polygon points="136,52 144,56 136,60" class="filled"></polygon>
  <line x1="92" y1="64" x2="92" y2="144" class="solid"></line>
  <text x="138" y="124">GPU1</text>
  <polygon points="296,132 288,136 296,140" class="filled"></polygon>
  <text x="42" y="156">x1</text>
  <polygon points="136,148 144,152 136,156" class="filled"></polygon>
  <line x1="92" y1="160" x2="92" y2="240" class="solid"></line>
  <polygon points="272,164 280,168 272,172" class="filled"></polygon>
  <text x="138" y="220">GPU2</text>
  <polygon points="296,228 288,232 296,236" class="filled"></polygon>
  <text x="42" y="252">x2</text>
  <polygon points="136,244 144,248 136,252" class="filled"></polygon>
  <polygon points="272,260 280,264 272,268" class="filled"></polygon>
  <polygon points="256,36 248,40 256,44" class="filled"></polygon>
  <line x1="256" y1="40" x2="308" y2="40" class="solid end_marked_open_circle"></line>
  <line x1="264" y1="56" x2="252" y2="56" class="solid end_marked_open_circle"></line>
  <line x1="264" y1="56" x2="312" y2="56" class="solid"></line>
  <polygon points="312,52 320,56 312,60" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="276" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="48" class="solid"></line>
    <path d="M 4,276 A 4,4 0,0,0 8,280" class="nofill"></path>
    <line x1="8" y1="280" x2="88" y2="280" class="solid"></line>
    <line x1="92" y1="256" x2="92" y2="276" class="solid"></line>
    <path d="M 92,276 A 4,4 0,0,1 88,280" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,8 A 4,4 0,0,0 124,12" class="nofill"></path>
    <line x1="124" y1="12" x2="124" y2="48" class="solid"></line>
    <line x1="128" y1="8" x2="440" y2="8" class="solid"></line>
    <path d="M 440,8 A 4,4 0,0,1 444,12" class="nofill"></path>
    <line x1="444" y1="12" x2="444" y2="84" class="solid"></line>
    <line x1="124" y1="64" x2="124" y2="84" class="solid"></line>
    <path d="M 124,84 A 4,4 0,0,0 128,88" class="nofill"></path>
    <line x1="128" y1="88" x2="440" y2="88" class="solid"></line>
    <path d="M 444,84 A 4,4 0,0,1 440,88" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,40 A 4,4 0,0,0 20,44" class="nofill"></path>
    <line x1="20" y1="44" x2="20" y2="68" class="solid"></line>
    <line x1="24" y1="40" x2="72" y2="40" class="solid"></line>
    <path d="M 72,40 A 4,4 0,0,1 76,44" class="nofill"></path>
    <line x1="76" y1="44" x2="76" y2="68" class="solid"></line>
    <line x1="76" y1="56" x2="136" y2="56" class="solid"></line>
    <path d="M 20,68 A 4,4 0,0,0 24,72" class="nofill"></path>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 76,68 A 4,4 0,0,1 72,72" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,104 A 4,4 0,0,0 124,108" class="nofill"></path>
    <line x1="124" y1="108" x2="124" y2="144" class="solid"></line>
    <line x1="128" y1="104" x2="440" y2="104" class="solid"></line>
    <path d="M 440,104 A 4,4 0,0,1 444,108" class="nofill"></path>
    <line x1="444" y1="108" x2="444" y2="180" class="solid"></line>
    <line x1="124" y1="160" x2="124" y2="180" class="solid"></line>
    <path d="M 124,180 A 4,4 0,0,0 128,184" class="nofill"></path>
    <line x1="128" y1="184" x2="440" y2="184" class="solid"></line>
    <path d="M 444,180 A 4,4 0,0,1 440,184" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,136 A 4,4 0,0,0 20,140" class="nofill"></path>
    <line x1="20" y1="140" x2="20" y2="164" class="solid"></line>
    <line x1="24" y1="136" x2="72" y2="136" class="solid"></line>
    <path d="M 72,136 A 4,4 0,0,1 76,140" class="nofill"></path>
    <line x1="76" y1="140" x2="76" y2="164" class="solid"></line>
    <line x1="76" y1="152" x2="136" y2="152" class="solid"></line>
    <path d="M 20,164 A 4,4 0,0,0 24,168" class="nofill"></path>
    <line x1="24" y1="168" x2="72" y2="168" class="solid"></line>
    <path d="M 76,164 A 4,4 0,0,1 72,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,136 A 8,8 0,0,0 266,140" class="nofill"></path>
    <line x1="266" y1="140" x2="264" y2="144" class="solid"></line>
    <path d="M 264,144 A 16,16 0,0,0 264,160" class="nofill"></path>
    <line x1="264" y1="160" x2="266" y2="164" class="solid"></line>
    <path d="M 266,164 A 8,8 0,0,0 272,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 296,136 A 8,8 0,0,1 302,140" class="nofill"></path>
    <line x1="302" y1="140" x2="304" y2="144" class="solid"></line>
    <path d="M 304,144 A 16,16 0,0,1 304,160" class="nofill"></path>
    <line x1="304" y1="160" x2="302" y2="164" class="solid"></line>
    <path d="M 302,164 A 8,8 0,0,1 296,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,200 A 4,4 0,0,0 124,204" class="nofill"></path>
    <line x1="124" y1="204" x2="124" y2="240" class="solid"></line>
    <line x1="128" y1="200" x2="440" y2="200" class="solid"></line>
    <path d="M 440,200 A 4,4 0,0,1 444,204" class="nofill"></path>
    <line x1="444" y1="204" x2="444" y2="276" class="solid"></line>
    <line x1="124" y1="256" x2="124" y2="276" class="solid"></line>
    <path d="M 124,276 A 4,4 0,0,0 128,280" class="nofill"></path>
    <line x1="128" y1="280" x2="440" y2="280" class="solid"></line>
    <path d="M 444,276 A 4,4 0,0,1 440,280" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,232 A 4,4 0,0,0 20,236" class="nofill"></path>
    <line x1="20" y1="236" x2="20" y2="260" class="solid"></line>
    <line x1="24" y1="232" x2="72" y2="232" class="solid"></line>
    <path d="M 72,232 A 4,4 0,0,1 76,236" class="nofill"></path>
    <line x1="76" y1="236" x2="76" y2="260" class="solid"></line>
    <line x1="76" y1="248" x2="136" y2="248" class="solid"></line>
    <path d="M 20,260 A 4,4 0,0,0 24,264" class="nofill"></path>
    <line x1="24" y1="264" x2="72" y2="264" class="solid"></line>
    <path d="M 76,260 A 4,4 0,0,1 72,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,232 A 8,8 0,0,0 266,236" class="nofill"></path>
    <line x1="266" y1="236" x2="264" y2="240" class="solid"></line>
    <path d="M 264,240 A 16,16 0,0,0 264,256" class="nofill"></path>
    <line x1="264" y1="256" x2="266" y2="260" class="solid"></line>
    <path d="M 266,260 A 8,8 0,0,0 272,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 296,232 A 8,8 0,0,1 302,236" class="nofill"></path>
    <line x1="302" y1="236" x2="304" y2="240" class="solid"></line>
    <path d="M 304,240 A 16,16 0,0,1 304,256" class="nofill"></path>
    <line x1="304" y1="256" x2="302" y2="260" class="solid"></line>
    <path d="M 302,260 A 8,8 0,0,1 296,264" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="480" height="560" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="480" height="560"></rect>
  <rect x="220" y="56" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="76">Network</text>
  <rect x="372" y="56" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="76">Loss</text>
  <rect x="220" y="248" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="268">Network</text>
  <rect x="372" y="248" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="268">Loss</text>
  <rect x="220" y="440" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="460">Network</text>
  <rect x="372" y="440" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="460">Loss</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <text x="42" y="76">x0</text>
  <polygon points="200,68 208,72 200,76" class="filled"></polygon>
  <line x1="92" y1="80" x2="92" y2="256" class="solid"></line>
  <polygon points="256,108 260,96 264,108" class="filled"></polygon>
  <text x="202" y="204">GPU1</text>
  <polygon points="400,228 408,228 404,240" class="filled"></polygon>
  <text x="42" y="268">x1</text>
  <polygon points="200,260 208,264 200,268" class="filled"></polygon>
  <line x1="92" y1="272" x2="92" y2="448" class="solid"></line>
  <polygon points="256,300 260,288 264,300" class="filled"></polygon>
  <text x="202" y="396">GPU2</text>
  <polygon points="400,420 408,420 404,432" class="filled"></polygon>
  <text x="42" y="460">x2</text>
  <polygon points="200,452 208,456 200,460" class="filled"></polygon>
  <polygon points="256,492 260,480 264,492" class="filled"></polygon>
  <line x1="328" y1="72" x2="316" y2="72" class="solid end_marked_open_circle"></line>
  <line x1="328" y1="72" x2="352" y2="72" class="solid"></line>
  <polygon points="352,68 360,72 352,76" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="532" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="64" class="solid"></line>
    <path d="M 4,532 A 4,4 0,0,0 8,536" class="nofill"></path>
    <line x1="8" y1="536" x2="88" y2="536" class="solid"></line>
    <line x1="92" y1="464" x2="92" y2="532" class="solid"></line>
    <path d="M 92,532 A 4,4 0,0,1 88,536" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="64" class="solid"></line>
    <line x1="192" y1="8" x2="464" y2="8" class="solid"></line>
    <path d="M 464,8 A 4,4 0,0,1 468,12" class="nofill"></path>
    <line x1="468" y1="12" x2="468" y2="148" class="solid"></line>
    <line x1="188" y1="80" x2="188" y2="148" class="solid"></line>
    <path d="M 188,148 A 4,4 0,0,0 192,152" class="nofill"></path>
    <line x1="192" y1="152" x2="464" y2="152" class="solid"></line>
    <path d="M 468,148 A 4,4 0,0,1 464,152" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,56 A 4,4 0,0,0 20,60" class="nofill"></path>
    <line x1="20" y1="60" x2="20" y2="84" class="solid"></line>
    <line x1="24" y1="56" x2="72" y2="56" class="solid"></line>
    <path d="M 72,56 A 4,4 0,0,1 76,60" class="nofill"></path>
    <line x1="76" y1="60" x2="76" y2="84" class="solid"></line>
    <line x1="76" y1="72" x2="200" y2="72" class="solid"></line>
    <path d="M 20,84 A 4,4 0,0,0 24,88" class="nofill"></path>
    <line x1="24" y1="88" x2="72" y2="88" class="solid"></line>
    <path d="M 76,84 A 4,4 0,0,1 72,88" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="108" x2="260" y2="132" class="solid"></line>
    <path d="M 260,132 A 4,4 0,0,0 264,136" class="nofill"></path>
    <line x1="264" y1="136" x2="400" y2="136" class="solid"></line>
    <line x1="404" y1="96" x2="404" y2="132" class="solid"></line>
    <path d="M 404,132 A 4,4 0,0,1 400,136" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,184 A 4,4 0,0,0 188,188" class="nofill"></path>
    <line x1="188" y1="188" x2="188" y2="256" class="solid"></line>
    <line x1="192" y1="184" x2="464" y2="184" class="solid"></line>
    <path d="M 464,184 A 4,4 0,0,1 468,188" class="nofill"></path>
    <line x1="468" y1="188" x2="468" y2="340" class="solid"></line>
    <line x1="188" y1="272" x2="188" y2="340" class="solid"></line>
    <path d="M 188,340 A 4,4 0,0,0 192,344" class="nofill"></path>
    <line x1="192" y1="344" x2="464" y2="344" class="solid"></line>
    <path d="M 468,340 A 4,4 0,0,1 464,344" class="nofill"></path>
  </g>
  <g>
    <path d="M 264,200 A 4,4 0,0,0 260,204" class="nofill"></path>
    <line x1="260" y1="204" x2="260" y2="240" class="solid"></line>
    <line x1="264" y1="200" x2="400" y2="200" class="solid"></line>
    <path d="M 400,200 A 4,4 0,0,1 404,204" class="nofill"></path>
    <line x1="404" y1="204" x2="404" y2="228" class="solid"></line>
  </g>
  <g>
    <path d="M 24,248 A 4,4 0,0,0 20,252" class="nofill"></path>
    <line x1="20" y1="252" x2="20" y2="276" class="solid"></line>
    <line x1="24" y1="248" x2="72" y2="248" class="solid"></line>
    <path d="M 72,248 A 4,4 0,0,1 76,252" class="nofill"></path>
    <line x1="76" y1="252" x2="76" y2="276" class="solid"></line>
    <line x1="76" y1="264" x2="200" y2="264" class="solid"></line>
    <path d="M 20,276 A 4,4 0,0,0 24,280" class="nofill"></path>
    <line x1="24" y1="280" x2="72" y2="280" class="solid"></line>
    <path d="M 76,276 A 4,4 0,0,1 72,280" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="300" x2="260" y2="324" class="solid"></line>
    <path d="M 260,324 A 4,4 0,0,0 264,328" class="nofill"></path>
    <line x1="264" y1="328" x2="400" y2="328" class="solid"></line>
    <line x1="404" y1="288" x2="404" y2="324" class="solid"></line>
    <path d="M 404,324 A 4,4 0,0,1 400,328" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,376 A 4,4 0,0,0 188,380" class="nofill"></path>
    <line x1="188" y1="380" x2="188" y2="448" class="solid"></line>
    <line x1="192" y1="376" x2="464" y2="376" class="solid"></line>
    <path d="M 464,376 A 4,4 0,0,1 468,380" class="nofill"></path>
    <line x1="468" y1="380" x2="468" y2="532" class="solid"></line>
    <line x1="188" y1="464" x2="188" y2="532" class="solid"></line>
    <path d="M 188,532 A 4,4 0,0,0 192,536" class="nofill"></path>
    <line x1="192" y1="536" x2="464" y2="536" class="solid"></line>
    <path d="M 468,532 A 4,4 0,0,1 464,536" class="nofill"></path>
  </g>
  <g>
    <path d="M 264,392 A 4,4 0,0,0 260,396" class="nofill"></path>
    <line x1="260" y1="396" x2="260" y2="432" class="solid"></line>
    <line x1="264" y1="392" x2="400" y2="392" class="solid"></line>
    <path d="M 400,392 A 4,4 0,0,1 404,396" class="nofill"></path>
    <line x1="404" y1="396" x2="404" y2="420" class="solid"></line>
  </g>
  <g>
    <path d="M 24,440 A 4,4 0,0,0 20,444" class="nofill"></path>
    <line x1="20" y1="444" x2="20" y2="468" class="solid"></line>
    <line x1="24" y1="440" x2="72" y2="440" class="solid"></line>
    <path d="M 72,440 A 4,4 0,0,1 76,444" class="nofill"></path>
    <line x1="76" y1="444" x2="76" y2="468" class="solid"></line>
    <line x1="76" y1="456" x2="200" y2="456" class="solid"></line>
    <path d="M 20,468 A 4,4 0,0,0 24,472" class="nofill"></path>
    <line x1="24" y1="472" x2="72" y2="472" class="solid"></line>
    <path d="M 76,468 A 4,4 0,0,1 72,472" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="492" x2="260" y2="516" class="solid"></line>
    <path d="M 260,516 A 4,4 0,0,0 264,520" class="nofill"></path>
    <line x1="264" y1="520" x2="400" y2="520" class="solid"></line>
    <line x1="404" y1="480" x2="404" y2="516" class="solid"></line>
    <path d="M 404,516 A 4,4 0,0,1 400,520" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="232" height="192" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="232" height="192"></rect>
  <rect x="108" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="172" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <polygon points="176,36 184,36 180,48" class="filled"></polygon>
  <polygon points="96,68 104,72 96,76" class="filled"></polygon>
  <line x1="120" y1="80" x2="130" y2="100" class="solid"></line>
  <line x1="176" y1="80" x2="166" y2="100" class="solid"></line>
  <polygon points="127,100 134,108 134,97" class="filled"></polygon>
  <polygon points="169,100 162,108 162,97" class="filled"></polygon>
  <polygon points="168,164 176,168 168,172" class="filled"></polygon>
  <g>
    <path d="M 184,8 A 4,4 0,0,0 180,12" class="nofill"></path>
    <line x1="180" y1="12" x2="180" y2="36" class="solid"></line>
    <line x1="184" y1="8" x2="200" y2="8" class="solid"></line>
    <path d="M 200,8 A 4,4 0,0,1 204,12" class="nofill"></path>
    <line x1="204" y1="12" x2="204" y2="128" class="solid"></line>
    <path d="M 80,72 A 4,4 0,0,0 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="128" class="solid"></line>
    <line x1="80" y1="72" x2="96" y2="72" class="solid"></line>
    <line x1="148" y1="104" x2="136" y2="128" class="solid"></line>
    <line x1="148" y1="104" x2="160" y2="128" class="solid"></line>
    <line x1="76" y1="128" x2="136" y2="128" class="solid"></line>
    <line x1="160" y1="128" x2="204" y2="128" class="solid"></line>
    <line x1="136" y1="128" x2="148" y2="152" class="solid"></line>
    <line x1="160" y1="128" x2="148" y2="152" class="solid"></line>
    <line x1="148" y1="152" x2="148" y2="164" class="solid"></line>
    <path d="M 148,164 A 4,4 0,0,0 152,168" class="nofill"></path>
    <line x1="152" y1="168" x2="168" y2="168" class="solid"></line>
  </g>
  <g>
    <line x1="148" y1="80" x2="148" y2="100" class="solid"></line>
    <path d="M 148,100 A 16,16 0,0,1 146,108" class="nofill"></path>
    <path d="M 148,100 A 16,16 0,0,0 150,108" class="nofill"></path>
  </g>
  <g>
    <line x1="192" y1="160" x2="224" y2="160" class="solid"></line>
    <line x1="192" y1="160" x2="184" y2="176" class="solid"></line>
    <line x1="184" y1="176" x2="216" y2="176" class="solid"></line>
    <line x1="224" y1="160" x2="216" y2="176" class="solid"></line>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="432" height="288" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="432" height="288"></rect>
  <rect x="84" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="188" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="244" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="316" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="84" y="72" width="104" height="32" class="solid nofill" rx="4"></rect>
  <text x="98" y="92">Filesystem</text>
  <rect x="220" y="72" width="96" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="92">Scheduler</text>
  <rect x="116" y="152" width="40" height="32" class="solid nofill" rx="4"></rect>
  <text x="130" y="172">IO</text>
  <rect x="300" y="152" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="314" y="172">Network</text>
  <rect x="100" y="232" width="320" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="252">HAL</text>
  <rect x="372" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="356" y="72" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="370" y="92">MMU</text>
  <line x1="100" y1="32" x2="100" y2="52" class="solid"></line>
  <polygon points="96,52 104,52 100,64" class="filled"></polygon>
  <line x1="156" y1="32" x2="156" y2="52" class="solid"></line>
  <polygon points="152,52 160,52 156,64" class="filled"></polygon>
  <polygon points="168,164 160,168 168,172" class="filled"></polygon>
  <line x1="260" y1="32" x2="260" y2="52" class="solid"></line>
  <polygon points="256,52 264,52 260,64" class="filled"></polygon>
  <line x1="332" y1="32" x2="332" y2="132" class="solid"></line>
  <polygon points="328,132 336,132 332,144" class="filled"></polygon>
  <line x1="140" y1="112" x2="140" y2="132" class="solid"></line>
  <polygon points="136,132 144,132 140,144" class="filled"></polygon>
  <line x1="260" y1="112" x2="260" y2="212" class="solid"></line>
  <polygon points="256,212 264,212 260,224" class="filled"></polygon>
  <line x1="140" y1="192" x2="140" y2="212" class="solid"></line>
  <polygon points="136,212 144,212 140,224" class="filled"></polygon>
  <line x1="340" y1="192" x2="340" y2="212" class="solid"></line>
  <polygon points="336,212 344,212 340,224" class="filled"></polygon>
  <line x1="388" y1="32" x2="388" y2="52" class="solid"></line>
  <polygon points="384,52 392,52 388,64" class="filled"></polygon>
  <text x="10" y="28">OS</text>
  <text x="34" y="28">API</text>
  <g>
    <line x1="204" y1="32" x2="204" y2="164" class="solid"></line>
    <line x1="168" y1="168" x2="200" y2="168" class="solid"></line>
    <path d="M 204,164 A 4,4 0,0,1 200,168" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="560" height="288" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="560" height="288"></rect>
  <rect x="236" y="72" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="92">Network</text>
  <rect x="388" y="72" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="92">Loss</text>
  <rect x="20" y="136" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="42" y="156">x1</text>
  <rect x="20" y="200" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="42" y="220">x2</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <polygon points="416,52 424,52 420,64" class="filled"></polygon>
  <text x="42" y="92">x0</text>
  <polygon points="216,84 224,88 216,92" class="filled"></polygon>
  <polygon points="272,124 276,112 280,124" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="260" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="80" class="solid"></line>
    <path d="M 4,260 A 4,4 0,0,0 8,264" class="nofill"></path>
    <line x1="8" y1="264" x2="88" y2="264" class="solid"></line>
    <line x1="92" y1="96" x2="92" y2="260" class="solid"></line>
    <path d="M 92,260 A 4,4 0,0,1 88,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="80" class="solid"></line>
    <line x1="192" y1="8" x2="540" y2="8" class="solid"></line>
    <path d="M 540,8 A 8,8 0,0,1 548,16" class="nofill"></path>
    <line x1="548" y1="16" x2="548" y2="160" class="solid"></line>
    <line x1="188" y1="96" x2="188" y2="164" class="solid"></line>
    <path d="M 188,164 A 4,4 0,0,0 192,168" class="nofill"></path>
    <line x1="192" y1="168" x2="540" y2="168" class="solid"></line>
    <path d="M 548,160 A 8,8 0,0,1 540,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,24 A 4,4 0,0,0 276,28" class="nofill"></path>
    <line x1="276" y1="28" x2="276" y2="64" class="solid"></line>
    <line x1="280" y1="24" x2="416" y2="24" class="solid"></line>
    <path d="M 416,24 A 4,4 0,0,1 420,28" class="nofill"></path>
    <line x1="420" y1="28" x2="420" y2="52" class="solid"></line>
  </g>
  <g>
    <path d="M 24,72 A 4,4 0,0,0 20,76" class="nofill"></path>
    <line x1="20" y1="76" x2="20" y2="100" class="solid"></line>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 72,72 A 4,4 0,0,1 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="100" class="solid"></line>
    <line x1="76" y1="88" x2="216" y2="88" class="solid"></line>
    <path d="M 20,100 A 4,4 0,0,0 24,104" class="nofill"></path>
    <line x1="24" y1="104" x2="72" y2="104" class="solid"></line>
    <path d="M 76,100 A 4,4 0,0,1 72,104" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="124" x2="276" y2="148" class="solid"></line>
    <path d="M 276,148 A 4,4 0,0,0 280,152" class="nofill"></path>
    <line x1="280" y1="152" x2="416" y2="152" class="solid"></line>
    <line x1="420" y1="112" x2="420" y2="148" class="solid"></line>
    <path d="M 420,148 A 4,4 0,0,1 416,152" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="496" height="576" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="496" height="576"></rect>
  <rect x="388" y="72" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="92">Loss</text>
  <rect x="236" y="264" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="284">Network</text>
  <rect x="388" y="264" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="284">Loss</text>
  <rect x="236" y="456" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="476">Network</text>
  <rect x="388" y="456" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="476">Loss</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <text x="42" y="92">x0</text>
  <polygon points="216,84 224,88 216,92" class="filled"></polygon>
  <text x="250" y="92">Network</text>
  <polygon points="376,84 384,88 376,92" class="filled"></polygon>
  <line x1="92" y1="96" x2="92" y2="272" class="solid"></line>
  <polygon points="272,124 276,112 280,124" class="filled"></polygon>
  <polygon points="321,124 314,116 314,127" class="filled"></polygon>
  <text x="202" y="220">GPU1</text>
  <polygon points="416,244 424,244 420,256" class="filled"></polygon>
  <text x="42" y="284">x1</text>
  <polygon points="216,276 224,280 216,284" class="filled"></polygon>
  <line x1="92" y1="288" x2="92" y2="464" class="solid"></line>
  <polygon points="272,316 276,304 280,316" class="filled"></polygon>
  <text x="202" y="412">GPU2</text>
  <polygon points="416,436 424,436 420,448" class="filled"></polygon>
  <text x="42" y="476">x2</text>
  <polygon points="216,468 224,472 216,476" class="filled"></polygon>
  <polygon points="272,508 276,496 280,508" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="548" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="80" class="solid"></line>
    <path d="M 4,548 A 4,4 0,0,0 8,552" class="nofill"></path>
    <line x1="8" y1="552" x2="88" y2="552" class="solid"></line>
    <line x1="92" y1="480" x2="92" y2="548" class="solid"></line>
    <path d="M 92,548 A 4,4 0,0,1 88,552" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="80" class="solid"></line>
    <line x1="192" y1="8" x2="480" y2="8" class="solid"></line>
    <path d="M 480,8 A 4,4 0,0,1 484,12" class="nofill"></path>
    <line x1="484" y1="12" x2="484" y2="164" class="solid"></line>
    <line x1="188" y1="96" x2="188" y2="164" class="solid"></line>
    <path d="M 188,164 A 4,4 0,0,0 192,168" class="nofill"></path>
    <line x1="192" y1="168" x2="480" y2="168" class="solid"></line>
    <path d="M 484,164 A 4,4 0,0,1 480,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,72 A 4,4 0,0,0 20,76" class="nofill"></path>
    <line x1="20" y1="76" x2="20" y2="100" class="solid"></line>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 72,72 A 4,4 0,0,1 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="100" class="solid"></line>
    <line x1="76" y1="88" x2="216" y2="88" class="solid"></line>
    <path d="M 20,100 A 4,4 0,0,0 24,104" class="nofill"></path>
    <line x1="24" y1="104" x2="72" y2="104" class="solid"></line>
    <path d="M 76,100 A 4,4 0,0,1 72,104" class="nofill"></path>
  </g>
  <g>
    <path d="M 240,72 A 4,4 0,0,0 236,76" class="nofill"></path>
    <line x1="236" y1="76" x2="236" y2="100" class="solid"></line>
    <line x1="240" y1="72" x2="312" y2="72" class="solid"></line>
    <path d="M 312,72 A 4,4 0,0,1 316,76" class="nofill"></path>
    <line x1="316" y1="76" x2="316" y2="100" class="solid"></line>
    <line x1="316" y1="88" x2="376" y2="88" class="solid"></line>
    <path d="M 236,100 A 4,4 0,0,0 240,104" class="nofill"></path>
    <line x1="240" y1="104" x2="312" y2="104" class="solid"></line>
    <path d="M 316,100 A 4,4 0,0,1 312,104" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="124" x2="276" y2="148" class="solid"></line>
    <path d="M 276,148 A 4,4 0,0,0 280,152" class="nofill"></path>
    <line x1="280" y1="152" x2="416" y2="152" class="solid"></line>
    <line x1="420" y1="112" x2="420" y2="148" class="solid"></line>
    <path d="M 420,148 A 4,4 0,0,1 416,152" class="nofill"></path>
  </g>
  <g>
    <line x1="318" y1="124" x2="328" y2="144" class="solid"></line>
    <line x1="384" y1="112" x2="368" y2="144" class="solid"></line>
    <line x1="328" y1="144" x2="368" y2="144" class="solid"></line>
  </g>
  <g>
    <path d="M 192,200 A 4,4 0,0,0 188,204" class="nofill"></path>
    <line x1="188" y1="204" x2="188" y2="272" class="solid"></line>
    <line x1="192" y1="200" x2="480" y2="200" class="solid"></line>
    <path d="M 480,200 A 4,4 0,0,1 484,204" class="nofill"></path>
    <line x1="484" y1="204" x2="484" y2="356" class="solid"></line>
    <line x1="188" y1="288" x2="188" y2="356" class="solid"></line>
    <path d="M 188,356 A 4,4 0,0,0 192,360" class="nofill"></path>
    <line x1="192" y1="360" x2="480" y2="360" class="solid"></line>
    <path d="M 484,356 A 4,4 0,0,1 480,360" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,216 A 4,4 0,0,0 276,220" class="nofill"></path>
    <line x1="276" y1="220" x2="276" y2="256" class="solid"></line>
    <line x1="280" y1="216" x2="416" y2="216" class="solid"></line>
    <path d="M 416,216 A 4,4 0,0,1 420,220" class="nofill"></path>
    <line x1="420" y1="220" x2="420" y2="244" class="solid"></line>
  </g>
  <g>
    <path d="M 24,264 A 4,4 0,0,0 20,268" class="nofill"></path>
    <line x1="20" y1="268" x2="20" y2="292" class="solid"></line>
    <line x1="24" y1="264" x2="72" y2="264" class="solid"></line>
    <path d="M 72,264 A 4,4 0,0,1 76,268" class="nofill"></path>
    <line x1="76" y1="268" x2="76" y2="292" class="solid"></line>
    <line x1="76" y1="280" x2="216" y2="280" class="solid"></line>
    <path d="M 20,292 A 4,4 0,0,0 24,296" class="nofill"></path>
    <line x1="24" y1="296" x2="72" y2="296" class="solid"></line>
    <path d="M 76,292 A 4,4 0,0,1 72,296" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="316" x2="276" y2="340" class="solid"></line>
    <path d="M 276,340 A 4,4 0,0,0 280,344" class="nofill"></path>
    <line x1="280" y1="344" x2="416" y2="344" class="solid"></line>
    <line x1="420" y1="304" x2="420" y2="340" class="solid"></line>
    <path d="M 420,340 A 4,4 0,0,1 416,344" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,392 A 4,4 0,0,0 188,396" class="nofill"></path>
    <line x1="188" y1="396" x2="188" y2="464" class="solid"></line>
    <line x1="192" y1="392" x2="480" y2="392" class="solid"></line>
    <path d="M 480,392 A 4,4 0,0,1 484,396" class="nofill"></path>
    <line x1="484" y1="396" x2="484" y2="548" class="solid"></line>
    <line x1="188" y1="480" x2="188" y2="548" class="solid"></line>
    <path d="M 188,548 A 4,4 0,0,0 192,552" class="nofill"></path>
    <line x1="192" y1="552" x2="480" y2="552" class="solid"></line>
    <path d="M 484,548 A 4,4 0,0,1 480,552" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,408 A 4,4 0,0,0 276,412" class="nofill"></path>
    <line x1="276" y1="412" x2="276" y2="448" class="solid"></line>
    <line x1="280" y1="408" x2="416" y2="408" class="solid"></line>
    <path d="M 416,408 A 4,4 0,0,1 420,412" class="nofill"></path>
    <line x1="420" y1="412" x2="420" y2="436" class="solid"></line>
  </g>
  <g>
    <path d="M 24,456 A 4,4 0,0,0 20,460" class="nofill"></path>
    <line x1="20" y1="460" x2="20" y2="484" class="solid"></line>
    <line x1="24" y1="456" x2="72" y2="456" class="solid"></line>
    <path d="M 72,456 A 4,4 0,0,1 76,460" class="nofill"></path>
    <line x1="76" y1="460" x2="76" y2="484" class="solid"></line>
    <line x1="76" y1="472" x2="216" y2="472" class="solid"></line>
    <path d="M 20,484 A 4,4 0,0,0 24,488" class="nofill"></path>
    <line x1="24" y1="488" x2="72" y2="488" class="solid"></line>
    <path d="M 76,484 A 4,4 0,0,1 72,488" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="508" x2="276" y2="532" class="solid"></line>
    <path d="M 276,532 A 4,4 0,0,0 280,536" class="nofill"></path>
    <line x1="280" y1="536" x2="416" y2="536" class="solid"></line>
    <line x1="420" y1="496" x2="420" y2="532" class="solid"></line>
    <path d="M 420,532 A 4,4 0,0,1 416,536" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="576" height="704" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

.svgbob .r{ 
    fill: #FF8180;
 }
.svgbob .g{ 
    fill: #97E6A5;
 }
.svgbob .b{ 
    fill: #7DCAFF;
 }
.svgbob .t{ 
    fill: none;
    stroke: #838383;
    color: #838383;
 }
.svgbob .r1{ 
    fill: papayawhip;
 }
.svgbob .r2{ 
    fill: crimson;
 }
.svgbob .a{ 
    stroke-dasharray: 8;
    fill: lightblue;
 }
.svgbob .bigrect{ 
    fill: yellow;
    stroke: red;
 }
.svgbob .red{ 
    fill:red;
    stroke:blue;
 }
.svgbob .container{ 
    fill: rgba(100,100,100, 0.1);
    stroke: #000;
 }</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="576" height="704"></rect>
  <rect x="4" y="40" width="560" height="448" class="broken nofill g container" rx="4"></rect>
  <rect x="36" y="72" width="56" height="32" class="solid nofill r1" rx="0"></rect>
  <rect x="124" y="72" width="56" height="32" class="solid nofill r2" rx="4"></rect>
  <rect x="308" y="72" width="216" height="160" class="solid nofill bigrect" rx="4"></rect>
  <circle cx="68" cy="304" r="36" class="nofill a"></circle>
  <text x="66" y="300">8</text>
  <circle cx="160" cy="304" r="40" class="nofill b"></circle>
  <text x="154" y="300">9</text>
  <circle cx="264" cy="312" r="44" class="nofill red"></circle>
  <text x="258" y="316">10</text>
  <circle cx="384" cy="312" r="44" class="nofill a b"></circle>
  <text x="378" y="316">11</text>
  <circle cx="96" cy="416" r="52" class="nofill c"></circle>
  <text x="90" y="412">12</text>
  <line x1="16" y1="8" x2="4" y2="8" class="solid end_marked_open_circle"></line>
  <polygon points="16,4 24,8 16,12" class="filled"></polygon>
  <text x="34" y="12">Latest</text>
  <text x="90" y="12">addition:</text>
  <text x="170" y="12">Styling</text>
  <text x="234" y="12">of</text>
  <text x="258" y="12">tagged</text>
  <text x="314" y="12">shapes</text>
  <text x="26" y="572">Advantages:</text>
  <line x1="8" y1="600" x2="20" y2="600" class="solid end_marked_circle"></line>
  <line x1="16" y1="600" x2="20" y2="600" class="solid"></line>
  <text x="34" y="604">Plain</text>
  <text x="82" y="604">text</text>
  <text x="122" y="604">format</text>
  <text x="34" y="620">Ultimately</text>
  <text x="122" y="620">portable,</text>
  <text x="34" y="636">Degrades</text>
  <text x="106" y="636">gracefully</text>
  <text x="34" y="652">Even</text>
  <text x="74" y="652">when</text>
  <text x="114" y="652">not</text>
  <text x="146" y="652">using</text>
  <text x="194" y="652">a</text>
  <text x="210" y="652">graphical</text>
  <text x="290" y="652">renderer,</text>
  <text x="370" y="652">it</text>
  <text x="394" y="652">would</text>
  <text x="442" y="652">still</text>
  <text x="490" y="652">looks</text>
  <text x="34" y="668">as</text>
  <text x="58" y="668">text</text>
  <text x="98" y="668">based</text>
  <text x="146" y="668">diagrams.</text>
  <text x="226" y="668">Paste</text>
  <text x="274" y="668">the</text>
  <text x="306" y="668">text</text>
  <text x="346" y="668">in</text>
  <text x="370" y="668">your</text>
  <text x="410" y="668">source</text>
  <text x="466" y="668">code.</text>
  <text x="34" y="684">Easiest</text>
  <text x="98" y="684">to</text>
  <text x="122" y="684">use.</text>
  <text x="162" y="684">Anyone</text>
  <text x="218" y="684">knows</text>
  <text x="266" y="684">how</text>
  <text x="298" y="684">to</text>
  <text x="322" y="684">edit</text>
  <text x="362" y="684">text.</text>
  <text x="202" y="620">backward</text>
  <text x="274" y="620">compatible</text>
  <text x="362" y="620">and</text>
  <text x="394" y="620">future</text>
  <text x="450" y="620">proof.</text>
  <line x1="8" y1="632" x2="20" y2="632" class="solid end_marked_circle"></line>
  <line x1="16" y1="632" x2="20" y2="632" class="solid"></line>
  <text x="538" y="652">good</text>
  <line x1="8" y1="680" x2="20" y2="680" class="solid end_marked_circle"></line>
  <line x1="16" y1="680" x2="20" y2="680" class="solid"></line>
  <g>
    <line x1="48" y1="128" x2="104" y2="128" class="solid"></line>
    <line x1="48" y1="128" x2="32" y2="160" class="solid"></line>
    <line x1="104" y1="128" x2="120" y2="160" class="solid"></line>
    <line x1="32" y1="160" x2="48" y2="192" class="solid"></line>
    <line x1="120" y1="160" x2="104" y2="192" class="solid"></line>
    <line x1="48" y1="192" x2="104" y2="192" class="solid"></line>
  </g>
  <g>
    <path d="M 224,72 A 8,8 0,0,0 218,76" class="nofill"></path>
    <line x1="218" y1="76" x2="216" y2="80" class="solid"></line>
    <line x1="224" y1="72" x2="272" y2="72" class="solid"></line>
    <path d="M 272,72 A 8,8 0,0,1 278,76" class="nofill"></path>
    <line x1="278" y1="76" x2="280" y2="80" class="solid"></line>
    <path d="M 216,80 A 16,16 0,0,0 216,96" class="nofill"></path>
    <path d="M 280,80 A 16,16 0,0,1 280,96" class="nofill"></path>
    <line x1="216" y1="96" x2="218" y2="100" class="solid"></line>
    <path d="M 218,100 A 8,8 0,0,0 224,104" class="nofill"></path>
    <line x1="224" y1="104" x2="272" y2="104" class="solid"></line>
    <line x1="280" y1="96" x2="278" y2="100" class="solid"></line>
    <path d="M 278,100 A 8,8 0,0,1 272,104" class="nofill"></path>
  </g>
  <g>
    <line x1="200" y1="128" x2="264" y2="128" class="solid"></line>
    <line x1="200" y1="128" x2="208" y2="144" class="solid"></line>
    <line x1="264" y1="128" x2="272" y2="144" class="solid"></line>
    <path d="M 208,144 A 16,16 0,0,1 208,160" class="nofill"></path>
    <path d="M 272,144 A 16,16 0,0,1 272,160" class="nofill"></path>
    <line x1="208" y1="160" x2="200" y2="176" class="solid"></line>
    <line x1="200" y1="176" x2="264" y2="176" class="solid"></line>
    <line x1="272" y1="160" x2="264" y2="176" class="solid"></line>
  </g>
  <g>
    <line x1="168" y1="128" x2="152" y2="160" class="solid"></line>
    <line x1="168" y1="128" x2="184" y2="160" class="solid"></line>
    <line x1="152" y1="160" x2="168" y2="192" class="solid"></line>
    <line x1="184" y1="160" x2="168" y2="192" class="solid"></line>
  </g>
  <g>
    <path d="M 184,392 A 3,3 0,0,0 182,396" class="nofill"></path>
    <line x1="182" y1="396" x2="204" y2="440" class="solid"></line>
    <line x1="184" y1="392" x2="224" y2="392" class="solid"></line>
    <path d="M 224,392 A 3,3 0,0,1 226,396" class="nofill"></path>
    <line x1="226" y1="396" x2="204" y2="440" class="solid"></line>
  </g>
  <g>
    <path d="M 248,392 A 3,3 0,0,0 246,396" class="nofill"></path>
    <line x1="246" y1="396" x2="266" y2="436" class="solid"></line>
    <line x1="248" y1="392" x2="280" y2="392" class="solid"></line>
    <path d="M 280,392 A 8,8 0,0,1 286,396" class="nofill"></path>
    <line x1="286" y1="396" x2="306" y2="436" class="solid"></line>
    <path d="M 266,436 A 8,8 0,0,0 272,440" class="nofill"></path>
    <line x1="272" y1="440" x2="304" y2="440" class="solid"></line>
    <path d="M 306,436 A 3,3 0,0,1 304,440" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,552 A 8,8 0,0,0 18,556" class="nofill"></path>
    <line x1="18" y1="556" x2="6" y2="580" class="solid"></line>
    <line x1="24" y1="552" x2="128" y2="552" class="solid"></line>
    <path d="M 128,552 A 3,3 0,0,1 130,556" class="nofill"></path>
    <line x1="130" y1="556" x2="118" y2="580" class="solid"></line>
    <path d="M 6,580 A 3,3 0,0,0 8,584" class="nofill"></path>
    <line x1="8" y1="584" x2="112" y2="584" class="solid"></line>
    <path d="M 118,580 A 8,8 0,0,1 112,584" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="760" height="7520" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="760" height="7520"></rect>
  <rect x="68" y="312" width="56" height="32" class="solid nofill" rx="0"></rect>
  <rect x="156" y="312" width="56" height="32" class="solid nofill" rx="4"></rect>
  <path d="M 88,468 A 20,20 0,0,0 88,508" class="nofill"></path>
  <circle cx="72" cy="536" r="4" class="nofill"></circle>
  <circle cx="444" cy="568" r="24" class="nofill"></circle>
  <circle cx="520" cy="568" r="28" class="nofill"></circle>
  <circle cx="156" cy="568" r="16" class="nofill"></circle>
  <circle cx="208" cy="568" r="20" class="nofill"></circle>
  <circle cx="264" cy="568" r="20" class="nofill"></circle>
  <path d="M 272,560 A 16,16 0,0,0 272,576" class="nofill"></path>
  <circle cx="360" cy="568" r="20" class="nofill"></circle>
  <circle cx="76" cy="568" r="8" class="nofill"></circle>
  <circle cx="100" cy="656" r="36" class="nofill"></circle>
  <circle cx="192" cy="656" r="40" class="nofill"></circle>
  <circle cx="296" cy="664" r="44" class="nofill"></circle>
  <circle cx="420" cy="664" r="48" class="nofill"></circle>
  <circle cx="128" cy="768" r="52" class="nofill"></circle>
  <rect x="146" y="1176" width="28" height="36" class="solid nofill" rx="0"></rect>
  <rect x="150" y="1180" width="12" height="12" class="solid nofill" rx="0"></rect>
  <rect x="166" y="1180" width="4" height="12" class="solid nofill" rx="0"></rect>
  <rect x="150" y="1196" width="12" height="12" class="solid nofill" rx="0"></rect>
  <rect x="166" y="1196" width="4" height="12" class="solid nofill" rx="0"></rect>
  <circle cx="72" cy="1376" r="40" class="nofill"></circle>
  <path d="M 200,1336 A 40,40 0,0,0 160,1376" class="nofill"></path>
  <path d="M 216,1336 A 40,40 0,0,1 256,1376" class="nofill"></path>
  <path d="M 312,1376 A 40,40 0,0,1 392,1376" class="nofill"></path>
  <path d="M 480,1352 A 40,40 0,0,0 480,1432" class="nofill"></path>
  <path d="M 504,1352 A 40,40 0,0,1 504,1432" class="nofill"></path>
  <path d="M 160,1392 A 40,40 0,0,0 200,1432" class="nofill"></path>
  <path d="M 256,1392 A 40,40 0,0,1 216,1432" class="nofill"></path>
  <path d="M 312,1392 A 40,40 0,0,0 392,1392" class="nofill"></path>
  <path d="M 112,1488 A 40,40 0,1,0 72,1528" class="nofill"></path>
  <path d="M 208,1448 A 40,40 0,1,0 248,1488" class="nofill"></path>
  <path d="M 352,1448 A 40,40 0,1,1 312,1488" class="nofill"></path>
  <path d="M 456,1488 A 40,40 0,1,1 496,1528" class="nofill"></path>
  <circle cx="516" cy="2168" r="16" class="nofill"></circle>
  <line x1="520" y1="2160" x2="512" y2="2176" class="solid"></line>
  <rect x="92" y="2296" width="104" height="32" class="solid nofill" rx="4"></rect>
  <rect x="228" y="2296" width="96" height="32" class="solid nofill" rx="4"></rect>
  <rect x="364" y="2296" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="378" y="2316">MMU</text>
  <rect x="212" y="2520" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="212" y="2712" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="108" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="172" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="308" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="364" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="412" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="468" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="540" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="308" y="4472" width="104" height="32" class="solid nofill" rx="4"></rect>
  <text x="322" y="4492">Filesystem</text>
  <rect x="444" y="4472" width="96" height="32" class="solid nofill" rx="4"></rect>
  <text x="458" y="4492">Scheduler</text>
  <rect x="340" y="4552" width="40" height="32" class="solid nofill" rx="4"></rect>
  <text x="354" y="4572">IO</text>
  <rect x="524" y="4552" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="538" y="4572">Network</text>
  <rect x="308" y="4632" width="320" height="32" class="solid nofill" rx="4"></rect>
  <text x="458" y="4652">HAL</text>
  <rect x="596" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="580" y="4472" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="594" y="4492">MMU</text>
  <rect x="580" y="4800" width="24" height="48" class="solid nofill" rx="0"></rect>
  <line x1="584" y1="4806" x2="600" y2="4806" class="solid"></line>
  <line x1="584" y1="4810" x2="600" y2="4810" class="solid"></line>
  <rect x="36" y="6856" width="560" height="448" class="broken nofill container" rx="4"></rect>
  <rect x="68" y="6888" width="56" height="32" class="solid nofill r1" rx="0"></rect>
  <rect x="156" y="6888" width="56" height="32" class="solid nofill r2" rx="4"></rect>
  <rect x="340" y="6888" width="216" height="160" class="solid nofill bigrect" rx="4"></rect>
  <circle cx="100" cy="7120" r="36" class="nofill a"></circle>
  <text x="98" y="7116">8</text>
  <circle cx="192" cy="7120" r="40" class="nofill b"></circle>
  <text x="186" y="7116">9</text>
  <circle cx="296" cy="7128" r="44" class="nofill red"></circle>
  <text x="290" y="7132">10</text>
  <circle cx="416" cy="7128" r="44" class="nofill a b"></circle>
  <text x="410" y="7132">11</text>
  <circle cx="128" cy="7232" r="52" class="nofill c"></circle>
  <text x="122" y="7228">12</text>
  <text x="2" y="12">Svgbob</text>
  <text x="58" y="12">is</text>
  <text x="82" y="12">a</text>
  <text x="98" y="12">diagramming</text>
  <text x="194" y="12">model</text>
  <text x="2" y="28">which</text>
  <text x="50" y="28">uses</text>
  <text x="90" y="28">a</text>
  <text x="106" y="28">set</text>
  <text x="138" y="28">of</text>
  <text x="162" y="28">typing</text>
  <text x="218" y="28">characters</text>
  <text x="2" y="44">to</text>
  <text x="26" y="44">approximate</text>
  <text x="122" y="44">the</text>
  <text x="154" y="44">intended</text>
  <text x="226" y="44">shape.</text>
  <line x1="58" y1="76" x2="36" y2="120" class="solid end_marked_circle"></line>
  <line x1="52" y1="88" x2="68" y2="88" class="solid end_marked_open_circle"></line>
  <line x1="72" y1="88" x2="104" y2="88" class="solid"></line>
  <polygon points="88,100 96,104 88,108" class="filled"></polygon>
  <text x="2" y="188">It</text>
  <text x="26" y="188">uses</text>
  <text x="66" y="188">a</text>
  <text x="2" y="204">which</text>
  <text x="50" y="204">are</text>
  <text x="82" y="188">combination</text>
  <text x="178" y="188">of</text>
  <text x="202" y="188">characters</text>
  <text x="82" y="204">readily</text>
  <text x="146" y="204">available</text>
  <text x="226" y="204">on</text>
  <text x="250" y="204">your</text>
  <text x="290" y="204">keyboards.</text>
  <text x="2" y="236">What</text>
  <text x="42" y="236">can</text>
  <text x="74" y="236">it</text>
  <text x="98" y="236">do?</text>
  <line x1="24" y1="264" x2="12" y2="264" class="solid end_marked_open_circle"></line>
  <polygon points="24,260 32,264 24,268" class="filled"></polygon>
  <text x="50" y="268">Basic</text>
  <text x="98" y="268">shapes</text>
  <line x1="56" y1="280" x2="64" y2="280" class="solid"></line>
  <line x1="72" y1="280" x2="80" y2="280" class="solid"></line>
  <line x1="88" y1="280" x2="96" y2="280" class="solid"></line>
  <line x1="104" y1="280" x2="112" y2="280" class="solid"></line>
  <line x1="120" y1="280" x2="128" y2="280" class="solid"></line>
  <line x1="136" y1="280" x2="144" y2="280" class="solid"></line>
  <line x1="152" y1="280" x2="160" y2="280" class="solid"></line>
  <line x1="168" y1="280" x2="176" y2="280" class="solid"></line>
  <line x1="184" y1="280" x2="192" y2="280" class="solid"></line>
  <line x1="200" y1="280" x2="208" y2="280" class="solid"></line>
  <line x1="216" y1="280" x2="224" y2="280" class="solid"></line>
  <line x1="232" y1="280" x2="240" y2="280" class="solid"></line>
  <line x1="248" y1="280" x2="256" y2="280" class="solid"></line>
  <line x1="264" y1="280" x2="272" y2="280" class="solid"></line>
  <line x1="280" y1="280" x2="288" y2="280" class="solid"></line>
  <line x1="296" y1="280" x2="304" y2="280" class="solid"></line>
  <line x1="312" y1="280" x2="320" y2="280" class="solid"></line>
  <line x1="328" y1="280" x2="336" y2="280" class="solid"></line>
  <line x1="344" y1="280" x2="352" y2="280" class="solid"></line>
  <line x1="360" y1="280" x2="368" y2="280" class="solid"></line>
  <line x1="376" y1="280" x2="384" y2="280" class="solid"></line>
  <line x1="392" y1="280" x2="400" y2="280" class="solid"></line>
  <line x1="408" y1="280" x2="416" y2="280" class="solid"></line>
  <line x1="424" y1="280" x2="432" y2="280" class="solid"></line>
  <line x1="440" y1="280" x2="448" y2="280" class="solid"></line>
  <line x1="456" y1="280" x2="464" y2="280" class="solid"></line>
  <text x="458" y="300">.</text>
  <text x="426" y="332">.</text>
  <text x="490" y="332">.</text>
  <text x="458" y="364">.</text>
  <line x1="472" y1="280" x2="480" y2="280" class="solid"></line>
  <line x1="488" y1="280" x2="496" y2="280" class="solid"></line>
  <line x1="504" y1="280" x2="512" y2="280" class="solid"></line>
  <line x1="520" y1="280" x2="528" y2="280" class="solid"></line>
  <line x1="536" y1="280" x2="544" y2="280" class="solid"></line>
  <polygon points="519,332 526,324 526,335" class="filled"></polygon>
  <line x1="522" y1="332" x2="502" y2="372" class="solid"></line>
  <polygon points="550.8,348 550.8,340 545.2,340 545.2,348" class="filled"></polygon>
  <line x1="546" y1="348" x2="526" y2="388" class="solid"></line>
  <polygon points="519,364 526,356 526,367" class="filled"></polygon>
  <line x1="522" y1="364" x2="504" y2="400" class="solid"></line>
  <polygon points="502.8,380 502.8,372 497.2,372 497.2,380" class="filled"></polygon>
  <polygon points="529,388 522,396 522,385" class="filled"></polygon>
  <rect x="416" y="356" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="420" y1="364" x2="420" y2="404" class="solid"></line>
  <polygon points="416,404 424,404 420,416" class="filled"></polygon>
  <line x1="360" y1="376" x2="348" y2="376" class="solid end_marked_open_circle"></line>
  <line x1="360" y1="376" x2="384" y2="376" class="solid"></line>
  <polygon points="384,372 392,376 384,380" class="filled"></polygon>
  <polygon points="352,388 344,392 352,396" class="filled"></polygon>
  <line x1="352" y1="392" x2="384" y2="392" class="solid"></line>
  <rect x="384" y="388" width="8" height="8" class="solid filled" rx="0"></rect>
  <polygon points="432,380 436,368 440,380" class="filled"></polygon>
  <line x1="436" y1="380" x2="436" y2="424" class="solid end_marked_open_circle"></line>
  <polygon points="456,396 460,384 464,396" class="filled"></polygon>
  <line x1="460" y1="396" x2="460" y2="432" class="broken"></line>
  <line x1="476" y1="384" x2="476" y2="420" class="broken"></line>
  <polygon points="472,420 480,420 476,432" class="filled"></polygon>
  <line x1="478" y1="460" x2="476" y2="456" class="solid end_marked_big_open_circle"></line>
  <line x1="480" y1="464" x2="498" y2="500" class="solid"></line>
  <polygon points="495,500 502,508 502,497" class="filled"></polygon>
  <polygon points="240,500 248,504 240,508" class="filled"></polygon>
  <polygon points="272,468 264,472 272,476" class="filled"></polygon>
  <polygon points="336,468 344,472 336,476" class="filled"></polygon>
  <polygon points="360,500 352,504 360,508" class="filled"></polygon>
  <polygon points="465,476 458,468 458,479" class="filled"></polygon>
  <line x1="462" y1="476" x2="484" y2="520" class="solid end_marked_circle"></line>
  <line x1="24" y1="888" x2="12" y2="888" class="solid end_marked_open_circle"></line>
  <polygon points="24,884 32,888 24,892" class="filled"></polygon>
  <text x="50" y="892">Quick</text>
  <text x="98" y="892">logo</text>
  <line x1="66" y1="908" x2="44" y2="952" class="solid end_marked_circle"></line>
  <line x1="60" y1="920" x2="76" y2="920" class="solid end_marked_open_circle"></line>
  <line x1="80" y1="920" x2="112" y2="920" class="solid"></line>
  <polygon points="96,932 104,936 96,940" class="filled"></polygon>
  <text x="138" y="892">scribbles</text>
  <line x1="276" y1="944" x2="276" y2="968" class="solid end_marked_circle"></line>
  <line x1="172" y1="956" x2="172" y2="952" class="solid end_marked_big_open_circle"></line>
  <line x1="416" y1="952" x2="436" y2="952" class="solid end_marked_circle"></line>
  <line x1="432" y1="952" x2="448" y2="952" class="solid"></line>
  <polygon points="344,948 352,952 344,956" class="filled"></polygon>
  <text x="58" y="1100">.::::.</text>
  <line x1="24" y1="1160" x2="12" y2="1160" class="solid end_marked_open_circle"></line>
  <polygon points="24,1156 32,1160 24,1164" class="filled"></polygon>
  <text x="50" y="1164">Even</text>
  <text x="90" y="1164">unicode</text>
  <text x="154" y="1164">box</text>
  <text x="186" y="1164">drawing</text>
  <text x="250" y="1164">characters</text>
  <text x="338" y="1164">are</text>
  <text x="370" y="1164">supported</text>
  <line x1="24" y1="1288" x2="12" y2="1288" class="solid end_marked_open_circle"></line>
  <polygon points="24,1284 32,1288 24,1292" class="filled"></polygon>
  <text x="42" y="1292">Circle,</text>
  <text x="106" y="1292">quarter</text>
  <text x="170" y="1292">arcs,</text>
  <text x="218" y="1292">half</text>
  <text x="258" y="1292">circles,</text>
  <text x="330" y="1292">3</text>
  <line x1="344" y1="1280" x2="336" y2="1296" class="solid"></line>
  <text x="346" y="1292">4</text>
  <text x="362" y="1292">quarter</text>
  <text x="426" y="1292">arcs</text>
  <line x1="24" y1="1560" x2="12" y2="1560" class="solid end_marked_open_circle"></line>
  <polygon points="24,1556 32,1560 24,1564" class="filled"></polygon>
  <text x="42" y="1564">Grids</text>
  <text x="42" y="1660">{r}</text>
  <text x="42" y="1724">{g}</text>
  <line x1="24" y1="2024" x2="12" y2="2024" class="solid end_marked_open_circle"></line>
  <polygon points="24,2020 32,2024 24,2028" class="filled"></polygon>
  <text x="42" y="2028">Graphics</text>
  <text x="114" y="2028">Diagram</text>
  <line x1="618" y1="2060" x2="620" y2="2056" class="solid end_marked_circle"></line>
  <polygon points="569,2076 562,2068 562,2079" class="filled"></polygon>
  <line x1="566" y1="2076" x2="586" y2="2116" class="solid"></line>
  <line x1="616" y1="2064" x2="598" y2="2100" class="solid"></line>
  <polygon points="601,2100 594,2108 594,2097" class="filled"></polygon>
  <line x1="520" y1="2120" x2="588" y2="2120" class="solid end_marked_circle"></line>
  <line x1="584" y1="2120" x2="656" y2="2120" class="solid"></line>
  <text x="34" y="2076">0</text>
  <text x="98" y="2076">3</text>
  <line x1="44" y1="2088" x2="44" y2="2088" class="solid end_marked_circle"></line>
  <line x1="42" y1="2092" x2="28" y2="2120" class="solid end_marked_circle"></line>
  <line x1="44" y1="2092" x2="44" y2="2152" class="solid end_marked_circle"></line>
  <line x1="48" y1="2088" x2="108" y2="2088" class="solid end_marked_circle"></line>
  <line x1="104" y1="2088" x2="108" y2="2088" class="solid"></line>
  <line x1="106" y1="2092" x2="94" y2="2116" class="solid"></line>
  <line x1="108" y1="2092" x2="108" y2="2148" class="solid"></line>
  <text x="18" y="2108">1</text>
  <text x="82" y="2108">2</text>
  <line x1="28" y1="2120" x2="92" y2="2120" class="solid end_marked_circle"></line>
  <line x1="88" y1="2120" x2="92" y2="2120" class="solid"></line>
  <line x1="28" y1="2124" x2="28" y2="2180" class="solid"></line>
  <line x1="92" y1="2124" x2="92" y2="2180" class="solid"></line>
  <text x="50" y="2140">4</text>
  <text x="114" y="2140">7</text>
  <line x1="44" y1="2152" x2="108" y2="2152" class="solid end_marked_circle"></line>
  <line x1="104" y1="2152" x2="108" y2="2152" class="solid"></line>
  <line x1="42" y1="2156" x2="28" y2="2184" class="solid end_marked_circle"></line>
  <line x1="106" y1="2156" x2="94" y2="2180" class="solid"></line>
  <line x1="28" y1="2184" x2="92" y2="2184" class="solid end_marked_circle"></line>
  <line x1="88" y1="2184" x2="92" y2="2184" class="solid"></line>
  <text x="18" y="2204">5</text>
  <text x="82" y="2204">6</text>
  <text x="314" y="2076">P</text>
  <line x1="334" y1="2076" x2="332" y2="2072" class="solid end_marked_circle"></line>
  <line x1="336" y1="2080" x2="370" y2="2148" class="solid"></line>
  <text x="306" y="2124">v0</text>
  <text x="418" y="2124">v3</text>
  <line x1="324" y1="2136" x2="324" y2="2136" class="solid end_marked_circle"></line>
  <line x1="322" y1="2140" x2="292" y2="2200" class="solid end_marked_circle"></line>
  <line x1="328" y1="2136" x2="412" y2="2136" class="solid end_marked_circle"></line>
  <line x1="408" y1="2136" x2="412" y2="2136" class="solid"></line>
  <line x1="414" y1="2140" x2="442" y2="2196" class="solid"></line>
  <polygon points="367,2148 374,2156 374,2145" class="filled"></polygon>
  <text x="386" y="2156">X</text>
  <line x1="384" y1="2160" x2="380" y2="2168" class="solid end_marked_open_circle"></line>
  <line x1="292" y1="2200" x2="444" y2="2200" class="solid end_marked_circle"></line>
  <line x1="440" y1="2200" x2="444" y2="2200" class="solid"></line>
  <text x="450" y="2076">Eye</text>
  <path d="M 480,2080 A 16,16 0,0,1 480,2096" class="nofill"></path>
  <text x="162" y="2092">+y</text>
  <polygon points="168,2108 172,2096 176,2108" class="filled"></polygon>
  <polygon points="192,2132 184,2136 192,2140" class="filled"></polygon>
  <path d="M 160,2148 A 4,4 0,0,0 156,2156" class="nofill"></path>
  <polygon points="159,2159 157,2155 155,2157" class="filled"></polygon>
  <polygon points="216,2148 224,2152 216,2156" class="filled"></polygon>
  <text x="178" y="2172">‚§¥</text>
  <polygon points="161,2180 154,2188 154,2177" class="filled"></polygon>
  <text x="138" y="2204">+z</text>
  <text x="626" y="2092">Reflection</text>
  <text x="234" y="2156">+x</text>
  <polygon points="536,2148 528,2152 536,2156" class="filled"></polygon>
  <line x1="536" y1="2152" x2="600" y2="2152" class="solid"></line>
  <text x="546" y="2172">Refraction</text>
  <line x1="508" y1="2192" x2="508" y2="2212" class="solid"></line>
  <polygon points="504,2212 512,2212 508,2224" class="filled"></polygon>
  <line x1="666" y1="2156" x2="668" y2="2152" class="solid end_marked_open_circle"></line>
  <line x1="670" y1="2156" x2="690" y2="2196" class="solid"></line>
  <line x1="664" y1="2160" x2="644" y2="2200" class="solid end_marked_open_circle"></line>
  <line x1="648" y1="2200" x2="692" y2="2200" class="solid end_marked_open_circle"></line>
  <text x="266" y="2204">v1</text>
  <text x="458" y="2204">v2</text>
  <line x1="24" y1="2264" x2="12" y2="2264" class="solid end_marked_open_circle"></line>
  <polygon points="24,2260 32,2264 24,2268" class="filled"></polygon>
  <text x="42" y="2268">CJK</text>
  <text x="74" y="2268">characters</text>
  <line x1="212" y1="2288" x2="212" y2="2336" class="solid"></line>
  <line x1="340" y1="2288" x2="340" y2="2336" class="solid"></line>
  <line x1="24" y1="2360" x2="12" y2="2360" class="solid end_marked_open_circle"></line>
  <polygon points="24,2356 32,2360 24,2364" class="filled"></polygon>
  <text x="50" y="2364">Sequence</text>
  <text x="122" y="2364">Diagrams</text>
  <polygon points="312,2388 320,2392 312,2396" class="filled"></polygon>
  <text x="82" y="2412">A</text>
  <text x="146" y="2412">B</text>
  <text x="202" y="2412">C</text>
  <text x="226" y="2412">D</text>
  <line x1="84" y1="2424" x2="84" y2="2424" class="solid end_marked_circle"></line>
  <line x1="88" y1="2424" x2="148" y2="2424" class="solid end_marked_circle"></line>
  <line x1="144" y1="2424" x2="196" y2="2424" class="solid end_marked_circle"></line>
  <line x1="150" y1="2428" x2="162" y2="2452" class="solid"></line>
  <line x1="192" y1="2424" x2="228" y2="2424" class="solid end_marked_circle"></line>
  <line x1="224" y1="2424" x2="268" y2="2424" class="solid end_marked_circle"></line>
  <line x1="264" y1="2424" x2="312" y2="2424" class="solid"></line>
  <polygon points="312,2420 320,2424 312,2428" class="filled"></polygon>
  <polygon points="255,2444 262,2436 262,2447" class="filled"></polygon>
  <polygon points="159,2452 166,2460 166,2449" class="filled"></polygon>
  <polygon points="312,2452 320,2456 312,2460" class="filled"></polygon>
  <text x="170" y="2476">B</text>
  <text x="338" y="2396">F</text>
  <text x="338" y="2428">E</text>
  <text x="338" y="2460">G</text>
  <line x1="184" y1="2472" x2="200" y2="2472" class="solid"></line>
  <polygon points="200,2468 208,2472 200,2476" class="filled"></polygon>
  <text x="218" y="2476">C</text>
  <line x1="216" y1="2544" x2="208" y2="2560" class="solid"></line>
  <line x1="224" y1="2544" x2="232" y2="2560" class="solid"></line>
  <text x="82" y="2588">Bob</text>
  <text x="202" y="2604">Alice</text>
  <text x="130" y="2620">hello</text>
  <line x1="220" y1="2608" x2="220" y2="2688" class="solid"></line>
  <polygon points="208,2628 216,2632 208,2636" class="filled"></polygon>
  <text x="114" y="2668">Is</text>
  <polygon points="104,2676 96,2680 104,2684" class="filled"></polygon>
  <line x1="104" y1="2680" x2="112" y2="2680" class="solid"></line>
  <line x1="120" y1="2680" x2="128" y2="2680" class="solid"></line>
  <line x1="200" y1="2680" x2="208" y2="2680" class="solid"></line>
  <text x="202" y="2700">Alice</text>
  <text x="82" y="2716">Bob</text>
  <line x1="216" y1="2736" x2="208" y2="2752" class="solid"></line>
  <line x1="224" y1="2736" x2="232" y2="2752" class="solid"></line>
  <text x="138" y="2668">it</text>
  <text x="162" y="2668">ok?</text>
  <line x1="136" y1="2680" x2="144" y2="2680" class="solid"></line>
  <line x1="152" y1="2680" x2="160" y2="2680" class="solid"></line>
  <line x1="168" y1="2680" x2="176" y2="2680" class="solid"></line>
  <line x1="184" y1="2680" x2="192" y2="2680" class="solid"></line>
  <text x="122" y="2844">0</text>
  <line x1="104" y1="2864" x2="86" y2="2900" class="solid"></line>
  <polygon points="89,2900 82,2908 82,2897" class="filled"></polygon>
  <text x="82" y="2940">1</text>
  <line x1="88" y1="2960" x2="106" y2="2996" class="solid"></line>
  <polygon points="103,2996 110,3004 110,2993" class="filled"></polygon>
  <text x="114" y="3036">3</text>
  <line x1="144" y1="2864" x2="162" y2="2900" class="solid"></line>
  <polygon points="159,2900 166,2908 166,2897" class="filled"></polygon>
  <text x="178" y="2940">4</text>
  <text x="202" y="2956">.</text>
  <line x1="172" y1="2960" x2="172" y2="3012" class="solid"></line>
  <line x1="192" y1="2960" x2="218" y2="3012" class="solid"></line>
  <line x1="204" y1="2952" x2="252" y2="3000" class="broken"></line>
  <text x="250" y="3004">.</text>
  <polygon points="168,3012 176,3012 172,3024" class="filled"></polygon>
  <polygon points="215,3012 222,3020 222,3009" class="filled"></polygon>
  <polygon points="256,3012 264,3016 260,3008" class="filled"></polygon>
  <text x="178" y="3052">5</text>
  <text x="226" y="3052">6</text>
  <text x="274" y="3052">7</text>
  <line x1="64" y1="2960" x2="46" y2="2996" class="solid"></line>
  <polygon points="49,2996 42,3004 42,2993" class="filled"></polygon>
  <text x="42" y="3036">2</text>
  <line x1="24" y1="3128" x2="12" y2="3128" class="solid end_marked_open_circle"></line>
  <polygon points="24,3124 32,3128 24,3132" class="filled"></polygon>
  <text x="42" y="3132">Plot</text>
  <text x="82" y="3132">diagrams</text>
  <polygon points="64,3164 68,3152 72,3164" class="filled"></polygon>
  <line x1="68" y1="3164" x2="68" y2="3224" class="broken end_marked_circle"></line>
  <polygon points="296,3220 304,3224 296,3228" class="filled"></polygon>
  <text x="34" y="3180">Uin</text>
  <text x="42" y="3260">Udc</text>
  <polygon points="64,3260 68,3248 72,3260" class="filled"></polygon>
  <line x1="68" y1="3260" x2="68" y2="3320" class="broken end_marked_circle"></line>
  <line x1="140" y1="3280" x2="140" y2="3344" class="broken"></line>
  <line x1="144" y1="3320" x2="296" y2="3320" class="broken"></line>
  <polygon points="296,3316 304,3320 296,3324" class="filled"></polygon>
  <polygon points="152,3332 144,3336 152,3340" class="filled"></polygon>
  <line x1="152" y1="3336" x2="192" y2="3336" class="solid"></line>
  <polygon points="192,3332 200,3336 192,3340" class="filled"></polygon>
  <line x1="204" y1="3328" x2="204" y2="3376" class="broken"></line>
  <polygon points="64,3356 68,3344 72,3356" class="filled"></polygon>
  <line x1="68" y1="3356" x2="68" y2="3432" class="broken end_marked_circle"></line>
  <text x="154" y="3356">500ms</text>
  <text x="226" y="3404">Inactive</text>
  <text x="106" y="3420">Active</text>
  <polygon points="296,3428 304,3432 296,3436" class="filled"></polygon>
  <text x="2" y="3388">Cpu.Qon</text>
  <line x1="24" y1="3464" x2="12" y2="3464" class="solid end_marked_open_circle"></line>
  <polygon points="24,3460 32,3464 24,3468" class="filled"></polygon>
  <text x="42" y="3468">Railroad</text>
  <text x="114" y="3468">diagrams</text>
  <line x1="80" y1="3512" x2="68" y2="3512" class="solid end_marked_open_circle"></line>
  <text x="138" y="3516">elem</text>
  <text x="218" y="3516">;</text>
  <text x="266" y="3516">n</text>
  <line x1="312" y1="3512" x2="332" y2="3512" class="solid end_marked_open_circle"></line>
  <polygon points="160,3540 168,3544 160,3548" class="filled"></polygon>
  <line x1="112" y1="3576" x2="120" y2="3576" class="solid"></line>
  <text x="162" y="3580">x</text>
  <line x1="208" y1="3576" x2="216" y2="3576" class="solid"></line>
  <line x1="308" y1="3584" x2="308" y2="3616" class="solid"></line>
  <text x="162" y="3628">,</text>
  <polygon points="304,3628 308,3616 312,3628" class="filled"></polygon>
  <polygon points="184,3652 192,3656 184,3660" class="filled"></polygon>
  <text x="162" y="3692">x</text>
  <text x="218" y="3692">,</text>
  <polygon points="200,3716 192,3720 200,3724" class="filled"></polygon>
  <polygon points="416,3732 424,3736 416,3740" class="filled"></polygon>
  <text x="50" y="3772">O</text>
  <text x="106" y="3772">struct</text>
  <line x1="152" y1="3776" x2="160" y2="3776" class="solid"></line>
  <text x="162" y="3772">name</text>
  <text x="234" y="3772">:</text>
  <line x1="256" y1="3776" x2="264" y2="3776" class="solid"></line>
  <line x1="284" y1="3760" x2="284" y2="3776" class="solid"></line>
  <text x="354" y="3772">name</text>
  <text x="426" y="3772">:</text>
  <text x="482" y="3772">tpe</text>
  <line x1="596" y1="3760" x2="596" y2="3776" class="solid"></line>
  <text x="650" y="3772">body</text>
  <text x="746" y="3772">O</text>
  <polygon points="432,3812 424,3816 432,3820" class="filled"></polygon>
  <line x1="432" y1="3816" x2="480" y2="3816" class="solid"></line>
  <text x="498" y="3820">,</text>
  <line x1="24" y1="3880" x2="12" y2="3880" class="solid end_marked_open_circle"></line>
  <polygon points="24,3876 32,3880 24,3884" class="filled"></polygon>
  <text x="42" y="3884">Statistical</text>
  <text x="138" y="3884">charts</text>
  <text x="34" y="3932">E</text>
  <text x="34" y="3948">D</text>
  <text x="34" y="3964">C</text>
  <text x="34" y="3980">B</text>
  <text x="34" y="3996">A</text>
  <line x1="52" y1="3928" x2="260" y2="3928" class="solid end_marked_circle"></line>
  <line x1="52" y1="3928" x2="52" y2="3992" class="solid"></line>
  <line x1="52" y1="3944" x2="212" y2="3944" class="solid end_marked_circle"></line>
  <line x1="208" y1="3944" x2="236" y2="3944" class="solid end_marked_circle"></line>
  <line x1="232" y1="3944" x2="284" y2="3944" class="solid end_marked_circle"></line>
  <line x1="280" y1="3944" x2="284" y2="3944" class="solid"></line>
  <line x1="52" y1="3960" x2="164" y2="3960" class="solid end_marked_circle"></line>
  <line x1="160" y1="3960" x2="188" y2="3960" class="solid end_marked_circle"></line>
  <line x1="184" y1="3960" x2="188" y2="3960" class="solid"></line>
  <line x1="52" y1="3976" x2="116" y2="3976" class="solid end_marked_circle"></line>
  <line x1="112" y1="3976" x2="140" y2="3976" class="solid end_marked_circle"></line>
  <line x1="136" y1="3976" x2="140" y2="3976" class="solid"></line>
  <line x1="52" y1="3992" x2="68" y2="3992" class="solid end_marked_circle"></line>
  <line x1="64" y1="3992" x2="92" y2="3992" class="solid end_marked_circle"></line>
  <text x="66" y="4012">5</text>
  <text x="82" y="4012">10</text>
  <text x="106" y="4012">15</text>
  <text x="130" y="4012">20</text>
  <text x="154" y="4012">25</text>
  <text x="178" y="4012">30</text>
  <text x="202" y="4012">35</text>
  <text x="226" y="4012">40</text>
  <text x="250" y="4012">45</text>
  <text x="274" y="4012">50</text>
  <text x="330" y="3932">E</text>
  <text x="330" y="3948">D</text>
  <text x="330" y="3964">C</text>
  <text x="330" y="3980">B</text>
  <text x="330" y="3996">A</text>
  <line x1="348" y1="3920" x2="348" y2="3992" class="solid"></line>
  <line x1="556" y1="3932" x2="556" y2="3928" class="solid end_marked_open_circle"></line>
  <line x1="508" y1="3948" x2="508" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="532" y1="3948" x2="532" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="556" y1="3936" x2="556" y2="4000" class="solid"></line>
  <line x1="580" y1="3948" x2="580" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="460" y1="3964" x2="460" y2="3960" class="solid end_marked_open_circle"></line>
  <line x1="484" y1="3964" x2="484" y2="3960" class="solid end_marked_open_circle"></line>
  <line x1="508" y1="3952" x2="508" y2="4000" class="solid"></line>
  <line x1="532" y1="3952" x2="532" y2="4000" class="solid"></line>
  <line x1="412" y1="3980" x2="412" y2="3976" class="solid end_marked_open_circle"></line>
  <line x1="436" y1="3980" x2="436" y2="3976" class="solid end_marked_open_circle"></line>
  <line x1="460" y1="3968" x2="460" y2="4000" class="solid"></line>
  <line x1="484" y1="3968" x2="484" y2="4000" class="solid"></line>
  <line x1="348" y1="3992" x2="364" y2="3992" class="solid end_marked_open_circle"></line>
  <line x1="368" y1="3992" x2="388" y2="3992" class="solid end_marked_open_circle"></line>
  <line x1="412" y1="3984" x2="412" y2="4000" class="solid"></line>
  <line x1="436" y1="3984" x2="436" y2="4000" class="solid"></line>
  <text x="362" y="4012">5</text>
  <text x="378" y="4012">10</text>
  <text x="402" y="4012">15</text>
  <text x="426" y="4012">20</text>
  <text x="450" y="4012">25</text>
  <text x="474" y="4012">30</text>
  <text x="498" y="4012">35</text>
  <text x="522" y="4012">40</text>
  <text x="546" y="4012">45</text>
  <text x="570" y="4012">50</text>
  <text x="18" y="4076">85.67</text>
  <text x="18" y="4092">78.20</text>
  <text x="18" y="4108">70.73</text>
  <text x="18" y="4124">63.27</text>
  <text x="18" y="4140">55.80</text>
  <text x="18" y="4156">48.33</text>
  <text x="18" y="4172">40.87</text>
  <text x="18" y="4188">33.40</text>
  <text x="18" y="4204">25.93</text>
  <text x="18" y="4220">18.47</text>
  <text x="18" y="4236">11.00</text>
  <text x="50" y="4268">2011</text>
  <text x="146" y="4268">2012</text>
  <text x="242" y="4268">2013</text>
  <text x="338" y="4268">2014</text>
  <text x="434" y="4268">2015</text>
  <text x="530" y="4268">2016</text>
  <line x1="24" y1="4392" x2="12" y2="4392" class="solid end_marked_open_circle"></line>
  <polygon points="24,4388 32,4392 24,4396" class="filled"></polygon>
  <text x="50" y="4396">Flow</text>
  <text x="90" y="4396">charts</text>
  <polygon points="176,4436 184,4436 180,4448" class="filled"></polygon>
  <polygon points="96,4468 104,4472 96,4476" class="filled"></polygon>
  <line x1="120" y1="4480" x2="130" y2="4500" class="solid"></line>
  <line x1="176" y1="4480" x2="166" y2="4500" class="solid"></line>
  <polygon points="127,4500 134,4508 134,4497" class="filled"></polygon>
  <polygon points="169,4500 162,4508 162,4497" class="filled"></polygon>
  <polygon points="168,4564 176,4568 168,4572" class="filled"></polygon>
  <line x1="324" y1="4432" x2="324" y2="4452" class="solid"></line>
  <polygon points="320,4452 328,4452 324,4464" class="filled"></polygon>
  <line x1="380" y1="4432" x2="380" y2="4452" class="solid"></line>
  <polygon points="376,4452 384,4452 380,4464" class="filled"></polygon>
  <polygon points="392,4564 384,4568 392,4572" class="filled"></polygon>
  <line x1="484" y1="4432" x2="484" y2="4452" class="solid"></line>
  <polygon points="480,4452 488,4452 484,4464" class="filled"></polygon>
  <line x1="556" y1="4432" x2="556" y2="4532" class="solid"></line>
  <polygon points="552,4532 560,4532 556,4544" class="filled"></polygon>
  <line x1="364" y1="4512" x2="364" y2="4532" class="solid"></line>
  <polygon points="360,4532 368,4532 364,4544" class="filled"></polygon>
  <line x1="484" y1="4512" x2="484" y2="4612" class="solid"></line>
  <polygon points="480,4612 488,4612 484,4624" class="filled"></polygon>
  <line x1="364" y1="4592" x2="364" y2="4612" class="solid"></line>
  <polygon points="360,4612 368,4612 364,4624" class="filled"></polygon>
  <line x1="564" y1="4592" x2="564" y2="4612" class="solid"></line>
  <polygon points="560,4612 568,4612 564,4624" class="filled"></polygon>
  <line x1="612" y1="4432" x2="612" y2="4452" class="solid"></line>
  <polygon points="608,4452 616,4452 612,4464" class="filled"></polygon>
  <text x="234" y="4428">OS</text>
  <text x="258" y="4428">API</text>
  <line x1="24" y1="4712" x2="12" y2="4712" class="solid end_marked_open_circle"></line>
  <polygon points="24,4708 32,4712 24,4716" class="filled"></polygon>
  <text x="50" y="4716">Block</text>
  <text x="98" y="4716">diagrams</text>
  <text x="50" y="4764">vncviewer</text>
  <line x1="56" y1="4784" x2="72" y2="4784" class="solid"></line>
  <text x="50" y="4796">[</text>
  <line x1="56" y1="4800" x2="72" y2="4800" class="solid"></line>
  <text x="74" y="4796">]</text>
  <line x1="88" y1="4790" x2="96" y2="4790" class="solid"></line>
  <line x1="88" y1="4794" x2="96" y2="4794" class="solid"></line>
  <line x1="48" y1="4800" x2="40" y2="4816" class="solid"></line>
  <text x="210" y="4764">,</text>
  <path d="M 224,4752 A 16,16 0,0,0 224,4768" class="nofill"></path>
  <line x1="120" y1="4792" x2="152" y2="4792" class="solid"></line>
  <polygon points="152,4788 160,4792 152,4796" class="filled"></polygon>
  <path d="M 192,4800 A 16,16 0,0,0 192,4816" class="nofill"></path>
  <path d="M 240,4752 A 16,16 0,0,1 240,4768" class="nofill"></path>
  <text x="250" y="4764">,</text>
  <text x="386" y="4780">gateway</text>
  <text x="530" y="4780">vncserver</text>
  <text x="298" y="4796">)</text>
  <line x1="304" y1="4792" x2="360" y2="4792" class="solid"></line>
  <polygon points="360,4788 368,4792 360,4796" class="filled"></polygon>
  <line x1="376" y1="4800" x2="456" y2="4800" class="solid"></line>
  <line x1="464" y1="4792" x2="512" y2="4792" class="solid"></line>
  <polygon points="512,4788 520,4792 512,4796" class="filled"></polygon>
  <text x="282" y="4812">.</text>
  <line x1="288" y1="4808" x2="296" y2="4808" class="solid"></line>
  <text x="298" y="4812">'</text>
  <text x="370" y="4812">[</text>
  <line x1="376" y1="4816" x2="384" y2="4816" class="solid"></line>
  <text x="386" y="4812">...</text>
  <line x1="408" y1="4816" x2="424" y2="4816" class="solid"></line>
  <path d="M 240,4816 A 16,16 0,0,1 240,4832" class="nofill"></path>
  <text x="250" y="4828">.</text>
  <line x1="568" y1="4832" x2="560" y2="4848" class="solid"></line>
  <text x="202" y="4796">internet</text>
  <text x="202" y="4828">'</text>
  <line x1="208" y1="4824" x2="216" y2="4824" class="solid"></line>
  <text x="218" y="4828">.</text>
  <path d="M 232,4816 A 16,16 0,0,0 232,4832" class="nofill"></path>
  <text x="242" y="4892">Valveless</text>
  <text x="226" y="4908">Pulsejet</text>
  <text x="298" y="4908">engine</text>
  <polygon points="377,4916 370,4924 370,4913" class="filled"></polygon>
  <line x1="328" y1="4984" x2="420" y2="4984" class="solid end_marked_open_circle"></line>
  <line x1="420" y1="4988" x2="420" y2="5192" class="solid end_marked_circle"></line>
  <text x="338" y="5004">'</text>
  <polygon points="264,5020 268,5008 272,5020" class="filled"></polygon>
  <text x="338" y="5020">.</text>
  <text x="426" y="5052">GND</text>
  <line x1="188" y1="5176" x2="268" y2="5176" class="solid end_marked_open_circle"></line>
  <line x1="188" y1="5176" x2="188" y2="5216" class="solid"></line>
  <line x1="204" y1="5176" x2="204" y2="5216" class="solid"></line>
  <line x1="220" y1="5176" x2="220" y2="5216" class="solid"></line>
  <line x1="296" y1="5176" x2="372" y2="5176" class="solid end_marked_circle"></line>
  <line x1="368" y1="5176" x2="540" y2="5176" class="solid end_marked_big_open_circle"></line>
  <line x1="372" y1="5180" x2="372" y2="5220" class="solid"></line>
  <text x="266" y="5196">power</text>
  <line x1="420" y1="5192" x2="540" y2="5192" class="solid end_marked_big_open_circle"></line>
  <line x1="420" y1="5196" x2="420" y2="5220" class="solid"></line>
  <text x="266" y="5212">switch</text>
  <line x1="348" y1="5224" x2="372" y2="5224" class="solid end_marked_open_circle"></line>
  <line x1="376" y1="5224" x2="420" y2="5224" class="solid end_marked_open_circle"></line>
  <text x="186" y="5244">HHO</text>
  <text x="178" y="5260">Generator</text>
  <text x="370" y="5260">+</text>
  <line x1="416" y1="5256" x2="424" y2="5256" class="solid"></line>
  <text x="370" y="5292">Battery</text>
  <line x1="488" y1="4952" x2="552" y2="4952" class="solid"></line>
  <polygon points="552,4948 560,4952 552,4956" class="filled"></polygon>
  <text x="498" y="4972">thrust</text>
  <line x1="544" y1="4968" x2="560" y2="4968" class="solid"></line>
  <polygon points="560,4964 568,4968 560,4972" class="filled"></polygon>
  <line x1="496" y1="4984" x2="560" y2="4984" class="solid"></line>
  <polygon points="560,4980 568,4984 560,4988" class="filled"></polygon>
  <text x="154" y="5052">fuel</text>
  <text x="146" y="5068">intake</text>
  <line x1="200" y1="5056" x2="216" y2="5056" class="solid"></line>
  <text x="218" y="5052">^</text>
  <text x="282" y="5052">^</text>
  <line x1="288" y1="5056" x2="304" y2="5056" class="solid"></line>
  <text x="306" y="5052">spark</text>
  <text x="306" y="5068">plug</text>
  <polygon points="120,5188 128,5192 120,5196" class="filled"></polygon>
  <text x="82" y="5228">Water</text>
  <text x="82" y="5244">intake</text>
  <text x="546" y="5260">Solar</text>
  <text x="594" y="5260">panel</text>
  <line x1="120" y1="5318" x2="176" y2="5318" class="solid"></line>
  <line x1="120" y1="5322" x2="176" y2="5322" class="solid"></line>
  <line x1="128" y1="5334" x2="168" y2="5334" class="solid"></line>
  <line x1="128" y1="5338" x2="168" y2="5338" class="solid"></line>
  <line x1="136" y1="5350" x2="160" y2="5350" class="solid"></line>
  <line x1="136" y1="5354" x2="160" y2="5354" class="solid"></line>
  <line x1="144" y1="5366" x2="152" y2="5366" class="solid"></line>
  <line x1="144" y1="5370" x2="152" y2="5370" class="solid"></line>
  <line x1="148" y1="5376" x2="148" y2="5520" class="solid"></line>
  <text x="234" y="5404">micro</text>
  <text x="282" y="5404">henry</text>
  <text x="234" y="5420">coil</text>
  <text x="274" y="5420">w</text>
  <line x1="288" y1="5408" x2="280" y2="5424" class="solid"></line>
  <text x="290" y="5420">tuning</text>
  <text x="202" y="5452">'</text>
  <text x="282" y="5484">pico</text>
  <text x="322" y="5484">farad</text>
  <text x="370" y="5484">cap</text>
  <path d="M 312,5488 A 16,16 0,0,0 312,5504" class="nofill"></path>
  <text x="314" y="5500">trimmable</text>
  <path d="M 384,5488 A 16,16 0,0,1 384,5504" class="nofill"></path>
  <text x="138" y="5564">ground</text>
  <text x="194" y="5564">plane</text>
  <path d="M 248,5552 A 16,16 0,0,0 248,5568" class="nofill"></path>
  <text x="250" y="5564">foil</text>
  <path d="M 280,5552 A 16,16 0,0,1 280,5568" class="nofill"></path>
  <text x="186" y="5340">symbolic</text>
  <text x="258" y="5340">antenna</text>
  <text x="346" y="5420">lug</text>
  <text x="66" y="5532">PC</text>
  <line x1="104" y1="5528" x2="112" y2="5528" class="solid"></line>
  <polygon points="112,5524 120,5528 112,5532" class="filled"></polygon>
  <text x="66" y="5548">Board</text>
  <line x1="24" y1="5640" x2="12" y2="5640" class="solid end_marked_open_circle"></line>
  <polygon points="24,5636 32,5640 24,5644" class="filled"></polygon>
  <text x="42" y="5644">Mindmaps</text>
  <line x1="354" y1="5676" x2="284" y2="5816" class="solid end_marked_open_circle"></line>
  <polygon points="376,5668 384,5672 376,5676" class="filled"></polygon>
  <polygon points="376,5700 384,5704 376,5708" class="filled"></polygon>
  <line x1="156" y1="5720" x2="156" y2="5720" class="solid end_marked_circle"></line>
  <line x1="222" y1="5724" x2="268" y2="5816" class="solid end_marked_open_circle"></line>
  <line x1="300" y1="5784" x2="376" y2="5784" class="solid"></line>
  <polygon points="376,5780 384,5784 376,5788" class="filled"></polygon>
  <line x1="300" y1="5832" x2="300" y2="5832" class="solid end_marked_circle"></line>
  <line x1="360" y1="5848" x2="412" y2="5848" class="solid end_marked_big_open_circle"></line>
  <line x1="416" y1="5848" x2="424" y2="5848" class="solid"></line>
  <polygon points="424,5844 432,5848 424,5852" class="filled"></polygon>
  <line x1="302" y1="5868" x2="300" y2="5864" class="solid end_marked_open_circle"></line>
  <line x1="250" y1="5884" x2="252" y2="5880" class="solid end_marked_open_circle"></line>
  <line x1="278" y1="5884" x2="276" y2="5880" class="solid end_marked_open_circle"></line>
  <line x1="294" y1="5884" x2="292" y2="5880" class="solid end_marked_open_circle"></line>
  <polygon points="384,5924 392,5928 384,5932" class="filled"></polygon>
  <line x1="192" y1="5952" x2="174" y2="5988" class="solid"></line>
  <polygon points="424,5956 432,5960 424,5964" class="filled"></polygon>
  <polygon points="177,5988 170,5996 170,5985" class="filled"></polygon>
  <polygon points="392,5988 400,5992 392,5996" class="filled"></polygon>
  <polygon points="177,6020 170,6028 170,6017" class="filled"></polygon>
  <text x="106" y="6044">Worklaod</text>
  <polygon points="376,6036 384,6040 376,6044" class="filled"></polygon>
  <polygon points="384,6036 392,6040 384,6044" class="filled"></polygon>
  <polygon points="177,6052 170,6060 170,6049" class="filled"></polygon>
  <polygon points="177,6084 170,6092 170,6081" class="filled"></polygon>
  <text x="402" y="5676">Alpha</text>
  <text x="402" y="5708">Initial</text>
  <polygon points="448,5732 456,5736 448,5740" class="filled"></polygon>
  <polygon points="456,5764 464,5768 456,5772" class="filled"></polygon>
  <text x="466" y="5708">Release</text>
  <text x="82" y="5724">Planning</text>
  <text x="466" y="5740">Patch</text>
  <text x="514" y="5740">1</text>
  <text x="50" y="5756">Initial</text>
  <text x="114" y="5756">research</text>
  <line x1="134" y1="5772" x2="132" y2="5768" class="solid end_marked_circle"></line>
  <polygon points="224,5844 232,5848 224,5852" class="filled"></polygon>
  <text x="482" y="5772">Patch</text>
  <text x="530" y="5772">2</text>
  <text x="394" y="5788">Beta</text>
  <text x="450" y="5852">.</text>
  <text x="466" y="5852">Release</text>
  <text x="530" y="5852">.</text>
  <text x="410" y="5932">Push</text>
  <text x="450" y="5932">backs</text>
  <text x="442" y="5964">Setbacks</text>
  <text x="410" y="5996">Reception</text>
  <text x="130" y="6012">Team</text>
  <text x="402" y="6044">Career</text>
  <text x="458" y="6044">change</text>
  <text x="138" y="6076">PTO</text>
  <text x="138" y="6108">Bug</text>
  <line x1="24" y1="6152" x2="12" y2="6152" class="solid end_marked_open_circle"></line>
  <polygon points="24,6148 32,6152 24,6156" class="filled"></polygon>
  <text x="50" y="6156">It</text>
  <text x="74" y="6156">can</text>
  <text x="106" y="6156">do</text>
  <text x="130" y="6156">complex</text>
  <text x="194" y="6156">stuff</text>
  <text x="242" y="6156">such</text>
  <text x="282" y="6156">as</text>
  <text x="306" y="6156">circuit</text>
  <text x="370" y="6156">diagrams</text>
  <text x="58" y="6204">+10</text>
  <line x1="80" y1="6200" x2="88" y2="6200" class="solid"></line>
  <text x="90" y="6204">15V</text>
  <text x="226" y="6204">0,047R</text>
  <line x1="52" y1="6216" x2="52" y2="6216" class="solid end_marked_circle"></line>
  <line x1="52" y1="6220" x2="52" y2="6240" class="solid"></line>
  <line x1="56" y1="6216" x2="132" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="136" y1="6216" x2="180" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="228" y1="6216" x2="244" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="248" y1="6216" x2="268" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="272" y1="6216" x2="348" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="352" y1="6216" x2="388" y2="6216" class="solid end_marked_open_circle"></line>
  <text x="34" y="6236">+</text>
  <line x1="32" y1="6248" x2="40" y2="6248" class="solid"></line>
  <line x1="40" y1="6246" x2="64" y2="6246" class="solid"></line>
  <line x1="40" y1="6250" x2="64" y2="6250" class="solid"></line>
  <line x1="64" y1="6248" x2="72" y2="6248" class="solid"></line>
  <line x1="32" y1="6264" x2="40" y2="6264" class="solid"></line>
  <line x1="40" y1="6262" x2="64" y2="6262" class="solid"></line>
  <line x1="40" y1="6266" x2="64" y2="6266" class="solid"></line>
  <line x1="64" y1="6264" x2="72" y2="6264" class="solid"></line>
  <text x="122" y="6268">.</text>
  <line x1="32" y1="6280" x2="40" y2="6280" class="solid"></line>
  <line x1="40" y1="6278" x2="64" y2="6278" class="solid"></line>
  <line x1="40" y1="6282" x2="64" y2="6282" class="solid"></line>
  <line x1="64" y1="6280" x2="72" y2="6280" class="solid"></line>
  <text x="106" y="6284">470</text>
  <line x1="132" y1="6272" x2="132" y2="6308" class="solid"></line>
  <text x="146" y="6284">+</text>
  <line x1="32" y1="6296" x2="40" y2="6296" class="solid"></line>
  <line x1="52" y1="6288" x2="52" y2="6312" class="solid"></line>
  <text x="114" y="6300">uF</text>
  <line x1="52" y1="6312" x2="132" y2="6312" class="solid end_marked_open_circle"></line>
  <text x="210" y="6316">6</text>
  <text x="250" y="6316">7</text>
  <text x="274" y="6316">8</text>
  <line x1="112" y1="6344" x2="152" y2="6344" class="solid"></line>
  <line x1="120" y1="6348" x2="144" y2="6348" class="solid"></line>
  <line x1="128" y1="6360" x2="136" y2="6360" class="solid"></line>
  <text x="298" y="6364">1</text>
  <text x="122" y="6380">GND</text>
  <line x1="292" y1="6376" x2="348" y2="6376" class="solid end_marked_open_circle"></line>
  <text x="378" y="6396">`</text>
  <polygon points="384,6388 392,6392 384,6396" class="filled"></polygon>
  <line x1="388" y1="6400" x2="388" y2="6424" class="solid end_marked_open_circle"></line>
  <text x="306" y="6428">220R</text>
  <polygon points="448,6436 456,6440 448,6444" class="filled"></polygon>
  <line x1="452" y1="6456" x2="452" y2="6488" class="solid end_marked_open_circle"></line>
  <text x="474" y="6476">BYV29</text>
  <line x1="552" y1="6472" x2="560" y2="6472" class="solid"></line>
  <text x="562" y="6476">12V6</text>
  <line x1="452" y1="6492" x2="452" y2="6512" class="solid"></line>
  <polygon points="488,6484 480,6488 488,6492" class="filled"></polygon>
  <line x1="488" y1="6488" x2="500" y2="6488" class="solid end_marked_open_circle"></line>
  <line x1="500" y1="6492" x2="500" y2="6612" class="solid"></line>
  <line x1="504" y1="6488" x2="540" y2="6488" class="solid end_marked_open_circle"></line>
  <line x1="540" y1="6492" x2="540" y2="6528" class="solid"></line>
  <line x1="544" y1="6488" x2="564" y2="6488" class="solid"></line>
  <text x="578" y="6492">OUT</text>
  <line x1="104" y1="6504" x2="112" y2="6504" class="solid"></line>
  <text x="138" y="6508">+</text>
  <text x="298" y="6508">2</text>
  <line x1="292" y1="6520" x2="316" y2="6520" class="solid end_marked_open_circle"></line>
  <text x="450" y="6524">C</text>
  <line x1="460" y1="6512" x2="460" y2="6560" class="solid"></line>
  <line x1="96" y1="6536" x2="104" y2="6536" class="broken"></line>
  <line x1="112" y1="6536" x2="120" y2="6536" class="broken"></line>
  <line x1="128" y1="6536" x2="136" y2="6536" class="broken"></line>
  <line x1="144" y1="6536" x2="152" y2="6536" class="broken"></line>
  <line x1="160" y1="6536" x2="168" y2="6536" class="broken"></line>
  <text x="306" y="6540">GND</text>
  <text x="450" y="6540">C</text>
  <line x1="528" y1="6536" x2="552" y2="6536" class="solid"></line>
  <text x="298" y="6556">3</text>
  <text x="354" y="6556">1nF</text>
  <text x="450" y="6556">C</text>
  <rect x="528" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <rect x="536" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="540" y1="6556" x2="540" y2="6576" class="solid"></line>
  <rect x="544" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="452" y1="6560" x2="452" y2="6576" class="solid"></line>
  <text x="554" y="6572">+</text>
  <text x="442" y="6588">GND</text>
  <text x="530" y="6588">GND</text>
  <text x="226" y="6604">5</text>
  <text x="266" y="6604">4</text>
  <line x1="280" y1="6616" x2="388" y2="6616" class="solid end_marked_open_circle"></line>
  <line x1="392" y1="6616" x2="500" y2="6616" class="solid end_marked_open_circle"></line>
  <line x1="128" y1="6648" x2="236" y2="6648" class="solid end_marked_circle"></line>
  <line x1="324" y1="6648" x2="428" y2="6648" class="solid end_marked_open_circle"></line>
  <text x="298" y="6668">2k</text>
  <text x="490" y="6668">1k0</text>
  <text x="418" y="6764">GND</text>
  <text x="290" y="6268">2k2</text>
  <text x="474" y="6300">LED</text>
  <text x="314" y="6316">1k</text>
  <text x="402" y="6364">BC</text>
  <text x="402" y="6380">547</text>
  <text x="474" y="6428">IRF9Z34</text>
  <text x="210" y="6460">MC34063</text>
  <text x="10" y="6508">6000</text>
  <text x="50" y="6508">micro</text>
  <text x="10" y="6524">Farad,</text>
  <text x="66" y="6524">40V</text>
  <text x="10" y="6540">Capacitor</text>
  <text x="402" y="6540">30uH</text>
  <text x="562" y="6540">470</text>
  <text x="570" y="6556">uF</text>
  <text x="450" y="6700">5k6</text>
  <text x="482" y="6700">+</text>
  <text x="498" y="6700">3k3</text>
  <text x="450" y="6716">in</text>
  <text x="474" y="6716">Serie</text>
  <line x1="16" y1="6824" x2="4" y2="6824" class="solid end_marked_open_circle"></line>
  <polygon points="16,6820 24,6824 16,6828" class="filled"></polygon>
  <text x="34" y="6828">Latest</text>
  <text x="90" y="6828">addition:</text>
  <text x="170" y="6828">Styling</text>
  <text x="234" y="6828">of</text>
  <text x="258" y="6828">tagged</text>
  <text x="314" y="6828">shapes</text>
  <text x="26" y="7388">Advantages:</text>
  <line x1="8" y1="7416" x2="20" y2="7416" class="solid end_marked_circle"></line>
  <line x1="16" y1="7416" x2="20" y2="7416" class="solid"></line>
  <text x="34" y="7420">Plain</text>
  <text x="82" y="7420">text</text>
  <text x="122" y="7420">format</text>
  <text x="34" y="7436">Ultimately</text>
  <text x="122" y="7436">portable,</text>
  <text x="34" y="7452">Degrades</text>
  <text x="106" y="7452">gracefully</text>
  <text x="34" y="7468">Even</text>
  <text x="74" y="7468">when</text>
  <text x="114" y="7468">not</text>
  <text x="146" y="7468">using</text>
  <text x="194" y="7468">a</text>
  <text x="210" y="7468">graphical</text>
  <text x="290" y="7468">renderer,</text>
  <text x="370" y="7468">it</text>
  <text x="394" y="7468">would</text>
  <text x="442" y="7468">still</text>
  <text x="490" y="7468">looks</text>
  <text x="34" y="7484">as</text>
  <text x="58" y="7484">text</text>
  <text x="98" y="7484">based</text>
  <text x="146" y="7484">diagrams.</text>
  <text x="226" y="7484">Paste</text>
  <text x="274" y="7484">the</text>
  <text x="306" y="7484">text</text>
  <text x="346" y="7484">in</text>
  <text x="370" y="7484">your</text>
  <text x="410" y="7484">source</text>
  <text x="466" y="7484">code.</text>
  <text x="34" y="7500">Easiest</text>
  <text x="98" y="7500">to</text>
  <text x="122" y="7500">use.</text>
  <text x="162" y="7500">Anyone</text>
  <text x="218" y="7500">knows</text>
  <text x="266" y="7500">how</text>
  <text x="298" y="7500">to</text>
  <text x="322" y="7500">edit</text>
  <text x="362" y="7500">text.</text>
  <text x="202" y="7436">backward</text>
  <text x="274" y="7436">compatible</text>
  <text x="362" y="7436">and</text>
  <text x="394" y="7436">future</text>
  <text x="450" y="7436">proof.</text>
  <line x1="8" y1="7448" x2="20" y2="7448" class="solid end_marked_circle"></line>
  <line x1="16" y1="7448" x2="20" y2="7448" class="solid"></line>
  <text x="538" y="7468">good</text>
  <line x1="8" y1="7496" x2="20" y2="7496" class="solid end_marked_circle"></line>
  <line x1="16" y1="7496" x2="20" y2="7496" class="solid"></line>
  <text x="362" y="748">.--------------.</text>
  <text x="362" y="764">| Don't draw me|</text>
  <text x="362" y="780">|              |</text>
  <text x="362" y="796">'--------------'</text>
  <text x="2" y="3276">Udc_OK</text>
  <g>
    <path d="M 64,72 A 8,8 0,0,0 58,76" class="nofill"></path>
    <line x1="64" y1="72" x2="88" y2="72" class="solid"></line>
    <path d="M 88,72 A 3,3 0,0,1 90,76" class="nofill"></path>
    <line x1="90" y1="76" x2="64" y2="128" class="solid"></line>
    <line x1="76" y1="104" x2="88" y2="104" class="solid"></line>
    <line x1="66" y1="92" x2="56" y2="112" class="solid"></line>
    <line x1="56" y1="112" x2="72" y2="144" class="solid"></line>
    <path d="M 32,104 A 8,8 0,0,0 26,108" class="nofill"></path>
    <line x1="26" y1="108" x2="24" y2="112" class="solid"></line>
    <line x1="32" y1="104" x2="44" y2="104" class="solid"></line>
    <path d="M 24,112 A 16,16 0,0,0 24,128" class="nofill"></path>
    <line x1="24" y1="128" x2="26" y2="132" class="solid"></line>
    <path d="M 26,132 A 8,8 0,0,0 32,136" class="nofill"></path>
    <line x1="32" y1="136" x2="40" y2="136" class="solid"></line>
    <path d="M 40,136 A 8,8 0,0,1 46,140" class="nofill"></path>
    <line x1="46" y1="140" x2="60" y2="168" class="solid"></line>
    <line x1="72" y1="144" x2="60" y2="168" class="solid"></line>
  </g>
  <g>
    <path d="M 40,280 A 4,4 0,0,0 36,284" class="nofill"></path>
    <line x1="36" y1="284" x2="36" y2="836" class="broken"></line>
    <line x1="40" y1="280" x2="48" y2="280" class="solid"></line>
    <path d="M 36,836 A 4,4 0,0,0 40,840" class="nofill"></path>
    <line x1="40" y1="840" x2="560" y2="840" class="broken"></line>
    <line x1="552" y1="280" x2="560" y2="280" class="solid"></line>
    <path d="M 560,280 A 4,4 0,0,1 564,284" class="nofill"></path>
    <line x1="564" y1="284" x2="564" y2="836" class="broken"></line>
    <path d="M 564,836 A 4,4 0,0,1 560,840" class="nofill"></path>
  </g>
  <g>
    <line x1="460" y1="296" x2="428" y2="328" class="broken"></line>
    <line x1="460" y1="296" x2="492" y2="328" class="broken"></line>
    <line x1="428" y1="328" x2="460" y2="360" class="broken"></line>
    <line x1="492" y1="328" x2="460" y2="360" class="broken"></line>
  </g>
  <g>
    <line x1="80" y1="368" x2="136" y2="368" class="solid"></line>
    <line x1="80" y1="368" x2="64" y2="400" class="solid"></line>
    <line x1="136" y1="368" x2="152" y2="400" class="solid"></line>
    <line x1="64" y1="400" x2="80" y2="432" class="solid"></line>
    <line x1="152" y1="400" x2="136" y2="432" class="solid"></line>
    <line x1="80" y1="432" x2="136" y2="432" class="solid"></line>
  </g>
  <g>
    <path d="M 256,312 A 8,8 0,0,0 250,316" class="nofill"></path>
    <line x1="250" y1="316" x2="248" y2="320" class="solid"></line>
    <line x1="256" y1="312" x2="304" y2="312" class="solid"></line>
    <path d="M 304,312 A 8,8 0,0,1 310,316" class="nofill"></path>
    <line x1="310" y1="316" x2="312" y2="320" class="solid"></line>
    <path d="M 248,320 A 16,16 0,0,0 248,336" class="nofill"></path>
    <path d="M 312,320 A 16,16 0,0,1 312,336" class="nofill"></path>
    <line x1="248" y1="336" x2="250" y2="340" class="solid"></line>
    <path d="M 250,340 A 8,8 0,0,0 256,344" class="nofill"></path>
    <line x1="256" y1="344" x2="304" y2="344" class="solid"></line>
    <line x1="312" y1="336" x2="310" y2="340" class="solid"></line>
    <path d="M 310,340 A 8,8 0,0,1 304,344" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="368" x2="296" y2="368" class="solid"></line>
    <line x1="232" y1="368" x2="240" y2="384" class="solid"></line>
    <line x1="296" y1="368" x2="304" y2="384" class="solid"></line>
    <path d="M 240,384 A 16,16 0,0,1 240,400" class="nofill"></path>
    <path d="M 304,384 A 16,16 0,0,1 304,400" class="nofill"></path>
    <line x1="240" y1="400" x2="232" y2="416" class="solid"></line>
    <line x1="232" y1="416" x2="296" y2="416" class="solid"></line>
    <line x1="304" y1="400" x2="296" y2="416" class="solid"></line>
  </g>
  <g>
    <line x1="368" y1="304" x2="350" y2="340" class="solid"></line>
    <line x1="368" y1="304" x2="386" y2="340" class="solid"></line>
    <path d="M 350,340 A 3,3 0,0,0 352,344" class="nofill"></path>
    <line x1="352" y1="344" x2="384" y2="344" class="solid"></line>
    <path d="M 386,340 A 3,3 0,0,1 384,344" class="nofill"></path>
  </g>
  <g>
    <line x1="200" y1="368" x2="184" y2="400" class="solid"></line>
    <line x1="200" y1="368" x2="216" y2="400" class="solid"></line>
    <line x1="184" y1="400" x2="200" y2="432" class="solid"></line>
    <line x1="216" y1="400" x2="200" y2="432" class="solid"></line>
  </g>
  <g>
    <line x1="88" y1="472" x2="168" y2="472" class="solid"></line>
    <path d="M 168,472 A 8,8 0,0,1 174,476" class="nofill"></path>
    <line x1="174" y1="476" x2="176" y2="480" class="solid"></line>
    <path d="M 176,480 A 16,16 0,0,1 176,496" class="nofill"></path>
    <line x1="176" y1="496" x2="174" y2="500" class="solid"></line>
    <path d="M 144,504 A 8,8 0,0,0 138,508" class="nofill"></path>
    <line x1="138" y1="508" x2="128" y2="528" class="solid"></line>
    <line x1="144" y1="504" x2="168" y2="504" class="solid"></line>
    <path d="M 174,500 A 8,8 0,0,1 168,504" class="nofill"></path>
  </g>
  <g>
    <line x1="88" y1="504" x2="124" y2="504" class="solid"></line>
    <line x1="124" y1="504" x2="124" y2="532" class="solid"></line>
  </g>
  <g>
    <line x1="104" y1="560" x2="120" y2="560" class="solid"></line>
    <path d="M 104,560 A 16,16 0,0,0 104,576" class="nofill"></path>
    <line x1="104" y1="576" x2="120" y2="576" class="solid"></line>
    <path d="M 120,560 A 16,16 0,0,1 120,576" class="nofill"></path>
  </g>
  <g>
    <path d="M 240,472 A 8,8 0,0,0 234,476" class="nofill"></path>
    <line x1="234" y1="476" x2="232" y2="480" class="solid"></line>
    <path d="M 232,480 A 16,16 0,0,0 232,496" class="nofill"></path>
    <line x1="232" y1="496" x2="234" y2="500" class="solid"></line>
    <path d="M 234,500 A 8,8 0,0,0 240,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,472 A 8,8 0,0,1 278,476" class="nofill"></path>
    <line x1="278" y1="476" x2="280" y2="480" class="solid"></line>
    <path d="M 280,480 A 16,16 0,0,1 280,496" class="nofill"></path>
    <line x1="280" y1="496" x2="278" y2="500" class="solid"></line>
    <path d="M 278,500 A 8,8 0,0,1 272,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 336,472 A 8,8 0,0,0 330,476" class="nofill"></path>
    <line x1="330" y1="476" x2="328" y2="480" class="solid"></line>
    <path d="M 328,480 A 16,16 0,0,0 328,496" class="nofill"></path>
    <line x1="328" y1="496" x2="330" y2="500" class="solid"></line>
    <path d="M 330,500 A 8,8 0,0,0 336,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 360,472 A 8,8 0,0,1 366,476" class="nofill"></path>
    <line x1="366" y1="476" x2="368" y2="480" class="solid"></line>
    <path d="M 368,480 A 16,16 0,0,1 368,496" class="nofill"></path>
    <line x1="368" y1="496" x2="366" y2="500" class="solid"></line>
    <path d="M 366,500 A 8,8 0,0,1 360,504" class="nofill"></path>
  </g>
  <g>
    <line x1="280" y1="552" x2="296" y2="552" class="solid"></line>
    <path d="M 296,552 A 8,8 0,0,1 302,556" class="nofill"></path>
    <line x1="302" y1="556" x2="304" y2="560" class="solid"></line>
    <path d="M 304,560 A 16,16 0,0,1 304,576" class="nofill"></path>
    <line x1="304" y1="576" x2="302" y2="580" class="solid"></line>
    <line x1="280" y1="584" x2="296" y2="584" class="solid"></line>
    <path d="M 302,580 A 8,8 0,0,1 296,584" class="nofill"></path>
  </g>
  <g>
    <path d="M 216,744 A 3,3 0,0,0 214,748" class="nofill"></path>
    <line x1="214" y1="748" x2="236" y2="792" class="solid"></line>
    <line x1="216" y1="744" x2="256" y2="744" class="solid"></line>
    <path d="M 256,744 A 3,3 0,0,1 258,748" class="nofill"></path>
    <line x1="258" y1="748" x2="236" y2="792" class="solid"></line>
  </g>
  <g>
    <path d="M 280,744 A 3,3 0,0,0 278,748" class="nofill"></path>
    <line x1="278" y1="748" x2="298" y2="788" class="solid"></line>
    <line x1="280" y1="744" x2="312" y2="744" class="solid"></line>
    <path d="M 312,744 A 8,8 0,0,1 318,748" class="nofill"></path>
    <line x1="318" y1="748" x2="338" y2="788" class="solid"></line>
    <path d="M 298,788 A 8,8 0,0,0 304,792" class="nofill"></path>
    <line x1="304" y1="792" x2="336" y2="792" class="solid"></line>
    <path d="M 338,788 A 3,3 0,0,1 336,792" class="nofill"></path>
  </g>
  <g>
    <path d="M 72,904 A 8,8 0,0,0 66,908" class="nofill"></path>
    <line x1="72" y1="904" x2="96" y2="904" class="solid"></line>
    <path d="M 96,904 A 3,3 0,0,1 98,908" class="nofill"></path>
    <line x1="98" y1="908" x2="72" y2="960" class="solid"></line>
    <line x1="84" y1="936" x2="96" y2="936" class="solid"></line>
    <line x1="74" y1="924" x2="64" y2="944" class="solid"></line>
    <line x1="64" y1="944" x2="80" y2="976" class="solid"></line>
    <path d="M 40,936 A 8,8 0,0,0 34,940" class="nofill"></path>
    <line x1="34" y1="940" x2="32" y2="944" class="solid"></line>
    <line x1="40" y1="936" x2="52" y2="936" class="solid"></line>
    <path d="M 32,944 A 16,16 0,0,0 32,960" class="nofill"></path>
    <line x1="32" y1="960" x2="34" y2="964" class="solid"></line>
    <path d="M 34,964 A 8,8 0,0,0 40,968" class="nofill"></path>
    <line x1="40" y1="968" x2="48" y2="968" class="solid"></line>
    <path d="M 48,968 A 8,8 0,0,1 54,972" class="nofill"></path>
    <line x1="54" y1="972" x2="68" y2="1000" class="solid"></line>
    <line x1="80" y1="976" x2="68" y2="1000" class="solid"></line>
  </g>
  <g>
    <line x1="276" y1="912" x2="292" y2="912" class="solid"></line>
    <line x1="276" y1="912" x2="276" y2="928" class="solid"></line>
    <line x1="276" y1="920" x2="292" y2="920" class="solid"></line>
    <line x1="292" y1="912" x2="292" y2="968" class="solid"></line>
    <path d="M 276,928 A 12,12 0,0,1 276,944" class="nofill"></path>
    <line x1="276" y1="952" x2="292" y2="952" class="solid"></line>
    <line x1="292" y1="968" x2="280" y2="992" class="solid"></line>
    <path d="M 256,936 A 4,4 0,0,0 252,940" class="nofill"></path>
    <line x1="252" y1="940" x2="252" y2="964" class="solid"></line>
    <line x1="256" y1="936" x2="292" y2="936" class="solid"></line>
    <path d="M 252,964 A 16,16 0,0,0 254,972" class="nofill"></path>
    <line x1="254" y1="972" x2="264" y2="992" class="solid"></line>
    <line x1="264" y1="992" x2="280" y2="992" class="solid"></line>
  </g>
  <g>
    <path d="M 176,920 A 8,8 0,0,0 170,924" class="nofill"></path>
    <line x1="170" y1="924" x2="144" y2="976" class="solid"></line>
    <line x1="176" y1="920" x2="192" y2="920" class="solid"></line>
    <path d="M 192,920 A 8,8 0,0,1 198,924" class="nofill"></path>
    <line x1="198" y1="924" x2="204" y2="936" class="solid"></line>
    <line x1="164" y1="936" x2="184" y2="936" class="solid"></line>
    <path d="M 184,936 A 8,8 0,0,1 190,940" class="nofill"></path>
    <line x1="190" y1="940" x2="192" y2="944" class="solid"></line>
    <line x1="204" y1="936" x2="204" y2="952" class="solid"></line>
    <path d="M 192,944 A 16,16 0,0,1 192,960" class="nofill"></path>
    <line x1="204" y1="952" x2="182" y2="996" class="solid"></line>
    <line x1="152" y1="960" x2="162" y2="980" class="solid"></line>
    <line x1="144" y1="976" x2="154" y2="996" class="solid"></line>
    <path d="M 162,980 A 8,8 0,0,0 168,984" class="nofill"></path>
    <path d="M 154,996 A 8,8 0,0,0 160,1000" class="nofill"></path>
    <line x1="160" y1="1000" x2="176" y2="1000" class="solid"></line>
    <path d="M 182,996 A 8,8 0,0,1 176,1000" class="nofill"></path>
    <line x1="172" y1="960" x2="172" y2="984" class="solid"></line>
    <line x1="172" y1="968" x2="188" y2="968" class="solid"></line>
    <line x1="192" y1="960" x2="182" y2="980" class="solid"></line>
    <line x1="168" y1="984" x2="176" y2="984" class="solid"></line>
    <path d="M 182,980 A 8,8 0,0,1 176,984" class="nofill"></path>
  </g>
  <g>
    <path d="M 424,920 A 8,8 0,0,0 418,924" class="nofill"></path>
    <line x1="418" y1="924" x2="408" y2="944" class="solid"></line>
    <line x1="424" y1="920" x2="440" y2="920" class="solid"></line>
    <path d="M 440,920 A 8,8 0,0,1 446,924" class="nofill"></path>
    <line x1="446" y1="924" x2="456" y2="944" class="solid"></line>
    <path d="M 408,944 A 16,16 0,0,0 408,960" class="nofill"></path>
    <path d="M 456,944 A 16,16 0,0,1 456,960" class="nofill"></path>
    <line x1="408" y1="960" x2="418" y2="980" class="solid"></line>
    <line x1="456" y1="960" x2="446" y2="980" class="solid"></line>
    <path d="M 418,980 A 8,8 0,0,0 424,984" class="nofill"></path>
    <line x1="424" y1="984" x2="440" y2="984" class="solid"></line>
    <path d="M 446,980 A 8,8 0,0,1 440,984" class="nofill"></path>
  </g>
  <g>
    <line x1="424" y1="928" x2="412" y2="952" class="solid"></line>
    <line x1="412" y1="952" x2="424" y2="976" class="solid"></line>
  </g>
  <g>
    <path d="M 432,936 A 8,8 0,0,0 426,940" class="nofill"></path>
    <line x1="426" y1="940" x2="424" y2="944" class="solid"></line>
    <line x1="432" y1="936" x2="440" y2="936" class="solid"></line>
    <path d="M 440,936 A 8,8 0,0,1 446,940" class="nofill"></path>
    <line x1="446" y1="940" x2="448" y2="944" class="solid"></line>
    <path d="M 424,944 A 16,16 0,0,0 424,960" class="nofill"></path>
    <path d="M 448,944 A 16,16 0,0,1 448,960" class="nofill"></path>
    <line x1="424" y1="960" x2="426" y2="964" class="solid"></line>
    <path d="M 426,964 A 8,8 0,0,0 432,968" class="nofill"></path>
    <line x1="432" y1="968" x2="440" y2="968" class="solid"></line>
    <line x1="448" y1="960" x2="446" y2="964" class="solid"></line>
    <path d="M 446,964 A 8,8 0,0,1 440,968" class="nofill"></path>
  </g>
  <g>
    <path d="M 336,936 A 4,4 0,0,0 332,940" class="nofill"></path>
    <line x1="332" y1="940" x2="332" y2="964" class="solid"></line>
    <line x1="336" y1="936" x2="352" y2="936" class="solid"></line>
    <path d="M 352,936 A 4,4 0,0,1 356,940" class="nofill"></path>
    <path d="M 360,936 A 4,4 0,0,0 356,940" class="nofill"></path>
    <line x1="356" y1="940" x2="356" y2="964" class="solid"></line>
    <line x1="360" y1="936" x2="368" y2="936" class="solid"></line>
    <path d="M 368,936 A 4,4 0,0,1 372,940" class="nofill"></path>
    <line x1="372" y1="940" x2="372" y2="964" class="solid"></line>
    <line x1="332" y1="952" x2="344" y2="952" class="solid"></line>
    <path d="M 332,964 A 4,4 0,0,0 336,968" class="nofill"></path>
    <line x1="336" y1="968" x2="352" y2="968" class="solid"></line>
    <path d="M 356,964 A 4,4 0,0,1 352,968" class="nofill"></path>
    <path d="M 356,964 A 4,4 0,0,0 360,968" class="nofill"></path>
    <line x1="360" y1="968" x2="368" y2="968" class="solid"></line>
    <path d="M 372,964 A 4,4 0,0,1 368,968" class="nofill"></path>
  </g>
  <g>
    <line x1="344" y1="1024" x2="384" y2="1024" class="solid"></line>
    <line x1="344" y1="1024" x2="340" y2="1032" class="solid"></line>
    <line x1="340" y1="1032" x2="340" y2="1072" class="solid"></line>
    <line x1="312" y1="1072" x2="340" y2="1072" class="solid"></line>
    <line x1="312" y1="1072" x2="296" y2="1104" class="solid"></line>
    <line x1="296" y1="1104" x2="312" y2="1136" class="solid"></line>
    <line x1="368" y1="1040" x2="384" y2="1040" class="solid"></line>
    <path d="M 384,1024 A 16,16 0,0,1 384,1040" class="nofill"></path>
    <line x1="368" y1="1040" x2="364" y2="1048" class="solid"></line>
    <line x1="364" y1="1048" x2="364" y2="1072" class="solid"></line>
    <line x1="384" y1="1040" x2="392" y2="1056" class="solid"></line>
    <line x1="364" y1="1072" x2="384" y2="1072" class="solid"></line>
    <line x1="392" y1="1056" x2="384" y2="1072" class="solid"></line>
  </g>
  <g>
    <line x1="392" y1="1024" x2="408" y2="1056" class="solid"></line>
    <line x1="408" y1="1056" x2="392" y2="1088" class="solid"></line>
    <line x1="384" y1="1088" x2="392" y2="1088" class="solid"></line>
  </g>
  <g>
    <path d="M 328,1072 A 16,16 0,0,0 328,1088" class="nofill"></path>
    <line x1="328" y1="1088" x2="340" y2="1088" class="solid"></line>
    <line x1="340" y1="1088" x2="340" y2="1104" class="solid"></line>
  </g>
  <g>
    <line x1="364" y1="1088" x2="376" y2="1088" class="solid"></line>
    <path d="M 376,1072 A 16,16 0,0,1 376,1088" class="nofill"></path>
    <line x1="364" y1="1088" x2="364" y2="1120" class="solid"></line>
  </g>
  <g>
    <line x1="320" y1="1088" x2="312" y2="1104" class="solid"></line>
    <line x1="312" y1="1104" x2="320" y2="1120" class="solid"></line>
    <line x1="320" y1="1120" x2="336" y2="1120" class="solid"></line>
    <line x1="344" y1="1104" x2="336" y2="1120" class="solid"></line>
    <path d="M 320,1120 A 16,16 0,0,0 320,1136" class="nofill"></path>
    <line x1="320" y1="1136" x2="360" y2="1136" class="solid"></line>
    <line x1="368" y1="1120" x2="360" y2="1136" class="solid"></line>
  </g>
  <g>
    <path d="M 64,1032 A 4,4 0,0,0 60,1036" class="nofill"></path>
    <line x1="60" y1="1036" x2="60" y2="1072" class="solid"></line>
    <line x1="64" y1="1032" x2="96" y2="1032" class="solid"></line>
    <path d="M 96,1032 A 4,4 0,0,1 100,1036" class="nofill"></path>
    <line x1="100" y1="1036" x2="100" y2="1072" class="solid"></line>
    <line x1="36" y1="1072" x2="124" y2="1072" class="solid"></line>
    <line x1="36" y1="1072" x2="36" y2="1092" class="solid"></line>
    <path d="M 36,1092 A 4,4 0,0,0 40,1096" class="nofill"></path>
    <line x1="40" y1="1096" x2="52" y2="1096" class="solid"></line>
    <line x1="56" y1="1088" x2="104" y2="1088" class="solid"></line>
    <line x1="56" y1="1088" x2="46" y2="1108" class="solid"></line>
    <line x1="104" y1="1088" x2="114" y2="1108" class="solid"></line>
    <line x1="108" y1="1096" x2="120" y2="1096" class="solid"></line>
    <path d="M 46,1108 A 3,3 0,0,0 48,1112" class="nofill"></path>
    <line x1="48" y1="1112" x2="112" y2="1112" class="solid"></line>
    <path d="M 114,1108 A 3,3 0,0,1 112,1112" class="nofill"></path>
    <line x1="104" y1="1080" x2="124" y2="1080" class="solid"></line>
    <line x1="124" y1="1072" x2="124" y2="1092" class="solid"></line>
    <path d="M 124,1092 A 4,4 0,0,1 120,1096" class="nofill"></path>
  </g>
  <g>
    <line x1="224" y1="1040" x2="232" y2="1040" class="solid"></line>
    <path d="M 224,1040 A 16,16 0,0,0 224,1056" class="nofill"></path>
    <line x1="224" y1="1056" x2="232" y2="1056" class="solid"></line>
    <path d="M 232,1040 A 16,16 0,0,1 232,1056" class="nofill"></path>
    <line x1="232" y1="1056" x2="240" y2="1072" class="solid"></line>
    <path d="M 240,1072 A 16,16 0,0,1 240,1088" class="nofill"></path>
    <line x1="224" y1="1104" x2="232" y2="1104" class="solid"></line>
    <line x1="240" y1="1088" x2="232" y2="1104" class="solid"></line>
    <path d="M 224,1104 A 16,16 0,0,0 224,1120" class="nofill"></path>
    <line x1="224" y1="1120" x2="232" y2="1120" class="solid"></line>
    <path d="M 232,1104 A 16,16 0,0,1 232,1120" class="nofill"></path>
  </g>
  <g>
    <path d="M 200,1048 A 8,8 0,0,0 194,1052" class="nofill"></path>
    <line x1="194" y1="1052" x2="184" y2="1072" class="solid"></line>
    <line x1="200" y1="1048" x2="216" y2="1048" class="solid"></line>
    <line x1="176" y1="1072" x2="184" y2="1072" class="solid"></line>
    <path d="M 176,1072 A 16,16 0,0,0 176,1088" class="nofill"></path>
    <line x1="176" y1="1088" x2="184" y2="1088" class="solid"></line>
    <path d="M 184,1072 A 16,16 0,0,1 184,1088" class="nofill"></path>
    <line x1="184" y1="1088" x2="194" y2="1108" class="solid"></line>
    <path d="M 194,1108 A 8,8 0,0,0 200,1112" class="nofill"></path>
    <line x1="200" y1="1112" x2="216" y2="1112" class="solid"></line>
  </g>
  <g>
    <path d="M 208,1064 A 8,8 0,0,0 202,1068" class="nofill"></path>
    <line x1="202" y1="1068" x2="200" y2="1072" class="solid"></line>
    <line x1="208" y1="1064" x2="216" y2="1064" class="solid"></line>
    <path d="M 216,1064 A 8,8 0,0,1 222,1068" class="nofill"></path>
    <line x1="222" y1="1068" x2="224" y2="1072" class="solid"></line>
    <path d="M 200,1072 A 16,16 0,0,0 200,1088" class="nofill"></path>
    <path d="M 224,1072 A 16,16 0,0,1 224,1088" class="nofill"></path>
    <line x1="200" y1="1088" x2="202" y2="1092" class="solid"></line>
    <path d="M 202,1092 A 8,8 0,0,0 208,1096" class="nofill"></path>
    <line x1="208" y1="1096" x2="216" y2="1096" class="solid"></line>
    <line x1="224" y1="1088" x2="222" y2="1092" class="solid"></line>
    <path d="M 222,1092 A 8,8 0,0,1 216,1096" class="nofill"></path>
  </g>
  <g>
    <line x1="100" y1="1176" x2="124" y2="1176" class="solid"></line>
    <line x1="100" y1="1176" x2="100" y2="1208" class="solid"></line>
    <line x1="116" y1="1176" x2="116" y2="1208" class="solid"></line>
    <line x1="124" y1="1176" x2="124" y2="1208" class="solid"></line>
    <line x1="100" y1="1192" x2="124" y2="1192" class="solid"></line>
    <line x1="100" y1="1208" x2="124" y2="1208" class="solid"></line>
  </g>
  <g>
    <path d="M 104,1224 A 4,4 0,0,0 100,1228" class="nofill"></path>
    <line x1="100" y1="1228" x2="100" y2="1252" class="solid"></line>
    <line x1="104" y1="1224" x2="120" y2="1224" class="solid"></line>
    <line x1="116" y1="1224" x2="116" y2="1256" class="solid"></line>
    <path d="M 120,1224 A 4,4 0,0,1 124,1228" class="nofill"></path>
    <line x1="124" y1="1228" x2="124" y2="1252" class="solid"></line>
    <line x1="100" y1="1240" x2="124" y2="1240" class="solid"></line>
    <path d="M 100,1252 A 4,4 0,0,0 104,1256" class="nofill"></path>
    <line x1="104" y1="1256" x2="120" y2="1256" class="solid"></line>
    <path d="M 124,1252 A 4,4 0,0,1 120,1256" class="nofill"></path>
  </g>
  <g>
    <line x1="194" y1="1176" x2="222" y2="1176" class="solid"></line>
    <line x1="194" y1="1176" x2="194" y2="1208" class="solid"></line>
    <line x1="198" y1="1176" x2="198" y2="1208" class="solid"></line>
    <line x1="210" y1="1176" x2="210" y2="1208" class="solid"></line>
    <line x1="214" y1="1176" x2="214" y2="1208" class="solid"></line>
    <line x1="218" y1="1176" x2="218" y2="1208" class="solid"></line>
    <line x1="222" y1="1176" x2="222" y2="1208" class="solid"></line>
    <line x1="198" y1="1192" x2="218" y2="1192" class="solid"></line>
    <line x1="194" y1="1208" x2="222" y2="1208" class="solid"></line>
  </g>
  <g>
    <line x1="244" y1="1176" x2="268" y2="1176" class="solid"></line>
    <line x1="244" y1="1176" x2="244" y2="1212" class="solid"></line>
    <line x1="244" y1="1180" x2="268" y2="1180" class="solid"></line>
    <line x1="260" y1="1180" x2="260" y2="1208" class="solid"></line>
    <line x1="268" y1="1176" x2="268" y2="1212" class="solid"></line>
    <line x1="244" y1="1192" x2="268" y2="1192" class="solid"></line>
    <line x1="244" y1="1196" x2="268" y2="1196" class="solid"></line>
    <line x1="244" y1="1208" x2="268" y2="1208" class="solid"></line>
    <line x1="244" y1="1212" x2="268" y2="1212" class="solid"></line>
  </g>
  <g>
    <path d="M 40,1624 A 8,8 0,0,0 34,1628" class="nofill"></path>
    <line x1="34" y1="1628" x2="20" y2="1656" class="solid"></line>
    <line x1="40" y1="1624" x2="72" y2="1624" class="solid"></line>
    <path d="M 72,1624 A 8,8 0,0,1 78,1628" class="nofill"></path>
    <line x1="78" y1="1628" x2="92" y2="1656" class="solid"></line>
    <line x1="20" y1="1656" x2="36" y2="1688" class="solid"></line>
    <path d="M 152,1624 A 8,8 0,0,0 146,1628" class="nofill"></path>
    <line x1="146" y1="1628" x2="132" y2="1656" class="solid"></line>
    <line x1="152" y1="1624" x2="184" y2="1624" class="solid"></line>
    <path d="M 184,1624 A 8,8 0,0,1 190,1628" class="nofill"></path>
    <line x1="190" y1="1628" x2="204" y2="1656" class="solid"></line>
    <line x1="92" y1="1656" x2="132" y2="1656" class="solid"></line>
    <line x1="92" y1="1656" x2="76" y2="1688" class="solid"></line>
    <line x1="132" y1="1656" x2="148" y2="1688" class="solid"></line>
    <line x1="204" y1="1656" x2="240" y2="1656" class="solid"></line>
    <line x1="204" y1="1656" x2="188" y2="1688" class="solid"></line>
    <path d="M 240,1656 A 8,8 0,0,1 246,1660" class="nofill"></path>
    <line x1="246" y1="1660" x2="260" y2="1688" class="solid"></line>
    <line x1="36" y1="1688" x2="76" y2="1688" class="solid"></line>
    <line x1="36" y1="1688" x2="20" y2="1720" class="solid"></line>
    <line x1="76" y1="1688" x2="92" y2="1720" class="solid"></line>
    <line x1="148" y1="1688" x2="188" y2="1688" class="solid"></line>
    <line x1="148" y1="1688" x2="132" y2="1720" class="solid"></line>
    <line x1="188" y1="1688" x2="204" y2="1720" class="solid"></line>
    <line x1="260" y1="1688" x2="244" y2="1720" class="solid"></line>
    <line x1="20" y1="1720" x2="34" y2="1748" class="solid"></line>
    <line x1="92" y1="1720" x2="132" y2="1720" class="solid"></line>
    <line x1="92" y1="1720" x2="76" y2="1752" class="solid"></line>
    <line x1="132" y1="1720" x2="148" y2="1752" class="solid"></line>
    <line x1="204" y1="1720" x2="244" y2="1720" class="solid"></line>
    <line x1="204" y1="1720" x2="188" y2="1752" class="solid"></line>
    <line x1="244" y1="1720" x2="260" y2="1752" class="solid"></line>
    <path d="M 34,1748 A 8,8 0,0,0 40,1752" class="nofill"></path>
    <line x1="40" y1="1752" x2="76" y2="1752" class="solid"></line>
    <line x1="76" y1="1752" x2="90" y2="1780" class="solid"></line>
    <line x1="148" y1="1752" x2="188" y2="1752" class="solid"></line>
    <line x1="148" y1="1752" x2="134" y2="1780" class="solid"></line>
    <line x1="188" y1="1752" x2="202" y2="1780" class="solid"></line>
    <line x1="260" y1="1752" x2="246" y2="1780" class="solid"></line>
    <path d="M 90,1780 A 8,8 0,0,0 96,1784" class="nofill"></path>
    <line x1="96" y1="1784" x2="128" y2="1784" class="solid"></line>
    <path d="M 134,1780 A 8,8 0,0,1 128,1784" class="nofill"></path>
    <path d="M 202,1780 A 8,8 0,0,0 208,1784" class="nofill"></path>
    <line x1="208" y1="1784" x2="240" y2="1784" class="solid"></line>
    <path d="M 246,1780 A 8,8 0,0,1 240,1784" class="nofill"></path>
  </g>
  <g>
    <path d="M 304,1640 A 4,4 0,0,0 300,1644" class="nofill"></path>
    <line x1="300" y1="1644" x2="300" y2="1780" class="solid"></line>
    <line x1="304" y1="1640" x2="440" y2="1640" class="solid"></line>
    <line x1="348" y1="1640" x2="348" y2="1784" class="solid"></line>
    <line x1="396" y1="1640" x2="396" y2="1784" class="solid"></line>
    <path d="M 440,1640 A 4,4 0,0,1 444,1644" class="nofill"></path>
    <line x1="444" y1="1644" x2="444" y2="1780" class="solid"></line>
    <line x1="300" y1="1688" x2="444" y2="1688" class="solid"></line>
    <line x1="300" y1="1736" x2="444" y2="1736" class="solid"></line>
    <path d="M 300,1780 A 4,4 0,0,0 304,1784" class="nofill"></path>
    <line x1="304" y1="1784" x2="440" y2="1784" class="solid"></line>
    <path d="M 444,1780 A 4,4 0,0,1 440,1784" class="nofill"></path>
  </g>
  <g>
    <path d="M 536,1656 A 8,8 0,0,0 530,1660" class="nofill"></path>
    <line x1="530" y1="1660" x2="470" y2="1780" class="solid"></line>
    <line x1="536" y1="1656" x2="724" y2="1656" class="solid"></line>
    <line x1="580" y1="1656" x2="516" y2="1784" class="solid"></line>
    <line x1="628" y1="1656" x2="564" y2="1784" class="solid"></line>
    <line x1="676" y1="1656" x2="612" y2="1784" class="solid"></line>
    <line x1="724" y1="1656" x2="660" y2="1784" class="solid"></line>
    <line x1="516" y1="1688" x2="708" y2="1688" class="solid"></line>
    <line x1="500" y1="1720" x2="692" y2="1720" class="solid"></line>
    <line x1="484" y1="1752" x2="676" y2="1752" class="solid"></line>
    <path d="M 470,1780 A 3,3 0,0,0 472,1784" class="nofill"></path>
    <line x1="472" y1="1784" x2="660" y2="1784" class="solid"></line>
  </g>
  <g>
    <line x1="56" y1="1888" x2="80" y2="1888" class="solid"></line>
    <line x1="80" y1="1888" x2="88" y2="1904" class="solid"></line>
    <line x1="88" y1="1904" x2="112" y2="1904" class="solid"></line>
    <line x1="120" y1="1888" x2="144" y2="1888" class="solid"></line>
    <line x1="120" y1="1888" x2="112" y2="1904" class="solid"></line>
    <line x1="144" y1="1888" x2="152" y2="1904" class="solid"></line>
    <line x1="112" y1="1904" x2="120" y2="1920" class="solid"></line>
    <line x1="120" y1="1920" x2="144" y2="1920" class="solid"></line>
    <line x1="152" y1="1904" x2="144" y2="1920" class="solid"></line>
    <line x1="144" y1="1920" x2="152" y2="1936" class="solid"></line>
    <line x1="24" y1="1904" x2="48" y2="1904" class="solid"></line>
    <line x1="56" y1="1888" x2="48" y2="1904" class="solid"></line>
    <line x1="24" y1="1904" x2="16" y2="1920" class="solid"></line>
    <line x1="48" y1="1904" x2="56" y2="1920" class="solid"></line>
    <line x1="56" y1="1920" x2="80" y2="1920" class="solid"></line>
    <line x1="88" y1="1904" x2="80" y2="1920" class="solid"></line>
    <line x1="16" y1="1920" x2="24" y2="1936" class="solid"></line>
    <line x1="24" y1="1936" x2="48" y2="1936" class="solid"></line>
    <line x1="56" y1="1920" x2="48" y2="1936" class="solid"></line>
    <line x1="80" y1="1920" x2="88" y2="1936" class="solid"></line>
    <line x1="88" y1="1936" x2="112" y2="1936" class="solid"></line>
    <line x1="120" y1="1920" x2="112" y2="1936" class="solid"></line>
    <line x1="24" y1="1936" x2="16" y2="1952" class="solid"></line>
    <line x1="48" y1="1936" x2="56" y2="1952" class="solid"></line>
    <line x1="56" y1="1952" x2="80" y2="1952" class="solid"></line>
    <line x1="88" y1="1936" x2="80" y2="1952" class="solid"></line>
    <line x1="112" y1="1936" x2="120" y2="1952" class="solid"></line>
    <line x1="120" y1="1952" x2="144" y2="1952" class="solid"></line>
    <line x1="152" y1="1936" x2="144" y2="1952" class="solid"></line>
    <line x1="16" y1="1952" x2="24" y2="1968" class="solid"></line>
    <line x1="24" y1="1968" x2="48" y2="1968" class="solid"></line>
    <line x1="56" y1="1952" x2="48" y2="1968" class="solid"></line>
    <line x1="80" y1="1952" x2="88" y2="1968" class="solid"></line>
    <line x1="88" y1="1968" x2="112" y2="1968" class="solid"></line>
    <line x1="120" y1="1952" x2="112" y2="1968" class="solid"></line>
    <line x1="144" y1="1952" x2="152" y2="1968" class="solid"></line>
    <line x1="48" y1="1968" x2="56" y2="1984" class="solid"></line>
    <line x1="56" y1="1984" x2="80" y2="1984" class="solid"></line>
    <line x1="88" y1="1968" x2="80" y2="1984" class="solid"></line>
    <line x1="112" y1="1968" x2="120" y2="1984" class="solid"></line>
    <line x1="120" y1="1984" x2="144" y2="1984" class="solid"></line>
    <line x1="152" y1="1968" x2="144" y2="1984" class="solid"></line>
  </g>
  <g>
    <path d="M 200,1880 A 4,4 0,0,0 196,1884" class="nofill"></path>
    <line x1="196" y1="1884" x2="196" y2="1972" class="solid"></line>
    <line x1="200" y1="1880" x2="352" y2="1880" class="solid"></line>
    <line x1="228" y1="1880" x2="228" y2="1976" class="solid"></line>
    <line x1="260" y1="1880" x2="260" y2="1976" class="solid"></line>
    <line x1="292" y1="1880" x2="292" y2="1976" class="solid"></line>
    <line x1="324" y1="1880" x2="324" y2="1976" class="solid"></line>
    <path d="M 352,1880 A 4,4 0,0,1 356,1884" class="nofill"></path>
    <line x1="356" y1="1884" x2="356" y2="1972" class="solid"></line>
    <line x1="196" y1="1912" x2="356" y2="1912" class="solid"></line>
    <line x1="196" y1="1944" x2="356" y2="1944" class="solid"></line>
    <path d="M 196,1972 A 4,4 0,0,0 200,1976" class="nofill"></path>
    <line x1="200" y1="1976" x2="352" y2="1976" class="solid"></line>
    <path d="M 356,1972 A 4,4 0,0,1 352,1976" class="nofill"></path>
  </g>
  <g>
    <line x1="404" y1="1880" x2="388" y2="1912" class="solid"></line>
    <line x1="404" y1="1880" x2="452" y2="1976" class="solid"></line>
    <path d="M 408,1880 A 8,8 0,0,0 402,1884" class="nofill"></path>
    <path d="M 408,1880 A 3,3 0,0,0 406,1884" class="nofill"></path>
    <line x1="408" y1="1880" x2="528" y2="1880" class="solid"></line>
    <line x1="436" y1="1880" x2="390" y2="1972" class="solid"></line>
    <line x1="436" y1="1880" x2="484" y2="1976" class="solid"></line>
    <line x1="468" y1="1880" x2="420" y2="1976" class="solid"></line>
    <line x1="468" y1="1880" x2="516" y2="1976" class="solid"></line>
    <line x1="500" y1="1880" x2="452" y2="1976" class="solid"></line>
    <line x1="500" y1="1880" x2="532" y2="1944" class="solid"></line>
    <path d="M 528,1880 A 3,3 0,0,1 530,1884" class="nofill"></path>
    <line x1="530" y1="1884" x2="484" y2="1976" class="solid"></line>
    <line x1="388" y1="1912" x2="516" y2="1912" class="solid"></line>
    <line x1="388" y1="1912" x2="420" y2="1976" class="solid"></line>
    <line x1="404" y1="1944" x2="532" y2="1944" class="solid"></line>
    <line x1="532" y1="1944" x2="516" y2="1976" class="solid"></line>
    <path d="M 390,1972 A 3,3 0,0,0 392,1976" class="nofill"></path>
    <line x1="392" y1="1976" x2="512" y2="1976" class="solid"></line>
    <path d="M 514,1972 A 3,3 0,0,1 512,1976" class="nofill"></path>
    <path d="M 518,1972 A 8,8 0,0,1 512,1976" class="nofill"></path>
  </g>
  <g>
    <path d="M 560,1880 A 4,4 0,0,0 556,1884" class="nofill"></path>
    <line x1="556" y1="1884" x2="556" y2="1972" class="solid"></line>
    <line x1="560" y1="1880" x2="584" y2="1880" class="solid"></line>
    <path d="M 584,1880 A 4,4 0,0,1 588,1884" class="nofill"></path>
    <line x1="588" y1="1884" x2="588" y2="1972" class="solid"></line>
    <line x1="556" y1="1912" x2="588" y2="1912" class="solid"></line>
    <line x1="556" y1="1944" x2="588" y2="1944" class="solid"></line>
    <path d="M 556,1972 A 4,4 0,0,0 560,1976" class="nofill"></path>
    <line x1="560" y1="1976" x2="584" y2="1976" class="solid"></line>
    <path d="M 588,1972 A 4,4 0,0,1 584,1976" class="nofill"></path>
    <path d="M 624,1880 A 4,4 0,0,0 620,1884" class="nofill"></path>
    <line x1="620" y1="1884" x2="620" y2="1972" class="solid"></line>
    <line x1="624" y1="1880" x2="648" y2="1880" class="solid"></line>
    <path d="M 648,1880 A 4,4 0,0,1 652,1884" class="nofill"></path>
    <line x1="652" y1="1884" x2="652" y2="1972" class="solid"></line>
    <line x1="588" y1="1896" x2="620" y2="1896" class="solid"></line>
    <line x1="620" y1="1912" x2="652" y2="1912" class="solid"></line>
    <line x1="588" y1="1928" x2="620" y2="1928" class="solid"></line>
    <line x1="620" y1="1944" x2="652" y2="1944" class="solid"></line>
    <line x1="588" y1="1960" x2="620" y2="1960" class="solid"></line>
    <path d="M 620,1972 A 4,4 0,0,0 624,1976" class="nofill"></path>
    <line x1="624" y1="1976" x2="648" y2="1976" class="solid"></line>
    <path d="M 652,1972 A 4,4 0,0,1 648,1976" class="nofill"></path>
  </g>
  <g>
    <line x1="488" y1="2064" x2="476" y2="2088" class="solid"></line>
    <line x1="476" y1="2088" x2="488" y2="2112" class="solid"></line>
  </g>
  <g>
    <line x1="172" y1="2108" x2="172" y2="2152" class="solid"></line>
    <line x1="172" y1="2152" x2="216" y2="2152" class="solid"></line>
    <line x1="172" y1="2152" x2="158" y2="2180" class="solid"></line>
  </g>
  <g>
    <path d="M 192,2136 A 4,4 0,0,1 196,2140" class="nofill"></path>
    <line x1="196" y1="2140" x2="196" y2="2144" class="solid"></line>
  </g>
  <g>
    <text x="114" y="2316">Êñá</text>
    <text x="130" y="2316">‰ª∂</text>
    <text x="146" y="2316">Á≥ª</text>
    <text x="162" y="2316">Áªü</text>
  </g>
  <g>
    <text x="258" y="2316">Ë∞É</text>
    <text x="274" y="2316">Â∫¶</text>
    <text x="290" y="2316">Âô®</text>
  </g>
  <g>
    <path d="M 288,2392 A 8,8 0,0,0 282,2396" class="nofill"></path>
    <line x1="282" y1="2396" x2="270" y2="2420" class="solid"></line>
    <line x1="288" y1="2392" x2="312" y2="2392" class="solid"></line>
  </g>
  <g>
    <line x1="270" y1="2428" x2="282" y2="2452" class="solid"></line>
    <path d="M 282,2452 A 8,8 0,0,0 288,2456" class="nofill"></path>
    <line x1="288" y1="2456" x2="312" y2="2456" class="solid"></line>
  </g>
  <g>
    <line x1="258" y1="2444" x2="246" y2="2468" class="solid"></line>
    <line x1="232" y1="2472" x2="240" y2="2472" class="solid"></line>
    <path d="M 246,2468 A 8,8 0,0,1 240,2472" class="nofill"></path>
  </g>
  <g>
    <line x1="220" y1="2544" x2="220" y2="2568" class="solid"></line>
    <line x1="220" y1="2568" x2="208" y2="2592" class="solid"></line>
    <line x1="220" y1="2568" x2="232" y2="2592" class="solid"></line>
  </g>
  <g>
    <path d="M 80,2568 A 4,4 0,0,0 76,2572" class="nofill"></path>
    <line x1="76" y1="2572" x2="76" y2="2596" class="solid"></line>
    <line x1="80" y1="2568" x2="104" y2="2568" class="solid"></line>
    <path d="M 104,2568 A 4,4 0,0,1 108,2572" class="nofill"></path>
    <line x1="108" y1="2572" x2="108" y2="2596" class="solid"></line>
    <path d="M 76,2596 A 4,4 0,0,0 80,2600" class="nofill"></path>
    <line x1="80" y1="2600" x2="104" y2="2600" class="solid"></line>
    <line x1="92" y1="2600" x2="92" y2="2696" class="solid"></line>
    <path d="M 108,2596 A 4,4 0,0,1 104,2600" class="nofill"></path>
    <line x1="92" y1="2632" x2="208" y2="2632" class="solid"></line>
    <path d="M 80,2696 A 4,4 0,0,0 76,2700" class="nofill"></path>
    <line x1="76" y1="2700" x2="76" y2="2724" class="solid"></line>
    <line x1="80" y1="2696" x2="104" y2="2696" class="solid"></line>
    <path d="M 104,2696 A 4,4 0,0,1 108,2700" class="nofill"></path>
    <line x1="108" y1="2700" x2="108" y2="2724" class="solid"></line>
    <path d="M 76,2724 A 4,4 0,0,0 80,2728" class="nofill"></path>
    <line x1="80" y1="2728" x2="104" y2="2728" class="solid"></line>
    <path d="M 108,2724 A 4,4 0,0,1 104,2728" class="nofill"></path>
  </g>
  <g>
    <line x1="220" y1="2736" x2="220" y2="2760" class="solid"></line>
    <line x1="220" y1="2760" x2="208" y2="2784" class="solid"></line>
    <line x1="220" y1="2760" x2="232" y2="2784" class="solid"></line>
  </g>
  <g>
    <path d="M 120,2824 A 8,8 0,0,0 114,2828" class="nofill"></path>
    <line x1="114" y1="2828" x2="112" y2="2832" class="solid"></line>
    <line x1="120" y1="2824" x2="128" y2="2824" class="solid"></line>
    <path d="M 128,2824 A 8,8 0,0,1 134,2828" class="nofill"></path>
    <line x1="134" y1="2828" x2="136" y2="2832" class="solid"></line>
    <path d="M 112,2832 A 16,16 0,0,0 112,2848" class="nofill"></path>
    <path d="M 136,2832 A 16,16 0,0,1 136,2848" class="nofill"></path>
    <line x1="112" y1="2848" x2="114" y2="2852" class="solid"></line>
    <path d="M 114,2852 A 8,8 0,0,0 120,2856" class="nofill"></path>
    <line x1="120" y1="2856" x2="128" y2="2856" class="solid"></line>
    <line x1="136" y1="2848" x2="134" y2="2852" class="solid"></line>
    <path d="M 134,2852 A 8,8 0,0,1 128,2856" class="nofill"></path>
  </g>
  <g>
    <path d="M 80,2920 A 8,8 0,0,0 74,2924" class="nofill"></path>
    <line x1="74" y1="2924" x2="72" y2="2928" class="solid"></line>
    <line x1="80" y1="2920" x2="88" y2="2920" class="solid"></line>
    <path d="M 88,2920 A 8,8 0,0,1 94,2924" class="nofill"></path>
    <line x1="94" y1="2924" x2="96" y2="2928" class="solid"></line>
    <path d="M 72,2928 A 16,16 0,0,0 72,2944" class="nofill"></path>
    <path d="M 96,2928 A 16,16 0,0,1 96,2944" class="nofill"></path>
    <line x1="72" y1="2944" x2="74" y2="2948" class="solid"></line>
    <path d="M 74,2948 A 8,8 0,0,0 80,2952" class="nofill"></path>
    <line x1="80" y1="2952" x2="88" y2="2952" class="solid"></line>
    <line x1="96" y1="2944" x2="94" y2="2948" class="solid"></line>
    <path d="M 94,2948 A 8,8 0,0,1 88,2952" class="nofill"></path>
  </g>
  <g>
    <path d="M 112,3016 A 8,8 0,0,0 106,3020" class="nofill"></path>
    <line x1="106" y1="3020" x2="104" y2="3024" class="solid"></line>
    <line x1="112" y1="3016" x2="120" y2="3016" class="solid"></line>
    <path d="M 120,3016 A 8,8 0,0,1 126,3020" class="nofill"></path>
    <line x1="126" y1="3020" x2="128" y2="3024" class="solid"></line>
    <path d="M 104,3024 A 16,16 0,0,0 104,3040" class="nofill"></path>
    <path d="M 128,3024 A 16,16 0,0,1 128,3040" class="nofill"></path>
    <line x1="104" y1="3040" x2="106" y2="3044" class="solid"></line>
    <path d="M 106,3044 A 8,8 0,0,0 112,3048" class="nofill"></path>
    <line x1="112" y1="3048" x2="120" y2="3048" class="solid"></line>
    <line x1="128" y1="3040" x2="126" y2="3044" class="solid"></line>
    <path d="M 126,3044 A 8,8 0,0,1 120,3048" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,2920 A 8,8 0,0,0 170,2924" class="nofill"></path>
    <line x1="170" y1="2924" x2="168" y2="2928" class="solid"></line>
    <line x1="176" y1="2920" x2="184" y2="2920" class="solid"></line>
    <path d="M 184,2920 A 8,8 0,0,1 190,2924" class="nofill"></path>
    <line x1="190" y1="2924" x2="192" y2="2928" class="solid"></line>
    <path d="M 168,2928 A 16,16 0,0,0 168,2944" class="nofill"></path>
    <path d="M 192,2928 A 16,16 0,0,1 192,2944" class="nofill"></path>
    <line x1="168" y1="2944" x2="170" y2="2948" class="solid"></line>
    <path d="M 170,2948 A 8,8 0,0,0 176,2952" class="nofill"></path>
    <line x1="176" y1="2952" x2="184" y2="2952" class="solid"></line>
    <line x1="192" y1="2944" x2="190" y2="2948" class="solid"></line>
    <path d="M 190,2948 A 8,8 0,0,1 184,2952" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,3032 A 8,8 0,0,0 170,3036" class="nofill"></path>
    <line x1="170" y1="3036" x2="168" y2="3040" class="solid"></line>
    <line x1="176" y1="3032" x2="184" y2="3032" class="solid"></line>
    <path d="M 184,3032 A 8,8 0,0,1 190,3036" class="nofill"></path>
    <line x1="190" y1="3036" x2="192" y2="3040" class="solid"></line>
    <path d="M 168,3040 A 16,16 0,0,0 168,3056" class="nofill"></path>
    <path d="M 192,3040 A 16,16 0,0,1 192,3056" class="nofill"></path>
    <line x1="168" y1="3056" x2="170" y2="3060" class="solid"></line>
    <path d="M 170,3060 A 8,8 0,0,0 176,3064" class="nofill"></path>
    <line x1="176" y1="3064" x2="184" y2="3064" class="solid"></line>
    <line x1="192" y1="3056" x2="190" y2="3060" class="solid"></line>
    <path d="M 190,3060 A 8,8 0,0,1 184,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 224,3032 A 8,8 0,0,0 218,3036" class="nofill"></path>
    <line x1="218" y1="3036" x2="216" y2="3040" class="solid"></line>
    <line x1="224" y1="3032" x2="232" y2="3032" class="solid"></line>
    <path d="M 232,3032 A 8,8 0,0,1 238,3036" class="nofill"></path>
    <line x1="238" y1="3036" x2="240" y2="3040" class="solid"></line>
    <path d="M 216,3040 A 16,16 0,0,0 216,3056" class="nofill"></path>
    <path d="M 240,3040 A 16,16 0,0,1 240,3056" class="nofill"></path>
    <line x1="216" y1="3056" x2="218" y2="3060" class="solid"></line>
    <path d="M 218,3060 A 8,8 0,0,0 224,3064" class="nofill"></path>
    <line x1="224" y1="3064" x2="232" y2="3064" class="solid"></line>
    <line x1="240" y1="3056" x2="238" y2="3060" class="solid"></line>
    <path d="M 238,3060 A 8,8 0,0,1 232,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,3032 A 8,8 0,0,0 266,3036" class="nofill"></path>
    <line x1="266" y1="3036" x2="264" y2="3040" class="solid"></line>
    <line x1="272" y1="3032" x2="280" y2="3032" class="solid"></line>
    <path d="M 280,3032 A 8,8 0,0,1 286,3036" class="nofill"></path>
    <line x1="286" y1="3036" x2="288" y2="3040" class="solid"></line>
    <path d="M 264,3040 A 16,16 0,0,0 264,3056" class="nofill"></path>
    <path d="M 288,3040 A 16,16 0,0,1 288,3056" class="nofill"></path>
    <line x1="264" y1="3056" x2="266" y2="3060" class="solid"></line>
    <path d="M 266,3060 A 8,8 0,0,0 272,3064" class="nofill"></path>
    <line x1="272" y1="3064" x2="280" y2="3064" class="solid"></line>
    <line x1="288" y1="3056" x2="286" y2="3060" class="solid"></line>
    <path d="M 286,3060 A 8,8 0,0,1 280,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 40,3016 A 8,8 0,0,0 34,3020" class="nofill"></path>
    <line x1="34" y1="3020" x2="32" y2="3024" class="solid"></line>
    <line x1="40" y1="3016" x2="48" y2="3016" class="solid"></line>
    <path d="M 48,3016 A 8,8 0,0,1 54,3020" class="nofill"></path>
    <line x1="54" y1="3020" x2="56" y2="3024" class="solid"></line>
    <path d="M 32,3024 A 16,16 0,0,0 32,3040" class="nofill"></path>
    <path d="M 56,3024 A 16,16 0,0,1 56,3040" class="nofill"></path>
    <line x1="32" y1="3040" x2="34" y2="3044" class="solid"></line>
    <path d="M 34,3044 A 8,8 0,0,0 40,3048" class="nofill"></path>
    <line x1="40" y1="3048" x2="48" y2="3048" class="solid"></line>
    <line x1="56" y1="3040" x2="54" y2="3044" class="solid"></line>
    <path d="M 54,3044 A 8,8 0,0,1 48,3048" class="nofill"></path>
  </g>
  <g>
    <path d="M 104,3176 A 4,4 0,0,0 100,3180" class="nofill"></path>
    <line x1="100" y1="3180" x2="100" y2="3220" class="solid"></line>
    <line x1="104" y1="3176" x2="296" y2="3176" class="solid"></line>
    <line x1="68" y1="3224" x2="96" y2="3224" class="solid"></line>
    <path d="M 100,3220 A 4,4 0,0,1 96,3224" class="nofill"></path>
    <path d="M 100,3220 A 4,4 0,0,0 104,3224" class="nofill"></path>
    <line x1="104" y1="3224" x2="296" y2="3224" class="broken"></line>
  </g>
  <g>
    <path d="M 128,3272 A 8,8 0,0,0 122,3276" class="nofill"></path>
    <line x1="122" y1="3276" x2="102" y2="3316" class="solid"></line>
    <line x1="128" y1="3272" x2="296" y2="3272" class="solid"></line>
    <line x1="68" y1="3320" x2="96" y2="3320" class="solid"></line>
    <path d="M 102,3316 A 8,8 0,0,1 96,3320" class="nofill"></path>
    <path d="M 102,3316 A 3,3 0,0,0 104,3320" class="nofill"></path>
    <line x1="104" y1="3320" x2="136" y2="3320" class="broken"></line>
  </g>
  <g>
    <line x1="72" y1="3384" x2="200" y2="3384" class="broken"></line>
    <path d="M 200,3384 A 4,4 0,0,1 204,3388" class="nofill"></path>
    <path d="M 208,3384 A 4,4 0,0,0 204,3388" class="nofill"></path>
    <line x1="204" y1="3388" x2="204" y2="3428" class="solid"></line>
    <line x1="208" y1="3384" x2="296" y2="3384" class="solid"></line>
    <line x1="68" y1="3432" x2="200" y2="3432" class="solid"></line>
    <path d="M 204,3428 A 4,4 0,0,1 200,3432" class="nofill"></path>
    <path d="M 204,3428 A 4,4 0,0,0 208,3432" class="nofill"></path>
    <line x1="208" y1="3432" x2="296" y2="3432" class="broken"></line>
  </g>
  <g>
    <line x1="124" y1="3496" x2="180" y2="3496" class="solid"></line>
    <line x1="124" y1="3496" x2="124" y2="3528" class="solid"></line>
    <line x1="180" y1="3496" x2="180" y2="3528" class="solid"></line>
    <line x1="96" y1="3512" x2="124" y2="3512" class="solid"></line>
    <line x1="180" y1="3512" x2="200" y2="3512" class="solid"></line>
    <line x1="124" y1="3528" x2="180" y2="3528" class="solid"></line>
  </g>
  <g>
    <path d="M 216,3496 A 8,8 0,0,0 210,3500" class="nofill"></path>
    <line x1="210" y1="3500" x2="208" y2="3504" class="solid"></line>
    <line x1="216" y1="3496" x2="224" y2="3496" class="solid"></line>
    <path d="M 224,3496 A 8,8 0,0,1 230,3500" class="nofill"></path>
    <line x1="230" y1="3500" x2="232" y2="3504" class="solid"></line>
    <path d="M 208,3504 A 16,16 0,0,0 208,3520" class="nofill"></path>
    <path d="M 232,3504 A 16,16 0,0,1 232,3520" class="nofill"></path>
    <line x1="208" y1="3520" x2="210" y2="3524" class="solid"></line>
    <path d="M 210,3524 A 8,8 0,0,0 216,3528" class="nofill"></path>
    <line x1="216" y1="3528" x2="224" y2="3528" class="solid"></line>
    <line x1="232" y1="3520" x2="230" y2="3524" class="solid"></line>
    <path d="M 230,3524 A 8,8 0,0,1 224,3528" class="nofill"></path>
  </g>
  <g>
    <line x1="252" y1="3496" x2="284" y2="3496" class="solid"></line>
    <line x1="252" y1="3496" x2="252" y2="3528" class="solid"></line>
    <line x1="284" y1="3496" x2="284" y2="3528" class="solid"></line>
    <line x1="240" y1="3512" x2="252" y2="3512" class="solid"></line>
    <line x1="284" y1="3512" x2="304" y2="3512" class="solid"></line>
    <line x1="252" y1="3528" x2="284" y2="3528" class="solid"></line>
  </g>
  <g>
    <line x1="80" y1="3512" x2="88" y2="3512" class="solid"></line>
    <path d="M 88,3512 A 4,4 0,0,1 92,3516" class="nofill"></path>
    <line x1="92" y1="3516" x2="92" y2="3572" class="solid"></line>
    <path d="M 92,3572 A 4,4 0,0,0 96,3576" class="nofill"></path>
    <line x1="96" y1="3576" x2="104" y2="3576" class="solid"></line>
    <path d="M 112,3544 A 4,4 0,0,0 108,3548" class="nofill"></path>
    <line x1="108" y1="3548" x2="108" y2="3572" class="solid"></line>
    <line x1="112" y1="3544" x2="160" y2="3544" class="solid"></line>
    <path d="M 108,3572 A 4,4 0,0,1 104,3576" class="nofill"></path>
  </g>
  <g>
    <path d="M 312,3512 A 4,4 0,0,0 308,3516" class="nofill"></path>
    <line x1="308" y1="3516" x2="308" y2="3572" class="solid"></line>
    <line x1="168" y1="3544" x2="216" y2="3544" class="solid"></line>
    <path d="M 216,3544 A 4,4 0,0,1 220,3548" class="nofill"></path>
    <line x1="220" y1="3548" x2="220" y2="3572" class="solid"></line>
    <path d="M 220,3572 A 4,4 0,0,0 224,3576" class="nofill"></path>
    <line x1="224" y1="3576" x2="304" y2="3576" class="solid"></line>
    <path d="M 308,3572 A 4,4 0,0,1 304,3576" class="nofill"></path>
  </g>
  <g>
    <line x1="148" y1="3560" x2="180" y2="3560" class="solid"></line>
    <line x1="148" y1="3560" x2="148" y2="3592" class="solid"></line>
    <line x1="180" y1="3560" x2="180" y2="3592" class="solid"></line>
    <line x1="180" y1="3576" x2="200" y2="3576" class="solid"></line>
    <path d="M 200,3576 A 4,4 0,0,1 204,3580" class="nofill"></path>
    <line x1="204" y1="3580" x2="204" y2="3620" class="solid"></line>
    <line x1="148" y1="3592" x2="180" y2="3592" class="solid"></line>
    <path d="M 128,3576 A 4,4 0,0,0 124,3580" class="nofill"></path>
    <line x1="124" y1="3580" x2="124" y2="3620" class="solid"></line>
    <line x1="128" y1="3576" x2="148" y2="3576" class="solid"></line>
    <path d="M 124,3620 A 4,4 0,0,0 128,3624" class="nofill"></path>
    <line x1="128" y1="3624" x2="144" y2="3624" class="solid"></line>
    <line x1="184" y1="3624" x2="200" y2="3624" class="solid"></line>
    <path d="M 204,3620 A 4,4 0,0,1 200,3624" class="nofill"></path>
  </g>
  <g>
    <line x1="92" y1="3584" x2="92" y2="3684" class="solid"></line>
    <path d="M 92,3684 A 4,4 0,0,0 96,3688" class="nofill"></path>
    <line x1="96" y1="3688" x2="112" y2="3688" class="solid"></line>
  </g>
  <g>
    <path d="M 160,3608 A 8,8 0,0,0 154,3612" class="nofill"></path>
    <line x1="154" y1="3612" x2="152" y2="3616" class="solid"></line>
    <line x1="160" y1="3608" x2="168" y2="3608" class="solid"></line>
    <path d="M 168,3608 A 8,8 0,0,1 174,3612" class="nofill"></path>
    <line x1="174" y1="3612" x2="176" y2="3616" class="solid"></line>
    <path d="M 152,3616 A 16,16 0,0,0 152,3632" class="nofill"></path>
    <path d="M 176,3616 A 16,16 0,0,1 176,3632" class="nofill"></path>
    <line x1="152" y1="3632" x2="154" y2="3636" class="solid"></line>
    <path d="M 154,3636 A 8,8 0,0,0 160,3640" class="nofill"></path>
    <line x1="160" y1="3640" x2="168" y2="3640" class="solid"></line>
    <line x1="176" y1="3632" x2="174" y2="3636" class="solid"></line>
    <path d="M 174,3636 A 8,8 0,0,1 168,3640" class="nofill"></path>
  </g>
  <g>
    <line x1="308" y1="3628" x2="308" y2="3684" class="solid"></line>
    <line x1="272" y1="3688" x2="304" y2="3688" class="solid"></line>
    <path d="M 308,3684 A 4,4 0,0,1 304,3688" class="nofill"></path>
  </g>
  <g>
    <path d="M 120,3656 A 4,4 0,0,0 116,3660" class="nofill"></path>
    <line x1="116" y1="3660" x2="116" y2="3684" class="solid"></line>
    <line x1="120" y1="3656" x2="184" y2="3656" class="solid"></line>
    <path d="M 116,3684 A 4,4 0,0,0 120,3688" class="nofill"></path>
    <line x1="120" y1="3688" x2="128" y2="3688" class="solid"></line>
  </g>
  <g>
    <line x1="192" y1="3656" x2="264" y2="3656" class="solid"></line>
    <path d="M 264,3656 A 4,4 0,0,1 268,3660" class="nofill"></path>
    <line x1="268" y1="3660" x2="268" y2="3684" class="solid"></line>
    <line x1="256" y1="3688" x2="264" y2="3688" class="solid"></line>
    <path d="M 268,3684 A 4,4 0,0,1 264,3688" class="nofill"></path>
  </g>
  <g>
    <line x1="148" y1="3672" x2="180" y2="3672" class="solid"></line>
    <line x1="148" y1="3672" x2="148" y2="3704" class="solid"></line>
    <line x1="180" y1="3672" x2="180" y2="3704" class="solid"></line>
    <line x1="180" y1="3688" x2="200" y2="3688" class="solid"></line>
    <line x1="148" y1="3704" x2="180" y2="3704" class="solid"></line>
    <path d="M 136,3688 A 4,4 0,0,0 132,3692" class="nofill"></path>
    <line x1="132" y1="3692" x2="132" y2="3716" class="solid"></line>
    <line x1="136" y1="3688" x2="148" y2="3688" class="solid"></line>
    <path d="M 132,3716 A 4,4 0,0,0 136,3720" class="nofill"></path>
    <line x1="136" y1="3720" x2="192" y2="3720" class="solid"></line>
  </g>
  <g>
    <path d="M 216,3672 A 8,8 0,0,0 210,3676" class="nofill"></path>
    <line x1="210" y1="3676" x2="208" y2="3680" class="solid"></line>
    <line x1="216" y1="3672" x2="224" y2="3672" class="solid"></line>
    <path d="M 224,3672 A 8,8 0,0,1 230,3676" class="nofill"></path>
    <line x1="230" y1="3676" x2="232" y2="3680" class="solid"></line>
    <path d="M 208,3680 A 16,16 0,0,0 208,3696" class="nofill"></path>
    <path d="M 232,3680 A 16,16 0,0,1 232,3696" class="nofill"></path>
    <line x1="208" y1="3696" x2="210" y2="3700" class="solid"></line>
    <path d="M 210,3700 A 8,8 0,0,0 216,3704" class="nofill"></path>
    <line x1="216" y1="3704" x2="224" y2="3704" class="solid"></line>
    <line x1="232" y1="3696" x2="230" y2="3700" class="solid"></line>
    <path d="M 230,3700 A 8,8 0,0,1 224,3704" class="nofill"></path>
  </g>
  <g>
    <line x1="240" y1="3688" x2="248" y2="3688" class="solid"></line>
    <path d="M 248,3688 A 4,4 0,0,1 252,3692" class="nofill"></path>
    <line x1="252" y1="3692" x2="252" y2="3716" class="solid"></line>
    <line x1="200" y1="3720" x2="248" y2="3720" class="solid"></line>
    <path d="M 252,3716 A 4,4 0,0,1 248,3720" class="nofill"></path>
  </g>
  <g>
    <path d="M 320,3736 A 4,4 0,0,0 316,3740" class="nofill"></path>
    <line x1="316" y1="3740" x2="316" y2="3768" class="solid"></line>
    <line x1="320" y1="3736" x2="416" y2="3736" class="solid"></line>
    <line x1="304" y1="3776" x2="312" y2="3776" class="solid"></line>
    <path d="M 316,3768 A 8,8 0,0,1 312,3776" class="nofill"></path>
  </g>
  <g>
    <line x1="424" y1="3736" x2="544" y2="3736" class="solid"></line>
    <path d="M 544,3736 A 4,4 0,0,1 548,3740" class="nofill"></path>
    <line x1="548" y1="3740" x2="548" y2="3768" class="solid"></line>
    <path d="M 548,3768 A 8,8 0,0,0 552,3776" class="nofill"></path>
    <line x1="552" y1="3776" x2="576" y2="3776" class="solid"></line>
  </g>
  <g>
    <line x1="92" y1="3752" x2="204" y2="3752" class="solid"></line>
    <line x1="92" y1="3752" x2="92" y2="3784" class="solid"></line>
    <line x1="204" y1="3752" x2="204" y2="3784" class="solid"></line>
    <line x1="56" y1="3776" x2="92" y2="3776" class="solid"></line>
    <line x1="204" y1="3776" x2="216" y2="3776" class="solid"></line>
    <line x1="92" y1="3784" x2="204" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 232,3752 A 8,8 0,0,0 226,3756" class="nofill"></path>
    <line x1="226" y1="3756" x2="224" y2="3760" class="solid"></line>
    <line x1="232" y1="3752" x2="240" y2="3752" class="solid"></line>
    <path d="M 240,3752 A 8,8 0,0,1 246,3756" class="nofill"></path>
    <line x1="246" y1="3756" x2="248" y2="3760" class="solid"></line>
    <path d="M 224,3760 A 16,16 0,0,0 224,3776" class="nofill"></path>
    <path d="M 248,3760 A 16,16 0,0,1 248,3776" class="nofill"></path>
    <line x1="224" y1="3776" x2="226" y2="3780" class="solid"></line>
    <path d="M 226,3780 A 8,8 0,0,0 232,3784" class="nofill"></path>
    <line x1="232" y1="3784" x2="240" y2="3784" class="solid"></line>
    <line x1="248" y1="3776" x2="246" y2="3780" class="solid"></line>
    <path d="M 246,3780 A 8,8 0,0,1 240,3784" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,3752 A 8,8 0,0,0 274,3756" class="nofill"></path>
    <line x1="274" y1="3756" x2="272" y2="3760" class="solid"></line>
    <line x1="280" y1="3752" x2="288" y2="3752" class="solid"></line>
    <path d="M 288,3752 A 8,8 0,0,1 294,3756" class="nofill"></path>
    <line x1="294" y1="3756" x2="296" y2="3760" class="solid"></line>
    <path d="M 272,3760 A 16,16 0,0,0 272,3776" class="nofill"></path>
    <path d="M 296,3760 A 16,16 0,0,1 296,3776" class="nofill"></path>
    <line x1="272" y1="3776" x2="274" y2="3780" class="solid"></line>
    <path d="M 274,3780 A 8,8 0,0,0 280,3784" class="nofill"></path>
    <line x1="280" y1="3784" x2="288" y2="3784" class="solid"></line>
    <line x1="296" y1="3776" x2="294" y2="3780" class="solid"></line>
    <path d="M 294,3780 A 8,8 0,0,1 288,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="340" y1="3752" x2="396" y2="3752" class="solid"></line>
    <line x1="340" y1="3752" x2="340" y2="3784" class="solid"></line>
    <line x1="396" y1="3752" x2="396" y2="3784" class="solid"></line>
    <line x1="320" y1="3776" x2="340" y2="3776" class="solid"></line>
    <line x1="396" y1="3776" x2="408" y2="3776" class="solid"></line>
    <line x1="340" y1="3784" x2="396" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 424,3752 A 8,8 0,0,0 418,3756" class="nofill"></path>
    <line x1="418" y1="3756" x2="416" y2="3760" class="solid"></line>
    <line x1="424" y1="3752" x2="432" y2="3752" class="solid"></line>
    <path d="M 432,3752 A 8,8 0,0,1 438,3756" class="nofill"></path>
    <line x1="438" y1="3756" x2="440" y2="3760" class="solid"></line>
    <path d="M 416,3760 A 16,16 0,0,0 416,3776" class="nofill"></path>
    <path d="M 440,3760 A 16,16 0,0,1 440,3776" class="nofill"></path>
    <line x1="416" y1="3776" x2="418" y2="3780" class="solid"></line>
    <path d="M 418,3780 A 8,8 0,0,0 424,3784" class="nofill"></path>
    <line x1="424" y1="3784" x2="432" y2="3784" class="solid"></line>
    <line x1="440" y1="3776" x2="438" y2="3780" class="solid"></line>
    <path d="M 438,3780 A 8,8 0,0,1 432,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="468" y1="3752" x2="516" y2="3752" class="solid"></line>
    <line x1="468" y1="3752" x2="468" y2="3784" class="solid"></line>
    <line x1="516" y1="3752" x2="516" y2="3784" class="solid"></line>
    <line x1="448" y1="3776" x2="468" y2="3776" class="solid"></line>
    <line x1="516" y1="3776" x2="544" y2="3776" class="solid"></line>
    <line x1="468" y1="3784" x2="516" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 592,3752 A 8,8 0,0,0 586,3756" class="nofill"></path>
    <line x1="586" y1="3756" x2="584" y2="3760" class="solid"></line>
    <line x1="592" y1="3752" x2="600" y2="3752" class="solid"></line>
    <path d="M 600,3752 A 8,8 0,0,1 606,3756" class="nofill"></path>
    <line x1="606" y1="3756" x2="608" y2="3760" class="solid"></line>
    <path d="M 584,3760 A 16,16 0,0,0 584,3776" class="nofill"></path>
    <path d="M 608,3760 A 16,16 0,0,1 608,3776" class="nofill"></path>
    <line x1="584" y1="3776" x2="586" y2="3780" class="solid"></line>
    <path d="M 586,3780 A 8,8 0,0,0 592,3784" class="nofill"></path>
    <line x1="592" y1="3784" x2="600" y2="3784" class="solid"></line>
    <line x1="608" y1="3776" x2="606" y2="3780" class="solid"></line>
    <path d="M 606,3780 A 8,8 0,0,1 600,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="636" y1="3752" x2="692" y2="3752" class="solid"></line>
    <line x1="636" y1="3752" x2="636" y2="3784" class="solid"></line>
    <line x1="692" y1="3752" x2="692" y2="3784" class="solid"></line>
    <line x1="616" y1="3776" x2="636" y2="3776" class="solid"></line>
    <line x1="692" y1="3776" x2="744" y2="3776" class="solid"></line>
    <line x1="636" y1="3784" x2="692" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 64,3776 A 8,8 0,0,1 68,3784" class="nofill"></path>
    <line x1="68" y1="3784" x2="68" y2="3844" class="solid"></line>
    <path d="M 68,3844 A 4,4 0,0,0 72,3848" class="nofill"></path>
    <line x1="72" y1="3848" x2="712" y2="3848" class="solid"></line>
    <path d="M 720,3776 A 8,8 0,0,0 716,3784" class="nofill"></path>
    <line x1="716" y1="3784" x2="716" y2="3844" class="solid"></line>
    <path d="M 716,3844 A 4,4 0,0,1 712,3848" class="nofill"></path>
  </g>
  <g>
    <path d="M 328,3776 A 8,8 0,0,0 324,3784" class="nofill"></path>
    <line x1="324" y1="3784" x2="324" y2="3812" class="solid"></line>
    <path d="M 324,3812 A 4,4 0,0,0 328,3816" class="nofill"></path>
    <line x1="328" y1="3816" x2="424" y2="3816" class="solid"></line>
  </g>
  <g>
    <path d="M 536,3776 A 8,8 0,0,1 540,3784" class="nofill"></path>
    <line x1="540" y1="3784" x2="540" y2="3812" class="solid"></line>
    <line x1="520" y1="3816" x2="536" y2="3816" class="solid"></line>
    <path d="M 540,3812 A 4,4 0,0,1 536,3816" class="nofill"></path>
  </g>
  <g>
    <path d="M 496,3800 A 8,8 0,0,0 490,3804" class="nofill"></path>
    <line x1="490" y1="3804" x2="488" y2="3808" class="solid"></line>
    <line x1="496" y1="3800" x2="504" y2="3800" class="solid"></line>
    <path d="M 504,3800 A 8,8 0,0,1 510,3804" class="nofill"></path>
    <line x1="510" y1="3804" x2="512" y2="3808" class="solid"></line>
    <path d="M 488,3808 A 16,16 0,0,0 488,3824" class="nofill"></path>
    <path d="M 512,3808 A 16,16 0,0,1 512,3824" class="nofill"></path>
    <line x1="488" y1="3824" x2="490" y2="3828" class="solid"></line>
    <path d="M 490,3828 A 8,8 0,0,0 496,3832" class="nofill"></path>
    <line x1="496" y1="3832" x2="504" y2="3832" class="solid"></line>
    <line x1="512" y1="3824" x2="510" y2="3828" class="solid"></line>
    <path d="M 510,3828 A 8,8 0,0,1 504,3832" class="nofill"></path>
  </g>
  <g>
    <line x1="256" y1="3928" x2="284" y2="3928" class="solid"></line>
    <line x1="284" y1="3928" x2="284" y2="3936" class="solid"></line>
  </g>
  <g>
    <line x1="260" y1="3932" x2="260" y2="3992" class="solid"></line>
    <line x1="212" y1="3948" x2="212" y2="3992" class="solid"></line>
    <line x1="236" y1="3948" x2="236" y2="3992" class="solid"></line>
    <line x1="284" y1="3948" x2="284" y2="3992" class="solid"></line>
    <line x1="164" y1="3964" x2="164" y2="3992" class="solid"></line>
    <line x1="188" y1="3964" x2="188" y2="3992" class="solid"></line>
    <line x1="88" y1="3992" x2="284" y2="3992" class="solid"></line>
    <line x1="116" y1="3984" x2="116" y2="3992" class="solid"></line>
    <line x1="140" y1="3984" x2="140" y2="3992" class="solid"></line>
  </g>
  <g>
    <line x1="580" y1="3952" x2="580" y2="4000" class="solid"></line>
    <line x1="392" y1="3992" x2="580" y2="3992" class="solid"></line>
  </g>
  <g>
    <line x1="68" y1="4064" x2="68" y2="4248" class="solid"></line>
    <line x1="64" y1="4072" x2="68" y2="4072" class="solid"></line>
    <line x1="64" y1="4088" x2="68" y2="4088" class="solid"></line>
    <line x1="64" y1="4104" x2="68" y2="4104" class="solid"></line>
    <line x1="64" y1="4120" x2="68" y2="4120" class="solid"></line>
    <line x1="64" y1="4136" x2="68" y2="4136" class="solid"></line>
    <line x1="64" y1="4152" x2="68" y2="4152" class="solid"></line>
    <line x1="64" y1="4168" x2="68" y2="4168" class="solid"></line>
    <line x1="64" y1="4184" x2="68" y2="4184" class="solid"></line>
    <line x1="64" y1="4200" x2="68" y2="4200" class="solid"></line>
    <line x1="64" y1="4232" x2="68" y2="4232" class="solid"></line>
    <line x1="68" y1="4248" x2="584" y2="4248" class="solid"></line>
    <line x1="164" y1="4240" x2="164" y2="4248" class="solid"></line>
    <line x1="260" y1="4240" x2="260" y2="4248" class="solid"></line>
    <line x1="356" y1="4240" x2="356" y2="4248" class="solid"></line>
    <line x1="452" y1="4240" x2="452" y2="4248" class="solid"></line>
    <line x1="548" y1="4240" x2="548" y2="4248" class="solid"></line>
  </g>
  <g>
    <path d="M 392,4072 A 4,4 0,0,0 388,4076" class="nofill"></path>
    <line x1="388" y1="4076" x2="388" y2="4132" class="solid"></line>
    <path d="M 392,4072 A 4,4 0,0,1 396,4076" class="nofill"></path>
    <line x1="396" y1="4076" x2="396" y2="4132" class="solid"></line>
    <path d="M 396,4132 A 4,4 0,0,0 400,4136" class="nofill"></path>
    <line x1="400" y1="4136" x2="408" y2="4136" class="solid"></line>
    <path d="M 360,4120 A 4,4 0,0,0 356,4124" class="nofill"></path>
    <line x1="356" y1="4124" x2="356" y2="4164" class="solid"></line>
    <line x1="360" y1="4120" x2="368" y2="4120" class="solid"></line>
    <path d="M 368,4120 A 4,4 0,0,1 372,4124" class="nofill"></path>
    <line x1="372" y1="4124" x2="372" y2="4132" class="solid"></line>
    <path d="M 372,4132 A 4,4 0,0,0 376,4136" class="nofill"></path>
    <line x1="376" y1="4136" x2="384" y2="4136" class="solid"></line>
    <path d="M 388,4132 A 4,4 0,0,1 384,4136" class="nofill"></path>
    <path d="M 424,4104 A 4,4 0,0,0 420,4108" class="nofill"></path>
    <line x1="420" y1="4108" x2="420" y2="4116" class="solid"></line>
    <path d="M 424,4104 A 4,4 0,0,1 428,4108" class="nofill"></path>
    <line x1="428" y1="4108" x2="428" y2="4116" class="solid"></line>
    <path d="M 428,4116 A 4,4 0,0,0 432,4120" class="nofill"></path>
    <path d="M 432,4120 A 4,4 0,0,1 436,4124" class="nofill"></path>
    <line x1="436" y1="4124" x2="436" y2="4148" class="solid"></line>
    <path d="M 436,4148 A 4,4 0,0,0 440,4152" class="nofill"></path>
    <path d="M 448,4104 A 4,4 0,0,0 444,4108" class="nofill"></path>
    <line x1="444" y1="4108" x2="444" y2="4148" class="solid"></line>
    <path d="M 448,4104 A 4,4 0,0,1 452,4108" class="nofill"></path>
    <line x1="452" y1="4108" x2="452" y2="4116" class="solid"></line>
    <path d="M 452,4116 A 4,4 0,0,0 456,4120" class="nofill"></path>
    <line x1="456" y1="4120" x2="464" y2="4120" class="solid"></line>
    <path d="M 444,4148 A 4,4 0,0,1 440,4152" class="nofill"></path>
    <path d="M 472,4104 A 4,4 0,0,0 468,4108" class="nofill"></path>
    <line x1="468" y1="4108" x2="468" y2="4116" class="solid"></line>
    <path d="M 472,4104 A 4,4 0,0,1 476,4108" class="nofill"></path>
    <line x1="476" y1="4108" x2="476" y2="4116" class="solid"></line>
    <path d="M 468,4116 A 4,4 0,0,1 464,4120" class="nofill"></path>
    <path d="M 476,4116 A 4,4 0,0,0 480,4120" class="nofill"></path>
    <path d="M 480,4120 A 4,4 0,0,1 484,4124" class="nofill"></path>
    <line x1="484" y1="4124" x2="484" y2="4148" class="solid"></line>
    <path d="M 484,4148 A 4,4 0,0,0 488,4152" class="nofill"></path>
    <path d="M 416,4120 A 4,4 0,0,0 412,4124" class="nofill"></path>
    <line x1="412" y1="4124" x2="412" y2="4132" class="solid"></line>
    <path d="M 420,4116 A 4,4 0,0,1 416,4120" class="nofill"></path>
    <path d="M 412,4132 A 4,4 0,0,1 408,4136" class="nofill"></path>
    <path d="M 272,4120 A 4,4 0,0,0 268,4124" class="nofill"></path>
    <line x1="268" y1="4124" x2="268" y2="4164" class="solid"></line>
    <path d="M 272,4120 A 4,4 0,0,1 276,4124" class="nofill"></path>
    <line x1="276" y1="4124" x2="276" y2="4164" class="solid"></line>
    <path d="M 276,4164 A 4,4 0,0,0 280,4168" class="nofill"></path>
    <path d="M 256,4136 A 4,4 0,0,0 252,4140" class="nofill"></path>
    <line x1="252" y1="4140" x2="252" y2="4164" class="solid"></line>
    <path d="M 256,4136 A 4,4 0,0,1 260,4140" class="nofill"></path>
    <line x1="260" y1="4140" x2="260" y2="4164" class="solid"></line>
    <path d="M 260,4164 A 4,4 0,0,0 264,4168" class="nofill"></path>
    <path d="M 268,4164 A 4,4 0,0,1 264,4168" class="nofill"></path>
    <path d="M 288,4136 A 4,4 0,0,0 284,4140" class="nofill"></path>
    <line x1="284" y1="4140" x2="284" y2="4164" class="solid"></line>
    <path d="M 288,4136 A 4,4 0,0,1 292,4140" class="nofill"></path>
    <line x1="292" y1="4140" x2="292" y2="4148" class="solid"></line>
    <path d="M 292,4148 A 4,4 0,0,0 296,4152" class="nofill"></path>
    <path d="M 296,4152 A 4,4 0,0,1 300,4156" class="nofill"></path>
    <line x1="300" y1="4156" x2="300" y2="4164" class="solid"></line>
    <path d="M 284,4164 A 4,4 0,0,1 280,4168" class="nofill"></path>
    <path d="M 300,4164 A 4,4 0,0,0 304,4168" class="nofill"></path>
    <path d="M 312,4136 A 4,4 0,0,0 308,4140" class="nofill"></path>
    <line x1="308" y1="4140" x2="308" y2="4164" class="solid"></line>
    <path d="M 312,4136 A 4,4 0,0,1 316,4140" class="nofill"></path>
    <line x1="316" y1="4140" x2="316" y2="4148" class="solid"></line>
    <path d="M 316,4148 A 4,4 0,0,0 320,4152" class="nofill"></path>
    <path d="M 308,4164 A 4,4 0,0,1 304,4168" class="nofill"></path>
    <path d="M 328,4136 A 4,4 0,0,0 324,4140" class="nofill"></path>
    <line x1="324" y1="4140" x2="324" y2="4148" class="solid"></line>
    <path d="M 328,4136 A 4,4 0,0,1 332,4140" class="nofill"></path>
    <line x1="332" y1="4140" x2="332" y2="4164" class="solid"></line>
    <path d="M 324,4148 A 4,4 0,0,1 320,4152" class="nofill"></path>
    <path d="M 332,4164 A 4,4 0,0,0 336,4168" class="nofill"></path>
    <line x1="336" y1="4168" x2="352" y2="4168" class="solid"></line>
    <path d="M 356,4164 A 4,4 0,0,1 352,4168" class="nofill"></path>
    <path d="M 552,4088 A 4,4 0,0,0 548,4092" class="nofill"></path>
    <line x1="548" y1="4092" x2="548" y2="4100" class="solid"></line>
    <path d="M 552,4088 A 4,4 0,0,1 556,4092" class="nofill"></path>
    <line x1="556" y1="4092" x2="556" y2="4100" class="solid"></line>
    <path d="M 556,4100 A 4,4 0,0,0 560,4104" class="nofill"></path>
    <line x1="560" y1="4104" x2="568" y2="4104" class="solid"></line>
    <path d="M 568,4104 A 4,4 0,0,1 572,4108" class="nofill"></path>
    <line x1="572" y1="4108" x2="572" y2="4132" class="solid"></line>
    <path d="M 572,4132 A 4,4 0,0,0 576,4136" class="nofill"></path>
    <path d="M 584,4120 A 4,4 0,0,0 580,4124" class="nofill"></path>
    <line x1="580" y1="4124" x2="580" y2="4132" class="solid"></line>
    <path d="M 580,4132 A 4,4 0,0,1 576,4136" class="nofill"></path>
    <path d="M 512,4104 A 4,4 0,0,0 508,4108" class="nofill"></path>
    <line x1="508" y1="4108" x2="508" y2="4148" class="solid"></line>
    <path d="M 512,4104 A 4,4 0,0,1 516,4108" class="nofill"></path>
    <line x1="516" y1="4108" x2="516" y2="4116" class="solid"></line>
    <path d="M 516,4116 A 4,4 0,0,0 520,4120" class="nofill"></path>
    <line x1="520" y1="4120" x2="536" y2="4120" class="solid"></line>
    <path d="M 544,4104 A 4,4 0,0,0 540,4108" class="nofill"></path>
    <line x1="540" y1="4108" x2="540" y2="4116" class="solid"></line>
    <path d="M 548,4100 A 4,4 0,0,1 544,4104" class="nofill"></path>
    <path d="M 540,4116 A 4,4 0,0,1 536,4120" class="nofill"></path>
    <path d="M 496,4120 A 4,4 0,0,0 492,4124" class="nofill"></path>
    <line x1="492" y1="4124" x2="492" y2="4148" class="solid"></line>
    <path d="M 496,4120 A 4,4 0,0,1 500,4124" class="nofill"></path>
    <line x1="500" y1="4124" x2="500" y2="4148" class="solid"></line>
    <path d="M 492,4148 A 4,4 0,0,1 488,4152" class="nofill"></path>
    <path d="M 500,4148 A 4,4 0,0,0 504,4152" class="nofill"></path>
    <path d="M 508,4148 A 4,4 0,0,1 504,4152" class="nofill"></path>
    <path d="M 104,4136 A 4,4 0,0,0 100,4140" class="nofill"></path>
    <line x1="100" y1="4140" x2="100" y2="4196" class="solid"></line>
    <path d="M 104,4136 A 4,4 0,0,1 108,4140" class="nofill"></path>
    <line x1="108" y1="4140" x2="108" y2="4148" class="solid"></line>
    <path d="M 108,4148 A 4,4 0,0,0 112,4152" class="nofill"></path>
    <path d="M 112,4152 A 4,4 0,0,1 116,4156" class="nofill"></path>
    <line x1="116" y1="4156" x2="116" y2="4164" class="solid"></line>
    <path d="M 116,4164 A 4,4 0,0,0 120,4168" class="nofill"></path>
    <path d="M 120,4168 A 4,4 0,0,1 124,4172" class="nofill"></path>
    <line x1="124" y1="4172" x2="124" y2="4180" class="solid"></line>
    <path d="M 124,4180 A 4,4 0,0,0 128,4184" class="nofill"></path>
    <path d="M 136,4168 A 4,4 0,0,0 132,4172" class="nofill"></path>
    <line x1="132" y1="4172" x2="132" y2="4180" class="solid"></line>
    <path d="M 136,4168 A 4,4 0,0,1 140,4172" class="nofill"></path>
    <line x1="140" y1="4172" x2="140" y2="4180" class="solid"></line>
    <path d="M 132,4180 A 4,4 0,0,1 128,4184" class="nofill"></path>
    <path d="M 140,4180 A 4,4 0,0,0 144,4184" class="nofill"></path>
    <path d="M 144,4184 A 4,4 0,0,1 148,4188" class="nofill"></path>
    <line x1="148" y1="4188" x2="148" y2="4196" class="solid"></line>
    <path d="M 148,4196 A 4,4 0,0,0 152,4200" class="nofill"></path>
    <path d="M 176,4152 A 4,4 0,0,0 172,4156" class="nofill"></path>
    <line x1="172" y1="4156" x2="172" y2="4164" class="solid"></line>
    <line x1="176" y1="4152" x2="192" y2="4152" class="solid"></line>
    <path d="M 192,4152 A 4,4 0,0,1 196,4156" class="nofill"></path>
    <line x1="196" y1="4156" x2="196" y2="4164" class="solid"></line>
    <path d="M 196,4164 A 4,4 0,0,0 200,4168" class="nofill"></path>
    <line x1="200" y1="4168" x2="208" y2="4168" class="solid"></line>
    <path d="M 208,4168 A 4,4 0,0,1 212,4172" class="nofill"></path>
    <line x1="212" y1="4172" x2="212" y2="4196" class="solid"></line>
    <path d="M 212,4196 A 4,4 0,0,0 216,4200" class="nofill"></path>
    <path d="M 168,4168 A 4,4 0,0,0 164,4172" class="nofill"></path>
    <line x1="164" y1="4172" x2="164" y2="4180" class="solid"></line>
    <path d="M 172,4164 A 4,4 0,0,1 168,4168" class="nofill"></path>
    <path d="M 224,4168 A 4,4 0,0,0 220,4172" class="nofill"></path>
    <line x1="220" y1="4172" x2="220" y2="4196" class="solid"></line>
    <path d="M 224,4168 A 4,4 0,0,1 228,4172" class="nofill"></path>
    <line x1="228" y1="4172" x2="228" y2="4180" class="solid"></line>
    <path d="M 228,4180 A 4,4 0,0,0 232,4184" class="nofill"></path>
    <path d="M 220,4196 A 4,4 0,0,1 216,4200" class="nofill"></path>
    <path d="M 240,4168 A 4,4 0,0,0 236,4172" class="nofill"></path>
    <line x1="236" y1="4172" x2="236" y2="4180" class="solid"></line>
    <line x1="240" y1="4168" x2="248" y2="4168" class="solid"></line>
    <path d="M 252,4164 A 4,4 0,0,1 248,4168" class="nofill"></path>
    <path d="M 236,4180 A 4,4 0,0,1 232,4184" class="nofill"></path>
    <path d="M 160,4184 A 4,4 0,0,0 156,4188" class="nofill"></path>
    <line x1="156" y1="4188" x2="156" y2="4196" class="solid"></line>
    <path d="M 164,4180 A 4,4 0,0,1 160,4184" class="nofill"></path>
    <path d="M 156,4196 A 4,4 0,0,1 152,4200" class="nofill"></path>
    <path d="M 80,4168 A 4,4 0,0,0 76,4172" class="nofill"></path>
    <line x1="76" y1="4172" x2="76" y2="4212" class="solid"></line>
    <path d="M 80,4168 A 4,4 0,0,1 84,4172" class="nofill"></path>
    <line x1="84" y1="4172" x2="84" y2="4228" class="solid"></line>
    <path d="M 84,4228 A 4,4 0,0,0 88,4232" class="nofill"></path>
    <path d="M 96,4200 A 4,4 0,0,0 92,4204" class="nofill"></path>
    <line x1="92" y1="4204" x2="92" y2="4228" class="solid"></line>
    <path d="M 100,4196 A 4,4 0,0,1 96,4200" class="nofill"></path>
    <path d="M 92,4228 A 4,4 0,0,1 88,4232" class="nofill"></path>
    <line x1="64" y1="4216" x2="72" y2="4216" class="solid"></line>
    <path d="M 76,4212 A 4,4 0,0,1 72,4216" class="nofill"></path>
  </g>
  <g>
    <path d="M 184,4408 A 4,4 0,0,0 180,4412" class="nofill"></path>
    <line x1="180" y1="4412" x2="180" y2="4436" class="solid"></line>
    <line x1="184" y1="4408" x2="200" y2="4408" class="solid"></line>
    <path d="M 200,4408 A 4,4 0,0,1 204,4412" class="nofill"></path>
    <line x1="204" y1="4412" x2="204" y2="4528" class="solid"></line>
    <path d="M 80,4472 A 4,4 0,0,0 76,4476" class="nofill"></path>
    <line x1="76" y1="4476" x2="76" y2="4528" class="solid"></line>
    <line x1="80" y1="4472" x2="96" y2="4472" class="solid"></line>
    <line x1="148" y1="4504" x2="136" y2="4528" class="solid"></line>
    <line x1="148" y1="4504" x2="160" y2="4528" class="solid"></line>
    <line x1="76" y1="4528" x2="136" y2="4528" class="solid"></line>
    <line x1="160" y1="4528" x2="204" y2="4528" class="solid"></line>
    <line x1="136" y1="4528" x2="148" y2="4552" class="solid"></line>
    <line x1="160" y1="4528" x2="148" y2="4552" class="solid"></line>
    <line x1="148" y1="4552" x2="148" y2="4564" class="solid"></line>
    <path d="M 148,4564 A 4,4 0,0,0 152,4568" class="nofill"></path>
    <line x1="152" y1="4568" x2="168" y2="4568" class="solid"></line>
  </g>
  <g>
    <line x1="148" y1="4480" x2="148" y2="4500" class="solid"></line>
    <path d="M 148,4500 A 16,16 0,0,1 146,4508" class="nofill"></path>
    <path d="M 148,4500 A 16,16 0,0,0 150,4508" class="nofill"></path>
  </g>
  <g>
    <line x1="428" y1="4432" x2="428" y2="4564" class="solid"></line>
    <line x1="392" y1="4568" x2="424" y2="4568" class="solid"></line>
    <path d="M 428,4564 A 4,4 0,0,1 424,4568" class="nofill"></path>
  </g>
  <g>
    <line x1="192" y1="4560" x2="224" y2="4560" class="solid"></line>
    <line x1="192" y1="4560" x2="184" y2="4576" class="solid"></line>
    <line x1="184" y1="4576" x2="216" y2="4576" class="solid"></line>
    <line x1="224" y1="4560" x2="216" y2="4576" class="solid"></line>
  </g>
  <g>
    <line x1="84" y1="4784" x2="100" y2="4784" class="solid"></line>
    <line x1="84" y1="4784" x2="84" y2="4792" class="solid"></line>
    <line x1="84" y1="4792" x2="72" y2="4816" class="solid"></line>
    <line x1="100" y1="4784" x2="100" y2="4816" class="solid"></line>
    <line x1="84" y1="4800" x2="84" y2="4816" class="solid"></line>
    <line x1="84" y1="4816" x2="100" y2="4816" class="solid"></line>
  </g>
  <g>
    <text x="50" y="4812">‚†∂</text>
    <text x="58" y="4812">‚†∂</text>
  </g>
  <g>
    <path d="M 200,4760 A 8,8 0,0,0 194,4764" class="nofill"></path>
    <line x1="194" y1="4764" x2="192" y2="4768" class="solid"></line>
    <line x1="200" y1="4760" x2="208" y2="4760" class="solid"></line>
    <path d="M 192,4768 A 16,16 0,0,0 192,4784" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,4776 A 8,8 0,0,0 170,4780" class="nofill"></path>
    <line x1="170" y1="4780" x2="168" y2="4784" class="solid"></line>
    <line x1="176" y1="4776" x2="184" y2="4776" class="solid"></line>
    <path d="M 168,4784 A 16,16 0,0,0 168,4800" class="nofill"></path>
    <line x1="168" y1="4800" x2="170" y2="4804" class="solid"></line>
    <path d="M 170,4804 A 8,8 0,0,0 176,4808" class="nofill"></path>
    <line x1="176" y1="4808" x2="184" y2="4808" class="solid"></line>
  </g>
  <g>
    <line x1="256" y1="4760" x2="264" y2="4760" class="solid"></line>
    <path d="M 264,4760 A 8,8 0,0,1 270,4764" class="nofill"></path>
    <line x1="270" y1="4764" x2="272" y2="4768" class="solid"></line>
    <path d="M 272,4768 A 16,16 0,0,1 272,4784" class="nofill"></path>
  </g>
  <g>
    <line x1="280" y1="4776" x2="288" y2="4776" class="solid"></line>
    <path d="M 288,4776 A 8,8 0,0,1 294,4780" class="nofill"></path>
    <line x1="294" y1="4780" x2="296" y2="4784" class="solid"></line>
  </g>
  <g>
    <line x1="524" y1="4800" x2="564" y2="4800" class="solid"></line>
    <line x1="524" y1="4800" x2="524" y2="4832" class="solid"></line>
    <line x1="564" y1="4800" x2="564" y2="4832" class="solid"></line>
    <line x1="524" y1="4832" x2="564" y2="4832" class="solid"></line>
    <line x1="528" y1="4832" x2="520" y2="4848" class="solid"></line>
  </g>
  <g>
    <path d="M 272,4800 A 16,16 0,0,1 272,4816" class="nofill"></path>
    <line x1="272" y1="4816" x2="270" y2="4820" class="solid"></line>
    <line x1="256" y1="4824" x2="264" y2="4824" class="solid"></line>
    <path d="M 270,4820 A 8,8 0,0,1 264,4824" class="nofill"></path>
  </g>
  <g>
    <text x="426" y="4812">...¬∞</text>
    <text x="458" y="4812">]</text>
  </g>
  <g>
    <text x="530" y="4844">‚†∂</text>
    <text x="538" y="4844">‚†∂</text>
    <text x="546" y="4844">‚†∂</text>
  </g>
  <g>
    <line x1="320" y1="4888" x2="384" y2="4888" class="solid"></line>
    <path d="M 384,4888 A 3,3 0,0,1 386,4892" class="nofill"></path>
    <line x1="386" y1="4892" x2="374" y2="4916" class="solid"></line>
  </g>
  <g>
    <line x1="248" y1="4944" x2="320" y2="4944" class="solid"></line>
    <line x1="328" y1="4936" x2="320" y2="4944" class="solid"></line>
    <line x1="328" y1="4936" x2="476" y2="4936" class="solid"></line>
    <line x1="476" y1="4936" x2="464" y2="4960" class="solid"></line>
    <line x1="464" y1="4960" x2="476" y2="4984" class="solid"></line>
    <line x1="424" y1="4984" x2="476" y2="4984" class="solid"></line>
    <path d="M 168,4952 A 8,8 0,0,0 162,4956" class="nofill"></path>
    <line x1="162" y1="4956" x2="152" y2="4976" class="solid"></line>
    <line x1="168" y1="4952" x2="240" y2="4952" class="solid"></line>
    <line x1="248" y1="4944" x2="240" y2="4952" class="solid"></line>
    <path d="M 152,4976 A 16,16 0,0,0 152,4992" class="nofill"></path>
    <line x1="152" y1="4992" x2="162" y2="5012" class="solid"></line>
    <path d="M 162,5012 A 8,8 0,0,0 168,5016" class="nofill"></path>
    <line x1="168" y1="5016" x2="216" y2="5016" class="solid"></line>
    <line x1="216" y1="5016" x2="224" y2="5024" class="solid"></line>
    <line x1="224" y1="5024" x2="236" y2="5024" class="solid"></line>
    <line x1="236" y1="5024" x2="236" y2="5120" class="solid"></line>
    <line x1="200" y1="5120" x2="236" y2="5120" class="solid"></line>
    <line x1="200" y1="5120" x2="196" y2="5128" class="solid"></line>
    <line x1="196" y1="5128" x2="196" y2="5168" class="solid"></line>
    <path d="M 168,5160 A 4,4 0,0,0 164,5164" class="nofill"></path>
    <line x1="164" y1="5164" x2="164" y2="5184" class="solid"></line>
    <line x1="168" y1="5160" x2="196" y2="5160" class="solid"></line>
    <line x1="136" y1="5184" x2="164" y2="5184" class="solid"></line>
  </g>
  <g>
    <path d="M 184,4968 A 8,8 0,0,0 178,4972" class="nofill"></path>
    <line x1="178" y1="4972" x2="176" y2="4976" class="solid"></line>
    <line x1="184" y1="4968" x2="240" y2="4968" class="solid"></line>
    <line x1="240" y1="4968" x2="248" y2="4976" class="solid"></line>
    <line x1="248" y1="4976" x2="320" y2="4976" class="solid"></line>
    <path d="M 176,4976 A 16,16 0,0,0 176,4992" class="nofill"></path>
    <line x1="320" y1="4976" x2="328" y2="4984" class="solid"></line>
    <line x1="176" y1="4992" x2="178" y2="4996" class="solid"></line>
    <path d="M 178,4996 A 8,8 0,0,0 184,5000" class="nofill"></path>
    <line x1="184" y1="5000" x2="216" y2="5000" class="solid"></line>
    <line x1="224" y1="4992" x2="296" y2="4992" class="solid"></line>
    <line x1="224" y1="4992" x2="216" y2="5000" class="solid"></line>
    <line x1="296" y1="4992" x2="304" y2="5000" class="solid"></line>
    <line x1="304" y1="5000" x2="336" y2="5000" class="solid"></line>
  </g>
  <g>
    <line x1="244" y1="5024" x2="296" y2="5024" class="solid"></line>
    <line x1="304" y1="5016" x2="296" y2="5024" class="solid"></line>
    <line x1="304" y1="5016" x2="336" y2="5016" class="solid"></line>
    <line x1="244" y1="5024" x2="244" y2="5124" class="solid"></line>
    <path d="M 216,5128 A 4,4 0,0,0 212,5132" class="nofill"></path>
    <line x1="212" y1="5132" x2="212" y2="5168" class="solid"></line>
    <line x1="216" y1="5128" x2="240" y2="5128" class="solid"></line>
    <path d="M 244,5124 A 4,4 0,0,1 240,5128" class="nofill"></path>
    <line x1="212" y1="5160" x2="240" y2="5160" class="solid"></line>
    <path d="M 240,5160 A 4,4 0,0,1 244,5164" class="nofill"></path>
    <line x1="244" y1="5164" x2="244" y2="5220" class="solid"></line>
    <line x1="136" y1="5200" x2="164" y2="5200" class="solid"></line>
    <line x1="164" y1="5200" x2="164" y2="5220" class="solid"></line>
    <path d="M 164,5220 A 4,4 0,0,0 168,5224" class="nofill"></path>
    <line x1="180" y1="5184" x2="180" y2="5224" class="solid"></line>
    <line x1="196" y1="5184" x2="196" y2="5224" class="solid"></line>
    <line x1="212" y1="5184" x2="212" y2="5224" class="solid"></line>
    <line x1="228" y1="5184" x2="228" y2="5224" class="solid"></line>
    <line x1="168" y1="5224" x2="240" y2="5224" class="solid"></line>
    <path d="M 244,5220 A 4,4 0,0,1 240,5224" class="nofill"></path>
  </g>
  <g>
    <line x1="268" y1="5020" x2="268" y2="5108" class="solid"></line>
    <path d="M 268,5108 A 4,4 0,0,0 272,5112" class="nofill"></path>
    <line x1="272" y1="5112" x2="368" y2="5112" class="solid"></line>
    <path d="M 368,5112 A 4,4 0,0,1 372,5116" class="nofill"></path>
    <line x1="372" y1="5116" x2="372" y2="5172" class="solid"></line>
  </g>
  <g>
    <line x1="540" y1="5144" x2="620" y2="5144" class="solid"></line>
    <line x1="540" y1="5144" x2="540" y2="5172" class="solid"></line>
    <line x1="556" y1="5144" x2="556" y2="5224" class="solid"></line>
    <line x1="572" y1="5144" x2="572" y2="5224" class="solid"></line>
    <line x1="588" y1="5144" x2="588" y2="5224" class="solid"></line>
    <line x1="604" y1="5144" x2="604" y2="5224" class="solid"></line>
    <line x1="620" y1="5144" x2="620" y2="5224" class="solid"></line>
    <line x1="540" y1="5160" x2="620" y2="5160" class="solid"></line>
    <line x1="544" y1="5176" x2="620" y2="5176" class="solid"></line>
    <line x1="544" y1="5192" x2="620" y2="5192" class="solid"></line>
    <line x1="540" y1="5196" x2="540" y2="5224" class="solid"></line>
    <line x1="540" y1="5208" x2="620" y2="5208" class="solid"></line>
    <line x1="540" y1="5224" x2="620" y2="5224" class="solid"></line>
  </g>
  <g>
    <line x1="272" y1="5168" x2="288" y2="5168" class="solid"></line>
    <line x1="288" y1="5168" x2="296" y2="5176" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="5224" x2="348" y2="5272" class="solid"></line>
    <line x1="424" y1="5224" x2="444" y2="5224" class="solid"></line>
    <line x1="444" y1="5224" x2="444" y2="5272" class="solid"></line>
    <line x1="348" y1="5272" x2="444" y2="5272" class="solid"></line>
  </g>
  <g>
    <path d="M 64,5192 A 3,3 0,0,0 62,5196" class="nofill"></path>
    <line x1="62" y1="5196" x2="72" y2="5216" class="solid"></line>
    <line x1="64" y1="5192" x2="120" y2="5192" class="solid"></line>
  </g>
  <g>
    <path d="M 192,5432 A 8,8 0,0,0 186,5436" class="nofill"></path>
    <line x1="186" y1="5436" x2="184" y2="5440" class="solid"></line>
    <line x1="192" y1="5432" x2="224" y2="5432" class="solid"></line>
    <path d="M 224,5432 A 4,4 0,0,1 228,5436" class="nofill"></path>
    <line x1="228" y1="5436" x2="228" y2="5524" class="solid"></line>
    <path d="M 184,5440 A 16,16 0,0,0 184,5456" class="nofill"></path>
    <path d="M 192,5448 A 8,8 0,0,0 186,5452" class="nofill"></path>
    <line x1="186" y1="5452" x2="184" y2="5456" class="solid"></line>
    <line x1="192" y1="5448" x2="200" y2="5448" class="solid"></line>
    <path d="M 184,5456 A 16,16 0,0,0 184,5472" class="nofill"></path>
    <path d="M 208,5440 A 16,16 0,0,1 208,5456" class="nofill"></path>
    <line x1="208" y1="5456" x2="206" y2="5460" class="solid"></line>
    <path d="M 208,5456 A 16,16 0,0,1 208,5472" class="nofill"></path>
    <line x1="208" y1="5472" x2="206" y2="5476" class="solid"></line>
    <path d="M 208,5472 A 16,16 0,0,1 208,5488" class="nofill"></path>
    <line x1="208" y1="5488" x2="206" y2="5492" class="solid"></line>
    <path d="M 192,5464 A 8,8 0,0,0 186,5468" class="nofill"></path>
    <line x1="186" y1="5468" x2="184" y2="5472" class="solid"></line>
    <line x1="192" y1="5464" x2="200" y2="5464" class="solid"></line>
    <path d="M 206,5460 A 8,8 0,0,1 200,5464" class="nofill"></path>
    <path d="M 184,5472 A 16,16 0,0,0 184,5488" class="nofill"></path>
    <path d="M 192,5480 A 8,8 0,0,0 186,5484" class="nofill"></path>
    <line x1="186" y1="5484" x2="184" y2="5488" class="solid"></line>
    <line x1="192" y1="5480" x2="200" y2="5480" class="solid"></line>
    <path d="M 206,5476 A 8,8 0,0,1 200,5480" class="nofill"></path>
    <path d="M 180,5488 A 12,12 0,0,0 180,5504" class="nofill"></path>
    <path d="M 188,5496 A 8,8 0,0,0 180,5504" class="nofill"></path>
    <line x1="188" y1="5496" x2="200" y2="5496" class="solid"></line>
    <path d="M 206,5492 A 8,8 0,0,1 200,5496" class="nofill"></path>
    <line x1="180" y1="5504" x2="180" y2="5524" class="solid"></line>
    <line x1="260" y1="5504" x2="292" y2="5504" class="solid"></line>
    <line x1="260" y1="5504" x2="260" y2="5524" class="solid"></line>
    <line x1="260" y1="5520" x2="292" y2="5520" class="solid"></line>
    <line x1="292" y1="5504" x2="292" y2="5524" class="solid"></line>
    <path d="M 144,5528 A 4,4 0,0,0 140,5532" class="nofill"></path>
    <line x1="140" y1="5532" x2="140" y2="5540" class="solid"></line>
    <line x1="144" y1="5528" x2="176" y2="5528" class="solid"></line>
    <path d="M 180,5524 A 4,4 0,0,1 176,5528" class="nofill"></path>
    <path d="M 180,5524 A 4,4 0,0,0 184,5528" class="nofill"></path>
    <line x1="184" y1="5528" x2="224" y2="5528" class="solid"></line>
    <path d="M 228,5524 A 4,4 0,0,1 224,5528" class="nofill"></path>
    <path d="M 228,5524 A 4,4 0,0,0 232,5528" class="nofill"></path>
    <line x1="232" y1="5528" x2="256" y2="5528" class="solid"></line>
    <line x1="264" y1="5520" x2="256" y2="5528" class="solid"></line>
    <path d="M 260,5524 A 4,4 0,0,1 256,5528" class="nofill"></path>
    <path d="M 260,5524 A 4,4 0,0,0 264,5528" class="nofill"></path>
    <line x1="264" y1="5528" x2="288" y2="5528" class="solid"></line>
    <path d="M 292,5524 A 4,4 0,0,1 288,5528" class="nofill"></path>
    <path d="M 140,5540 A 4,4 0,0,0 144,5544" class="nofill"></path>
    <line x1="144" y1="5544" x2="296" y2="5544" class="solid"></line>
  </g>
  <g>
    <path d="M 360,5672 A 8,8 0,0,0 354,5676" class="nofill"></path>
    <line x1="360" y1="5672" x2="376" y2="5672" class="solid"></line>
  </g>
  <g>
    <path d="M 344,5704 A 8,8 0,0,0 338,5708" class="nofill"></path>
    <line x1="344" y1="5704" x2="376" y2="5704" class="solid"></line>
  </g>
  <g>
    <line x1="160" y1="5720" x2="216" y2="5720" class="solid"></line>
    <path d="M 216,5720 A 8,8 0,0,1 222,5724" class="nofill"></path>
  </g>
  <g>
    <path d="M 256,5832 A 8,8 0,0,0 250,5836" class="nofill"></path>
    <line x1="250" y1="5836" x2="248" y2="5840" class="solid"></line>
    <line x1="256" y1="5832" x2="280" y2="5832" class="solid"></line>
    <path d="M 280,5832 A 8,8 0,0,1 286,5836" class="nofill"></path>
    <line x1="286" y1="5836" x2="288" y2="5840" class="solid"></line>
    <path d="M 248,5840 A 16,16 0,0,0 248,5856" class="nofill"></path>
    <path d="M 288,5840 A 16,16 0,0,1 288,5856" class="nofill"></path>
    <line x1="248" y1="5856" x2="250" y2="5860" class="solid"></line>
    <path d="M 250,5860 A 8,8 0,0,0 256,5864" class="nofill"></path>
    <line x1="256" y1="5864" x2="280" y2="5864" class="solid"></line>
    <line x1="288" y1="5856" x2="286" y2="5860" class="solid"></line>
    <path d="M 286,5860 A 8,8 0,0,1 280,5864" class="nofill"></path>
  </g>
  <g>
    <line x1="304" y1="5832" x2="320" y2="5832" class="solid"></line>
    <line x1="320" y1="5832" x2="328" y2="5840" class="solid"></line>
    <line x1="328" y1="5840" x2="352" y2="5840" class="solid"></line>
    <line x1="352" y1="5840" x2="360" y2="5848" class="solid"></line>
  </g>
  <g>
    <line x1="304" y1="5872" x2="330" y2="5924" class="solid"></line>
    <path d="M 330,5924 A 8,8 0,0,0 336,5928" class="nofill"></path>
    <line x1="336" y1="5928" x2="384" y2="5928" class="solid"></line>
    <line x1="372" y1="5928" x2="386" y2="5956" class="solid"></line>
    <path d="M 386,5956 A 8,8 0,0,0 392,5960" class="nofill"></path>
    <line x1="392" y1="5960" x2="424" y2="5960" class="solid"></line>
  </g>
  <g>
    <line x1="248" y1="5888" x2="238" y2="5908" class="solid"></line>
    <path d="M 216,5912 A 8,8 0,0,0 210,5916" class="nofill"></path>
    <line x1="210" y1="5916" x2="196" y2="5944" class="solid"></line>
    <line x1="216" y1="5912" x2="232" y2="5912" class="solid"></line>
    <path d="M 238,5908 A 8,8 0,0,1 232,5912" class="nofill"></path>
    <line x1="196" y1="5944" x2="196" y2="5976" class="solid"></line>
    <line x1="196" y1="5976" x2="174" y2="6020" class="solid"></line>
  </g>
  <g>
    <line x1="280" y1="5888" x2="344" y2="6016" class="solid"></line>
    <line x1="344" y1="6016" x2="354" y2="6036" class="solid"></line>
    <path d="M 354,6036 A 8,8 0,0,0 360,6040" class="nofill"></path>
    <line x1="360" y1="6040" x2="376" y2="6040" class="solid"></line>
  </g>
  <g>
    <line x1="296" y1="5888" x2="346" y2="5988" class="solid"></line>
    <path d="M 346,5988 A 8,8 0,0,0 352,5992" class="nofill"></path>
    <line x1="352" y1="5992" x2="392" y2="5992" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="5984" x2="196" y2="6008" class="solid"></line>
    <line x1="196" y1="6008" x2="174" y2="6052" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="6016" x2="196" y2="6036" class="solid"></line>
    <path d="M 196,6036 A 16,16 0,0,1 194,6044" class="nofill"></path>
    <line x1="194" y1="6044" x2="174" y2="6084" class="solid"></line>
  </g>
  <g>
    <line x1="408" y1="5712" x2="418" y2="5732" class="solid"></line>
    <path d="M 418,5732 A 8,8 0,0,0 424,5736" class="nofill"></path>
    <line x1="424" y1="5736" x2="448" y2="5736" class="solid"></line>
  </g>
  <g>
    <line x1="424" y1="5744" x2="434" y2="5764" class="solid"></line>
    <path d="M 434,5764 A 8,8 0,0,0 440,5768" class="nofill"></path>
    <line x1="440" y1="5768" x2="456" y2="5768" class="solid"></line>
  </g>
  <g>
    <line x1="136" y1="5776" x2="170" y2="5844" class="solid"></line>
    <path d="M 170,5844 A 8,8 0,0,0 176,5848" class="nofill"></path>
    <line x1="176" y1="5848" x2="224" y2="5848" class="solid"></line>
  </g>
  <g>
    <line x1="464" y1="5824" x2="520" y2="5824" class="solid"></line>
    <line x1="464" y1="5824" x2="456" y2="5840" class="solid"></line>
    <line x1="520" y1="5824" x2="528" y2="5840" class="solid"></line>
  </g>
  <g>
    <line x1="456" y1="5856" x2="464" y2="5872" class="solid"></line>
    <line x1="464" y1="5872" x2="520" y2="5872" class="solid"></line>
    <line x1="528" y1="5856" x2="520" y2="5872" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="6208" x2="228" y2="6208" class="solid"></line>
    <line x1="184" y1="6216" x2="196" y2="6216" class="solid"></line>
    <line x1="196" y1="6208" x2="196" y2="6224" class="solid"></line>
    <line x1="196" y1="6224" x2="228" y2="6224" class="solid"></line>
    <line x1="228" y1="6208" x2="228" y2="6224" class="solid"></line>
  </g>
  <g>
    <line x1="132" y1="6220" x2="132" y2="6256" class="solid"></line>
    <line x1="120" y1="6256" x2="144" y2="6256" class="solid"></line>
  </g>
  <g>
    <line x1="180" y1="6220" x2="180" y2="6292" class="solid"></line>
    <path d="M 180,6292 A 4,4 0,0,0 184,6296" class="nofill"></path>
    <line x1="184" y1="6296" x2="200" y2="6296" class="solid"></line>
    <path d="M 200,6296 A 4,4 0,0,1 204,6300" class="nofill"></path>
    <line x1="204" y1="6300" x2="204" y2="6328" class="solid"></line>
    <line x1="244" y1="6220" x2="244" y2="6328" class="solid"></line>
    <line x1="268" y1="6220" x2="268" y2="6248" class="solid"></line>
    <path d="M 264,6248 A 4,4 0,0,0 260,6252" class="nofill"></path>
    <line x1="260" y1="6252" x2="260" y2="6292" class="solid"></line>
    <line x1="264" y1="6248" x2="272" y2="6248" class="solid"></line>
    <path d="M 272,6248 A 4,4 0,0,1 276,6252" class="nofill"></path>
    <line x1="276" y1="6252" x2="276" y2="6292" class="solid"></line>
    <path d="M 260,6292 A 4,4 0,0,0 264,6296" class="nofill"></path>
    <line x1="264" y1="6296" x2="272" y2="6296" class="solid"></line>
    <line x1="268" y1="6296" x2="268" y2="6328" class="solid"></line>
    <path d="M 276,6292 A 4,4 0,0,1 272,6296" class="nofill"></path>
    <path d="M 192,6328 A 4,4 0,0,0 188,6332" class="nofill"></path>
    <line x1="188" y1="6332" x2="188" y2="6580" class="solid"></line>
    <line x1="192" y1="6328" x2="288" y2="6328" class="solid"></line>
    <path d="M 288,6328 A 4,4 0,0,1 292,6332" class="nofill"></path>
    <line x1="292" y1="6332" x2="292" y2="6580" class="solid"></line>
    <line x1="292" y1="6568" x2="356" y2="6568" class="solid"></line>
    <line x1="356" y1="6560" x2="356" y2="6576" class="solid"></line>
    <path d="M 188,6580 A 4,4 0,0,0 192,6584" class="nofill"></path>
    <line x1="192" y1="6584" x2="288" y2="6584" class="solid"></line>
    <line x1="236" y1="6584" x2="236" y2="6644" class="solid"></line>
    <line x1="276" y1="6584" x2="276" y2="6612" class="solid"></line>
    <path d="M 292,6580 A 4,4 0,0,1 288,6584" class="nofill"></path>
    <path d="M 276,6612 A 4,4 0,0,0 280,6616" class="nofill"></path>
    <path d="M 128,6424 A 4,4 0,0,0 124,6428" class="nofill"></path>
    <line x1="124" y1="6428" x2="124" y2="6528" class="solid"></line>
    <line x1="128" y1="6424" x2="188" y2="6424" class="solid"></line>
    <line x1="96" y1="6528" x2="168" y2="6528" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="6220" x2="348" y2="6296" class="solid"></line>
    <path d="M 344,6296 A 4,4 0,0,0 340,6300" class="nofill"></path>
    <line x1="340" y1="6300" x2="340" y2="6340" class="solid"></line>
    <line x1="344" y1="6296" x2="352" y2="6296" class="solid"></line>
    <path d="M 352,6296 A 4,4 0,0,1 356,6300" class="nofill"></path>
    <line x1="356" y1="6300" x2="356" y2="6340" class="solid"></line>
    <path d="M 340,6340 A 4,4 0,0,0 344,6344" class="nofill"></path>
    <line x1="344" y1="6344" x2="352" y2="6344" class="solid"></line>
    <line x1="348" y1="6344" x2="348" y2="6372" class="solid"></line>
    <path d="M 356,6340 A 4,4 0,0,1 352,6344" class="nofill"></path>
  </g>
  <g>
    <line x1="388" y1="6220" x2="388" y2="6344" class="solid"></line>
    <line x1="388" y1="6344" x2="372" y2="6376" class="solid"></line>
    <line x1="372" y1="6352" x2="372" y2="6400" class="solid"></line>
    <line x1="352" y1="6376" x2="372" y2="6376" class="solid"></line>
  </g>
  <g>
    <line x1="392" y1="6216" x2="448" y2="6216" class="solid"></line>
    <path d="M 448,6216 A 4,4 0,0,1 452,6220" class="nofill"></path>
    <line x1="452" y1="6220" x2="452" y2="6288" class="solid"></line>
    <line x1="440" y1="6288" x2="464" y2="6288" class="solid"></line>
    <line x1="440" y1="6288" x2="452" y2="6312" class="solid"></line>
    <line x1="464" y1="6288" x2="452" y2="6312" class="solid"></line>
    <line x1="440" y1="6312" x2="464" y2="6312" class="solid"></line>
    <line x1="452" y1="6312" x2="452" y2="6424" class="solid"></line>
    <line x1="436" y1="6416" x2="436" y2="6464" class="solid"></line>
    <line x1="436" y1="6424" x2="452" y2="6424" class="solid"></line>
    <line x1="436" y1="6440" x2="448" y2="6440" class="solid"></line>
    <line x1="436" y1="6456" x2="452" y2="6456" class="solid"></line>
  </g>
  <g>
    <line x1="128" y1="6264" x2="140" y2="6264" class="solid"></line>
    <path d="M 140,6264 A 8,8 0,0,1 148,6272" class="nofill"></path>
  </g>
  <g>
    <line x1="132" y1="6316" x2="132" y2="6336" class="solid"></line>
    <line x1="104" y1="6336" x2="160" y2="6336" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="6380" x2="348" y2="6408" class="solid"></line>
    <path d="M 344,6408 A 4,4 0,0,0 340,6412" class="nofill"></path>
    <line x1="340" y1="6412" x2="340" y2="6452" class="solid"></line>
    <line x1="344" y1="6408" x2="352" y2="6408" class="solid"></line>
    <path d="M 352,6408 A 4,4 0,0,1 356,6412" class="nofill"></path>
    <line x1="356" y1="6412" x2="356" y2="6452" class="solid"></line>
    <path d="M 340,6452 A 4,4 0,0,0 344,6456" class="nofill"></path>
    <line x1="344" y1="6456" x2="352" y2="6456" class="solid"></line>
    <line x1="348" y1="6456" x2="348" y2="6484" class="solid"></line>
    <path d="M 356,6452 A 4,4 0,0,1 352,6456" class="nofill"></path>
    <path d="M 348,6484 A 4,4 0,0,0 352,6488" class="nofill"></path>
    <line x1="352" y1="6488" x2="384" y2="6488" class="solid"></line>
    <line x1="388" y1="6428" x2="388" y2="6484" class="solid"></line>
    <path d="M 388,6484 A 4,4 0,0,1 384,6488" class="nofill"></path>
  </g>
  <g>
    <line x1="392" y1="6424" x2="428" y2="6424" class="solid"></line>
    <line x1="428" y1="6416" x2="428" y2="6464" class="solid"></line>
  </g>
  <g>
    <line x1="456" y1="6488" x2="476" y2="6488" class="solid"></line>
    <line x1="476" y1="6480" x2="476" y2="6496" class="solid"></line>
  </g>
  <g>
    <line x1="124" y1="6544" x2="124" y2="6644" class="solid"></line>
    <path d="M 124,6644 A 4,4 0,0,0 128,6648" class="nofill"></path>
  </g>
  <g>
    <line x1="364" y1="6560" x2="364" y2="6576" class="solid"></line>
    <line x1="364" y1="6568" x2="384" y2="6568" class="solid"></line>
    <path d="M 384,6568 A 4,4 0,0,1 388,6572" class="nofill"></path>
    <line x1="388" y1="6572" x2="388" y2="6612" class="solid"></line>
  </g>
  <g>
    <line x1="500" y1="6620" x2="500" y2="6644" class="solid"></line>
    <line x1="452" y1="6640" x2="484" y2="6640" class="solid"></line>
    <line x1="432" y1="6648" x2="452" y2="6648" class="solid"></line>
    <line x1="452" y1="6640" x2="452" y2="6656" class="solid"></line>
    <line x1="452" y1="6656" x2="484" y2="6656" class="solid"></line>
    <line x1="484" y1="6640" x2="484" y2="6656" class="solid"></line>
    <line x1="484" y1="6648" x2="496" y2="6648" class="solid"></line>
    <path d="M 500,6644 A 4,4 0,0,1 496,6648" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="6648" x2="292" y2="6648" class="solid"></line>
    <line x1="296" y1="6640" x2="288" y2="6656" class="solid"></line>
    <line x1="296" y1="6640" x2="304" y2="6656" class="solid"></line>
    <line x1="312" y1="6640" x2="304" y2="6656" class="solid"></line>
    <line x1="312" y1="6640" x2="320" y2="6656" class="solid"></line>
    <line x1="328" y1="6640" x2="320" y2="6656" class="solid"></line>
  </g>
  <g>
    <line x1="428" y1="6652" x2="428" y2="6680" class="solid"></line>
    <path d="M 424,6680 A 4,4 0,0,0 420,6684" class="nofill"></path>
    <line x1="420" y1="6684" x2="420" y2="6724" class="solid"></line>
    <line x1="424" y1="6680" x2="432" y2="6680" class="solid"></line>
    <path d="M 432,6680 A 4,4 0,0,1 436,6684" class="nofill"></path>
    <line x1="436" y1="6684" x2="436" y2="6724" class="solid"></line>
    <path d="M 420,6724 A 4,4 0,0,0 424,6728" class="nofill"></path>
    <line x1="424" y1="6728" x2="432" y2="6728" class="solid"></line>
    <line x1="428" y1="6728" x2="428" y2="6752" class="solid"></line>
    <path d="M 436,6724 A 4,4 0,0,1 432,6728" class="nofill"></path>
  </g>
  <g>
    <line x1="80" y1="6944" x2="136" y2="6944" class="solid"></line>
    <line x1="80" y1="6944" x2="64" y2="6976" class="solid"></line>
    <line x1="136" y1="6944" x2="152" y2="6976" class="solid"></line>
    <line x1="64" y1="6976" x2="80" y2="7008" class="solid"></line>
    <line x1="152" y1="6976" x2="136" y2="7008" class="solid"></line>
    <line x1="80" y1="7008" x2="136" y2="7008" class="solid"></line>
  </g>
  <g>
    <path d="M 256,6888 A 8,8 0,0,0 250,6892" class="nofill"></path>
    <line x1="250" y1="6892" x2="248" y2="6896" class="solid"></line>
    <line x1="256" y1="6888" x2="304" y2="6888" class="solid"></line>
    <path d="M 304,6888 A 8,8 0,0,1 310,6892" class="nofill"></path>
    <line x1="310" y1="6892" x2="312" y2="6896" class="solid"></line>
    <path d="M 248,6896 A 16,16 0,0,0 248,6912" class="nofill"></path>
    <path d="M 312,6896 A 16,16 0,0,1 312,6912" class="nofill"></path>
    <line x1="248" y1="6912" x2="250" y2="6916" class="solid"></line>
    <path d="M 250,6916 A 8,8 0,0,0 256,6920" class="nofill"></path>
    <line x1="256" y1="6920" x2="304" y2="6920" class="solid"></line>
    <line x1="312" y1="6912" x2="310" y2="6916" class="solid"></line>
    <path d="M 310,6916 A 8,8 0,0,1 304,6920" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="6944" x2="296" y2="6944" class="solid"></line>
    <line x1="232" y1="6944" x2="240" y2="6960" class="solid"></line>
    <line x1="296" y1="6944" x2="304" y2="6960" class="solid"></line>
    <path d="M 240,6960 A 16,16 0,0,1 240,6976" class="nofill"></path>
    <path d="M 304,6960 A 16,16 0,0,1 304,6976" class="nofill"></path>
    <line x1="240" y1="6976" x2="232" y2="6992" class="solid"></line>
    <line x1="232" y1="6992" x2="296" y2="6992" class="solid"></line>
    <line x1="304" y1="6976" x2="296" y2="6992" class="solid"></line>
  </g>
  <g>
    <line x1="200" y1="6944" x2="184" y2="6976" class="solid"></line>
    <line x1="200" y1="6944" x2="216" y2="6976" class="solid"></line>
    <line x1="184" y1="6976" x2="200" y2="7008" class="solid"></line>
    <line x1="216" y1="6976" x2="200" y2="7008" class="solid"></line>
  </g>
  <g>
    <path d="M 216,7208 A 3,3 0,0,0 214,7212" class="nofill"></path>
    <line x1="214" y1="7212" x2="236" y2="7256" class="solid"></line>
    <line x1="216" y1="7208" x2="256" y2="7208" class="solid"></line>
    <path d="M 256,7208 A 3,3 0,0,1 258,7212" class="nofill"></path>
    <line x1="258" y1="7212" x2="236" y2="7256" class="solid"></line>
  </g>
  <g>
    <path d="M 280,7208 A 3,3 0,0,0 278,7212" class="nofill"></path>
    <line x1="278" y1="7212" x2="298" y2="7252" class="solid"></line>
    <line x1="280" y1="7208" x2="312" y2="7208" class="solid"></line>
    <path d="M 312,7208 A 8,8 0,0,1 318,7212" class="nofill"></path>
    <line x1="318" y1="7212" x2="338" y2="7252" class="solid"></line>
    <path d="M 298,7252 A 8,8 0,0,0 304,7256" class="nofill"></path>
    <line x1="304" y1="7256" x2="336" y2="7256" class="solid"></line>
    <path d="M 338,7252 A 3,3 0,0,1 336,7256" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,7368 A 8,8 0,0,0 18,7372" class="nofill"></path>
    <line x1="18" y1="7372" x2="6" y2="7396" class="solid"></line>
    <line x1="24" y1="7368" x2="128" y2="7368" class="solid"></line>
    <path d="M 128,7368 A 3,3 0,0,1 130,7372" class="nofill"></path>
    <line x1="130" y1="7372" x2="118" y2="7396" class="solid"></line>
    <path d="M 6,7396 A 3,3 0,0,0 8,7400" class="nofill"></path>
    <line x1="8" y1="7400" x2="112" y2="7400" class="solid"></line>
    <path d="M 118,7396 A 8,8 0,0,1 112,7400" class="nofill"></path>
  </g>
</svg>
</p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Svgbob},
  date = {2024-11-15},
  url = {https://samforeman.me/posts/svgbob},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúSvgbob.‚Äù</span> November 15, 2024. <a href="https://samforeman.me/posts/svgbob">https://samforeman.me/posts/svgbob</a>.
</div></div></section></div> ]]></description>
  <category>diagrams</category>
  <category>style</category>
  <guid>https://samforeman.me/posts/svgbob/</guid>
  <pubDate>Fri, 15 Nov 2024 06:00:00 GMT</pubDate>
</item>
<item>
  <title>Parallel Training Methods</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/ai-for-science-2024/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="overview" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="overview">üëÄ Overview</h2>
<ul>
<li>üìä Slides @ <a href="https://samforeman.me/talks/ai-for-science-2024/slides">samforeman.me/talks/ai-for-science-2024/slides</a>
<ul>
<li>üìÑ HTML version: <a href="https://samforeman.me/talks/ai-for-science-2024">samforeman.me/talks/ai-for-science-2024</a></li>
</ul></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/ai-science-training-series">argonne-lcf/<code>ai-science-training-series</code></a>
<ul>
<li><a href="https://www.alcf.anl.gov/alcf-ai-science-training-series">Series Page</a></li>
</ul></li>
</ul>
</section>
<section id="outline" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="outline">üìë Outline</h2>
<ol type="1">
<li>Scaling: Overview</li>
<li>Data Parallel Training
<ol type="1">
<li>Communication</li>
<li>Why Distributed Training?</li>
</ol></li>
<li>Beyond Data Parallelism
<ol type="1">
<li>Additional Parallelism Strategies</li>
</ol></li>
<li>Large Language Models</li>
<li>Hands On</li>
</ol>
</section>
<section id="scaling-overview" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="scaling-overview">üöÄ Scaling: Overview</h2>
<ul>
<li>‚úÖ <strong>Goal</strong>:
<ul>
<li>Minimize: <span class="highlight-red">Cost</span> (i.e.&nbsp;amount of time spent training)</li>
<li>Maximize: <span class="highlight-blue">Performance</span></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üìë Note">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üìë Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>See <a href="https://huggingface.co/docs/transformers/v4.46.0/performance">ü§ó Performance and Scalability</a> for more details</p>
</div>
</div>
</div></li>
</ul>
</section>
<section id="training-on-a-single-device" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="training-on-a-single-device">üê¢ Training on a Single Device</h2>
<ul>
<li>See <a href="https://huggingface.co/docs/transformers/v4.46.0/perf_train_gpu_one">ü§ó Methods and tools for efficient training on a single GPU</a></li>
</ul>
<div id="fig-single-gpu-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-gpu-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph G0["`GPU0`"]
        subgraph N0["`Network`"]
        end
        L0("`Loss`")
    end
    subgraph D["`Data`"]
        x("`x0`")
        x1("`x1`")
        x2("`x2`")
    end
    x --&gt; N0
    N0 --&gt; L0
    L0 --&gt; N0
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
class x,L0 red
class x1, green
class x2, blue
class x3, grey
class N0,D,G0,n0 block
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-gpu-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <strong>SLOW</strong> !! model size limited by GPU memory
</figcaption>
</figure>
</div>
</section>
<section id="single-gpu" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="single-gpu">Single GPU</h2>
<ul>
<li>See <a href="https://huggingface.co/docs/transformers/v4.46.0/perf_train_gpu_one">ü§ó Methods and tools for efficient training on a single GPU</a></li>
</ul>
<div id="fig-single-gpu-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-gpu-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph G0["`GPU0`"]
        subgraph N0["`Network`"]
        end
        L0("`Loss`")
    end
    subgraph D["`Data`"]
        x("`x0`")
        x1("`x1`")
        x2("`x2`")
    end
    x --&gt; N0
    N0 --&gt; L0
    L0 --&gt; N0
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,L0 green
class x1, blue
class x2, yellow
class x3, grey
class N0,D,G0,n0 block
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-gpu-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: <strong>SLOW</strong> !! model size limited by GPU memory
</figcaption>
</figure>
</div>
</section>
<section id="single-gpu-1" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="single-gpu-1">Single GPU</h2>
<ul>
<li>See <a href="https://huggingface.co/docs/transformers/v4.46.0/perf_train_gpu_one">ü§ó Methods and tools for efficient training on a single GPU</a></li>
</ul>
<div id="fig-single-gpu-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-gpu-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph G0["`GPU0`"]
        subgraph N0["`Network`"]
        end
        L0("`Loss`")
    end
    subgraph D["`Data`"]
        x("`x‚ÇÇ`")
        x1("`x‚ÇÉ`")
        x2("`x‚ÇÑ`")
    end
    x --&gt; N0
    N0 --&gt; L0
    L0 --&gt; N0
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,L0 blue
class x1, yellow
class x2, purple
class x3, grey
class N0,D,G0,n0 block
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-gpu-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <strong>SLOW</strong> !! model size limited by GPU memory
</figcaption>
</figure>
</div>
</section>
<section id="training-on-multiple-gpus-data-parallelism" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="training-on-multiple-gpus-data-parallelism">üèéÔ∏è Training on Multiple GPUs: Data Parallelism</h2>
<div id="fig-ddp-training-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ddp-training-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph D["`Data`"]
        direction TB
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    direction LR
    subgraph G0["`GPU0`"]
        direction LR
        subgraph N0["`NN`"]
        end
        %%y0("`y‚ÇÄ`")
        L0["`Loss`"]
    end
    subgraph G1["`GPU1`"]
        direction LR
        subgraph N1["`NN`"]
        end
        L1["`Loss`"]
    end
    subgraph G2["`GPU2`"]
        direction LR
        subgraph N2["`NN`"]
        end
        L2["`Loss`"]
    end
    x --&gt; G0
    x1 --&gt; G1
    x2 --&gt; G2
    N0 --&gt; L0
    N1 --&gt; L1
    N2 --&gt; L2
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class AR block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ddp-training-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Each GPU receives <strong>unique</strong> data at each step
</figcaption>
</figure>
</div>
<section id="data-parallel-forward-pass" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="data-parallel-forward-pass">Data Parallel: Forward Pass</h3>
<div id="fig-ddp-training-mermaid-allreduce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ddp-training-mermaid-allreduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph D["`Data`"]
        direction TB
        %%xp("`x‚Çô‚Çä‚ÇÅ`")
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    direction LR
    subgraph G0["`GPU0`"]
        direction LR
        subgraph N0["`NN`"]
        end
        %%y0("`y‚ÇÄ`")
        L0["`Loss`"]
    end
    subgraph G1["`GPU1`"]
        direction LR
        subgraph N1["`NN`"]
        end
        L1["`Loss`"]
    end
    subgraph G2["`GPU2`"]
        direction LR
        subgraph N2["`NN`"]
        end
        L2["`Loss`"]
    end
    %% subgraph AR["`Average Grads`"]
    %%     direction TB
    %%     ar("`(‚àë‚Çôg‚Çô)/n`")
    %% end
    ar("`Avg. Grads&lt;br&gt;(‚àë‚Çôg‚Çô)/N`")
    x --&gt; G0
    x1 --&gt; G1
    x2 --&gt; G2
    N0 --&gt; L0
    N1 --&gt; L1
    N2 --&gt; L2
    G0 -.-&gt; ar
    G1 -.-&gt; ar
    G2 -.-&gt; ar
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class AR block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ddp-training-mermaid-allreduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Average gradients across all GPUs
</figcaption>
</figure>
</div>
</section>
<section id="data-parallel-backward-pass" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="data-parallel-backward-pass">Data Parallel: Backward Pass</h3>
<div id="fig-ddp-backward-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ddp-backward-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart RL
    subgraph D["`Data`"]
        direction TB
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    subgraph G0["`GPU0`"]
        direction RL
        subgraph N0["`NN`"]
        end
        L0["`Loss`"]
    end
    subgraph G1["`GPU1`"]
        direction RL
        subgraph N1["`NN`"]
        end
        L1["`Loss`"]
    end
    subgraph G2["`GPU2`"]
        direction RL
        subgraph N2["`NN`"]
        end
        L2["`Loss`"]
    end
    subgraph BC["`Send Updates`"]
        direction TB
    end
    BC -.-&gt; G0
    BC -.-&gt; G1
    BC -.-&gt; G2
    L0 ~~~ N0
    L1 ~~~ N1
    L2 ~~~ N2
    G0 ~~~ x
    G1 ~~~ x1
    G2 ~~~ x2
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class BC block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ddp-backward-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Send global updates back to each GPU
</figcaption>
</figure>
</div>
</section>
<section id="data-parallel-full-setup" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="data-parallel-full-setup">Data Parallel: Full Setup</h3>
<div id="fig-ddp-training" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ddp-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph D["`Data`"]
        direction TB
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    direction LR
    subgraph G0["`GPU0`"]
        direction LR
        subgraph N0["`NN`"]
        end
        L0["`L0`"]
    end
    subgraph G1["`GPU1`"]
        direction LR
        subgraph N1["`NN`"]
        end
        L1["`L1`"]
    end
    subgraph G2["`GPU2`"]
        direction LR
        subgraph N2["`NN`"]
        end
        L2["`L2`"]
    end
    subgraph AR["`Average Grads`"]
        direction LR
        ar("`(1/N) ‚àë g‚Çô`")
        bc("`Update Weights`")
        ar --&gt; bc
    end
    x --&gt; G0
    x1 --&gt; G1
    x2 --&gt; G2
    N0 --&gt; L0
    N1 --&gt; L1
    N2 --&gt; L2
    G0 &lt;-.-&gt; AR
    G1 &lt;-.-&gt; AR
    G2 &lt;-.-&gt; AR
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class AR block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ddp-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: See: <a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html">PyTorch / Distributed Data Parallel</a>
</figcaption>
</figure>
</div>
</section>
<section id="data-parallel-training" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="data-parallel-training">Data Parallel: Training</h3>
<ul>
<li>Each GPU:
<ul>
<li>has <strong>identical copy</strong> of model</li>
<li>works on a <strong>unique</strong> subset of data</li>
</ul></li>
<li>Easy to get started (minor modifications to code):
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2/<code>ezpz</code></a></li>
<li>üî• <a href="https://pytorch.org/docs/stable/notes/ddp.html">PyTorch / <code>DDP</code></a></li>
<li>ü§ó <a href="https://huggingface.co/docs/transformers/accelerate">HF / <code>Accelerate</code></a></li>
<li><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="https://www.deepspeed.ai/">Microsoft / <code>DeepSpeed</code></a></li>
</ul></li>
<li>Requires <strong>global</strong> communication
<ul>
<li>every rank <em>must participate</em> (collective communication) !!</li>
</ul></li>
</ul>
</section>
</section>
<section id="communication" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="communication">üó£Ô∏è Communication</h2>
<ul>
<li>Need mechanism(s) for communicating across GPUs:
<ul>
<li><a href="https://mpi4py.readthedocs.io/en/stable/tutorial.html"><code>mpi4py</code></a></li>
<li><a href="https://pytorch.org/docs/stable/distributed.html"><code>torch.distributed</code></a></li>
</ul></li>
<li>Collective Communication:
<ul>
<li><a href="https://developer.nvidia.com/nccl">Nvidia Collective Communications Library (NCCL)</a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/oneccl.html#gs.gouznn">Intel oneAPI Collective Communications Library (oneCCL)</a></li>
</ul>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="‚åõ Timeouts">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚åõ Timeouts
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Collective operations have to be called for each <code>rank</code> to form a complete collective operation.
<ul>
<li>Failure to do so will result in other ranks waiting <strong>indefinitely</strong></li>
</ul></li>
</ul>
</div>
</div>
</div></li>
</ul>
<section id="allreduce" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="allreduce">AllReduce</h3>
<p>Perform <em>reductions</em> on data (e.g.&nbsp;<code>sum</code>, <code>min</code>, <code>max</code>) across ranks, send result back to everyone.</p>
<div id="fig-all-reduce-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-all-reduce-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  subgraph R0["`0`"]
    x0("`x0`")
  end
  subgraph R1["`1`"]
    x1("`x1`")
  end
  subgraph R2["`2`"]
    x2("`x2`")
  end
  subgraph R3["`3`"]
    x3("`x3`")
  end
  subgraph AR["`Allreduce`"]
    xp["`x' = ‚àë x‚Çô `"]
  end
  subgraph AR3["`3`"]
    xp3("`x'`")
  end
  subgraph AR2["`2`"]
    xp2("`x'`")
  end
  subgraph AR1["`1`"]
    xp1("`x'`")
  end
  subgraph AR0["`0`"]
    xp0("`x'`")
  end
  x0 --&gt; AR
  x1 --&gt; AR
  x2 --&gt; AR
  x3 --&gt; AR
  AR --&gt; xp0
  AR --&gt; xp1
  AR --&gt; xp2
  AR --&gt; xp3
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef pink fill:#E599F7,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
class R0,R1,R2,R3,AR,AR0,AR1,AR2,AR3 block
class xp,xp0,xp1,xp2,xp3, purple
class x0, red
class x1, green
class x2, blue
class x3, yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-all-reduce-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: All-Reduce operation: each rank receives the reduction of input values across ranks.
</figcaption>
</figure>
</div>
</section>
<section id="reduce" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="reduce">Reduce</h3>
<ul>
<li>Perform a <em>reduction</em> on data across ranks, send to individual</li>
</ul>
<div id="fig-reduce-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reduce-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  subgraph R0["`0`"]
    x0("`x0`")
  end
  subgraph R1["`1`"]
    x1("`x1`")
  end
  subgraph R2["`2`"]
    x2("`x2`")
  end
  subgraph R3["`3`"]
    x3("`x3`")
  end
  subgraph AR["`Reduce`"]
    xp["`x'=reduce(x, 2, SUM)`"]
  end
  subgraph AR3["`3`"]
  end
  subgraph AR2["`2`"]
    xp2("`x'`")
  end
  subgraph AR1["`1`"]
  end
  subgraph AR0["`0`"]
  end
  x0 --&gt; AR
  x1 --&gt; AR
  x2 --&gt; AR
  x3 --&gt; AR
  AR --&gt; AR3
  AR --&gt; xp2
  AR --&gt; AR1
  AR --&gt; AR0
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef pink fill:#E599F7,stroke:#333,stroke-width:1px,color:#000
class R0,R1,R2,R3,AR,AR0,AR1,AR2,AR3, block
class xp,xp2 purple
class x0, red
class x1, green
class x2, blue
class x3, yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reduce-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Reduce operation: one rank receives the reduction of input values across ranks
</figcaption>
</figure>
</div>
</section>
<section id="broadcast" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="broadcast">Broadcast</h3>
<div id="fig-broadcast-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-broadcast-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  subgraph R3["`3`"]
  end
  subgraph R2["`2`"]
    x2("`x2`")
  end
  subgraph R1["`1`"]
  end
  subgraph R0["`0`"]
  end
  subgraph AR["` `"]
    xp["`broadcast(x2, 2)`"]
  end
  subgraph AR0["`0`"]
    xp0("`x2`")
  end
  subgraph AR1["`1`"]
    xp1("`x2`")
  end
  subgraph AR2["`2`"]
    xp2("`x2`")
  end
  subgraph AR3["`3`"]
    xp3("`x2`")
  end
  x2 --&gt; AR
  AR --&gt; AR0
  AR --&gt; AR1
  AR --&gt; AR2
  AR --&gt; AR3
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383,font-weight:500
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,font-weight:500,color:#838383
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
class R0,R1,R2,R3,AR0,AR1,AR2,AR3,AR, block
class x2,xp0,xp1,xp2,xp3 blue
class xp, text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-broadcast-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: <code>broadcast</code> (send) a tensor <code><img src="https://latex.codecogs.com/png.latex?x"></code> from one rank to all ranks
</figcaption>
</figure>
</div>
</section>
<section id="allgather" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="allgather">AllGather</h3>
<div id="fig-allgather-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-allgather-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  subgraph R0["`0`"]
    x0("`x0`")
  end
  subgraph R1["`1`"]
    x1("`x1`")
  end
  subgraph R2["`2`"]
    x2("`x2`")
  end
  subgraph AG["`Allgather`"]
    %%xp0["`z=[empty_like(x) for _ in range(4)]`"]
    %%xp1["`dist.all_gather(z, x)`"]
  end
  subgraph AG2["`2`"]
    direction TB
    xp02("`x0`")
    xp12("`x1`")
    xp22("`x2`")
  end
  subgraph AG1["`1`"]
    direction TB
    xp01("`x0`")
    xp11("`x1`")
    xp21("`x2`")
  end
  subgraph AG0["`0`"]
    direction TB
    xp00("`x0`")
    xp10("`x1`")
    xp20("`x2`")
  end
  x0 --&gt; AG
  x1 --&gt; AG
  x2 --&gt; AG
  AG --&gt; AG0
  AG --&gt; AG1
  AG --&gt; AG2
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,font-weight:500,color:#838383
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class xp0,xp1, text
class AG0,AG1,AG2,AG3,AG,R0,R1,R2,R3, block
class xp00,xp01,xp02,xp03, red
class xp10,xp11,xp12,xp13, green
class xp20,xp21,xp22,xp23, blue
class xp30,xp31,xp32,xp33, yellow
class x0, red
class x1, green
class x2, blue
class x3, yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-allgather-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Gathers tensors from the whole group in a list.
</figcaption>
</figure>
</div>
</section>
<section id="scatter" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="scatter">Scatter</h3>
<div id="fig-scatter-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  subgraph R3["`3`"]
  end
  subgraph R2["`2`"]
  end
  subgraph R1["`1`"]
    direction TB
    xp0("`x0`")
    xp1("`x1`")
    xp2("`x2`")
    xp3("`x3`")
  end
  subgraph R0["`0`"]
  end
  subgraph S["`Scatter`"]
  end
  subgraph S3["`3`"]
    x3("`x3`")
  end
  subgraph S2["`2`"]
    x2("`x2`")
  end
  subgraph S1["`1`"]
    x1("`x1`")
  end
  subgraph S0["`0`"]
    x0("`x0`")
  end
  R1 --&gt; S
  S --&gt; S0
  S --&gt; S1
  S --&gt; S2
  S --&gt; S3
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,font-weight:500,color:#838383
class AG0,AG1,AG2,AG3,S,R0,R1,R2,R3,S0,S1,S2,S3, block
class x0,xp0, red
class x1,xp1, green
class x2,xp2, blue
class x3,xp3, yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Scatters a list of tensors to the whole group
</figcaption>
</figure>
</div>
</section>
</section>
<section id="why-distributed-training" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="why-distributed-training">Why Distributed Training?</h2>
<ul>
<li><code>N</code> workers each processing unique batch<sup>1</sup> of data:
<ul>
<li>[<code>micro_batch_size = 1</code>] <img src="https://latex.codecogs.com/png.latex?%5Ctimes"> [<code>N</code> GPUs] <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> [<b><code>global_batch_size = N</code></b>]</li>
</ul></li>
<li>Improved gradient estimators
<ul>
<li>Smooth loss landscape</li>
<li>Less iterations needed for same number of epochs
<ul>
<li>common to scale learning rate <code>lr *= sqrt(N)</code></li>
</ul></li>
</ul></li>
<li>See: <a href="https://arxiv.org/abs/1708.03888">Large Batch Training of Convolutional Networks</a></li>
</ul>
<section id="why-distributed-training-speedup" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="why-distributed-training-speedup">Why Distributed Training? Speedup!</h3>
<div id="tbl-recent-progress" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-recent-progress-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Recent progress
</figcaption>
<div aria-describedby="tbl-recent-progress-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Author</th>
<th style="text-align: center;">GPU</th>
<th style="text-align: center;">Batch Size</th>
<th style="text-align: center;"># GPU</th>
<th style="text-align: center;">TIME (s)</th>
<th style="text-align: center;">ACC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2016</td>
<td style="text-align: center;">He</td>
<td style="text-align: center;">P100</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;"><span class="red-bg">8</span></td>
<td style="text-align: center;"><span class="red-bg">104,400</span></td>
<td style="text-align: center;">75.30%</td>
</tr>
<tr class="even">
<td style="text-align: center;">2019</td>
<td style="text-align: center;">Yamazaki</td>
<td style="text-align: center;">V100</td>
<td style="text-align: center;">81,920</td>
<td style="text-align: center;"><span class="blue-bg">2048</span></td>
<td style="text-align: center;"><span class="blue-bg">72</span></td>
<td style="text-align: center;">75.08%</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</section>
<section id="dealing-with-data" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="dealing-with-data">Dealing with Data</h3>
<ul>
<li>At each training step, we want to ensure that <strong>each worker receives unique data</strong></li>
<li>This can be done in one of two ways:
<ol type="1">
<li>Manually partition data (ahead of time)
<ul>
<li>Assign <strong>unique subsets</strong> to each worker</li>
<li>Each worker can only see their local portion of the data</li>
<li>Most common approach</li>
</ul></li>
<li>From each worker, randomly select a mini-batch
<ul>
<li>Each worker can see the full dataset</li>
<li>‚ö†Ô∏è When randomly selecting, it is important that each worker uses different seeds to ensure they receive unique data</li>
</ul></li>
</ol></li>
</ul>
</section>
<section id="broadcast-initial-state" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="broadcast-initial-state">Broadcast Initial State</h3>
<ul>
<li>At the start of training (or when loading from a checkpoint), we want all of our workers to be initialized consistently
<ul>
<li><strong>Broadcast</strong> the model and optimizer states from <code>rank() == 0</code> worker</li>
</ul></li>
</ul>
<div id="fig-broadcast" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  0["GPU0"] --&gt; 1["GPU 1"]
  CKPT --&gt; 0
  0 --&gt; 2["GPU 2"]
  0 --Model + Optim. State--&gt;3["GPU 3"]
  0 --&gt; X["`...`"]
  0 --&gt; N["GPU N"]
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383,font-weight:500
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,font-weight:500,color:#838383
class 0,1,2,3,N,X,CKPT block
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: To ensure all workers have the same copies, we load on <code>RANK==0</code> and <code>broadcast</code>
</figcaption>
</figure>
</div>
</section>
<section id="best-practices" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="best-practices">Best Practices</h3>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="‚è∞ Keeping things in Sync">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>‚è∞ Keeping things in Sync
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>Computation stalls during communication !!</strong></p>
<p>Keeping the communication to computation ratio small is important for effective scaling.</p>
</div>
</div>
</div>
<div class="flex-container">
<div class="column" style="width:50%;">
<ul>
<li>Use parallel IO whenever possible
<ul>
<li>Feed each rank from different files</li>
<li>Use MPI IO to have each rank read its own batch from a file</li>
<li>Use several ranks to read data, MPI to scatter to remaining ranks
<ul>
<li>Most practical in big <em>at-scale</em> training</li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="column" style="width:50%;">
<ul>
<li>Take advantage of data storage
<ul>
<li>Use <a href="https://wiki.lustre.org/Configuring_Lustre_File_Striping">striping on lustre</a></li>
</ul></li>
<li>Use the right optimizations for Aurora, Polaris, etc.</li>
<li>Preload data when possible
<ul>
<li>Offloading to a GPU frees CPU cycles for loading the next batch of data
<ul>
<li><strong>minimize IO latency this way</strong></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="going-beyond-data-parallelism" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="going-beyond-data-parallelism">Going Beyond Data Parallelism</h3>
<ul>
<li>‚úÖ Useful when model fits on single GPU:
<ul>
<li>ultimately <strong>limited by GPU memory</strong></li>
<li>model performance limited by size</li>
</ul></li>
<li>‚ö†Ô∏è When model does not fit on a single GPU:
<ul>
<li>Offloading (can only get you so far‚Ä¶):
<ul>
<li><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="https://www.deepspeed.ai/tutorials/zero/">DeepSpeed + <code>ZeRO</code></a></li>
<li>üî• <a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">PyTorch + <code>FSDP</code></a></li>
</ul></li>
<li>Otherwise, resort to model parallelism strategies</li>
</ul></li>
</ul>
</section>
<section id="going-beyond-data-parallelism-deepspeed-zero" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="going-beyond-data-parallelism-deepspeed-zero">Going beyond Data Parallelism: <iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> DeepSpeed + <code>ZeRO</code></h3>
<ul>
<li>Depending on the <code>ZeRO</code> stage (1, 2, 3), we can offload:
<ol type="1">
<li><strong>Stage 1</strong>: optimizer states <img src="https://latex.codecogs.com/png.latex?%5Cleft(P_%7B%5Cmathrm%7Bos%7D%7D%5Cright)"></li>
<li><strong>Stage 2</strong>: gradients + opt. states <img src="https://latex.codecogs.com/png.latex?%5Cleft(P_%7B%5Cmathrm%7Bos%7D+%5Cmathrm%7Bg%7D%7D%5Cright)"></li>
<li><strong>Stage 3</strong>: model params + grads + opt. states <img src="https://latex.codecogs.com/png.latex?%5Cleft(P_%7B%5Cmathrm%7Bos%7D+%5Cmathrm%7Bg%7D+%5Cmathrm%7Bp%7D%7D%5Cright)"></li>
</ol></li>
</ul>
<div id="fig-zero" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/zero.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;14:  DeepSpeed + ZeRO"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/zero.png" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: <iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="deepspeed.ai">DeepSpeed</a> + <a href="https://www.deepspeed.ai/tutorials/zero-offload/"><code>ZeRO</code></a>
</figcaption>
</figure>
</div>
</section>
<section id="fully-sharded-data-parallel-pytorch-fsdp" class="level3 smaller" data-background-color="white">
<h3 class="smaller anchored" data-background-color="white" data-anchor-id="fully-sharded-data-parallel-pytorch-fsdp">Fully Sharded Data Parallel: üî• PyTorch + <code>FSDP</code></h3>
<ul>
<li>Instead of maintaining per-GPU copy of <code>{params, grads, opt_states}</code>, FSDP shards (distributes) these across data-parallel workers
<ul>
<li>can optionally offload the sharded model params to CPU</li>
</ul></li>
<li><a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">Introducing PyTorch Fully Sharded Data Parallel (FSDP) API | PyTorch</a></li>
</ul>
<div id="fig-fsdp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fsdp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/fsdp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;15: FSDP Workflow. Source"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/fsdp.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fsdp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: FSDP Workflow. <a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">Source</a>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="additional-parallelism-strategies" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="additional-parallelism-strategies">üï∏Ô∏è Additional Parallelism Strategies</h2>
<ul>
<li><strong>Tensor (/ Model) Parallelism</strong> (<code>TP</code>):
<ul>
<li>ü§ó <a href="https://huggingface.co/docs/text-generation-inference/en/conceptual/tensor_parallelism">Tensor Parallelism</a></li>
<li>üî• <a href="https://pytorch.org/tutorials/intermediate/TP_tutorial.html">Large Scale Transformer model training with Tensor Parallel (TP)</a></li>
</ul></li>
<li><strong>Pipeline Parallelism</strong> (<code>PP</code>):
<ul>
<li>üî• <a href="https://pytorch.org/docs/main/distributed.pipelining.html">PyTorch</a>, <iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="https://deepspeed.readthedocs.io/en/latest/pipeline.html">DeepSpeed</a></li>
</ul></li>
<li><strong>Sequence Parallelism</strong> (<code>SP</code>):
<ul>
<li><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="https://github.com/microsoft/DeepSpeed/blob/master/blogs/deepspeed-ulysses/README.md">DeepSpeed Ulysses</a></li>
<li><a href="https://docs.nvidia.com/megatron-core/developer-guide/latest/api-guide/context_parallel.html">Megatron / Context Parallelism</a></li>
<li><a href="https://arxiv.org/abs/2405.07719v3">Unified Sequence Parallel (USP)</a>
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/feifeibear/long-context-attention">feifeibear/<code>long-context-attention</code></a></li>
</ul></li>
</ul></li>
<li><label><input type="checkbox" checked=""><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf/<code>Megatron-DeepSpeed</code></a></label>
<ul>
<li>Supports 4D Parallelism (<code>DP</code> + <code>TP</code> + <code>PP</code> + <code>SP</code>)</li>
</ul></li>
</ul>
<section id="pipeline-parallelism-pp" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="pipeline-parallelism-pp">Pipeline Parallelism (PP)</h3>
<div class="flex-container" style="place-content: end space-evenly;">
<div class="column" style="width:60%;">
<ul>
<li>Model is split up <strong>vertically</strong> (layer-level) across multiple GPUs</li>
<li>Each GPU:
<ul>
<li>has a portion of the full model</li>
<li>processes <em>in parallel</em> different stages of the pipeline (on a small chunk of the batch)</li>
</ul></li>
<li>See:
<ul>
<li>üî• <a href="https://pytorch.org/docs/main/distributed.pipelining.html">PyTorch / Pipeline Parallelism</a></li>
<li><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <a href="https://deepspeed.readthedocs.io/en/latest/pipeline.html">DeepSpeed / Pipeline Parallelism</a></li>
</ul></li>
</ul>
</div>
<div class="column" style="width:40%;">
<div id="fig-pipeline-parallelism" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pipeline-parallelism-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    subgraph G0["`GPU 0`"]
        direction LR
        a0("`Layer 0`")
        b0("`Layer 1`")
    end
    subgraph G1["`GPU 1`"]
        direction LR
        a1("`Layer 2`")
        b1("`Layer 3`")
    end
    a0 -.-&gt; b0
    b0 --&gt; a1
    a1 -.-&gt; b1
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
class G0,G1, block
class a0, red
class b0, green
class a1, blue
class b1, yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pipeline-parallelism-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Pipeline Parallelism
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="tensor-parallel-tp" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="tensor-parallel-tp">Tensor Parallel (TP)</h3>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Each tensor is split up into multiple chunks</li>
<li>Each shard of the tensor resides on its designated GPU</li>
<li>During processing each shard gets processed separately (and in parallel) on different GPUs
<ul>
<li>synced at the end of the step</li>
</ul></li>
<li>See: <a href="https://huggingface.co/docs/transformers/v4.15.0/parallelism">ü§ó Model Parallelism</a> for additional details</li>
</ul>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-model-parallel-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
   subgraph G0["`GPU0`"]
    direction TB
    a0("`Layer 0`")
    b0("`Layer 1`")
    c0("`Layer 2`")
    d0("`Layer 3`")
   end
   subgraph G1["`GPU1`"]
    direction TB
    a1("`Layer 0`")
    b1("`Layer 1`")
    c1("`Layer 2`")
    d1("`Layer 3`")
   end
   a0 &lt;-.-&gt; a1
   b0 &lt;-.-&gt; b1
   c0 &lt;-.-&gt; c1
   d0 &lt;-.-&gt; d1
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
class G0,G1, block
class a0,a1 red
class b0,b1 green
class c0,c1 blue
class d0,d1 yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Tensor Parallel Training
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="tensor-parallel-tp-1" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="tensor-parallel-tp-1">Tensor Parallel (TP)</h3>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Suitable when the model is too large to fit onto a single device (CPU / GPU)</li>
<li>Typically <strong>more complicated</strong> to implement than data parallel training
<ul>
<li>This is what one may call <em>horizontal parallelism</em></li>
<li>Communication whenever dataflow between two subsets</li>
</ul></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a></li>
<li>ü§ó <a href="https://github.com/huggingface/nanotron"><code>huggingface/nanotron</code></a></li>
</ul>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-model-parallel-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
   subgraph G0["`GPU0`"]
    direction TB
    a0("`Layer 0`")
    b0("`Layer 1`")
    c0("`Layer 2`")
    d0("`Layer 3`")
   end
   subgraph G1["`GPU1`"]
    direction TB
    a1("`Layer 0`")
    b1("`Layer 1`")
    c1("`Layer 2`")
    d1("`Layer 3`")
   end
   a0 &lt;-.-&gt; a1
   b0 &lt;-.-&gt; b1
   c0 &lt;-.-&gt; c1
   d0 &lt;-.-&gt; d1
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
class G0,G1, block
class a0,a1 red
class b0,b1 green
class c0,c1 blue
class d0,d1 yellow
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Tensor Parallel Training
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>Split up network over multiple workers</li>
<li>Each receives disjoint subset</li>
<li>All communication associated with subsets are distributed</li>
<li>Communication whenever dataflow between two subsets</li>
<li>Typically <strong>more complicated</strong> to implement than data parallel training</li>
<li>Suitable when the model is too large to fit onto a single device (CPU / GPU)</li>
</ul>
</div>
</section>
</section>
<section id="tensor-model-parallel-training-example" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="tensor-model-parallel-training-example">Tensor (/ Model) Parallel Training: Example</h2>
<p>Want to compute: <img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csum_%7Bi%7D%20x_%7Bi%7D%20W_%7Bi%7D%20=%20x_0%20*%20W_0%20+%20x_1%20*%20W_1%20+%20x_2%20*%20W_2"><br>
where each GPU only has only its portion of the full weights as shown below</p>
<ol type="1">
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y_%7B0%7D%20=%20x_%7B0%7D%20*%20W_%7B0%7D%5Crightarrow"> <code>GPU1</code></li>
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y_%7B1%7D%20=%20y_%7B0%7D%20+%20x_%7B1%7D%20*%20W_%7B1%7D%5Crightarrow"> <code>GPU2</code></li>
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y%20=%20y_%7B1%7D%20+%20x_%7B2%7D%20*%20W_%7B2%7D%20=%20%5Csum_%7Bi%7D%20x_%7Bi%7D%20W_%7Bi%7D"> ‚úÖ</li>
</ol>
<div id="fig-tensor-parallel-example" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:75%; margin-left: auto; margin-right: auto; text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tensor-parallel-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph X0["`GPU0`"]
        direction LR
        a("`W0`")
    end
    subgraph X1["`GPU1`"]
        direction LR
        b("`W1`")
    end
    subgraph X2["`GPU2`"]
        direction LR
        c("`W2`")
    end
  t0("`x‚ÇÄ`")--&gt;X0
  X0 --&gt;|"`x‚ÇÄ W‚ÇÄ`"|X1
  X1 --&gt;|"`x‚ÇÄ W‚ÇÄ &lt;br&gt;+ x‚ÇÅ W‚ÇÅ`"|X2
  t1("`x‚ÇÅ`") --&gt; X1
  t2("`x‚ÇÇ`") --&gt; X2
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-tensor-parallel-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19
</figcaption>
</figure>
</div>
<section id="tensor-model-parallelismefficient-large-scale" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="tensor-model-parallelismefficient-large-scale">Tensor (Model) Parallelism<sup>2</sup></h3>
<ul>
<li>In <strong>Tensor Paralleism</strong> each GPU processes only a slice of a tensor and only aggregates the full tensor for operations that require the whole thing.
<ul>
<li>The main building block of any transformer is a fully connected <code>nn.Linear</code> followed by a nonlinear activation GeLU.
<ul>
<li><code>Y = GeLU(XA)</code>, where X and Y are the input and output vectors, and A is the weight matrix.</li>
</ul></li>
<li>If we look at the computation in matrix form, it‚Äôs easy to see how the matrix multiplication can be split between multiple GPUs:</li>
</ul></li>
</ul>
</section>
<section id="tensor-parallelism" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="tensor-parallelism">Tensor Parallelism</h3>
<div id="fig-parallel-gemm" class="quarto-float quarto-figure quarto-figure-center anchored" style="max-width: 80%; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parallel-gemm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/parallelism-tp-parallel_gemm.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;20: Tensor Parallel GEMM. This information is based on (the much more in-depth) TP Overview by @anton-l"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/parallelism-tp-parallel_gemm.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parallel-gemm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Tensor Parallel GEMM. This information is based on (the much more in-depth) <a href="https://github.com/huggingface/transformers/issues/10321#issuecomment-783543530">TP Overview</a> by <a href="https://github.com/anton-l">@anton-l</a>
</figcaption>
</figure>
</div>
</section>
<section id="d-parallelism" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="d-parallelism">3D Parallelism</h3>
<ul>
<li><code>DP</code> + <code>TP</code> + <code>PP</code> (3D) Parallelism</li>
</ul>
<div id="fig-3dparallel" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center!important;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-3dparallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/parallelism-deepspeed-3d.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;21: Figure taken from 3D parallelism: Scaling to trillion-parameter models"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/parallelism-deepspeed-3d.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3dparallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: Figure taken from <a href="https://www.microsoft.com/en-us/research/blog/deepspeed-extreme-scale-model-training-for-everyone/">3D parallelism: Scaling to trillion-parameter models</a>
</figcaption>
</figure>
</div>
</section>
<section id="deciding-on-a-parallelism-strategy" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="deciding-on-a-parallelism-strategy">Deciding on a Parallelism Strategy</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Single GPU</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Single Node / Multi-GPU</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Multi-Node / Multi-GPU</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li>Model fits onto a single GPU:
<ul>
<li>Normal use</li>
</ul></li>
<li>Model <strong>DOES NOT</strong> fit on a single GPU:
<ul>
<li><code>ZeRO</code> + Offload CPU (or, optionally, <code>NVMe</code>)</li>
</ul></li>
<li>Largest layer <strong>DOES NOT</strong> fit on a single GPU:
<ul>
<li><code>ZeRO</code> + Enable <a href="https://deepspeed.readthedocs.io/en/latest/zero3.html#memory-centric-tiling">Memory Centric Tiling (MCT)</a>
<ul>
<li>MCT Allows running of arbitrarily large layers by automatically splitting them and executing them sequentially.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="flex-container">
<div class="column">
<ul>
<li>Model fits onto a single GPU
<ul>
<li><a href="https://pytorch.org/docs/stable/notes/ddp.html"><code>DDP</code></a></li>
<li><a href="https://deepspeed.readthedocs.io/en/latest/zero3.html"><code>ZeRO</code></a></li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li>Model <strong>DOES NOT</strong> fit onto a single GPU
<ol type="1">
<li><a href="https://www.deepspeed.ai/tutorials/pipeline/">Pipeline Parallelism (<code>PP</code>)</a></li>
<li><a href="https://deepspeed.readthedocs.io/en/latest/zero3.html"><code>ZeRO</code></a></li>
<li><a href="https://pytorch.org/docs/stable/distributed.tensor.parallel.html">Tensor Parallelism (<code>TP</code>)</a></li>
</ol></li>
</ul>
</div>
</div>
<ul>
<li>With sufficiently fast connectivity between nodes, these three strategies should be comparable.
<ul>
<li>Otherwise, <code>PP</code> &gt; <code>ZeRO</code> <img src="https://latex.codecogs.com/png.latex?%5Csimeq"> <code>TP</code>.</li>
</ul></li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<ul>
<li><p>When you have fast inter-node connectivity:</p>
<ul>
<li><code>ZeRO</code> (virtually <strong>NO</strong> modifications)</li>
<li><code>PP</code> + <code>ZeRO</code> + <code>TP</code> + <code>DP</code> (less communication, at the cost of <strong>MAJOR</strong> modifications)
<ul>
<li><p>when you have slow inter-node connectivity and still low on GPU memory:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DP</span> + PP + TP + ZeRO-1</span></code></pre></div></div></li>
</ul></li>
<li><strong>NOTE</strong>: <code>TP</code> is almost <em>always</em> used within a single node, e.g.<br>
<code>TP &lt;= GPUS_PER_NODE</code></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="large-language-models" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="large-language-models">ü¶ô Large Language Models</h2>
<div id="fig-llms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-llms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;22: Large Language Models have (LLM)s have taken the NLP community world by storm."><img src="https://samforeman.me/talks/ai-for-science-2024/assets/llms.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-llms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: Large Language Models have (LLM)s have taken the <del>NLP community</del> <strong>world</strong> by storm<sup>3</sup>.
</figcaption>
</figure>
</div>
<section id="emergent-abilities" class="level3" data-background-color="#FBFBFD">
<h3 data-background-color="#FBFBFD" class="anchored" data-anchor-id="emergent-abilities">üîÆ Emergent Abilities</h3>
<div id="fig-emergent-abilities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emergent-abilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/emergent-abilities.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;23: See @wei2022emergentabilitieslargelanguage, @yao2023tree"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/emergent-abilities.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emergent-abilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23: See <span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span>, <span class="citation" data-cites="yao2023tree">Yao et al. (2023)</span>
</figcaption>
</figure>
</div>
</section>
<section id="training-llms" class="level3 smaller" data-background-color="white">
<h3 class="smaller anchored" data-background-color="white" data-anchor-id="training-llms">üöÇ Training LLMs</h3>
<div class="quarto-layout-panel" data-layout="[15,-2,10]">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 55.6%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/evolution.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Visualization from Hannibal046/Awesome-LLM"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/evolution.gif" class="img-fluid figure-img" alt="Visualization from Hannibal046/Awesome-LLM"></a></p>
<figcaption>Visualization from <a href="https://github.com/Hannibal046/Awesome-LLM">Hannibal046/Awesome-LLM</a></figcaption>
</figure>
</div>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 7.4%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 37.0%;justify-content: center;">
<p><a href="./assets/it_hungers.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/it_hungers.jpeg" class="img-fluid"></a></p>
</div>
</div>
</div>
</section>
<section id="life-cycle-of-the-llm" class="level3" data-auto-animate="true" data-background-color="white">
<h3 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">‚ôªÔ∏è Life-Cycle of the LLM</h3>
<div class="flex-container">
<div class="column" style="width: 40%;">
<ol type="1">
<li>Data collection + preprocessing</li>
<li><strong>Pre-training</strong>
<ul>
<li>Architecture decisions, model size, etc.</li>
</ul></li>
<li>Supervised Fine-Tuning
<ul>
<li>Instruction Tuning</li>
<li>Alignment</li>
</ul></li>
<li>Deploy (+ monitor, re-evaluate, etc.)</li>
</ol>
</div>
<div class="column" style="width:50%;">
<div id="fig-pretrain-two" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretrain-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;24: Pre-training: Virtually all of the compute used during pre-training."><img src="https://samforeman.me/talks/ai-for-science-2024/assets/gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretrain-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24: <strong>Pre-training</strong>: Virtually <em>all of the compute</em> used during pre-training<sup>4</sup>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="life-cycle-of-the-llm-1" class="level3" data-auto-animate="true" data-background-color="white">
<h3 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm-1">üéÄ Life-Cycle of the LLM</h3>
<div class="flex-container">
<div class="column" style="width: 50%;">
<ol type="1">
<li>Data collection + preprocessing</li>
<li>Pre-training
<ul>
<li>Architecture decisions, model size, etc.</li>
</ul></li>
<li><strong>Supervised Fine-Tuning</strong>
<ul>
<li>Instruction Tuning</li>
<li>Alignment</li>
</ul></li>
<li>Deploy (+ monitor, re-evaluate, etc.)</li>
</ol>
</div>
<div class="column" style="width:50%;">
<div id="fig-finetune-lifecycle" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-finetune-lifecycle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;25: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://samforeman.me/talks/ai-for-science-2024/assets/gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-finetune-lifecycle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task<sup>5</sup>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="forward-pass" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="forward-pass">‚è© Forward Pass</h3>
<div id="fig-hf-assisted-generation" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:100%;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hf-assisted-generation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/hf_assisted_generation.mov" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;26: Language Model trained for causal language modeling."><video src="./assets/hf_assisted_generation.mov" class="img-fluid" controls=""></video></a><a href="./assets/hf_assisted_generation.mov">Video</a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hf-assisted-generation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26: Language Model trained for causal language modeling<sup>6</sup>.
</figcaption>
</figure>
</div>
</section>
<section id="generating-text" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="generating-text">üí¨ Generating Text</h3>
<div id="fig-generating-text" class="quarto-float quarto-figure quarto-figure-center anchored" style="width: 100%;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-generating-text-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/hf_assisted_generation2.mov" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;27: Language Model trained for causal language modeling."><video src="./assets/hf_assisted_generation2.mov" class="img-fluid" controls=""></video></a><a href="./assets/hf_assisted_generation2.mov">Video</a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-generating-text-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27: Language Model trained for causal language modeling<sup>7</sup>.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="hands-on" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="hands-on">üëã Hands On</h2>
<p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/ai-science-training-series/tree/main/06_parallel_training#hands-on">ai-science-training-series / 06_parallel_training</a></p>
<section id="hands-on-getting-started" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="hands-on-getting-started">üßë‚Äçüíª Hands On: Getting Started</h3>
<ol type="1">
<li><p>üå± Clone Repo(s):</p>
<ul>
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/wordplay">saforem2/<code>wordplay</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/wordplay</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> wordplay</span></code></pre></div></div></li>
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2/<code>ezpz</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/ezpz deps/ezpz</span></code></pre></div></div></li>
</ul></li>
<li><p>üêç Setup Python:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PBS_O_WORKDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> deps/ezpz/src/ezpz/bin/utils.sh</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_python</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_job</span></span></code></pre></div></div></li>
</ol>
</section>
<section id="install-ezpz-wordplay" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="install-ezpz-wordplay">üì¶ Install {<code>ezpz</code>, <code>wordplay</code>}</h3>
<ol type="1">
<li><p>Install Python packages:</p>
<ol type="1">
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2/<code>ezpz</code></a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./deps/ezpz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div></div></li>
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2/<code>wordplay</code></a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from inside `wordplay/`</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div></div></li>
</ol></li>
<li><p>Test distributed setup:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpirun</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.test_dist</span></code></pre></div></div>
<p>See: üçã <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py"><code>ezpz/test_dist.py</code></a></p></li>
</ol>
</section>
<section id="ezpz-example-video" class="level3" data-background-color="#121314">
<h3 data-background-color="#121314" class="anchored" data-anchor-id="ezpz-example-video"><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz"><code>ezpz</code></a>: Example [<a href="https://asciinema.org/a/668460">video</a>]</h3>
<div id="fig-ezpz-asciinema" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ezpz-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<script src="https://asciinema.org/a/668460.js" id="asciicast-668460" async="true"></script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ezpz-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28: Example: using <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py">üçã <code>ezpz.test_dist</code></a> to train a small model using DDP
</figcaption>
</figure>
</div>
</section>
<section id="install-wordplay" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="install-wordplay">Install <a href="https://github.com/saforem2/wordplay"><code>wordplay</code> üéÆüí¨</a></h3>
<div id="fig-nanoGPT" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nanoGPT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/nanogpt.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;29: The simplest, fastest repository for training / finetuning GPT based models. Figure from karpathy/nanoGPT"><img src="https://samforeman.me/talks/ai-for-science-2024/assets/nanogpt.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nanoGPT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29: The simplest, fastest repository for training / finetuning GPT based models. Figure from <a href="https://github.com/karpathy/nanoGPT">karpathy/<code>nanoGPT</code></a>
</figcaption>
</figure>
</div>
</section>
<section id="prepare-data" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="prepare-data">Prepare Data</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 wordplay/data/shakespeare_char/prepare.py</span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> HF_DATASETS_CACHE=/home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/.cache/huggingface</span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">length</span> of dataset in characters: 1,115,394</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">all</span> the unique characters:</span>
<span id="cb8-5"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">!$</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">\',-.3:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span></span>
<span id="cb8-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab</span> size: 65</span>
<span id="cb8-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train</span> has 1,003,854 tokens</span>
<span id="cb8-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">val</span> has 111,540 tokens</span></code></pre></div></div>
</section>
<section id="launch-training-ddp" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="launch-training-ddp">Launch Training (DDP)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> wordplay <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2">    train.backend=DDP <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-3">    train.eval_interval=100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">    data=shakespeare <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">    train.dtype=bf16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-6">    model.batch_size=64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-7">    model.block_size=1024 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-8">    train.max_iters=1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-9">    train.log_interval=10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-10">    train.compile=false <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> wordplay-gpt2-DDP.log</span></code></pre></div></div>
</section>
<section id="training-example-output" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="training-example-output">Training: Example Output</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> wordplay <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2">    train.backend=DDP <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3">    train.eval_interval=100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">    data=shakespeare <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">    train.dtype=bf16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">    model.batch_size=64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-7">    model.block_size=1024 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-8">    train.max_iters=1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-9">    train.log_interval=10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-10">    train.compile=false <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> wordplay-gpt2-DDP.log</span>
<span id="cb10-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.746540]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb10-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.748763]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb10-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.749453]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:160</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To disable this behavior, and log from ALL ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">not</span> recommended<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> set: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export LOG_FROM_ALL_RANKS=1'</span>  in your environment, and re-run.</span>
<span id="cb10-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.772718]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:81</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting HF_DATASETS_CACHE to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/.cache/huggingface/datasets</span>
<span id="cb10-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.341532]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.342381]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.342430]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.348657]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb10-20"></span>
<span id="cb10-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb10-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=cuda</span>
<span id="cb10-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=cuda:0</span>
<span id="cb10-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=nccl</span>
<span id="cb10-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=4</span>
<span id="cb10-26">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb10-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb10-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb10-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Polaris</span>
<span id="cb10-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=1</span>
<span id="cb10-32">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb10-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=4</span>
<span id="cb10-34">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb10-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb10-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb10-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=4</span>
<span id="cb10-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=4</span>
<span id="cb10-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb10-40"></span>
<span id="cb10-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.351446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/4</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nccl'</span> for distributed training.</span>
<span id="cb10-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.356169]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.356692]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:364</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [4 / 4] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> devices !!</span>
<span id="cb10-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.359571]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:317</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Loading val from /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/val.bin</span>
<span id="cb10-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.360138]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:317</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Loading train from /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/train.bin</span>
<span id="cb10-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.361154]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:442</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Tokens per iteration: 262,144</span>
<span id="cb10-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.361574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:465</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using self.ptdtype=torch.float16 on self.device_type=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span></span>
<span id="cb10-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362002]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:471</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Initializing a new model from scratch</span>
<span id="cb10-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362529]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:874</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb10-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362896]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:875</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: WordPlay</span>
<span id="cb10-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.451786]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:905</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">still</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">frog</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/WordPlay/runs/6by9vpcj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.464106]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:312</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Updating wandb.run: still-frog-17 config with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIST_INFO"</span></span>
<span id="cb10-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.469424]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:938</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Polaris'</span></span>
<span id="cb10-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.471151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__:89</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> {</span>
<span id="cb10-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb10-56">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"framework"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pytorch"</span>,</span>
<span id="cb10-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"backend"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb10-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"device"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-59">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-60">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"port"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-61">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ds_config_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-62">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-63">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ngpus"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb10-64">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb10-65">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb10-66">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 10,</span>
<span id="cb10-67">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 200,</span>
<span id="cb10-68">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_only"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb10-69">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"always_save_checkpoint"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb10-70">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_from"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scratch"</span>,</span>
<span id="cb10-71">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wandb_project"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WordPlay"</span>,</span>
<span id="cb10-72">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1000,</span>
<span id="cb10-73">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"warmup_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb10-74">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dtype"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span>,</span>
<span id="cb10-75">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"compile"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb10-76">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-77">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb10-78">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_layer"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb10-79">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_head"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb10-80">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_embd"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 768,</span>
<span id="cb10-81">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 64,</span>
<span id="cb10-82">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"block_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1024,</span>
<span id="cb10-83">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"activation"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gelu"</span>,</span>
<span id="cb10-84">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dropout"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0,</span>
<span id="cb10-85">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bias"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb10-86">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vocab_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 65</span>
<span id="cb10-87">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-88">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb10-89">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dataset"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shakespeare_char"</span>,</span>
<span id="cb10-90">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"out_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"out-shakespeare-char"</span>,</span>
<span id="cb10-91">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"root_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb10-92">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-93">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"optimizer"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb10-94">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gas"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb10-95">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AdamW"</span>,</span>
<span id="cb10-96">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"learning_rate"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0006,</span>
<span id="cb10-97">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_decay"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.1,</span>
<span id="cb10-98">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta1"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.9,</span>
<span id="cb10-99">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta2"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.95,</span>
<span id="cb10-100">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grad_clip"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.0,</span>
<span id="cb10-101">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"decay_lr"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb10-102">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr_decay_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 600000,</span>
<span id="cb10-103">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_lr"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 6e-05</span>
<span id="cb10-104">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb10-105"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb10-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.474305]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__:90</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Output dir: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb10-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.474922]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:246</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Initializing a new model from scratch</span>
<span id="cb10-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.258904]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:255</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> number of parameters: 85.00M</span>
<span id="cb10-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.290004]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:264</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Model size: num_params=85003776</span>
<span id="cb10-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.292626]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:445</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> num decayed parameter tensors: 50, with 85,771,008 parameters</span>
<span id="cb10-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.293296]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:449</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> num non-decayed parameter tensors: 25, with 19,200 parameters</span>
<span id="cb10-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515324]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:1'"</span></span>
<span id="cb10-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515340]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:2'"</span></span>
<span id="cb10-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515465]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:3'"</span></span>
<span id="cb10-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:18.431814]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:465</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> using fused AdamW: True</span>
<span id="cb10-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:18.432620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:0'"</span></span>
<span id="cb10-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.951020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:356</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.model=GPT<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-118">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-119">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wte</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-120">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wpe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-121">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drop</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-122">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleList<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-123">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0-11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12 x Block<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-124">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-125">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CausalSelfAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-126">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2304, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-127">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-128">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-129">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resid_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-130">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-131">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-132">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> MLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-133">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_fc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-134">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">act_fn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GELU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">approximate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-135">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-136">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-137">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-138">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-139">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-140">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-141">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-142">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-143"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.955340]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:357</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.grad_scaler=<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>torch.cuda.amp.grad_scaler.GradScaler object at 0x145a38f0f090<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb10-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.956897]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.model_engine=DistributedDataParallel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-146">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GPT<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-147">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-148">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wte</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-149">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wpe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-150">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drop</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-151">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleList<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-152">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0-11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12 x Block<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-153">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-154">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CausalSelfAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-155">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2304, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-156">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-157">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-158">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resid_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-159">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-160">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-161">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> MLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-162">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_fc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-163">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">act_fn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GELU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">approximate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-164">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-165">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-166">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-167">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-168">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-169">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-170">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-171">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-172">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-173"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.961066]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:359</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.optimizer=AdamW <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb10-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Parameter</span> Group 0</span>
<span id="cb10-176">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">amsgrad:</span> False</span>
<span id="cb10-177">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">betas:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.95<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-178">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">capturable:</span> False</span>
<span id="cb10-179">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">differentiable:</span> False</span>
<span id="cb10-180">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eps:</span> 1e-08</span>
<span id="cb10-181">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foreach:</span> None</span>
<span id="cb10-182">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> True</span>
<span id="cb10-183">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 0.0006</span>
<span id="cb10-184">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maximize:</span> False</span>
<span id="cb10-185">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay:</span> 0.1</span>
<span id="cb10-186"></span>
<span id="cb10-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Parameter</span> Group 1</span>
<span id="cb10-188">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">amsgrad:</span> False</span>
<span id="cb10-189">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">betas:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.95<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-190">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">capturable:</span> False</span>
<span id="cb10-191">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">differentiable:</span> False</span>
<span id="cb10-192">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eps:</span> 1e-08</span>
<span id="cb10-193">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foreach:</span> None</span>
<span id="cb10-194">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> True</span>
<span id="cb10-195">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 0.0006</span>
<span id="cb10-196">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maximize:</span> False</span>
<span id="cb10-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay:</span> 0.0</span>
<span id="cb10-198"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.988827]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:802</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Startup time: 6.7125</span>
<span id="cb10-200">                <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Training</span> Legend</span>
<span id="cb10-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì</span></span>
<span id="cb10-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>    abbr     ‚îÉ desc                           ‚îÉ</span>
<span id="cb10-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©</span></span>
<span id="cb10-204"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    step     ‚îÇ Current training iteration     ‚îÇ</span>
<span id="cb10-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    loss     ‚îÇ Loss value                     ‚îÇ</span>
<span id="cb10-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dt      ‚îÇ Elapsed time per training step ‚îÇ</span>
<span id="cb10-207"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dtf     ‚îÇ Elapsed time per forward step  ‚îÇ</span>
<span id="cb10-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dtb     ‚îÇ Elapsed time per backward step ‚îÇ</span>
<span id="cb10-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     sps     ‚îÇ Samples per second             ‚îÇ</span>
<span id="cb10-210"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> sps_per_gpu ‚îÇ Samples per second <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per</span> GPU<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb10-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     tps     ‚îÇ Tokens per second              ‚îÇ</span>
<span id="cb10-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> tps_per_gpu ‚îÇ Tokens per second <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per</span> GPU<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb10-213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     mfu     ‚îÇ Model flops utilization        ‚îÇ</span>
<span id="cb10-214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> train_loss  ‚îÇ Training loss value            ‚îÇ</span>
<span id="cb10-215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  val_loss   ‚îÇ Validation loss value          ‚îÇ</span>
<span id="cb10-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span>
<span id="cb10-217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:21.451865]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb10-218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:21.452667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb10-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>eelEl\'<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$nltPwBSWal</span>,<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PWw</span> bbu<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>HiyP<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>FWwF <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AhW:ygrn</span> kk-<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'\'</span>KFlMwnlEfflkc,elpWaWtgml<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Pgglhllw</span> lglhFllzczPAFHpeAAPPSltgkrWPPhlEMgcrN ggPWt-WPSSzHSkkrzzk.FFrtSSkgMll<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gFXr,hghaueaVPW-pHFF-gg,,,FF,,kbApgg</span> gg<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>aWWzzkk<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>a<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>CggHl<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bGeA</span>,FFk,,SF<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UF,,aZ</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gglee$,k.US</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kg:S,,zVzzc</span></span>
<span id="cb10-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:01.573073]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=10 loss=3.154310 dt=0.282833 dtf=0.005247 dtb=0.011417 sps=14.142633 sps_per_gpu=3.535658 tps=926851.609409 tps_per_gpu=231712.902352 mfu=46.288281 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:04.402750]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=20 loss=2.660851 dt=0.306263 dtf=0.005233 dtb=0.011419 sps=13.060678 sps_per_gpu=3.265170 tps=855944.613638 tps_per_gpu=213986.153409 mfu=45.934162 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:07.237507]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=30 loss=2.543283 dt=0.283021 dtf=0.005238 dtb=0.011245 sps=14.133211 sps_per_gpu=3.533303 tps=926234.088226 tps_per_gpu=231558.522057 mfu=45.966490 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:10.077248]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=40 loss=2.503963 dt=0.285001 dtf=0.005213 dtb=0.011471 sps=14.035061 sps_per_gpu=3.508765 tps=919801.749941 tps_per_gpu=229950.437485 mfu=45.963461 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:12.917039]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=50 loss=2.477469 dt=0.283532 dtf=0.005166 dtb=0.011294 sps=14.107763 sps_per_gpu=3.526941 tps=924566.380009 tps_per_gpu=231141.595002 mfu=45.984530 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:15.760749]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=60 loss=2.471083 dt=0.284630 dtf=0.005140 dtb=0.011224 sps=14.053326 sps_per_gpu=3.513332 tps=920998.786204 tps_per_gpu=230249.696551 mfu=45.985675 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:18.602785]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=70 loss=2.458894 dt=0.283926 dtf=0.005219 dtb=0.010383 sps=14.088155 sps_per_gpu=3.522039 tps=923281.352698 tps_per_gpu=230820.338174 mfu=45.998106 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:21.451433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=80 loss=2.489088 dt=0.285537 dtf=0.005183 dtb=0.011373 sps=14.008683 sps_per_gpu=3.502171 tps=918073.060430 tps_per_gpu=229518.265108 mfu=45.983282 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:24.302241]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=90 loss=2.471990 dt=0.300767 dtf=0.005445 dtb=0.010290 sps=13.299337 sps_per_gpu=3.324834 tps=871585.359388 tps_per_gpu=217896.339847 mfu=45.737774 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:27.153275]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=100 loss=2.445556 dt=0.285869 dtf=0.005182 dtb=0.011251 sps=13.992403 sps_per_gpu=3.498101 tps=917006.151328 tps_per_gpu=229251.537832 mfu=45.743655 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb10-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:28.182553]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb10-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:28.183179]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb10-232"></span>
<span id="cb10-233"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb10-234"></span>
<span id="cb10-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Goupay</span> my winghimithell bls ger t bon sinthard ht omind be,</span>
<span id="cb10-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">And</span> lereind h py balithand frd oforondof wimon me hageas thinero mand,</span>
<span id="cb10-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Thacanes,</span></span>
<span id="cb10-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">An</span> frift ghik med d herthecke ntore thack couthen ale, t thit ang d m t h chy me fache ag, wit my hathan glat ng</span>
<span id="cb10-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:06.025837]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:760</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb10-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:06.026607]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:761</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span>
<span id="cb10-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:07.682968]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:141</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span>
<span id="cb10-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:10.519506]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=110 loss=2.433923 dt=0.285038 dtf=0.005757 dtb=0.011762 sps=14.033209 sps_per_gpu=3.508302 tps=919680.367894 tps_per_gpu=229920.091974 mfu=45.762304 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:13.362148]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=120 loss=2.429014 dt=0.284445 dtf=0.005222 dtb=0.011486 sps=14.062460 sps_per_gpu=3.515615 tps=921597.361532 tps_per_gpu=230399.340383 mfu=45.788661 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:16.210694]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=130 loss=2.402059 dt=0.285559 dtf=0.005199 dtb=0.011765 sps=14.007633 sps_per_gpu=3.501908 tps=918004.211586 tps_per_gpu=229501.052897 mfu=45.794438 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:19.061546]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=140 loss=2.374062 dt=0.285476 dtf=0.005239 dtb=0.011453 sps=14.011662 sps_per_gpu=3.502916 tps=918268.297093 tps_per_gpu=229567.074273 mfu=45.800956 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:21.917283]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=150 loss=2.365385 dt=0.285846 dtf=0.005125 dtb=0.011320 sps=13.993568 sps_per_gpu=3.498392 tps=917082.475791 tps_per_gpu=229270.618948 mfu=45.800900 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:24.771924]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=160 loss=2.317337 dt=0.280788 dtf=0.005173 dtb=0.011249 sps=14.245602 sps_per_gpu=3.561401 tps=933599.792506 tps_per_gpu=233399.948127 mfu=45.883340 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:27.626812]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=170 loss=2.256231 dt=0.284973 dtf=0.005141 dtb=0.011299 sps=14.036416 sps_per_gpu=3.509104 tps=919890.544506 tps_per_gpu=229972.636126 mfu=45.889069 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:30.480952]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=180 loss=2.216419 dt=0.286555 dtf=0.005180 dtb=0.011402 sps=13.958906 sps_per_gpu=3.489726 tps=914810.852170 tps_per_gpu=228702.713043 mfu=45.868857 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:33.337342]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=190 loss=2.145123 dt=0.291456 dtf=0.005409 dtb=0.019347 sps=13.724205 sps_per_gpu=3.431051 tps=899429.467247 tps_per_gpu=224857.366812 mfu=45.773849 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:36.194584]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=200 loss=2.068149 dt=0.285703 dtf=0.005153 dtb=0.011286 sps=14.000555 sps_per_gpu=3.500139 tps=917540.393411 tps_per_gpu=229385.098353 mfu=45.778791 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb10-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:37.224149]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb10-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:37.224745]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb10-254"></span>
<span id="cb10-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb10-256"></span>
<span id="cb10-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">LORTESS</span> LA:</span>
<span id="cb10-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No,</span> sighappat selace<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> don downd sourciceans note cancen up sof liond</span>
<span id="cb10-259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">This</span> and my man, werame, of re thee</span>
<span id="cb10-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Thise</span> not will I on land brond sul me a fingore<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb10-261"></span>
<span id="cb10-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FLER:</span></span>
<span id="cb10-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tisint</span> your not nare lame o igen,-to brorst.</span>
<span id="cb10-264"></span>
<span id="cb10-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SamERS:</span></span>
<span id="cb10-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Sin:</span></span>
<span id="cb10-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">I\'l</span> hell she lor hen w</span>
<span id="cb10-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:14.409129]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:760</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb10-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:14.409820]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:761</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span>
<span id="cb10-270"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:16.366935]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:141</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span>
<span id="cb10-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:19.245061]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=210 loss=1.982169 dt=0.283305 dtf=0.005223 dtb=0.011284 sps=14.119042 sps_per_gpu=3.529760 tps=925305.515083 tps_per_gpu=231326.378771 mfu=45.822019 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:22.092430]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=220 loss=1.897731 dt=0.284759 dtf=0.005217 dtb=0.011187 sps=14.046945 sps_per_gpu=3.511736 tps=920580.608106 tps_per_gpu=230145.152026 mfu=45.837327 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:24.942639]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=230 loss=1.817213 dt=0.285266 dtf=0.005208 dtb=0.011446 sps=14.022003 sps_per_gpu=3.505501 tps=918945.985503 tps_per_gpu=229736.496376 mfu=45.842940 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:27.797910]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=240 loss=1.779287 dt=0.285465 dtf=0.005189 dtb=0.011220 sps=14.012250 sps_per_gpu=3.503062 tps=918306.793546 tps_per_gpu=229576.698387 mfu=45.844800 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:30.653597]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=250 loss=1.704220 dt=0.289284 dtf=0.005471 dtb=0.010346 sps=13.827253 sps_per_gpu=3.456813 tps=906182.836379 tps_per_gpu=226545.709095 mfu=45.785926 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:33.512769]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=260 loss=1.671318 dt=0.287679 dtf=0.005125 dtb=0.011250 sps=13.904380 sps_per_gpu=3.476095 tps=911237.442617 tps_per_gpu=227809.360654 mfu=45.758182 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:36.373461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=270 loss=1.650952 dt=0.298661 dtf=0.005118 dtb=0.011520 sps=13.393107 sps_per_gpu=3.348277 tps=877730.651421 tps_per_gpu=219432.662855 mfu=45.565875 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:39.236930]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=280 loss=1.573242 dt=0.285970 dtf=0.005171 dtb=0.011290 sps=13.987477 sps_per_gpu=3.496869 tps=916683.279847 tps_per_gpu=229170.819962 mfu=45.587333 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:42.100605]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=290 loss=1.533265 dt=0.286487 dtf=0.005432 dtb=0.011288 sps=13.962259 sps_per_gpu=3.490565 tps=915030.617828 tps_per_gpu=228757.654457 mfu=45.598392 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:44.964424]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=300 loss=1.492064 dt=0.288480 dtf=0.005355 dtb=0.011480 sps=13.865774 sps_per_gpu=3.466443 tps=908707.340870 tps_per_gpu=227176.835218 mfu=45.576766 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb10-281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:45.995833]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb10-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:45.996497]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb10-283"></span>
<span id="cb10-284"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb10-285"></span>
<span id="cb10-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RICHMORD:</span></span>
<span id="cb10-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Char</span> stire<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> how in those are name the range hone.</span>
<span id="cb10-288"></span>
<span id="cb10-289"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GLOUCESTER:</span></span>
<span id="cb10-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Nay,</span> in lond<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s time the palt are worder more</span></span>
<span id="cb10-291"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">That wilt in the purpose be a pey</span></span>
<span id="cb10-292"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">And thou thine onter hands, and the which broth.</span></span>
<span id="cb10-293"></span>
<span id="cb10-294"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ELBOWINCA:</span></span>
<span id="cb10-295"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">At lie my lord with the me an arms be a s</span></span>
<span id="cb10-296"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:23.549987][INFO][trainer:760] - Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span></span>
<span id="cb10-297"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:23.550696][INFO][trainer:761] - Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span></span>
<span id="cb10-298"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:25.496559][INFO][configs:141] - Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span></span>
<span id="cb10-299"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:28.374854][INFO][trainer:885] - step=310 loss=1.444200 dt=0.299907 dtf=0.005333 dtb=0.010637 sps=13.337481 sps_per_gpu=3.334370 tps=874085.133345 tps_per_gpu=218521.283336 mfu=45.384395 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb10-300"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:31.223079][INFO][trainer:885] - step=320 loss=1.429350 dt=0.285238 dtf=0.005245 dtb=0.011485 sps=14.023353 sps_per_gpu=3.505838 tps=919034.479880 tps_per_gpu=229758.619970 mfu=45.435743 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb10-301"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:34.074957][INFO][trainer:885] - step=330 loss=1.362220 dt=0.285027 dtf=0.005165 dtb=0.011407 sps=14.033736 sps_per_gpu=3.508434 tps=919714.904826 tps_per_gpu=229928.726207 mfu=45.485355 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb10-302"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:36.929464][INFO][trainer:885] - step=340 loss=1.350888 dt=0.284436 dtf=0.005199 dtb=0.011287 sps=14.062893 sps_per_gpu=3.515723 tps=921625.744709 tps_per_gpu=230406.436177 mfu=45.539549 train_loss=1.495372 val_loss=1.713714</span></span></code></pre></div></div>
</section>
<section id="wordplay-example-video" class="level3" data-background-color="#121314">
<h3 data-background-color="#121314" class="anchored" data-anchor-id="wordplay-example-video"><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/wordplay"><code>wordplay</code></a>: Example [<a href="https://asciinema.org/a/668462">video</a>]</h3>
<div id="fig-wordplay-asciinema" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wordplay-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<script src="https://asciinema.org/a/668462.js" id="asciicast-668462" async="true"></script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wordplay-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30: Training a LLM to talk like Shakespeare using <a href="https://github.com/saforem2/wordplay">saforem2/<code>wordplay</code> üéÆüí¨</a>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="thank-you" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h2>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357</p>
</div>
</div>
</div>
</section>
<section id="references" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="references">üìì References</h2>
<ul>
<li>Title slide (Tetris animation) from: <a href="https://github.com/emilhvitfeldt/quarto-iframe-examples">emilhvitfeldt/quarto-iframe-examples</a></li>
</ul>




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yao2023tree" class="csl-entry">
Yao, Shunyu, Dian Yu, Jeffrey Zhao, Izhak Shafran, Thomas L. Griffiths, Yuan Cao, and Karthik Narasimhan. 2023. <span>‚ÄúTree of Thoughts: Deliberate Problem Solving with Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2305.10601">https://arxiv.org/abs/2305.10601</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>micro_batch_size</code> = batch_size <strong>per</strong> GPU‚Ü©Ô∏é</p></li>
<li id="fn2"><p><a href="https://arxiv.org/abs/2104.04473">Efficient Large-Scale Language Model Training on GPU Clusters</a>‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Source: <a href="https://github.com/Hannibal046/Awesome-LLM"><i class="fa-brands fa-github" aria-label="github"></i> <code>Hannibal046/Awesome-LLM</code></a>‚Ü©Ô∏é</p></li>
<li id="fn4"><p>Figure from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a>‚Ü©Ô∏é</p></li>
<li id="fn5"><p>Figure from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a>‚Ü©Ô∏é</p></li>
<li id="fn6"><p>Video from: <a href="https://huggingface.co/docs/transformers/main/en/llm_tutorial">ü§ó Generation with LLMs</a>‚Ü©Ô∏é</p></li>
<li id="fn7"><p>Video from: <a href="https://huggingface.co/docs/transformers/main/en/llm_tutorial">ü§ó Generation with LLMs</a>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2024,
  author = {Foreman, Sam},
  title = {Parallel {Training} {Methods}},
  date = {2024-11-05},
  url = {https://samforeman.me/talks/ai-for-science-2024/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúParallel Training Methods.‚Äù</span> November
5. <a href="https://samforeman.me/talks/ai-for-science-2024/slides">https://samforeman.me/talks/ai-for-science-2024/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/ai-for-science-2024/</guid>
  <pubDate>Tue, 05 Nov 2024 06:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/ai-for-science-2024/assets/thumbnail.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>AuroraGPT: ANL‚Äôs General Purpose Scientific LLM</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="auroragpt-goals" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="auroragpt-goals">üéØ AuroraGPT Goals</h2>
<div class="flex-container" style="flex-direction: column; justify-content: space-around;">
<div class="flex-container" style="flex-direction: row; justify-content: space-around; align-items:center;">
<div class="column" style="width: 55%">
<div class="blue-card">
<p><strong>AuroraGPT</strong>: <em>General purpose scientific LLM</em><br>
Broadly trained on a general corpora plus scientific {papers, texts, data}</p>
</div>
<ul>
<li><strong>Explore pathways</strong> towards a ‚ÄúScientific Assistant‚Äù model</li>
<li><strong>Build with international partners</strong> (RIKEN, BSC, others)</li>
<li><strong>Multilingual</strong> English, Êó•Êú¨Ë™û, French, German, Spanish</li>
<li><strong>Multimodal</strong>: images, tables, equations, proofs, time series, graphs, fields, sequences, etc</li>
</ul>
</div>
<div class="column" style="text-align: center;">
<div id="fig-awesome-llm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Image from  Hannibal046/Awesome-LLM"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/llms.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-awesome-llm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Image from <iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/Hannibal046/Awesome-LLM"><code>Hannibal046/Awesome-LLM</code></a>
</figcaption>
</figure>
</div>
</div>
</div>
<div id="fig-timeline" class="quarto-float quarto-figure quarto-figure-center anchored" style="margin-left:auto;margin-right:auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/timelines.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Credit to the entire AuroraGPT team for slides."><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/timelines.png" class="img-fluid figure-img" style="margin-left:auto;margin-right:auto;;width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Credit to the entire AuroraGPT team for slides.
</figcaption>
</figure>
</div>
</div>
<div class="notes">
<ul>
<li><p>Here to talk about AuroraGPT, Argonne‚Äôs internal effort to build a general purpose scientific LLM, broadly trained on a general corpora of text + scientific {papers, text, data}</p></li>
<li><p>As part of this effort, we plan to‚Ä¶</p>
<ul>
<li>Explore pathways, build with international partners, multi-{lingual, modal}</li>
</ul></li>
<li><p>Rough timeline of the project and deliverables:</p>
<ul>
<li>202{3,4}: text-only models, plan to release a series of {7B, 70B, 1T} models</li>
<li>202{4,5}: Basic multi-modal models</li>
<li>202{5,6}: Advanced scientific multimodal models</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-open-science-foundation-models" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-open-science-foundation-models">üß™ AuroraGPT: Open Science Foundation Models</h2>
<div id="fig-aurora-gpt" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored" style="vertical-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/AuroraGPT.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3:  argonne-lcf/Megatron-DeepSpeed"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/AuroraGPT.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a>
</figcaption>
</figure>
</div>
<div class="notes">
<ul>
<li>AuroraGPT will be a publicly distributed, open source foundation model for open science</li>
<li>Is being trained on:
<ul>
<li>Scientific / engineering structured data</li>
<li>General text, media, news, etc.</li>
<li>Large amounts of low to medium quality data</li>
<li>Much less high quality data (that is publicly available for use)</li>
</ul></li>
<li>This data is then cleaned, processed, de-duplicated and used for the initial pre-training phase of the model</li>
<li>The vast majority of the overall compute is spent during this initial pre-training phase
<ul>
<li>This is the group I help to lead and will be talking a bit about today</li>
</ul></li>
<li>The initial pre-training phase is currently underway
<ul>
<li>Eventually, given a bit of time, effort and magic, the model will be ready for fine-tuning and additional training for a variety of downstream tasks</li>
</ul></li>
<li>The pretrained model will then be handed off for additional fine-tuning on a variety of downstream tasks
<ul>
<li>Scientific discovery</li>
<li>Accelerate scientific tasks</li>
<li>Digital twins</li>
<li>Inverse design</li>
<li>Code optimization</li>
<li>Accelerated simulations</li>
<li>Autonomous experiments</li>
<li>Co-design</li>
</ul></li>
<li>Becoming increasingly clear that LLMs have the potential to drastically accelerate computational science
<ul>
<li>We‚Äôve seen this already for {GenSLMs, Weather / Climate / Earth Systems Modeling, Particle Physics, etc.}</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-outcomes" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-outcomes">üìä AuroraGPT Outcomes</h2>
<ul>
<li><strong>Datasets and data pipelines</strong> for preparing science training data</li>
<li><strong>Software infrastructure and workflows</strong> to train, evaluate and deploy LLMs at scale for scientific resarch purposes</li>
<li><strong>Evaluation of state-of-the-art LLM Models</strong> to determine where they fall short in deep scientific tasks and where deep data may have an impact</li>
<li><strong>Assessment of the approach</strong> of augmenting web training data with two forms of data specific to science
<ul>
<li>Full text scientific papers</li>
<li>Structured scientific datasets (suitably mapped to narrative form)</li>
</ul></li>
<li><strong>Research grade artifacts</strong> (<strong>models</strong>) for scientific community for adaptation for downstream uses</li>
<li><strong>Promotion of responsible AI</strong> best practices where we can figure them out</li>
<li><strong>International Collaborations</strong> around the long term goal of <em>AGI for science</em></li>
</ul>
<div class="notes">
<ul>
<li><p>Deliverables:</p>
<ul>
<li>datasets, pipelines</li>
<li>software infrastructure, workflows to interface with science applications</li>
<li>checkpoints, models, logs, workbook, insights, etc.</li>
</ul></li>
<li><p>Hope to understand:</p>
<ul>
<li>How different state-of-the-art models perform at different scientific tasks</li>
<li>where deep data may have an impact</li>
<li>feasibility of generically augmenting text with scientific structured data</li>
</ul></li>
<li><p>Huge undertaking that will require large international collaborations around long term goal of AGI for science</p></li>
<li><p>Extra points:</p>
<ul>
<li>Well known that LLMs are good for non-consequential tasks</li>
<li>Known to ‚Äúhallucinate‚Äù and create false information</li>
<li>Can this be mitigated reliably ??</li>
</ul></li>
</ul>
</div>
</section>
<section id="aurora" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="aurora">üåå Aurora</h2>
<div class="flex-container" style="align-items: center;">
<div class="column" style="width:5%;">
<div id="tbl-aurora" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Aurora Specs
</figcaption>
<div aria-describedby="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover caption-top table">
<caption>Aurora Specs</caption>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Racks</td>
<td style="text-align: left;">166</td>
</tr>
<tr class="even">
<td style="text-align: right;">Nodes</td>
<td style="text-align: left;">10,624</td>
</tr>
<tr class="odd">
<td style="text-align: right;">CPUs</td>
<td style="text-align: left;">21,248</td>
</tr>
<tr class="even">
<td style="text-align: right;">GPUs</td>
<td style="text-align: left;">63,744</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NICs</td>
<td style="text-align: left;">84,992</td>
</tr>
<tr class="even">
<td style="text-align: right;">HBM</td>
<td style="text-align: left;">8 PB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">DDR5c</td>
<td style="text-align: left;">10 PB</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="column">
<div id="fig-aurora" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/aurora.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Aurora Fact Sheet"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/aurora.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: <a href="https://www.alcf.anl.gov/sites/default/files/2024-07/Aurora_FactSheet_2024.pdf">Aurora Fact Sheet</a>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="alcf-ai-testbed" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="alcf-ai-testbed">ü§ñ ALCF AI Testbed</h2>
<ul>
<li>ALCF AI Testbed Systems are in production and <a href="https://accounts.alcf.anl.gov/#/allocationRequests">available for allocations</a> to the research community</li>
<li>Significant improvement in time-to-solution and energy-efficiency for diverse AI for science applications.</li>
<li><a href="https://nairrpilot.org/">NAIRR Pilot</a></li>
</ul>
<div class="red-card" style="color: #FF5252; font-size:90%;">
<p>Up to <strong>25</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> improvement for genomic foundation models with <strong>6.5</strong><img src="https://latex.codecogs.com/png.latex?%5Ctimes"> energy efficiency</p>
</div>
<div class="flex-container" style="align-items: flex-end;">
<div id="fig-sambanova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/sambanova.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: SambaNova SN-30: 2nd Gen, 8 nodes with 64 AI Accelerators"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/sambanova.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: <strong>SambaNova SN-30</strong>: 2nd Gen, 8 nodes with 64 AI Accelerators
</figcaption>
</figure>
</div>
<div id="fig-graphcore" class="column quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/graphcore.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Graphcore Bow: generation accelerators: Pod-64 configuration with 64 accelerators"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/graphcore.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>Graphcore Bow</strong>: generation accelerators: Pod-64 configuration with 64 accelerators
</figcaption>
</figure>
</div>
<div id="fig-cerebras" class="column quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/cerebras.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Cerebras: 2x CS-2 WSE with Memory-X and Swarm-X technologies"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/cerebras.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: <strong>Cerebras</strong>: 2x CS-2 WSE with Memory-X and Swarm-X technologies
</figcaption>
</figure>
</div>
<div id="fig-groq" class="column quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/groq.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: GroqRack: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/groq.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: <strong>GroqRack</strong>: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node
</figcaption>
</figure>
</div>
</div>
</section>
<section id="team-leads" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="team-leads">üë• Team Leads</h2>
<div style="font-size: 100%;">
<div class="flex-container" style="text-align: center; align-items: center;">
<p><strong>Planning</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rick-stevens.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rick Stevens"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/rick-stevens.png" style="height:1.04167in" alt="Rick Stevens" class="figure-img"></a></p>
<figcaption>Rick Stevens<sup>1</sup></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Ian Foster"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rinku-gupta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rinku Gupta"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/rinku-gupta.png" style="height:1.04167in" alt="Rinku Gupta" class="figure-img"></a></p>
<figcaption>Rinku Gupta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/mike-papka.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Mike Papka"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/mike-papka.png" style="height:1.04167in" alt="Mike Papka" class="figure-img"></a></p>
<figcaption>Mike Papka</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/arvind-ramanathan.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Arvind Ramanathan"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/arvind-ramanathan.png" style="height:1.04167in" alt="Arvind Ramanathan" class="figure-img"></a></p>
<figcaption>Arvind Ramanathan</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/fangfang-xia.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Fangfang Xia"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/fangfang-xia.png" style="height:1.04167in" alt="Fangfang Xia" class="figure-img"></a></p>
<figcaption>Fangfang Xia</figcaption>
</figure>
</div>
</div>
<div class="flex-container" style="text-align: center;">
<div class="col">
<p><strong>Data</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Ian Foster"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/robert-underwood.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Robert Underwood"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/robert-underwood.png" style="height:1.04167in" alt="Robert Underwood" class="figure-img"></a></p>
<figcaption>Robert Underwood</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Training</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/venkat-vishwanath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Venkat Vishwanath"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/venkat-vishwanath.png" style="height:1.04167in" alt="Venkat Vishwanath" class="figure-img"></a></p>
<figcaption>Venkat Vishwanath</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sam-foreman.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Sam Foreman"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/sam-foreman.png" style="height:1.04167in" alt="Sam Foreman" class="figure-img"></a></p>
<figcaption><span style="color: #ff1a8f; background-color: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); font-weight: 500;">Sam Foreman</span></figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Evaluation</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/franck-cappello.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Franck Cappello"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/franck-cappello.png" style="height:1.04167in" alt="Franck Cappello" class="figure-img"></a></p>
<figcaption>Franck Cappello</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sandeep-madireddy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Sandeep Madireddy"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/sandeep-madireddy.png" style="height:1.04167in" alt="Sandeep Madireddy" class="figure-img"></a></p>
<figcaption>Sandeep Madireddy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/bo-li.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Bo Li"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/bo-li.png" style="height:1.04167in" alt="Bo Li" class="figure-img"></a></p>
<figcaption>Bo Li</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Post</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/eliu-huerta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Eliu Huerta"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/eliu-huerta.png" style="height:1.04167in" alt="Eliu Huerta" class="figure-img"></a></p>
<figcaption>Eliu Huerta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/azton-wells.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Azton Wells"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/azton-wells.png" style="height:1.04167in" alt="Azton Wells" class="figure-img"></a></p>
<figcaption>Azton Wells</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Inference</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rajeev-thakur.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Rajeev Thakur"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/rajeev-thakur.png" style="height:1.04167in" alt="Rajeev Thakur" class="figure-img"></a></p>
<figcaption>Rajeev Thakur</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Comms</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/charlie-catlett.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Charlie Catlett"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/charlie-catlett.png" style="height:1.04167in" alt="Charlie Catlett" class="figure-img"></a></p>
<figcaption>Charlie Catlett</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/david-martin.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="David Martin"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/david-martin.png" style="height:1.04167in" alt="David Martin" class="figure-img"></a></p>
<figcaption>David Martin</figcaption>
</figure>
</div>
</div>
<div class="col">
<p><strong>Distribution</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/brad-ullrich.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Brad Ullrich"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/team/brad-ullrich.png" style="height:1.04167in" alt="Brad Ullrich" class="figure-img"></a></p>
<figcaption>Brad Ullrich</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="teams" class="level2" data-auto-animate="true" data-background-color="white">
<h2 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="teams">ü§ù Teams</h2>
<div class="flex-container">
<div class="column">
<ul>
<li><strong>Planning</strong></li>
<li><strong>Data Prep</strong>
<ul>
<li>Accumulate 20+ T tokens of high-quality scientific text and structured data</li>
</ul></li>
<li><span style="background: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); border: 1px solid #ff1a8f; border-radius: 0.25px;"><strong>Models / Training</strong></span><sup>2</sup>
<ul>
<li>Train (entirely from scratch) a series of models on publicly available data</li>
</ul></li>
<li><strong>Evaluation</strong>
<ul>
<li>Skills, trustworthiness, safety, robustness, privacy, machine ethics</li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li><strong>Post-Training</strong>
<ul>
<li>Fine-tuning, alignment</li>
</ul></li>
<li><strong>Inference</strong>
<ul>
<li>Model serving, API development / public-facing web services</li>
</ul></li>
<li><strong>Distribution</strong>
<ul>
<li>Licensing, generating and distributing artifacts for public consumption</li>
</ul></li>
<li><strong>Communication</strong></li>
</ul>
</div>
</div>
</section>
<section id="model-training" class="level2 smaller page-columns page-full" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="model-training">ü¶ú Model Training</h2>
<div class="flex-container" style="text-align: left; width: 100%; justify-content: space-around; line-height: 1em; gap: 5pt;">
<div class="column" style="background: oklch(from #03BD00 calc(l * 1.15) c h / 0.1); border: 1px solid #03BD00; border-radius: 0.25em; padding: 3pt 8pt;">
<p>‚úÖ <span style="color: #03BD00;"><strong>Goals</strong></span></p>
<ul>
<li>Want training runs at scale to be:
<ul>
<li>efficient</li>
<li>stable</li>
<li>reproducible</li>
</ul></li>
<li>This requires:
<ul>
<li>robust data pipelines / file IO</li>
<li>effectively overlapping compute with communication</li>
<li>stability across {network, filesystem, machine}</li>
</ul></li>
<li>3D / Multi-dimensional Parallelism strategies</li>
<li>Large batch training</li>
<li>Second order optimizers</li>
<li>Sub-quadratic attention</li>
<li>State space models</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
<div class="column" style="background: oklch(from #E90102 calc(l * 1.15) c h / 0.1); border: 1px solid #E90102; border-radius: 0.25em; padding: 3pt 8pt;">
<p>‚ùå <span style="color: #E90102;"><strong>Challenges</strong></span></p>
<ul>
<li><em>Looong time</em> to train, can be:
<ul>
<li>weeks (even months) of continuous training</li>
<li>order of magnitude longer than typical NN training jobs</li>
</ul></li>
<li>Stability issues:
<ul>
<li>failures are expensive (but inevitable)</li>
<li>stragglers common at scale</li>
</ul></li>
<li>Individual jobs are:
<ul>
<li><strong>fragile</strong></li>
<li>only as good as the worst rank</li>
<li>one hang or bad worker can crash job</li>
<li>network / filesystem / other-user(s) dependent</li>
</ul></li>
<li>Cost / benefits of different collective communication algorithms
<ul>
<li>depend on optimized / efficient implementations</li>
</ul></li>
<li>Network performance</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / <code>Megatron-DeepSpeed</code></a></p>
</div></div></section>
<section id="accelerating-dataset-processing-at-scale-for-training" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-at-scale-for-training">üöÄ Accelerating Dataset Processing at Scale for Training</h2>
<ul>
<li>To train a fixed model on trillions of tokens requires:
<ul>
<li>Aggregating data from multiple different <em>corpora</em> (e.g.&nbsp;Reddit, StackExchange, GitHub, etc.)</li>
<li>Sampling <em>each training batch</em> according to a fixed distribution across corpora</li>
<li>Building indices that map batches of tokens into these files (indexing)</li>
</ul></li>
<li>The original implementation was slow, and designed to run on a single device
<ul>
<li>Major bottleneck when debugging data pipeline at scale</li>
</ul></li>
<li><label><input type="checkbox" checked="">Completely re-wrote an asynchronous, distributed implementation that <em>significantly</em> improves performance</label></li>
</ul>
</section>
<section id="accelerating-dataset-processing-results" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-results">üöÄ Accelerating Dataset Processing: Results</h2>
<ul class="task-list">
<li><label><input type="checkbox" checked="">Completely re-wrote an asynchronous, distributed implementation that <em>significantly</em> improves performance (<del>60 min</del> <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> 4 min)</label></li>
</ul>
<div class="flex-container">
<div id="fig-data-blendable" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-blendable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/blendable.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Figure&nbsp;9: Time spent building BlendableDataset"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/blendable.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-blendable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Time spent building <code>BlendableDataset</code>
</figcaption>
</figure>
</div>
<div id="fig-data-gpt" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/gpt.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Figure&nbsp;10: Time spent building GPTDataset"><img src="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/gpt.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-gpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Time spent building <code>GPTDataset</code>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="references" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="references">üìì References</h2>
<div class="flex-container" style="gap: 2pt;">
<div class="column">
<ul>
<li>See my other slides at <a href="https://samforeman.me/talks">samforeman.me/talks</a>
<ul>
<li><a href="https://saforem2.github.io/llm-workshop-talk">LLMs from Scratch</a></li>
<li><a href="https://saforem2.github.io/LLM-tutorial">Creating Small(~ish) LLMs</a></li>
<li><a href="https://saforem2.github.io/parallel-training-slides">Parallel Training Techniques</a></li>
<li><a href="https://samforeman.me/talks/llms-on-polaris/#/title-slide">LLMs on Polaris</a></li>
<li><a href="https://samforeman.me/talks/llms-at-scale/">Training LLMs at Scale</a></li>
</ul></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">argonne-lcf / <code>Megatron-DeepSpeed</code></a><br>
<span class="dim-text">For the largest of large language models.</span></li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz">saforem2 / <code>ezpz</code></a><br>
<span class="dim-text">Distributed training, ezpz. üçã</span></li>
</ul>
</div>
<div class="column">
<ul>
<li>üëÄ See also:
<ul>
<li><a href="https://www.anl.gov/article/new-international-consortium-formed-to-create-trustworthy-and-reliable-generative-ai-models-for">New international consortium for generative AI models for science</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/dist_overview.html">PyTorch Distributed Overview</a></li>
<li><a href="https://pytorch.org/docs/master/notes/ddp.html">Distributed Data Parallel ‚Äî PyTorch master documentation</a></li>
<li><a href="https://huggingface.co/docs/transformers/en/perf_train_gpu_many">ü§ó Efficient Training on Multiple GPUs</a></li>
<li><a href="https://www.deepspeed.ai/getting-started/">Getting Started - DeepSpeed</a></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="thank-you" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h2>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:///foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üôè Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üôè Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</div>
</div>
</div>
</section>
<section id="bibliography" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="bibliography">üìë Bibliography</h2>
<ul>
<li>Refs:
<ul>
<li><span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span></li>
<li>Animations from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></li>
</ul></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-song2023ds4sci" class="csl-entry">
Song, Shuaiwen Leon, Bonnie Kruft, Minjia Zhang, Conglong Li, Shiyang Chen, Chengming Zhang, Masahiro Tanaka, et al. 2023. <span>‚ÄúDeepSpeed4Science Initiative: Enabling Large-Scale Scientific Discovery Through Sophisticated AI System Technologies.‚Äù</span> <a href="https://arxiv.org/abs/2310.04610">https://arxiv.org/abs/2310.04610</a>.
</div>
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yang2023harnessing" class="csl-entry">
Yang, Jingfeng, Hongye Jin, Ruixiang Tang, Xiaotian Han, Qizhang Feng, Haoming Jiang, Bing Yin, and Xia Hu. 2023. <span>‚ÄúHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond.‚Äù</span> <a href="https://arxiv.org/abs/2304.13712">https://arxiv.org/abs/2304.13712</a>.
</div>
</div>
</section>
<section id="extras" class="level2 page-columns page-full" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="extras">üéÅ Extras</h2>
<section id="loooooooooong-sequence-lengths" class="level3 smaller page-columns page-full" data-background-color="#1c1c1c">
<h3 class="smaller anchored" data-background-color="#1c1c1c" data-anchor-id="loooooooooong-sequence-lengths">üöÇ Loooooooooong Sequence Lengths</h3>
<div class="flex-container" style="align-items: center; justify-content: center;">
<p><a href="../../../assets/anl.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="https://samforeman.me/assets/anl.svg" class="img-fluid" style="height:50pt;"></a></p>
<p><span class="dim-text" style="font-size: 2.0em;"><iconify-icon inline="" icon="ic:baseline-plus" aria-label="Icon baseline-plus from ic Iconify.design set." title="Icon baseline-plus from ic Iconify.design set."></iconify-icon></span></p>
<p><a href="../../../assets/deepspeed-logo-transparent.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="https://samforeman.me/assets/deepspeed-logo-transparent.svg" class="img-fluid" style="height:50pt;"></a></p>
</div>
<ul>
<li>Working with <a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-microsoft" aria-label="microsoft"></i> Microsoft/DeepSpeed</a> team to enable longer sequence lengths (context windows) for LLMs
<ul>
<li>See my <a href="https://samforeman.me/posts/auroragpt/long-sequences/">blog post</a> for additional details</li>
</ul></li>
</ul>
<div id="fig-long-seq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="flex-container">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="25B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="img-fluid figure-img"></a></p>
<figcaption>25B</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="33B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="img-fluid figure-img"></a></p>
<figcaption>33B</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Maximum (achievable) <code>SEQ_LEN</code> for both <code>25B</code> and <code>33B</code> models (See: <span class="citation" data-cites="song2023ds4sci">Song et al. (2023)</span>)
</figcaption>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><a href="https://github.com/saforem2/scaling4science"><i class="fa-brands fa-github" aria-label="github"></i> <code>scaling4science</code></a><br>
<a href="https://github.com/saforem2/Megatron-DS-Benchmarking"><i class="fa-brands fa-github" aria-label="github"></i> <code>Megatron-DS-Benchmarking</code></a></p>
</div></div></section>
<section id="life-cycle-of-the-llm" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">‚ôªÔ∏è Life Cycle of the LLM</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" style="text-align:center">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">üìù Pre-training</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">üéÄ Fine-Tuning</a></li></ul>
<div class="tab-content" style="text-align:center">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div id="fig-pretraining" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;12: Pre-training: Virtually all of the compute used during pretraining phase"><img src="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: <strong>Pre-training</strong>: Virtually all of the compute used during pretraining phase
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div id="fig-fine-tuning" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;13: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-llms" class="level3 smaller" data-background-color="white">
<h3 class="smaller anchored" data-background-color="white" data-anchor-id="training-llms">üçé Training LLMs</h3>
<div class="flex-container" style="align-items: flex-end;">
<div class="column" style="width:33%;">
<div id="fig-it-hungers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;14: It‚Äôs hungry!"><img src="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: It‚Äôs hungry!
</figcaption>
</figure>
</div>
</div>
<div class="column" style="width:60%;">
<div id="fig-evolution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;15: Visualization from @yang2023harnessing"><img src="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Visualization from <span class="citation" data-cites="yang2023harnessing">Yang et al. (2023)</span>
</figcaption>
</figure>
</div>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Lead‚Ü©Ô∏é</p></li>
<li id="fn2"><p>Co-led by: Venkat Vishwanath, Sam Foreman‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2024,
  author = {Foreman, Sam},
  title = {AuroraGPT: {ANL‚Äôs} {General} {Purpose} {Scientific} {LLM}},
  date = {2024-10-30},
  url = {https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúAuroraGPT: ANL‚Äôs General Purpose Scientific
LLM.‚Äù</span> October 30. <a href="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/slides">https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/</guid>
  <pubDate>Wed, 30 Oct 2024 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/AuroraGPT/alcf-hpc-workshop-2024/assets/thumbnail.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>Deep Learning and Foundation Models at Scale</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/alcf-hpc-workshop-2024/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="overview" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="overview">Overview</h3>
<ul>
<li><a href="https://www.alcf.anl.gov/events/2024-alcf-hands-hpc-workshop">ALCF Hands-on HPC Workshop</a>
<ul>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/ALCF_Hands_on_HPC_Workshop"><code>argonne-lcf/ALCF_Hands_on_HPC_Workshop</code></a></li>
</ul></li>
<li>Slides @ <a href="https://samforeman.me/talks/alcf-hpc-workshop-2024/slides">samforeman.me/talks/alcf-hpc-workshop-2024/slides</a>
<ul>
<li>HTML Version: <a href="https://samforeman.me/talks/alcf-hpc-workshop-2024">samforeman.me/talks/alcf-hpc-workshop-2024</a></li>
</ul></li>
</ul>
</section>
<section id="scaling-overview" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="scaling-overview">üöÄ Scaling: Overview</h3>
<ul>
<li>‚úÖ <strong>Goal</strong>:
<ul>
<li>Minimize: <span class="highlight-red">Cost</span> (i.e.&nbsp;amount of time spent training)</li>
<li>Maximize: <span class="highlight-blue">Performance</span></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>See <a href="https://huggingface.co/docs/transformers/v4.46.0/performance">ü§ó Performance and Scalability</a> for more details</p>
</div>
</div>
</div></li>
</ul>
<section id="single-gpu" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="single-gpu">Single GPU</h4>
<p>See <a href="https://huggingface.co/docs/transformers/v4.46.0/perf_train_gpu_one">ü§ó Methods and tools for efficient training on a single GPU</a></p>
<div id="fig-single-gpu" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-gpu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/single-gpu-step-1.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: SLOW !! model size limited by GPU memory"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/single-gpu-step-1.drawio.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-gpu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <strong>SLOW</strong> !! model size limited by GPU memory
</figcaption>
</figure>
</div>
</section>
<section id="data-parallel-training" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="data-parallel-training">Data Parallel Training</h4>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>The simplest and most common parallelism technique</li>
<li>Each GPU:
<ul>
<li>has identical copy of model</li>
<li>works on a <strong>unique</strong> subset of data</li>
</ul></li>
<li>Multiple copies of <strong>the same setup</strong>
<ul>
<li>each copy gets fed <strong>unique</strong> data</li>
<li>all copies compute gradients w.r.t local model</li>
<li>everyone syncs up before updating weights</li>
</ul></li>
<li>See: <a href="https://pytorch.org/tutorials/intermediate/ddp_tutorial.html">Distributed Data Parallel ‚Äî PyTorch</a></li>
</ul>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ddp-training" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ddp-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/multi-gpu-ddp.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Data Parallel Training"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/multi-gpu-ddp.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ddp-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Data Parallel Training
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="data-parallel-training-1" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="data-parallel-training-1">Data Parallel Training</h4>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Relatively simple to get up and running (minor modifications to code)</li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz"><code>saforem2/ezpz</code></a></li>
<li><a href="https://pytorch.org/docs/stable/notes/ddp.html">PyTorch ‚Äì DDP</a></li>
<li><a href="https://www.deepspeed.ai/"><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> DeepSpeed</a></li>
<li><a href="https://huggingface.co/docs/transformers/accelerate">Distributed training with ü§ó Accelerate</a></li>
<li><a href="https://youtu.be/930yrXjNkgM">üé¨ ‚ÄúParallel Training Techniques‚Äù</a></li>
</ul>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-avgGrads" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-avgGrads-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/multi-gpu-ddp.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Data Parallel Training"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/multi-gpu-ddp.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-avgGrads-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Data Parallel Training
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="communication" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="communication">Communication</h4>
<ul>
<li>Need mechanism(s) for communicating across GPUs:
<ul>
<li><a href="https://pytorch.org/docs/stable/distributed.html"><code>torch.distributed</code></a></li>
<li><a href="https://mpi4py.readthedocs.io/en/stable/tutorial.html"><code>mpi4py</code></a></li>
</ul></li>
<li>Collective Communication:
<ul>
<li><a href="https://developer.nvidia.com/nccl">Nvidia Collective Communications Library (NCCL)</a></li>
<li><a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/oneccl.html#gs.gouznn">Intel oneAPI Collective Communications Library (oneCCL)</a></li>
</ul>
<div class="callout callout-style-simple callout-warning no-icon callout-titled" title="‚åõ Timeouts">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚åõ Timeouts
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Collective operations have to be called for each <code>rank</code> to form a complete collective operation.
<ul>
<li>Failure to do so will result in other ranks waiting <strong>indefinitely</strong></li>
</ul></li>
</ul>
</div>
</div>
</div></li>
</ul>
</section>
<section id="allreduce" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="allreduce">AllReduce</h4>
<p>Perform <em>reductions</em> on data (e.g.&nbsp;<code>sum</code>, <code>min</code>, <code>max</code>) across ranks, send result back to everyone.</p>
<div id="fig-all-reduce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-all-reduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/collective-allreduce-sum.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: All-Reduce operation: each rank receives the reduction of input values across ranks."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/collective-allreduce-sum.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-all-reduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: All-Reduce operation: each rank receives the reduction of input values across ranks.
</figcaption>
</figure>
</div>
<div class="footer">

</div>
</section>
<section id="reduce" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="reduce">Reduce</h4>
<ul>
<li>Perform a <em>reduction</em> on data across ranks, send to individual</li>
</ul>
<div id="fig-reduce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/collective-reduce-sum.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Reduce operation: one rank receives the reduction of input values across ranks"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/collective-reduce-sum.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reduce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Reduce operation: one rank receives the reduction of input values across ranks
</figcaption>
</figure>
</div>
</section>
<section id="broadcast" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="broadcast">Broadcast</h4>
<div id="fig-broadcast" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/collective-broadcast.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: broadcast (send) a tensor x from one rank to all ranks"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/collective-broadcast.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <code>broadcast</code> (<em>send</em>) a tensor <code><img src="https://latex.codecogs.com/png.latex?x"></code> from one rank to all ranks
</figcaption>
</figure>
</div>
</section>
<section id="allgather" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="allgather">AllGather</h4>
<div id="fig-allgather" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-allgather-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/collective-allgather.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Gathers tensors from the whole group in a list."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/collective-allgather.drawio.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-allgather-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Gathers tensors from the whole group in a list.
</figcaption>
</figure>
</div>
</section>
<section id="scatter" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="scatter">Scatter</h4>
<div id="fig-scatter" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/collective-scatter.drawio.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Scatters a list of tensors to the whole group"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/collective-scatter.drawio.svg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Scatters a list of tensors to the whole group
</figcaption>
</figure>
</div>
</section>
<section id="why-distributed-training" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="why-distributed-training">Why Distributed Training?</h4>
<ul>
<li><code>N</code> workers each processing unique batch<sup>1</sup> of data:
<ul>
<li>[<code>micro_batch_size = 1</code>] <img src="https://latex.codecogs.com/png.latex?%5Ctimes"> [<code>N</code> GPUs] <img src="https://latex.codecogs.com/png.latex?%5Crightarrow"> [<b><code>global_batch_size = N</code></b>]</li>
</ul></li>
<li>Smooth loss landscape</li>
<li>Improved gradient estimators</li>
<li>Less iterations needed for same number of epochs
<ul>
<li>May need to train for more epochs if another change is not made</li>
<li>e.g.&nbsp;scaling learning rate <code>lr *= sqrt(N)</code></li>
</ul></li>
<li>See: <a href="https://arxiv.org/abs/1708.03888">Large Batch Training of Convolutional Networks</a></li>
</ul>
</section>
</section>
<section id="why-distributed-training-speedup" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="why-distributed-training-speedup">Why Distributed Training? Speedup!</h3>
<div id="tbl-recent-progress" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-recent-progress-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Recent progress
</figcaption>
<div aria-describedby="tbl-recent-progress-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Author</th>
<th style="text-align: center;">GPU</th>
<th style="text-align: center;">Batch Size</th>
<th style="text-align: center;"># GPU</th>
<th style="text-align: center;">TIME (s)</th>
<th style="text-align: center;">ACC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2016</td>
<td style="text-align: center;">He</td>
<td style="text-align: center;">P100</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;"><span class="red-bg">8</span></td>
<td style="text-align: center;"><span class="red-bg">104,400</span></td>
<td style="text-align: center;">75.30%</td>
</tr>
<tr class="even">
<td style="text-align: center;">2019</td>
<td style="text-align: center;">Yamazaki</td>
<td style="text-align: center;">V100</td>
<td style="text-align: center;">81,920</td>
<td style="text-align: center;"><span class="blue-bg">2048</span></td>
<td style="text-align: center;"><span class="blue-bg">72</span></td>
<td style="text-align: center;">75.08%</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
<section id="dealing-with-data" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="dealing-with-data">Dealing with Data</h4>
<ul>
<li>At each training step, we want to ensure that <strong>each worker receives unique data</strong></li>
<li>This can be done in one of two ways:
<ol type="1">
<li>Manually partition data (ahead of time)
<ul>
<li>Assign <strong>unique subsets</strong> to each worker</li>
<li>Each worker can only see their local portion of the data</li>
<li>Most common approach</li>
</ul></li>
<li>From each worker, randomly select a mini-batch
<ul>
<li>Each worker can see the full dataset</li>
<li>‚ö†Ô∏è When randomly selecting, it is important that each worker uses different seeds to ensure they receive unique data</li>
</ul></li>
</ol></li>
</ul>
</section>
<section id="broadcast-initial-state" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="broadcast-initial-state">Broadcast Initial State</h4>
<ul>
<li>At the start of training (or when loading from a checkpoint), we want all of our workers to be initialized consistently
<ul>
<li><strong>Broadcast</strong> the model and optimizer states from <code>rank() == 0</code> worker</li>
</ul></li>
</ul>
<div id="fig-broadcast" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
0["GPU0"] --&gt; 1["GPU 1"]
0 --&gt; 2["GPU 2"]
0 --Model + Optim. State--&gt;3["GPU 3"]
0 --&gt; ...
0 --&gt; N["GPU N"]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-broadcast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: To ensure all workers have the same copies, we load on <code>RANK==0</code> and <code>broadcast</code>
</figcaption>
</figure>
</div>
</section>
<section id="best-practices" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="best-practices">Best Practices</h4>
<div class="flex-container">
<div class="column" style="width:50%;">
<ul>
<li>Use parallel IO whenever possible
<ul>
<li>Feed each rank from different files</li>
<li>Use MPI IO to have each rank read its own batch from a file</li>
<li>Use several ranks to read data, MPI to scatter to remaining ranks
<ul>
<li>Most practical in big <em>at-scale</em> training</li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="column" style="width:50%;">
<ul>
<li>Take advantage of data storage
<ul>
<li>Use <a href="https://wiki.lustre.org/Configuring_Lustre_File_Striping">striping on lustre</a></li>
</ul></li>
<li>Use the right optimizations for Aurora, Polaris, etc.</li>
<li>Preload data when possible
<ul>
<li>Offloading to a GPU frees CPU cycles for loading the next batch of data
<ul>
<li><strong>minimize IO latency this way</strong></li>
</ul></li>
</ul></li>
<li>Communication Bottleneck</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="‚è∞ Keeping things in Sync">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>‚è∞ Keeping things in Sync
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>Computation stalls during communication !!</strong></p>
<p>Keeping the communication to computation ratio small is important for effective scaling.</p>
</div>
</div>
</div>
</section>
<section id="data-parallelism" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="data-parallelism">Data Parallelism</h4>
<ul>
<li>Useful when model fits on single GPU
<ul>
<li>ultimately limited by GPU memory</li>
</ul></li>
<li>When model does not fit on a single GPU:
<ul>
<li><iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> <code>DeepSpeed</code> + <a href="https://www.deepspeed.ai/tutorials/zero/"><code>ZeRO</code></a></li>
<li><a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">PyTorch + FSDP</a></li>
</ul></li>
</ul>
</section>
<section id="going-beyond-data-parallelism-zero" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="going-beyond-data-parallelism-zero">Going beyond Data Parallelism: <iconify-icon inline="" icon="logos:microsoft-icon" aria-label="Icon microsoft-icon from logos Iconify.design set." title="Icon microsoft-icon from logos Iconify.design set."></iconify-icon> ZeRO</h4>
<ul>
<li>Depending on the <code>ZeRO</code> stage (1, 2, 3), we can offload:
<ol type="1">
<li><strong>Stage 1</strong>: optimizer states</li>
<li><strong>Stage 2</strong>: gradients + opt. states</li>
<li><strong>Stage 3</strong>: model params + grads + opt. states</li>
</ol></li>
</ul>
<div id="fig-zero" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/zero.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;10: DeepSpeed + ZeRO"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/zero.png" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: <a href="deepspeed.ai">DeepSpeed</a> + <a href="https://www.deepspeed.ai/tutorials/zero-offload/"><code>ZeRO</code></a>
</figcaption>
</figure>
</div>
</section>
<section id="fully-sharded-data-parallel-fsdp" class="level4 smaller" data-background-color="white">
<h4 class="smaller anchored" data-background-color="white" data-anchor-id="fully-sharded-data-parallel-fsdp">Fully Sharded Data Parallel (FSDP)</h4>
<ul>
<li>Instead of maintaining per-GPU copy of <code>{params, grads, opt_states}</code>, FSDP shards (distributes) these across data-parallel workers
<ul>
<li>can optionally offload the sharded model params to CPU</li>
</ul></li>
<li><a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">Introducing PyTorch Fully Sharded Data Parallel (FSDP) API | PyTorch</a></li>
</ul>
<div id="fig-fsdp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fsdp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/fsdp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;11: FSDP Workflow. Source"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/fsdp.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fsdp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: FSDP Workflow. <a href="https://pytorch.org/blog/introducing-pytorch-fully-sharded-data-parallel-api/">Source</a>
</figcaption>
</figure>
</div>
</section>
<section id="pipeline-parallel-pp" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="pipeline-parallel-pp">Pipeline Parallel (PP)</h4>
<div class="flex-container" style="place-content: end space-evenly;">
<div class="column" style="width:35%;">
<ul>
<li>Model is split up vertically (layer-level) across multiple GPUs</li>
<li>Each GPU:
<ul>
<li>has a portion of the full model</li>
<li>processes <em>in parallel</em> different stages of the pipeline (on a small chunk of the batch)</li>
</ul></li>
</ul>
</div>
<div class="column" style="width:55%;">
<div id="fig-pipeline-parallelism" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pipeline-parallelism-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/pipeline_parallelism.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;12: Pipeline Parallelism"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/pipeline_parallelism.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pipeline-parallelism-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: <a href="https://www.deepspeed.ai/tutorials/pipeline/">Pipeline Parallelism</a>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="tensor-parallel-tp" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="tensor-parallel-tp">Tensor Parallel (TP)</h4>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Each tensor is split up into multiple chunks</li>
<li>Each shard of the tensor resides on its designated GPU</li>
<li>During processing each shard gets processed separately (and in parallel) on different GPUs
<ul>
<li>synced at the end of the step</li>
</ul></li>
<li>This is what one may call <em>horizontal parallelism</em></li>
</ul>
<p>See: <a href="https://huggingface.co/docs/transformers/v4.15.0/parallelism">ü§ó Model Parallelism</a> for additional details</p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-model-parallel-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/model-parallel.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;13: Tensor Parallel Training"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/model-parallel.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Tensor Parallel Training
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="model-parallel-training" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="model-parallel-training">Model Parallel Training</h4>
<div class="flex-container">
<div class="column" style="width:60%;">
<ul>
<li>Split up network over multiple workers
<ul>
<li>Each receives disjoint subset</li>
<li>All communication associated with subsets are distributed</li>
</ul></li>
<li>Communication whenever dataflow between two subsets</li>
<li>Typically <strong>more complicated</strong> to implement than data parallel training</li>
<li>Suitable when the model is too large to fit onto a single device (CPU / GPU)</li>
<li><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a></li>
<li>ü§ó <a href="https://github.com/huggingface/nanotron"><code>huggingface/nanotron</code></a></li>
</ul>
</div>
<div class="column" style="width:40%;">
<div id="fig-model-parallel-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/model-parallel.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;14: "><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/model-parallel.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-model-parallel-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="tensor-model-parallel-training-example" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="tensor-model-parallel-training-example">Tensor (/ Model) Parallel Training: Example</h4>
<p>Want to compute: <img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csum_%7Bi%7D%20x_%7Bi%7D%20W_%7Bi%7D%20=%20x_0%20*%20W_0%20+%20x_1%20*%20W_1%20+%20x_2%20*%20W_2"><br>
where each GPU only has only its portion of the full weights as shown below</p>
<ol type="1">
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y_%7B0%7D%20=%20x_%7B0%7D%20*%20W_%7B0%7D%5Crightarrow"> <code>GPU1</code></li>
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y_%7B1%7D%20=%20y_%7B0%7D%20+%20x_%7B1%7D%20*%20W_%7B1%7D%5Crightarrow"> <code>GPU2</code></li>
<li>Compute: <img src="https://latex.codecogs.com/png.latex?y%20=%20y_%7B1%7D%20+%20x_%7B2%7D%20*%20W_%7B2%7D%20=%20%5Csum_%7Bi%7D%20x_%7Bi%7D%20W_%7Bi%7D"> ‚úÖ</li>
</ol>
<div id="fig-tensor-parallel-example" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:75%; margin-left: auto; margin-right: auto; text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tensor-parallel-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph X0["`GPU0`"]
        direction LR
        a("`W‚ÇÄ`")
    end
    subgraph X1["`GPU1`"]
        direction LR
        b("`W‚ÇÅ`")
    end
    subgraph X2["`GPU2`"]
        direction LR
        c("`W‚ÇÇ`")
    end
  t0("`x‚ÇÄ`")--&gt;X0
  X0 --&gt;|"`x‚ÇÄ W‚ÇÄ`"|X1
  X1 --&gt;|"`x‚ÇÄ W‚ÇÄ &lt;br&gt;+ x‚ÇÅ W‚ÇÅ`"|X2
  t1("`x‚ÇÅ`") --&gt; X1
  t2("`x‚ÇÇ`") --&gt; X2
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-tensor-parallel-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15
</figcaption>
</figure>
</div>
<div class="footer">

</div>
</section>
<section id="tensor-model-parallelismefficient-large-scale" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="tensor-model-parallelismefficient-large-scale">Tensor (Model) Parallelism<sup>2</sup></h4>
<ul>
<li>In <strong>Tensor Paralleism</strong> each GPU processes only a slice of a tensor and only aggregates the full tensor for operations that require the whole thing.
<ul>
<li>The main building block of any transformer is a fully connected <code>nn.Linear</code> followed by a nonlinear activation GeLU.
<ul>
<li><code>Y = GeLU(XA)</code>, where X and Y are the input and output vectors, and A is the weight matrix.</li>
</ul></li>
<li>If we look at the computation in matrix form, it‚Äôs easy to see how the matrix multiplication can be split between multiple GPUs:</li>
</ul></li>
</ul>
</section>
<section id="tensor-parallelism" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="tensor-parallelism">Tensor Parallelism</h4>
<div id="fig-parallel-gemm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parallel-gemm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/parallelism-tp-parallel_gemm.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;16: Tensor Parallel GEMM. This information is based on (the much more in-depth) TP Overview by @anton-l"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/parallelism-tp-parallel_gemm.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parallel-gemm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Tensor Parallel GEMM. This information is based on (the much more in-depth) <a href="https://github.com/huggingface/transformers/issues/10321#issuecomment-783543530">TP Overview</a> by <a href="https://github.com/anton-l">@anton-l</a>
</figcaption>
</figure>
</div>
</section>
<section id="d-parallelism" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="d-parallelism">3D Parallelism</h4>
<ul>
<li><code>DP</code> + <code>TP</code> + <code>PP</code> (3D) Parallelism</li>
</ul>
<div id="fig-3dparallel" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center!important;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-3dparallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/parallelism-deepspeed-3d.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;17: Figure taken from 3D parallelism: Scaling to trillion-parameter models"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/parallelism-deepspeed-3d.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3dparallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Figure taken from <a href="https://www.microsoft.com/en-us/research/blog/deepspeed-extreme-scale-model-training-for-everyone/">3D parallelism: Scaling to trillion-parameter models</a>
</figcaption>
</figure>
</div>
</section>
<section id="deciding-on-a-parallelism-strategy" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="deciding-on-a-parallelism-strategy">Deciding on a Parallelism Strategy</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Single GPU</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Single Node / Multi-GPU</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Multi-Node / Multi-GPU</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<ul>
<li>Model fits onto a single GPU:
<ul>
<li>Normal use</li>
</ul></li>
<li>Model <strong>DOES NOT</strong> fit on a single GPU:
<ul>
<li><code>ZeRO</code> + Offload CPU (or, optionally, <code>NVMe</code>)</li>
</ul></li>
<li>Largest layer <strong>DOES NOT</strong> fit on a single GPU:
<ul>
<li><code>ZeRO</code> + Enable <a href="https://deepspeed.readthedocs.io/en/latest/zero3.html#memory-centric-tiling">Memory Centric Tiling (MCT)</a>
<ul>
<li>MCT Allows running of arbitrarily large layers by automatically splitting them and executing them sequentially.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="flex-container">
<div class="column">
<ul>
<li>Model fits onto a single GPU
<ul>
<li><a href="https://pytorch.org/docs/stable/notes/ddp.html"><code>DDP</code></a></li>
<li><a href="https://deepspeed.readthedocs.io/en/latest/zero3.html"><code>ZeRO</code></a></li>
</ul></li>
</ul>
</div>
<div class="column">
<ul>
<li>Model <strong>DOES NOT</strong> fit onto a single GPU
<ol type="1">
<li><a href="https://www.deepspeed.ai/tutorials/pipeline/">Pipeline Parallelism (<code>PP</code>)</a></li>
<li><a href="https://deepspeed.readthedocs.io/en/latest/zero3.html"><code>ZeRO</code></a></li>
<li><a href="https://pytorch.org/docs/stable/distributed.tensor.parallel.html">Tensor Parallelism (<code>TP</code>)</a></li>
</ol></li>
</ul>
</div>
</div>
<ul>
<li><p>With sufficiently fast connectivity between nodes, these three strategies should be comparable.</p>
<ul>
<li>Otherwise, <code>PP</code> <img src="https://latex.codecogs.com/png.latex?%3E"> <code>ZeRO</code> <img src="https://latex.codecogs.com/png.latex?%5Csimeq"> <code>TP</code>.</li>
</ul></li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<ul>
<li><p>When you have fast inter-node connectivity:</p>
<ul>
<li><code>ZeRO</code> (virtually <strong>NO</strong> modifications)</li>
<li><code>PP</code> + <code>ZeRO</code> + <code>TP</code> + <code>DP</code> (less communication, at the cost of <strong>MAJOR</strong> modifications)
<ul>
<li><p>when you have slow inter-node connectivity and still low on GPU memory:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DP</span> + PP + TP + ZeRO-1</span></code></pre></div></div></li>
</ul></li>
<li><strong>NOTE</strong>: <code>TP</code> is almost <em>always</em> used within a single node, e.g.<br>
<code>TP &lt;= GPUS_PER_NODE</code></li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="large-language-models" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="large-language-models">Large Language Models</h3>
<div id="fig-llms" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-llms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;18: Large Language Models have (LLM)s have taken the NLP community world by storm."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/llms.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-llms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Large Language Models have (LLM)s have taken the <del>NLP community</del> <strong>world</strong> by storm<sup>3</sup>.
</figcaption>
</figure>
</div>
<section id="emergent-abilities" class="level4" data-background-color="#FBFBFD">
<h4 data-background-color="#FBFBFD" class="anchored" data-anchor-id="emergent-abilities">Emergent Abilities</h4>
<div id="fig-emergent-abilities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emergent-abilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/emergent-abilities.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;19: Emergent abilities of Large Language Models @yao2023tree"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/emergent-abilities.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emergent-abilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: <a href="https://arxiv.org/abs/2206.07682">Emergent abilities of Large Language Models</a> <span class="citation" data-cites="yao2023tree">Yao et al. (2023)</span>
</figcaption>
</figure>
</div>
</section>
<section id="training-llms" class="level4 r-stretch" data-background-color="white">
<h4 class="r-stretch anchored" data-background-color="white" data-anchor-id="training-llms">Training LLMs</h4>
<div class="flex-container" style="align-items: flex-end; width:90%; text-align:center;">
<div class="column" style="width: 60%;">
<div id="fig-evolution" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/evolution.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;20: Visualization from @yang2023harnessing"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/evolution.gif" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Visualization from <span class="citation" data-cites="yang2023harnessing">Yang et al. (2023)</span>
</figcaption>
</figure>
</div>
</div>
<div class="column" style="width:40%;">
<div id="fig-it-hungers" class="r-stretch quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/it_hungers.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;21: It‚Äôs hungry! @wei2022emergentabilitieslargelanguage"><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/it_hungers.jpeg" class="r-stretch img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: It‚Äôs hungry! <span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="life-cycle-of-the-llm" class="level4" data-auto-animate="true" data-background-color="white">
<h4 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">Life-Cycle of the LLM</h4>
<div class="flex-container">
<div class="column" style="width: 40%;">
<ol type="1">
<li>Data collection + preprocessing</li>
<li><strong>Pre-training</strong>
<ul>
<li>Architecture decisions, model size, etc.</li>
</ul></li>
<li>Supervised Fine-Tuning
<ul>
<li>Instruction Tuning</li>
<li>Alignment</li>
</ul></li>
<li>Deploy (+ monitor, re-evaluate, etc.)</li>
</ol>
</div>
<div class="column" style="width:50%;">
<div id="fig-pretrain-two" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretrain-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;22: Pre-training: Virtually all of the compute used during pre-training."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretrain-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: <strong>Pre-training</strong>: Virtually <em>all of the compute</em> used during pre-training<sup>4</sup>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="life-cycle-of-the-llm-1" class="level4" data-auto-animate="true" data-background-color="white">
<h4 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm-1">Life-Cycle of the LLM</h4>
<div class="flex-container">
<div class="column" style="width: 50%;">
<ol type="1">
<li>Data collection + preprocessing</li>
<li>Pre-training
<ul>
<li>Architecture decisions, model size, etc.</li>
</ul></li>
<li><strong>Supervised Fine-Tuning</strong>
<ul>
<li>Instruction Tuning</li>
<li>Alignment</li>
</ul></li>
<li>Deploy (+ monitor, re-evaluate, etc.)</li>
</ol>
</div>
<div class="column" style="width:50%;">
<div id="fig-finetune-lifecycle" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-finetune-lifecycle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;23: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-finetune-lifecycle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task<sup>5</sup>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="forward-pass" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="forward-pass">Forward Pass</h4>
<div id="fig-hf-assisted-generation" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:100%;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hf-assisted-generation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/hf_assisted_generation.mov" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure&nbsp;24: Language Model trained for causal language modeling."><video src="./assets/hf_assisted_generation.mov" class="img-fluid" controls=""></video></a><a href="./assets/hf_assisted_generation.mov">Video</a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hf-assisted-generation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24: Language Model trained for causal language modeling<sup>6</sup>.
</figcaption>
</figure>
</div>
</section>
<section id="generating-text" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="generating-text">Generating Text</h4>
<div id="fig-generating-text" class="quarto-float quarto-figure quarto-figure-center anchored" style="width: 100%;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-generating-text-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/hf_assisted_generation2.mov" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure&nbsp;25: Language Model trained for causal language modeling."><video src="./assets/hf_assisted_generation2.mov" class="img-fluid" controls=""></video></a><a href="./assets/hf_assisted_generation2.mov">Video</a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-generating-text-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25: Language Model trained for causal language modeling<sup>7</sup>.
</figcaption>
</figure>
</div>
</section>
<section id="assistant-models" class="level4 centeredslide" data-background-color="#181D29">
<h4 class="centeredslide anchored" data-background-color="#181D29" data-anchor-id="assistant-models">Assistant Models</h4>
<div id="fig-assistant-models" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-assistant-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><span class="preview-image" style="text-align:center; margin-left:auto; margin-right: auto;"><a href="./assets/jailbreak.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Figure&nbsp;26: "><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/jailbreak.jpeg" class="img-fluid figure-img"></a></span></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-assistant-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26
</figcaption>
</figure>
</div>
</section>
</section>
<section id="hands-on" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="hands-on">Hands On</h3>
<p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/argonne-lcf/ALCF_Hands_on_HPC_Workshop/tree/master/ml-at-scale#hands-on">ALCF_Hands_on_HPC_Workshop / ml-at-scale</a></p>
<section id="clone-repositories" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="clone-repositories">üå± Clone Repositories</h4>
<ol type="1">
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/wordplay"><code>saforem2/wordplay/</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/wordplay</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> wordplay</span></code></pre></div></div></li>
<li><p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/ezpz"><code>saforem2/ezpz/</code></a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/ezpz deps/ezpz</span></code></pre></div></div></li>
</ol>
</section>
<section id="setup-python" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="setup-python">üêç Setup Python</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> deps/ezpz/src/ezpz/bin/utils.sh</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /eagle/argonne_tpc/foremans/tmp/2024-10-26-094746</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ezpz_setup_python</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> conda_prefix OR virtual_env found in environment...</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Setting</span> up conda...</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nvhpc/23.9"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gcc-native/12.3"</span>.</span>
<span id="cb4-9"></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-nvhpc/8.5.0"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-gnu/8.5.0"</span>.</span>
<span id="cb4-12"></span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb4-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-mpich/8.1.28</span></span>
<span id="cb4-16"></span>
<span id="cb4-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> conda at: /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb4-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> VIRTUAL_ENV found in environment!</span>
<span id="cb4-19">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Trying to setup from /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb4-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Using VENV_DIR=/eagle/argonne_tpc/foremans/tmp/2024-10-26-094746/venvs/2024-04-29</span>
<span id="cb4-21"></span>
<span id="cb4-22">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Creating a new virtual env on top of 2024-04-29 in /eagle/argonne_tpc/foremans/tmp/2024-10-26-094746/venvs/2024-04-29</span>
<span id="cb4-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[python]</span> Using /eagle/argonne_tpc/foremans/tmp/2024-10-26-094746/venvs/2024-04-29/bin/python3</span></code></pre></div></div>
</section>
<section id="setup-job" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="setup-job">Setup Job</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ezpz_setup_job</span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[üçã</span> ezpz/bin/utils.sh]</span>
<span id="cb5-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> USER=foremans</span>
<span id="cb5-4">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=polaris</span>
<span id="cb5-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOST=x3205c0s25b0n0</span>
<span id="cb5-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> TSTAMP=2024-10-26-094841</span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_get_pbs_env]:</span> Caught 0 arguments</span>
<span id="cb5-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> hostfile: /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> jobenv_file: /home/foremans/.pbsenv</span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_setup_host_pbs]</span></span>
<span id="cb5-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Using hostfile: /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Found in environment:</span>
<span id="cb5-16">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-17">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Writing PBS vars to: /home/foremans/.pbsenv</span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_save_pbs_env]</span></span>
<span id="cb5-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Setting:</span>
<span id="cb5-21">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-22">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> JOBENV_FILE: /home/foremans/.pbsenv</span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[HOSTS]</span></span>
<span id="cb5-25">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x3205c0s25b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x3205c0s25b1n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DIST</span> INFO]</span>
<span id="cb5-29">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=8</span>
<span id="cb5-30">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NHOSTS=2</span>
<span id="cb5-31">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPU_PER_HOST=4</span>
<span id="cb5-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb5-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DIST_LAUNCH=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8</span>
<span id="cb5-34"></span>
<span id="cb5-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LAUNCH]:</span></span>
<span id="cb5-36">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> To launch across all available GPUs, use: launch</span>
<span id="cb5-37"></span>
<span id="cb5-38">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/3061463.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8</span></code></pre></div></div>
</section>
<section id="install-ezpz-wordplay" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="install-ezpz-wordplay">üì¶ Install <code>{ezpz, wordplay}</code></h4>
<ol type="1">
<li><p><a href="https://github.com/saforem2/ezpz"><code>saforem2/ezpz</code></a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./deps/ezpz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div></div></li>
<li><p><a href="https://github.com/saforem2/ezpz"><code>saforem2/wordplay</code></a>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from inside `wordplay/`</span></span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div></div></li>
</ol>
</section>
<section id="launch-ezpz.test_dist" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="launch-ezpz.test_dist">üöÄ Launch <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py"><code>ezpz.test_dist</code></a></h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> unset NCCL_COLLNET_ENABLE NCCL_CROSS_NIC NCCL_NET NCCL_NET_GDR_LEVEL</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> which launch</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch:</span> aliased to mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> which python3</span>
<span id="cb8-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/tmp/polaris-talk/2024-07-17-073327/venvs/2024-04-29/bin/python3</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.test_dist</span>
<span id="cb8-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov:7919</span>
<span id="cb8-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /home/foremans/tmp/polaris-talk/2024-07-17-073327/venvs/2024-04-29/bin/python3</span>
<span id="cb8-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application cff755ee-557e-4df2-a987-db85a8b7dbe7</span>
<span id="cb8-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:30.304306]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb8-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:30.307036]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb8-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:30.307494]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:160</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To disable this behavior, and log from ALL ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">not</span> recommended<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> set: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export LOG_FROM_ALL_RANKS=1'</span>  in your environment, and re-run.</span>
<span id="cb8-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.116037]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.116089]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.116940]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.122726]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb8-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb8-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=cuda</span>
<span id="cb8-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=cuda:0</span>
<span id="cb8-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=nccl</span>
<span id="cb8-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=4</span>
<span id="cb8-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-26">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb8-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb8-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb8-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Polaris</span>
<span id="cb8-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=1</span>
<span id="cb8-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb8-32">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=4</span>
<span id="cb8-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb8-34">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb8-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb8-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=4</span>
<span id="cb8-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=4</span>
<span id="cb8-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb8-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.124800]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/4</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nccl'</span> for distributed training.</span>
<span id="cb8-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.129169]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.129674]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:364</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [4 / 4] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> devices !!</span>
<span id="cb8-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.130219]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:874</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb8-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:32.130638]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:875</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: ezpz.test_dist</span>
<span id="cb8-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.</span>
<span id="cb8-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Currently logged in as: foremans <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aurora_gpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> Use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> login <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--relogin</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to force relogin</span>
<span id="cb8-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Tracking run with wandb version 0.17.4</span>
<span id="cb8-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run data is saved locally in /home/foremans/tmp/polaris-talk/2024-07-17-073327/wandb/run-20240717_073532-p49rzxtv</span>
<span id="cb8-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> offline<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to turn off syncing.</span>
<span id="cb8-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Syncing run vibrant-river-284</span>
<span id="cb8-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ‚≠êÔ∏è View project at https://wandb.ai/aurora_gpt/ezpz.test_dist</span>
<span id="cb8-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run at https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/p49rzxtv</span>
<span id="cb8-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:33.171085]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:905</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">vibrant</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">river</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">284</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/p49rzxtv</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:33.182307]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:312</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Updating wandb.run: vibrant-river-284 config with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIST_INFO"</span></span>
<span id="cb8-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:33.186499]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:938</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Polaris'</span></span>
<span id="cb8-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:33.187790]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb8-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[timers_import]:</span></span>
<span id="cb8-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> os=1.082196831703186e-06</span>
<span id="cb8-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> logging=4.507601261138916e-07</span>
<span id="cb8-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> typing=2.9457733035087585e-06</span>
<span id="cb8-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> pathlib=1.3122335076332092e-06</span>
<span id="cb8-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> ezpz=6.109476089477539e-07</span>
<span id="cb8-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch=2.9457733035087585e-06</span>
<span id="cb8-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch_ddp=2.314336597919464e-06</span>
<span id="cb8-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> wandb=1.842435449361801e-05</span>
<span id="cb8-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> total=3.0086375772953033e-05</span>
<span id="cb8-66"></span>
<span id="cb8-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:33.188979]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb8-68"></span>
<span id="cb8-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[CONFIG]:</span></span>
<span id="cb8-70">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> warmup=0</span>
<span id="cb8-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> log_freq=1</span>
<span id="cb8-72">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> batch_size=64</span>
<span id="cb8-73">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> input_size=128</span>
<span id="cb8-74">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> output_size=128</span>
<span id="cb8-75">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> dtype=torch.float32</span>
<span id="cb8-76">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> device=cuda</span>
<span id="cb8-77">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> world_size=4</span>
<span id="cb8-78">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> train_iters=100</span>
<span id="cb8-79"></span>
<span id="cb8-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:34.761945]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:183</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model=Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb8-81">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb8-82">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-83">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-84">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-85">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-86">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-87">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-88"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.943300]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=1, loss=2152.41, sps=1.697e+04, dt=0.00377066, dtf=0.001003, dtb=0.002768</span>
<span id="cb8-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.948048]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=2, loss=1577.24, sps=3.611e+04, dt=0.00177221, dtf=0.0005256, dtb=0.001247</span>
<span id="cb8-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.952085]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=3, loss=1201.25, sps=3.59e+04, dt=0.00178271, dtf=0.0004875, dtb=0.001295</span>
<span id="cb8-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.956071]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=4, loss=1034.03, sps=3.704e+04, dt=0.0017279, dtf=0.0005082, dtb=0.00122</span>
<span id="cb8-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.959944]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=5, loss=875.796, sps=3.825e+04, dt=0.00167313, dtf=0.0005121, dtb=0.001161</span>
<span id="cb8-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.963806]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=6, loss=817.544, sps=3.804e+04, dt=0.00168248, dtf=0.0004651, dtb=0.001217</span>
<span id="cb8-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.967806]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=7, loss=734.838, sps=3.536e+04, dt=0.0018099, dtf=0.0004969, dtb=0.001313</span>
<span id="cb8-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.971741]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=8, loss=741.583, sps=3.682e+04, dt=0.00173809, dtf=0.0004537, dtb=0.001284</span>
<span id="cb8-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.975672]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=9, loss=738.157, sps=3.717e+04, dt=0.0017217, dtf=0.0004635, dtb=0.001258</span>
<span id="cb8-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.979537]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=10, loss=727.255, sps=3.857e+04, dt=0.00165911, dtf=0.0004897, dtb=0.001169</span>
<span id="cb8-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.983367]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=11, loss=715.534, sps=3.979e+04, dt=0.00160845, dtf=0.0004246, dtb=0.001184</span>
<span id="cb8-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.987262]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=12, loss=693.96, sps=3.791e+04, dt=0.00168827, dtf=0.0004543, dtb=0.001234</span>
<span id="cb8-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.991156]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=13, loss=693.518, sps=3.815e+04, dt=0.00167748, dtf=0.0004182, dtb=0.001259</span>
<span id="cb8-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.994942]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=14, loss=675.289, sps=4.003e+04, dt=0.00159879, dtf=0.0004048, dtb=0.001194</span>
<span id="cb8-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:36.999681]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=15, loss=677.706, sps=4.062e+04, dt=0.0015755, dtf=0.0004248, dtb=0.001151</span>
<span id="cb8-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.003599]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=16, loss=671.639, sps=3.754e+04, dt=0.00170499, dtf=0.000416, dtb=0.001289</span>
<span id="cb8-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.007565]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=17, loss=652.219, sps=3.704e+04, dt=0.00172777, dtf=0.0004208, dtb=0.001307</span>
<span id="cb8-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.011753]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=18, loss=633.308, sps=3.191e+04, dt=0.00200554, dtf=0.0004193, dtb=0.001586</span>
<span id="cb8-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.015595]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=19, loss=635.459, sps=3.845e+04, dt=0.0016645, dtf=0.0004236, dtb=0.001241</span>
<span id="cb8-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.019356]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=20, loss=626.979, sps=4.033e+04, dt=0.00158685, dtf=0.0004225, dtb=0.001164</span>
<span id="cb8-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.023081]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=21, loss=612.352, sps=4.105e+04, dt=0.00155914, dtf=0.0004169, dtb=0.001142</span>
<span id="cb8-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.026861]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=22, loss=609.89, sps=4.004e+04, dt=0.00159827, dtf=0.0004155, dtb=0.001183</span>
<span id="cb8-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.030555]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=23, loss=602.673, sps=4.258e+04, dt=0.00150295, dtf=0.0004166, dtb=0.001086</span>
<span id="cb8-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.034382]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=24, loss=613.106, sps=3.918e+04, dt=0.00163367, dtf=0.0004164, dtb=0.001217</span>
<span id="cb8-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.038129]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=25, loss=644.755, sps=4.173e+04, dt=0.00153368, dtf=0.0004175, dtb=0.001116</span>
<span id="cb8-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.041943]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=26, loss=789.106, sps=4.049e+04, dt=0.00158053, dtf=0.0004397, dtb=0.001141</span>
<span id="cb8-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.045705]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=27, loss=691.36, sps=4.166e+04, dt=0.00153641, dtf=0.0004157, dtb=0.001121</span>
<span id="cb8-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.049496]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=28, loss=657.228, sps=4.018e+04, dt=0.00159288, dtf=0.0004209, dtb=0.001172</span>
<span id="cb8-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.053229]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=29, loss=633.212, sps=4.19e+04, dt=0.0015274, dtf=0.0004288, dtb=0.001099</span>
<span id="cb8-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.057013]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=30, loss=640.29, sps=4.012e+04, dt=0.00159538, dtf=0.0004144, dtb=0.001181</span>
<span id="cb8-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.060722]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=31, loss=604.287, sps=4.21e+04, dt=0.00152018, dtf=0.000398, dtb=0.001122</span>
<span id="cb8-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.064489]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=32, loss=640.15, sps=4.079e+04, dt=0.00156912, dtf=0.0004007, dtb=0.001168</span>
<span id="cb8-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.068206]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=33, loss=585.789, sps=4.238e+04, dt=0.00151007, dtf=0.0004199, dtb=0.00109</span>
<span id="cb8-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.071974]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=34, loss=591.99, sps=4.053e+04, dt=0.00157917, dtf=0.000434, dtb=0.001145</span>
<span id="cb8-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.075702]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=35, loss=618.223, sps=4.168e+04, dt=0.00153538, dtf=0.0004152, dtb=0.00112</span>
<span id="cb8-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.079496]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=36, loss=572.365, sps=3.998e+04, dt=0.0016008, dtf=0.0004108, dtb=0.00119</span>
<span id="cb8-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.083250]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=37, loss=573.749, sps=4.276e+04, dt=0.00149675, dtf=0.0004123, dtb=0.001084</span>
<span id="cb8-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.086969]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=38, loss=580.662, sps=4.136e+04, dt=0.00154751, dtf=0.0004129, dtb=0.001135</span>
<span id="cb8-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.090636]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=39, loss=568.836, sps=4.311e+04, dt=0.0014847, dtf=0.000409, dtb=0.001076</span>
<span id="cb8-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.094396]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=40, loss=551.294, sps=4.145e+04, dt=0.00154388, dtf=0.0004118, dtb=0.001132</span>
<span id="cb8-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.098103]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=41, loss=573.647, sps=4.352e+04, dt=0.00147048, dtf=0.0003977, dtb=0.001073</span>
<span id="cb8-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.101867]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=42, loss=545.584, sps=4.257e+04, dt=0.00150354, dtf=0.000433, dtb=0.001071</span>
<span id="cb8-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.105639]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=43, loss=544.877, sps=4.322e+04, dt=0.00148085, dtf=0.0004117, dtb=0.001069</span>
<span id="cb8-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.109471]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=44, loss=559.886, sps=4.028e+04, dt=0.00158879, dtf=0.0004254, dtb=0.001163</span>
<span id="cb8-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.113186]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=45, loss=534.895, sps=4.311e+04, dt=0.00148444, dtf=0.0004153, dtb=0.001069</span>
<span id="cb8-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.116972]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=46, loss=536.457, sps=4.099e+04, dt=0.00156151, dtf=0.0004113, dtb=0.00115</span>
<span id="cb8-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.120710]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=47, loss=548.508, sps=4.183e+04, dt=0.00152993, dtf=0.0004151, dtb=0.001115</span>
<span id="cb8-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.124552]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=48, loss=532.186, sps=4.051e+04, dt=0.0015798, dtf=0.0004379, dtb=0.001142</span>
<span id="cb8-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.128266]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=49, loss=519.254, sps=4.272e+04, dt=0.0014981, dtf=0.0004164, dtb=0.001082</span>
<span id="cb8-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.131975]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=50, loss=535.535, sps=4.16e+04, dt=0.00153862, dtf=0.0004304, dtb=0.001108</span>
<span id="cb8-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.135717]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=51, loss=520.722, sps=4.136e+04, dt=0.00154757, dtf=0.0004158, dtb=0.001132</span>
<span id="cb8-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.139451]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=52, loss=513.063, sps=4.147e+04, dt=0.00154317, dtf=0.0004138, dtb=0.001129</span>
<span id="cb8-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.143231]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=53, loss=514.546, sps=4.038e+04, dt=0.0015848, dtf=0.0004149, dtb=0.00117</span>
<span id="cb8-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.146971]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=54, loss=506.488, sps=4.137e+04, dt=0.00154701, dtf=0.0004132, dtb=0.001134</span>
<span id="cb8-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.150659]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=55, loss=503.01, sps=4.319e+04, dt=0.0014817, dtf=0.000415, dtb=0.001067</span>
<span id="cb8-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.154441]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=56, loss=506.116, sps=4.06e+04, dt=0.00157637, dtf=0.0004211, dtb=0.001155</span>
<span id="cb8-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.158180]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=57, loss=485.523, sps=4.287e+04, dt=0.00149301, dtf=0.000414, dtb=0.001079</span>
<span id="cb8-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.161931]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=58, loss=489.076, sps=4.185e+04, dt=0.00152915, dtf=0.0004162, dtb=0.001113</span>
<span id="cb8-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.165759]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=59, loss=484.844, sps=4.134e+04, dt=0.00154802, dtf=0.0004119, dtb=0.001136</span>
<span id="cb8-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.169483]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=60, loss=496.104, sps=4.209e+04, dt=0.00152069, dtf=0.0003993, dtb=0.001121</span>
<span id="cb8-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.173190]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=61, loss=467.599, sps=4.221e+04, dt=0.00151621, dtf=0.0004142, dtb=0.001102</span>
<span id="cb8-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.176950]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=62, loss=480.055, sps=4.187e+04, dt=0.00152868, dtf=0.0004138, dtb=0.001115</span>
<span id="cb8-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.181194]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=63, loss=483.146, sps=3.656e+04, dt=0.00175062, dtf=0.0006253, dtb=0.001125</span>
<span id="cb8-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.185018]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=64, loss=479.273, sps=4.099e+04, dt=0.00156151, dtf=0.0004447, dtb=0.001117</span>
<span id="cb8-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.188752]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=65, loss=464.753, sps=4.189e+04, dt=0.00152781, dtf=0.0004161, dtb=0.001112</span>
<span id="cb8-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.192464]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=66, loss=462.583, sps=4.188e+04, dt=0.00152824, dtf=0.0004138, dtb=0.001114</span>
<span id="cb8-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.196126]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=67, loss=461.665, sps=4.272e+04, dt=0.00149801, dtf=0.0004293, dtb=0.001069</span>
<span id="cb8-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.199838]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=68, loss=465.25, sps=4.118e+04, dt=0.00155412, dtf=0.0004298, dtb=0.001124</span>
<span id="cb8-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.203602]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=69, loss=460.897, sps=4.01e+04, dt=0.00159593, dtf=0.0004131, dtb=0.001183</span>
<span id="cb8-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.207372]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=70, loss=456.136, sps=4.106e+04, dt=0.00155887, dtf=0.00041, dtb=0.001149</span>
<span id="cb8-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.211089]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=71, loss=447.565, sps=4.158e+04, dt=0.00153923, dtf=0.0004113, dtb=0.001128</span>
<span id="cb8-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.214861]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=72, loss=444.733, sps=4.05e+04, dt=0.00158026, dtf=0.0004127, dtb=0.001168</span>
<span id="cb8-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.218601]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=73, loss=459.152, sps=4.123e+04, dt=0.00155234, dtf=0.0004201, dtb=0.001132</span>
<span id="cb8-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.222334]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=74, loss=444.6, sps=4.226e+04, dt=0.00151444, dtf=0.0004371, dtb=0.001077</span>
<span id="cb8-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.226042]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=75, loss=439.884, sps=4.29e+04, dt=0.001492, dtf=0.0004154, dtb=0.001077</span>
<span id="cb8-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.229838]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=76, loss=438.578, sps=4.086e+04, dt=0.00156632, dtf=0.0004418, dtb=0.001125</span>
<span id="cb8-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.233560]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=77, loss=431.993, sps=4.327e+04, dt=0.00147909, dtf=0.0004096, dtb=0.00107</span>
<span id="cb8-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.237367]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=78, loss=422.338, sps=4.057e+04, dt=0.00157754, dtf=0.0004468, dtb=0.001131</span>
<span id="cb8-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.241117]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=79, loss=427.973, sps=4.288e+04, dt=0.00149254, dtf=0.000415, dtb=0.001077</span>
<span id="cb8-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.244895]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=80, loss=418.703, sps=4.06e+04, dt=0.00157617, dtf=0.0004137, dtb=0.001162</span>
<span id="cb8-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.248740]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=81, loss=427.645, sps=4.031e+04, dt=0.00158766, dtf=0.000415, dtb=0.001173</span>
<span id="cb8-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.252447]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=82, loss=417.629, sps=4.227e+04, dt=0.00151406, dtf=0.0004149, dtb=0.001099</span>
<span id="cb8-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.256190]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=83, loss=411.667, sps=4.189e+04, dt=0.00152778, dtf=0.0004357, dtb=0.001092</span>
<span id="cb8-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.259935]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=84, loss=409.366, sps=4.144e+04, dt=0.0015445, dtf=0.0004575, dtb=0.001087</span>
<span id="cb8-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.263677]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=85, loss=409.511, sps=4.232e+04, dt=0.00151228, dtf=0.0004035, dtb=0.001109</span>
<span id="cb8-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.267463]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=86, loss=409.593, sps=4.101e+04, dt=0.00156049, dtf=0.0004028, dtb=0.001158</span>
<span id="cb8-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.271174]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=87, loss=408.794, sps=4.3e+04, dt=0.00148828, dtf=0.0004006, dtb=0.001088</span>
<span id="cb8-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.274926]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=88, loss=403.151, sps=4.091e+04, dt=0.00156441, dtf=0.000415, dtb=0.001149</span>
<span id="cb8-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.278633]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=89, loss=402.182, sps=4.26e+04, dt=0.00150243, dtf=0.0004147, dtb=0.001088</span>
<span id="cb8-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.282372]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=90, loss=387.829, sps=4.216e+04, dt=0.00151793, dtf=0.0004411, dtb=0.001077</span>
<span id="cb8-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.286102]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=91, loss=393.108, sps=4.308e+04, dt=0.00148558, dtf=0.0004167, dtb=0.001069</span>
<span id="cb8-180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.289904]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=92, loss=389.039, sps=4.103e+04, dt=0.00155996, dtf=0.0004359, dtb=0.001124</span>
<span id="cb8-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.293618]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=93, loss=383.54, sps=4.322e+04, dt=0.00148092, dtf=0.0004147, dtb=0.001066</span>
<span id="cb8-182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.297401]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=94, loss=384.459, sps=4.1e+04, dt=0.00156106, dtf=0.0004164, dtb=0.001145</span>
<span id="cb8-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.301172]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=95, loss=376.397, sps=4.191e+04, dt=0.0015272, dtf=0.0004129, dtb=0.001114</span>
<span id="cb8-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.304924]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=96, loss=389.544, sps=4.091e+04, dt=0.00156433, dtf=0.0004139, dtb=0.00115</span>
<span id="cb8-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.308641]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=97, loss=365.041, sps=4.343e+04, dt=0.00147362, dtf=0.0004165, dtb=0.001057</span>
<span id="cb8-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.312398]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=98, loss=358.427, sps=4.134e+04, dt=0.00154796, dtf=0.0004143, dtb=0.001134</span>
<span id="cb8-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.561881]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=99, loss=375.596, sps=258.9, dt=0.247161, dtf=0.1969, dtb=0.05026</span>
<span id="cb8-188"></span>
<span id="cb8-189">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-190">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.247‚î§</span>                                                                        ‚ñù‚îÇ</span>
<span id="cb8-192">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-193">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.206‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-195">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-196">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.165‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-198">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.124‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-200">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-201">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.083‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-203">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-204">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.042‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-206">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-207">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.001‚î§‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ññ‚îÇ</span></span>
<span id="cb8-209">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-210">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0              74.5             99.0</span>
<span id="cb8-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span>                                iter</span>
<span id="cb8-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.589287]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dt.txt</span>
<span id="cb8-213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dt.txt</span>
<span id="cb8-214">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-215">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.197‚î§</span>                                                                        ‚ñù‚îÇ</span>
<span id="cb8-217">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-218">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.164‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-220">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-221">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.131‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-223">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.099‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-225">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-226">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.066‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-228">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-229">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.033‚î§</span>                                                                         ‚îÇ</span>
<span id="cb8-231">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-232">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                         ‚îÇ</span>
<span id="cb8-233"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.000‚î§‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ññ‚îÇ</span></span>
<span id="cb8-234">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-235">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0              74.5             99.0</span>
<span id="cb8-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span>                               iter</span>
<span id="cb8-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.603242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dtf.txt</span>
<span id="cb8-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dtf.txt</span>
<span id="cb8-239">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-240">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0503‚î§</span>                                                                       ‚ñù‚îÇ</span>
<span id="cb8-242">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-243">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0421‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-245">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-246">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0339‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-248">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0257‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-250">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-251">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0175‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-253">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-254">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0093‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-256">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-257">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0011‚î§‚ñö‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ññ‚îÇ</span></span>
<span id="cb8-259">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-260">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0             74.5             99.0</span>
<span id="cb8-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span>                                iter</span>
<span id="cb8-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.615896]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dtb.txt</span>
<span id="cb8-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/dtb.txt</span>
<span id="cb8-264">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-265">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2152.4‚î§‚ñò</span>                                                                       ‚îÇ</span>
<span id="cb8-267">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-268">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1853.4‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-270">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-271">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñó</span>                                                                       ‚îÇ</span>
<span id="cb8-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1554.4‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-273">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1255.4‚î§</span>                                                                        ‚îÇ</span>
<span id="cb8-275">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñó                                                                      ‚îÇ</span>
<span id="cb8-276">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb8-277"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">956.4‚î§</span>  ‚ñò                                                                     ‚îÇ</span>
<span id="cb8-278">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ññ                                                                    ‚îÇ</span>
<span id="cb8-279">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñù              ‚ññ                                                     ‚îÇ</span>
<span id="cb8-280"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">657.4‚î§</span>    ‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñö‚ññ‚ñÑ     ‚ñó ‚ñÑ                                                    ‚îÇ</span>
<span id="cb8-281">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>            ‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñò  ‚ñù‚ñò‚ñÄ‚ñó‚ñò‚ñö‚ñó‚ñÑ‚ñó‚ññ‚ñÑ‚ñó ‚ñó                                      ‚îÇ</span>
<span id="cb8-282">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                ‚ñò‚ñò‚ñù‚ñò‚ñÄ‚ñò‚ñÄ‚ñù‚ñò‚ñû‚ñó‚ñò‚ñÑ‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ                 ‚îÇ</span>
<span id="cb8-283"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">358.4‚î§</span>                                                       ‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñÄ‚ñù‚ñÄ‚ñù‚ñò‚ñÄ‚ñù‚ññ‚ñö‚ñù‚ññ‚ñÑ‚îÇ</span>
<span id="cb8-284">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-285">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0             74.5             99.0</span>
<span id="cb8-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span>                               iter</span>
<span id="cb8-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.655339]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/loss.txt</span>
<span id="cb8-288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/loss.txt</span>
<span id="cb8-289">                           <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-290">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">99.0‚î§</span>                                                                      ‚ñó‚ñó‚ññ‚ñÄ‚îÇ</span>
<span id="cb8-292">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                   ‚ñÑ‚ñù‚ñò‚ñò   ‚îÇ</span>
<span id="cb8-293">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                              ‚ñó‚ññ‚ñû‚ñù‚ñò       ‚îÇ</span>
<span id="cb8-294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82.7‚î§</span>                                                          ‚ñÑ‚ñó‚ñò‚ñÄ            ‚îÇ</span>
<span id="cb8-295">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                      ‚ññ‚ñÑ‚ñù‚ñò                ‚îÇ</span>
<span id="cb8-296">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                 ‚ñó‚ñó‚ññ‚ñÄ‚ñù                    ‚îÇ</span>
<span id="cb8-297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">66.3‚î§</span>                                              ‚ñÑ‚ñù‚ñò‚ñò                        ‚îÇ</span>
<span id="cb8-298">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                         ‚ñó‚ññ‚ñû‚ñù‚ñò                            ‚îÇ</span>
<span id="cb8-299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">50.0‚î§</span>                                     ‚ñÑ‚ñó‚ñò‚ñÄ                                 ‚îÇ</span>
<span id="cb8-300">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                 ‚ññ‚ñÑ‚ñù‚ñò                                     ‚îÇ</span>
<span id="cb8-301">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                            ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                         ‚îÇ</span>
<span id="cb8-302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33.7‚î§</span>                         ‚ñÑ‚ñù‚ñò‚ñò                                             ‚îÇ</span>
<span id="cb8-303">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                    ‚ñó‚ññ‚ñû‚ñù‚ñò                                                 ‚îÇ</span>
<span id="cb8-304">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                ‚ñÑ‚ñó‚ñò‚ñÄ                                                      ‚îÇ</span>
<span id="cb8-305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17.3‚î§</span>            ‚ññ‚ñÑ‚ñù‚ñò                                                          ‚îÇ</span>
<span id="cb8-306">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                                              ‚îÇ</span>
<span id="cb8-307">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñÑ‚ñù‚ñò‚ñò                                                                  ‚îÇ</span>
<span id="cb8-308"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0‚î§‚ññ‚ñû‚ñù‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb8-309">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-310">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5               50.0              74.5             99.0</span>
<span id="cb8-311"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span>                              iter</span>
<span id="cb8-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.669214]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/iter.txt</span>
<span id="cb8-313"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/iter.txt</span>
<span id="cb8-314">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">073537</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb8-315">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb8-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">43523.3‚î§</span>                ‚ññ‚ñó  ‚ññ‚ñó ‚ññ‚ñó ‚ññ‚ñù ‚ñö‚ñò‚ñù ‚ññ‚ñó    ‚ñò‚ñó‚ññ‚ñó‚ññ‚ññ ‚ññ‚ñÑ    ‚ñó‚ññ‚ñù ‚ññ ‚ñó‚ññ‚ñó ‚ñò‚ñó‚ñû ‚ñò‚ñó ‚ñò ‚îÇ</span>
<span id="cb8-317">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ññ ‚ñó‚ñò  ‚ñó‚ñù‚ññ  ‚ñÄ‚ñó ‚ññ‚ñù‚ñù ‚ññ‚ñù ‚ñò  ‚ññ‚ñù ‚ñò‚ñù‚ñÄ‚ñó‚ñò‚ñù ‚ñù   ‚ñù  ‚ñò‚ñû‚ñù‚ñò‚ñò ‚ñò‚ñù ‚ñö ‚ñù ‚ñò‚ñù  ‚ñù ‚ñò‚ñù ‚ñò‚îÇ</span>
<span id="cb8-318">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚ññ‚ñÄ ‚ññ‚ñû ‚ñû  ‚ñÑ ‚ñò  ‚ñù                                                      ‚îÇ</span>
<span id="cb8-319"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">36312.5‚î§‚ñù‚ñù</span>  ‚ñó                                       ‚ñù                          ‚îÇ</span>
<span id="cb8-320">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>            ‚ññ                                                          ‚îÇ</span>
<span id="cb8-321">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-322"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29101.8‚î§</span>                                                                       ‚îÇ</span>
<span id="cb8-323">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21891.1‚î§</span>                                                                       ‚îÇ</span>
<span id="cb8-325">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-326">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ññ</span>                                                                      ‚îÇ</span>
<span id="cb8-327"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14680.4‚î§</span>                                                                       ‚îÇ</span>
<span id="cb8-328">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-329">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-330"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7469.7‚î§</span>                                                                       ‚îÇ</span>
<span id="cb8-331">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-332">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb8-333">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">258.9‚î§</span>                                                                      ‚ñó‚îÇ</span>
<span id="cb8-334">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb8-335">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb8-336"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span>                                iter</span>
<span id="cb8-337"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.681268]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/sps.txt</span>
<span id="cb8-338"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/polaris-talk/2024-07-17-073327/test-dist-plots/train/sps.txt</span></code></pre></div></div>
</section>
<section id="pyinstrument-profile" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="pyinstrument-profile">PyInstrument Profile</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Recorded:</span> 07:35:34  Samples:  2227</span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Duration:</span> 2.948     CPU time: 5.441</span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PyInstrument:</span> v4.6.2</span>
<span id="cb9-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Program:</span> /home/foremans/tmp/polaris-talk/2024-07-17-073327/ezpz/src/ezpz/test_dist.py</span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.948</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/test_dist.py:1</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 2.946 main  ezpz/test_dist.py:217</span>
<span id="cb9-7">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 2.043 build_model_and_optimizer  ezpz/test_dist.py:171</span>
<span id="cb9-8">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 2.011 Adam.__init__  torch/optim/adam.py:15</span>
<span id="cb9-9">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [129 frames hidden]  torch, wandb, transformers, jax, func...</span>
<span id="cb9-10">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.326 _forward_step  ezpz/test_dist.py:231</span>
<span id="cb9-11">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îú‚îÄ 0.279 DistributedDataParallel._wrapped_call_impl  torch/nn/modules/module.py:1528</span>
<span id="cb9-12">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ     [13 frames hidden]  torch, wandb, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>built-in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb9-13">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ        0.273 Network._call_impl  torch/nn/modules/module.py:1534</span>
<span id="cb9-14">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ        ‚îî‚îÄ 0.076 Network.forward  ezpz/test_dist.py:164</span>
<span id="cb9-15">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ           ‚îî‚îÄ 0.076 Sequential._wrapped_call_impl  torch/nn/modules/module.py:1528</span>
<span id="cb9-16">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ                 [7 frames hidden]  torch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>built-in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb9-17">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.046 calc_loss  ezpz/test_dist.py:168</span>
<span id="cb9-18">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.254 _backward_step  ezpz/test_dist.py:236</span>
<span id="cb9-19">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îú‚îÄ 0.177 Tensor.backward  torch/_tensor.py:466</span>
<span id="cb9-20">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ     [4 frames hidden]  torch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>built-in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb9-21">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.077 wrapper  torch/optim/optimizer.py:374</span>
<span id="cb9-22">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [5 frames hidden]  torch</span>
<span id="cb9-23">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.119 tplot_dict  ezpz/plot.py:136</span>
<span id="cb9-24">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.069 show  plotext/_core.py:292</span>
<span id="cb9-25">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [5 frames hidden]  plotext</span>
<span id="cb9-26">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.102 Logger.info  logging/__init__.py:1479</span>
<span id="cb9-27">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     [6 frames hidden]  logging, rich</span>
<span id="cb9-28">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        0.102 RichHandler.emit  rich/logging.py:126</span>
<span id="cb9-29">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        ‚îî‚îÄ 0.100 Console.print  ezpz/log/console.py:79</span>
<span id="cb9-30">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚îî‚îÄ 0.100 Console.print  rich/console.py:1624</span>
<span id="cb9-31">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                 [5 frames hidden]  rich</span>
<span id="cb9-32">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 0.099 Run.wrapper  wandb/sdk/wandb_run.py:418</span>
<span id="cb9-33">         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[13</span> frames hidden]  wandb, json</span>
<span id="cb9-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.876629]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:115</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving pyinstrument profile output to: /home/foremans/tmp/polaris-talk/2024-07-17-073327/ezpz_pyinstrument_profiles</span>
<span id="cb9-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.877255]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:123</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> PyInstrument profile saved <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span> html<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to:</span>  /home/foremans/tmp/polaris-talk/2024-07-17-073327/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-17-073537.html</span>
<span id="cb9-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:37.877936]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:131</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> PyInstrument profile saved <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span> text<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to:</span>  /home/foremans/tmp/polaris-talk/2024-07-17-073327/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-17-073537.txt</span>
<span id="cb9-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:38.391628]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Finished with pyinstrument profiler. Took: 2.94768s</span>
<span id="cb9-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:35:38.392519]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:318</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> runtime=8.075730s</span>
<span id="cb9-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run vibrant-river-284 at: https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/p49rzxtv</span>
<span id="cb9-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Find logs at: wandb/run-20240717_073532-p49rzxtv/logs</span>
<span id="cb9-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Application</span> cff755ee resources: utime=25s stime=23s maxrss=1434396KB inblock=32 oublock=4320 minflt=670179 majflt=864 nvcsw=195893 nivcsw=1331214</span></code></pre></div></div>
</section>
<section id="ezpz-example-video" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="ezpz-example-video">üçã <a href="https://github.com/saforem2/ezpz"><code>ezpz</code></a>: Example [<a href="https://asciinema.org/a/668460">video</a>]</h4>
<div id="fig-ezpz-asciinema" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ezpz-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<script src="https://asciinema.org/a/668460.js" id="asciicast-668460" async="true"></script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ezpz-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27: Example: using <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py">üçã <code>ezpz.test_dist</code></a> to train a small model using DDP
</figcaption>
</figure>
</div>
</section>
<section id="install-wordplay" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="install-wordplay">Install <a href="https://github.com/saforem2/wordplay"><code>wordplay</code> üéÆüí¨</a></h4>
<div id="fig-nanoGPT" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nanoGPT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/nanogpt.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Figure&nbsp;28: The simplest, fastest repository for training / finetuning GPT based models."><img src="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/nanogpt.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nanoGPT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28: The simplest, fastest repository for training / finetuning GPT based models.
</figcaption>
</figure>
</div>
</section>
<section id="prepare-data" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="prepare-data">Prepare Data</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 wordplay/data/shakespeare_char/prepare.py</span>
<span id="cb10-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> HF_DATASETS_CACHE=/home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/.cache/huggingface</span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">length</span> of dataset in characters: 1,115,394</span>
<span id="cb10-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">all</span> the unique characters:</span>
<span id="cb10-5"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">!$</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">\',-.3:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span></span>
<span id="cb10-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab</span> size: 65</span>
<span id="cb10-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train</span> has 1,003,854 tokens</span>
<span id="cb10-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">val</span> has 111,540 tokens</span></code></pre></div></div>
</section>
<section id="launch-training-ddp" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="launch-training-ddp">Launch Training (DDP)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> wordplay <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-2">    train.backend=DDP <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">    train.eval_interval=100 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">    data=shakespeare <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">    train.dtype=bf16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">    model.batch_size=64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">    model.block_size=1024 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">    train.max_iters=1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-9">    train.log_interval=10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-10">    train.compile=false <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> wordplay-gpt2-DDP.log</span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.746540]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.748763]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb11-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.749453]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:160</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To disable this behavior, and log from ALL ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">not</span> recommended<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> set: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export LOG_FROM_ALL_RANKS=1'</span>  in your environment, and re-run.</span>
<span id="cb11-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:11.772718]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:81</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting HF_DATASETS_CACHE to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/.cache/huggingface/datasets</span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.341532]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.342381]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.342430]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.348657]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb11-21"></span>
<span id="cb11-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb11-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=cuda</span>
<span id="cb11-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=cuda:0</span>
<span id="cb11-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=nccl</span>
<span id="cb11-26">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=4</span>
<span id="cb11-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb11-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x3101c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb11-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb11-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Polaris</span>
<span id="cb11-32">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=1</span>
<span id="cb11-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb11-34">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=4</span>
<span id="cb11-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb11-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb11-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb11-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=4</span>
<span id="cb11-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=4</span>
<span id="cb11-40">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2024084.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb11-41"></span>
<span id="cb11-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.351446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/4</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nccl'</span> for distributed training.</span>
<span id="cb11-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.356169]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.356692]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:364</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [4 / 4] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> devices !!</span>
<span id="cb11-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.359571]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:317</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Loading val from /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/val.bin</span>
<span id="cb11-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.360138]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:317</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Loading train from /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/data/shakespeare_char/train.bin</span>
<span id="cb11-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.361154]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:442</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Tokens per iteration: 262,144</span>
<span id="cb11-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.361574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:465</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using self.ptdtype=torch.float16 on self.device_type=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span></span>
<span id="cb11-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362002]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:471</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Initializing a new model from scratch</span>
<span id="cb11-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362529]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:874</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb11-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:15.362896]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:875</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: WordPlay</span>
<span id="cb11-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.451786]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:905</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">still</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">frog</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">17</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/WordPlay/runs/6by9vpcj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.464106]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:312</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Updating wandb.run: still-frog-17 config with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIST_INFO"</span></span>
<span id="cb11-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.469424]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:938</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Polaris'</span></span>
<span id="cb11-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.471151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__:89</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> {</span>
<span id="cb11-56">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"framework"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pytorch"</span>,</span>
<span id="cb11-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"backend"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb11-59">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"device"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-60">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-61">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"port"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-62">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ds_config_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-63">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-64">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ngpus"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb11-65">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb11-66">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb11-67">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 10,</span>
<span id="cb11-68">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 200,</span>
<span id="cb11-69">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_only"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb11-70">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"always_save_checkpoint"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb11-71">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_from"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scratch"</span>,</span>
<span id="cb11-72">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wandb_project"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WordPlay"</span>,</span>
<span id="cb11-73">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1000,</span>
<span id="cb11-74">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"warmup_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb11-75">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dtype"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span>,</span>
<span id="cb11-76">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"compile"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb11-77">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-78">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-79">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_layer"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb11-80">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_head"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb11-81">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_embd"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 768,</span>
<span id="cb11-82">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 64,</span>
<span id="cb11-83">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"block_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1024,</span>
<span id="cb11-84">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"activation"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gelu"</span>,</span>
<span id="cb11-85">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dropout"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0,</span>
<span id="cb11-86">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bias"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb11-87">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vocab_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 65</span>
<span id="cb11-88">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-89">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-90">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dataset"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shakespeare_char"</span>,</span>
<span id="cb11-91">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"out_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"out-shakespeare-char"</span>,</span>
<span id="cb11-92">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"root_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb11-93">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb11-94">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"optimizer"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb11-95">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gas"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb11-96">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AdamW"</span>,</span>
<span id="cb11-97">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"learning_rate"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0006,</span>
<span id="cb11-98">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_decay"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.1,</span>
<span id="cb11-99">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta1"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.9,</span>
<span id="cb11-100">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beta2"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.95,</span>
<span id="cb11-101">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grad_clip"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.0,</span>
<span id="cb11-102">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"decay_lr"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb11-103">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr_decay_iters"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 600000,</span>
<span id="cb11-104">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_lr"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 6e-05</span>
<span id="cb11-105">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-106"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.474305]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__:90</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Output dir: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb11-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:16.474922]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:246</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Initializing a new model from scratch</span>
<span id="cb11-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.258904]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:255</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> number of parameters: 85.00M</span>
<span id="cb11-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.290004]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:264</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Model size: num_params=85003776</span>
<span id="cb11-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.292626]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:445</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> num decayed parameter tensors: 50, with 85,771,008 parameters</span>
<span id="cb11-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.293296]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:449</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> num non-decayed parameter tensors: 25, with 19,200 parameters</span>
<span id="cb11-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515324]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:1'"</span></span>
<span id="cb11-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515340]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:2'"</span></span>
<span id="cb11-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:17.515465]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:3'"</span></span>
<span id="cb11-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:18.431814]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">model:465</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> using fused AdamW: True</span>
<span id="cb11-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:18.432620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:316</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devid='cuda:0'"</span></span>
<span id="cb11-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.951020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:356</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.model=GPT<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-119">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-120">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wte</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-121">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wpe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-122">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drop</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-123">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleList<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-124">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0-11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12 x Block<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-125">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-126">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CausalSelfAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-127">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2304, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-128">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-129">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-130">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resid_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-131">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-132">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-133">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> MLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-134">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_fc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-135">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">act_fn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GELU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">approximate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-136">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-137">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-138">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-139">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-140">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-141">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-142">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-143">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-144"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.955340]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:357</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.grad_scaler=<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>torch.cuda.amp.grad_scaler.GradScaler object at 0x145a38f0f090<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb11-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.956897]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.model_engine=DistributedDataParallel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-147">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GPT<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-148">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-149">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wte</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-150">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wpe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Embedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024,</span> 768<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-151">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drop</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-152">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleList<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-153">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0-11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12 x Block<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-154">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-155">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CausalSelfAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-156">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2304, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-157">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-158">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attn_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-159">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resid_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-160">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-161">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-162">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> MLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-163">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_fc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-164">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">act_fn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> GELU<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">approximate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-165">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">c_proj</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3072, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-166">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-167">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-168">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-169">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-170">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ln_f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LayerNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-171">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-172">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-173">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-174"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.961066]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:359</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> ‚Ä¢ self.optimizer=AdamW <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Parameter</span> Group 0</span>
<span id="cb11-177">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">amsgrad:</span> False</span>
<span id="cb11-178">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">betas:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.95<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-179">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">capturable:</span> False</span>
<span id="cb11-180">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">differentiable:</span> False</span>
<span id="cb11-181">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eps:</span> 1e-08</span>
<span id="cb11-182">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foreach:</span> None</span>
<span id="cb11-183">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> True</span>
<span id="cb11-184">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 0.0006</span>
<span id="cb11-185">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maximize:</span> False</span>
<span id="cb11-186">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay:</span> 0.1</span>
<span id="cb11-187"></span>
<span id="cb11-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Parameter</span> Group 1</span>
<span id="cb11-189">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">amsgrad:</span> False</span>
<span id="cb11-190">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">betas:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.95<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-191">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">capturable:</span> False</span>
<span id="cb11-192">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">differentiable:</span> False</span>
<span id="cb11-193">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eps:</span> 1e-08</span>
<span id="cb11-194">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foreach:</span> None</span>
<span id="cb11-195">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> True</span>
<span id="cb11-196">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 0.0006</span>
<span id="cb11-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maximize:</span> False</span>
<span id="cb11-198">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay:</span> 0.0</span>
<span id="cb11-199"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:19.988827]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:802</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Startup time: 6.7125</span>
<span id="cb11-201">                <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Training</span> Legend</span>
<span id="cb11-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì</span></span>
<span id="cb11-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>    abbr     ‚îÉ desc                           ‚îÉ</span>
<span id="cb11-204"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©</span></span>
<span id="cb11-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    step     ‚îÇ Current training iteration     ‚îÇ</span>
<span id="cb11-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    loss     ‚îÇ Loss value                     ‚îÇ</span>
<span id="cb11-207"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dt      ‚îÇ Elapsed time per training step ‚îÇ</span>
<span id="cb11-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dtf     ‚îÇ Elapsed time per forward step  ‚îÇ</span>
<span id="cb11-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     dtb     ‚îÇ Elapsed time per backward step ‚îÇ</span>
<span id="cb11-210"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     sps     ‚îÇ Samples per second             ‚îÇ</span>
<span id="cb11-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> sps_per_gpu ‚îÇ Samples per second <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per</span> GPU<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb11-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     tps     ‚îÇ Tokens per second              ‚îÇ</span>
<span id="cb11-213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> tps_per_gpu ‚îÇ Tokens per second <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per</span> GPU<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb11-214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     mfu     ‚îÇ Model flops utilization        ‚îÇ</span>
<span id="cb11-215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> train_loss  ‚îÇ Training loss value            ‚îÇ</span>
<span id="cb11-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  val_loss   ‚îÇ Validation loss value          ‚îÇ</span>
<span id="cb11-217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span>
<span id="cb11-218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:21.451865]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb11-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:42:21.452667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb11-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>eelEl\'<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$nltPwBSWal</span>,<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PWw</span> bbu<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>HiyP<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>FWwF <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AhW:ygrn</span> kk-<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'\'</span>KFlMwnlEfflkc,elpWaWtgml<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$Pgglhllw</span> lglhFllzczPAFHpeAAPPSltgkrWPPhlEMgcrN ggPWt-WPSSzHSkkrzzk.FFrtSSkgMll<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gFXr,hghaueaVPW-pHFF-gg,,,FF,,kbApgg</span> gg<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>aWWzzkk<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>a<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\'</span>CggHl<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bGeA</span>,FFk,,SF<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UF,,aZ</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gglee$,k.US</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kg:S,,zVzzc</span></span>
<span id="cb11-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:01.573073]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=10 loss=3.154310 dt=0.282833 dtf=0.005247 dtb=0.011417 sps=14.142633 sps_per_gpu=3.535658 tps=926851.609409 tps_per_gpu=231712.902352 mfu=46.288281 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:04.402750]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=20 loss=2.660851 dt=0.306263 dtf=0.005233 dtb=0.011419 sps=13.060678 sps_per_gpu=3.265170 tps=855944.613638 tps_per_gpu=213986.153409 mfu=45.934162 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:07.237507]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=30 loss=2.543283 dt=0.283021 dtf=0.005238 dtb=0.011245 sps=14.133211 sps_per_gpu=3.533303 tps=926234.088226 tps_per_gpu=231558.522057 mfu=45.966490 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:10.077248]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=40 loss=2.503963 dt=0.285001 dtf=0.005213 dtb=0.011471 sps=14.035061 sps_per_gpu=3.508765 tps=919801.749941 tps_per_gpu=229950.437485 mfu=45.963461 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:12.917039]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=50 loss=2.477469 dt=0.283532 dtf=0.005166 dtb=0.011294 sps=14.107763 sps_per_gpu=3.526941 tps=924566.380009 tps_per_gpu=231141.595002 mfu=45.984530 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:15.760749]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=60 loss=2.471083 dt=0.284630 dtf=0.005140 dtb=0.011224 sps=14.053326 sps_per_gpu=3.513332 tps=920998.786204 tps_per_gpu=230249.696551 mfu=45.985675 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:18.602785]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=70 loss=2.458894 dt=0.283926 dtf=0.005219 dtb=0.010383 sps=14.088155 sps_per_gpu=3.522039 tps=923281.352698 tps_per_gpu=230820.338174 mfu=45.998106 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:21.451433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=80 loss=2.489088 dt=0.285537 dtf=0.005183 dtb=0.011373 sps=14.008683 sps_per_gpu=3.502171 tps=918073.060430 tps_per_gpu=229518.265108 mfu=45.983282 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:24.302241]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=90 loss=2.471990 dt=0.300767 dtf=0.005445 dtb=0.010290 sps=13.299337 sps_per_gpu=3.324834 tps=871585.359388 tps_per_gpu=217896.339847 mfu=45.737774 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:27.153275]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=100 loss=2.445556 dt=0.285869 dtf=0.005182 dtb=0.011251 sps=13.992403 sps_per_gpu=3.498101 tps=917006.151328 tps_per_gpu=229251.537832 mfu=45.743655 train_loss=4.125778 val_loss=4.128809</span>
<span id="cb11-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:28.182553]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb11-232"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:43:28.183179]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb11-233"></span>
<span id="cb11-234"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb11-235"></span>
<span id="cb11-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Goupay</span> my winghimithell bls ger t bon sinthard ht omind be,</span>
<span id="cb11-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">And</span> lereind h py balithand frd oforondof wimon me hageas thinero mand,</span>
<span id="cb11-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Thacanes,</span></span>
<span id="cb11-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">An</span> frift ghik med d herthecke ntore thack couthen ale, t thit ang d m t h chy me fache ag, wit my hathan glat ng</span>
<span id="cb11-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:06.025837]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:760</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb11-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:06.026607]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:761</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span>
<span id="cb11-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:07.682968]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:141</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span>
<span id="cb11-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:10.519506]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=110 loss=2.433923 dt=0.285038 dtf=0.005757 dtb=0.011762 sps=14.033209 sps_per_gpu=3.508302 tps=919680.367894 tps_per_gpu=229920.091974 mfu=45.762304 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:13.362148]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=120 loss=2.429014 dt=0.284445 dtf=0.005222 dtb=0.011486 sps=14.062460 sps_per_gpu=3.515615 tps=921597.361532 tps_per_gpu=230399.340383 mfu=45.788661 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:16.210694]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=130 loss=2.402059 dt=0.285559 dtf=0.005199 dtb=0.011765 sps=14.007633 sps_per_gpu=3.501908 tps=918004.211586 tps_per_gpu=229501.052897 mfu=45.794438 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:19.061546]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=140 loss=2.374062 dt=0.285476 dtf=0.005239 dtb=0.011453 sps=14.011662 sps_per_gpu=3.502916 tps=918268.297093 tps_per_gpu=229567.074273 mfu=45.800956 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:21.917283]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=150 loss=2.365385 dt=0.285846 dtf=0.005125 dtb=0.011320 sps=13.993568 sps_per_gpu=3.498392 tps=917082.475791 tps_per_gpu=229270.618948 mfu=45.800900 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:24.771924]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=160 loss=2.317337 dt=0.280788 dtf=0.005173 dtb=0.011249 sps=14.245602 sps_per_gpu=3.561401 tps=933599.792506 tps_per_gpu=233399.948127 mfu=45.883340 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:27.626812]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=170 loss=2.256231 dt=0.284973 dtf=0.005141 dtb=0.011299 sps=14.036416 sps_per_gpu=3.509104 tps=919890.544506 tps_per_gpu=229972.636126 mfu=45.889069 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:30.480952]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=180 loss=2.216419 dt=0.286555 dtf=0.005180 dtb=0.011402 sps=13.958906 sps_per_gpu=3.489726 tps=914810.852170 tps_per_gpu=228702.713043 mfu=45.868857 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:33.337342]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=190 loss=2.145123 dt=0.291456 dtf=0.005409 dtb=0.019347 sps=13.724205 sps_per_gpu=3.431051 tps=899429.467247 tps_per_gpu=224857.366812 mfu=45.773849 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:36.194584]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=200 loss=2.068149 dt=0.285703 dtf=0.005153 dtb=0.011286 sps=14.000555 sps_per_gpu=3.500139 tps=917540.393411 tps_per_gpu=229385.098353 mfu=45.778791 train_loss=2.439494 val_loss=2.478951</span>
<span id="cb11-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:37.224149]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb11-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:44:37.224745]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb11-255"></span>
<span id="cb11-256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb11-257"></span>
<span id="cb11-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">LORTESS</span> LA:</span>
<span id="cb11-259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No,</span> sighappat selace<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> don downd sourciceans note cancen up sof liond</span>
<span id="cb11-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">This</span> and my man, werame, of re thee</span>
<span id="cb11-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Thise</span> not will I on land brond sul me a fingore<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb11-262"></span>
<span id="cb11-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FLER:</span></span>
<span id="cb11-264"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tisint</span> your not nare lame o igen,-to brorst.</span>
<span id="cb11-265"></span>
<span id="cb11-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SamERS:</span></span>
<span id="cb11-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Sin:</span></span>
<span id="cb11-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">I\'l</span> hell she lor hen w</span>
<span id="cb11-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:14.409129]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:760</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span>
<span id="cb11-270"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:14.409820]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:761</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span>
<span id="cb11-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:16.366935]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs:141</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span>
<span id="cb11-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:19.245061]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=210 loss=1.982169 dt=0.283305 dtf=0.005223 dtb=0.011284 sps=14.119042 sps_per_gpu=3.529760 tps=925305.515083 tps_per_gpu=231326.378771 mfu=45.822019 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:22.092430]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=220 loss=1.897731 dt=0.284759 dtf=0.005217 dtb=0.011187 sps=14.046945 sps_per_gpu=3.511736 tps=920580.608106 tps_per_gpu=230145.152026 mfu=45.837327 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:24.942639]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=230 loss=1.817213 dt=0.285266 dtf=0.005208 dtb=0.011446 sps=14.022003 sps_per_gpu=3.505501 tps=918945.985503 tps_per_gpu=229736.496376 mfu=45.842940 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:27.797910]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=240 loss=1.779287 dt=0.285465 dtf=0.005189 dtb=0.011220 sps=14.012250 sps_per_gpu=3.503062 tps=918306.793546 tps_per_gpu=229576.698387 mfu=45.844800 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:30.653597]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=250 loss=1.704220 dt=0.289284 dtf=0.005471 dtb=0.010346 sps=13.827253 sps_per_gpu=3.456813 tps=906182.836379 tps_per_gpu=226545.709095 mfu=45.785926 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:33.512769]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=260 loss=1.671318 dt=0.287679 dtf=0.005125 dtb=0.011250 sps=13.904380 sps_per_gpu=3.476095 tps=911237.442617 tps_per_gpu=227809.360654 mfu=45.758182 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:36.373461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=270 loss=1.650952 dt=0.298661 dtf=0.005118 dtb=0.011520 sps=13.393107 sps_per_gpu=3.348277 tps=877730.651421 tps_per_gpu=219432.662855 mfu=45.565875 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:39.236930]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=280 loss=1.573242 dt=0.285970 dtf=0.005171 dtb=0.011290 sps=13.987477 sps_per_gpu=3.496869 tps=916683.279847 tps_per_gpu=229170.819962 mfu=45.587333 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:42.100605]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=290 loss=1.533265 dt=0.286487 dtf=0.005432 dtb=0.011288 sps=13.962259 sps_per_gpu=3.490565 tps=915030.617828 tps_per_gpu=228757.654457 mfu=45.598392 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:44.964424]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:885</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> step=300 loss=1.492064 dt=0.288480 dtf=0.005355 dtb=0.011480 sps=13.865774 sps_per_gpu=3.466443 tps=908707.340870 tps_per_gpu=227176.835218 mfu=45.576766 train_loss=2.045786 val_loss=2.148510</span>
<span id="cb11-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:45.995833]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:820</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prompt'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'What is an LLM?'</span></span>
<span id="cb11-283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-17</span> 07:45:45.996497]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">trainer:824</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'response'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb11-284"></span>
<span id="cb11-285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">What</span> is an LLM<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb11-286"></span>
<span id="cb11-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RICHMORD:</span></span>
<span id="cb11-288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Char</span> stire<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> how in those are name the range hone.</span>
<span id="cb11-289"></span>
<span id="cb11-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GLOUCESTER:</span></span>
<span id="cb11-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Nay,</span> in lond<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s time the palt are worder more</span></span>
<span id="cb11-292"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">That wilt in the purpose be a pey</span></span>
<span id="cb11-293"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">And thou thine onter hands, and the which broth.</span></span>
<span id="cb11-294"></span>
<span id="cb11-295"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ELBOWINCA:</span></span>
<span id="cb11-296"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">At lie my lord with the me an arms be a s</span></span>
<span id="cb11-297"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:23.549987][INFO][trainer:760] - Saving checkpoint to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13</span></span>
<span id="cb11-298"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:23.550696][INFO][trainer:761] - Saving model to: /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13/model.pth</span></span>
<span id="cb11-299"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:25.496559][INFO][configs:141] - Appending /home/foremans/tmp/polaris-talk/outputs/runs/pytorch/DDP/2024-07-17/07-42-13 to /home/foremans/tmp/polaris-talk/2024-07-17-073327/wordplay/src/ckpts/checkpoints.log</span></span>
<span id="cb11-300"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:28.374854][INFO][trainer:885] - step=310 loss=1.444200 dt=0.299907 dtf=0.005333 dtb=0.010637 sps=13.337481 sps_per_gpu=3.334370 tps=874085.133345 tps_per_gpu=218521.283336 mfu=45.384395 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb11-301"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:31.223079][INFO][trainer:885] - step=320 loss=1.429350 dt=0.285238 dtf=0.005245 dtb=0.011485 sps=14.023353 sps_per_gpu=3.505838 tps=919034.479880 tps_per_gpu=229758.619970 mfu=45.435743 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb11-302"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:34.074957][INFO][trainer:885] - step=330 loss=1.362220 dt=0.285027 dtf=0.005165 dtb=0.011407 sps=14.033736 sps_per_gpu=3.508434 tps=919714.904826 tps_per_gpu=229928.726207 mfu=45.485355 train_loss=1.495372 val_loss=1.713714</span></span>
<span id="cb11-303"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-17 07:46:36.929464][INFO][trainer:885] - step=340 loss=1.350888 dt=0.284436 dtf=0.005199 dtb=0.011287 sps=14.062893 sps_per_gpu=3.515723 tps=921625.744709 tps_per_gpu=230406.436177 mfu=45.539549 train_loss=1.495372 val_loss=1.713714</span></span></code></pre></div></div>
</section>
<section id="wordplay-example-video" class="level4" data-background-color="white">
<h4 data-background-color="white" class="anchored" data-anchor-id="wordplay-example-video"><a href="https://github.com/saforem2/wordplay"><code>wordplay</code></a>: Example [<a href="https://asciinema.org/a/668462">video</a>]</h4>
<div id="fig-wordplay-asciinema" class="asciinema quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wordplay-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<script src="https://asciinema.org/a/668462.js" id="asciicast-668462" async="true"></script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wordplay-asciinema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29: Example: Training a LLM to talk like Shakespeare using <a href="https://github.com/saforem2/wordplay"><code>saforem2/wordplay</code> üéÆüí¨</a>
</figcaption>
</figure>
</div>
</section>
</section>
<section id="thank-you" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h3>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:///foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üôè Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üôè Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</div>
</div>
</div>
</section>
<section id="references" class="level3" data-background-color="white">





</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yang2023harnessing" class="csl-entry">
Yang, Jingfeng, Hongye Jin, Ruixiang Tang, Xiaotian Han, Qizhang Feng, Haoming Jiang, Bing Yin, and Xia Hu. 2023. <span>‚ÄúHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond.‚Äù</span> <a href="https://arxiv.org/abs/2304.13712">https://arxiv.org/abs/2304.13712</a>.
</div>
<div id="ref-yao2023tree" class="csl-entry">
Yao, Shunyu, Dian Yu, Jeffrey Zhao, Izhak Shafran, Thomas L. Griffiths, Yuan Cao, and Karthik Narasimhan. 2023. <span>‚ÄúTree of Thoughts: Deliberate Problem Solving with Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2305.10601">https://arxiv.org/abs/2305.10601</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>micro_batch_size</code> = batch_size <strong>per</strong> GPU‚Ü©Ô∏é</p></li>
<li id="fn2"><p><a href="https://arxiv.org/abs/2104.04473">Efficient Large-Scale Language Model Training on GPU Clusters</a>‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Source: <a href="https://github.com/Hannibal046/Awesome-LLM"><i class="fa-brands fa-github" aria-label="github"></i> <code>Hannibal046/Awesome-LLM</code></a>‚Ü©Ô∏é</p></li>
<li id="fn4"><p>Figure from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a>‚Ü©Ô∏é</p></li>
<li id="fn5"><p>Figure from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a>‚Ü©Ô∏é</p></li>
<li id="fn6"><p>Video from: <a href="https://huggingface.co/docs/transformers/main/en/llm_tutorial">ü§ó Generation with LLMs</a>‚Ü©Ô∏é</p></li>
<li id="fn7"><p>Video from: <a href="https://huggingface.co/docs/transformers/main/en/llm_tutorial">ü§ó Generation with LLMs</a>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2024,
  author = {Foreman, Sam},
  title = {Deep {Learning} and {Foundation} {Models} at {Scale}},
  date = {2024-10-29},
  url = {https://samforeman.me/talks/alcf-hpc-workshop-2024/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúDeep Learning and Foundation Models at
Scale.‚Äù</span> October 29. <a href="https://samforeman.me/talks/alcf-hpc-workshop-2024/slides">https://samforeman.me/talks/alcf-hpc-workshop-2024/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/alcf-hpc-workshop-2024/</guid>
  <pubDate>Tue, 29 Oct 2024 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/alcf-hpc-workshop-2024/assets/thumbnail.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>üíæ Converting Checkpoints</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/checkpoints/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="mds-hf" class="level2">
<h2 class="anchored" data-anchor-id="mds-hf">MDS ‚Äì&gt; HF</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convert_mds_to_hf()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GLOBAL_STEP=$1</span></span>
<span id="cb1-3"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CKPT_ROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$2</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CKPT_ROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/Aurora_deployment/AuroraGPT-Testing/foremans/rollback-41k8/Megatron-DeepSpeed-41800/checkpoints/ws768_ds_stage1_nl32_hs4096_mb4_seq4096_gb3072_sp1_pp1_tp1_bf16_optadamw_lr0.00020_lwf0.05/"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-6"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SRC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CKPT_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/global_step</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-7"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Converting checkpoint @ global step </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\tsrc=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/Aurora_deployment/AuroraGPT-Checkpoints/Megatron-DeepSpeed/checkpoints-to-convert/ws768_ds_stage1_nl32_hs4096_mb4_seq4096_gb3072_sp1_pp1_tp1_bf16_optadamw_lr0.00020_lwf0.05/global_step</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_hf"</span></span>
<span id="cb1-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\tdst=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> mds_to_hf.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mds_checkpoint</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/mp_rank_00_model_states.pt"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output_dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cache_dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./.cache"</span></span>
<span id="cb1-13"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unable to locate directory </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">. Exiting"</span></span>
<span id="cb1-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb1-16"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span></code></pre></div></div>
</section>
<section id="hf-to-meg-ds" class="level1">
<h1>üöß HF to Meg-DS</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">2024-10-17</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ez</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> deepspeed</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoTokenizer, AutoConfig, AutoModelForCausalLM</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.integrations <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HfDeepSpeedConfig</span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># distributed setup</span></span>
<span id="cb2-9"></span>
<span id="cb2-10">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'WORLD_SIZE'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'12'</span></span>
<span id="cb2-11">rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.setup_torch(backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span>)</span>
<span id="cb2-12">deepspeed.init_distributed()</span>
<span id="cb2-13">model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meta-llama/Llama-3.2-1B"</span></span>
<span id="cb2-14">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoConfig.from_pretrained(model_name)</span>
<span id="cb2-15">ds_config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb2-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steps_per_print"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_micro_batch_size_per_gpu"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span>: {</span>
<span id="cb2-20">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb2-21">    },</span>
<span id="cb2-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"optimizer"</span>: {</span>
<span id="cb2-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adam"</span>,</span>
<span id="cb2-24">    },</span>
<span id="cb2-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero_optimization"</span>: {</span>
<span id="cb2-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stage"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-27">    },</span>
<span id="cb2-28">}</span>
<span id="cb2-29"></span>
<span id="cb2-30">dschf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> HfDeepSpeedConfig(ds_config)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep this object alive</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now a model can be loaded.</span></span>
<span id="cb2-32">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(model_name).to(ez.get_torch_device()).to(torch.bfloat16)</span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialise Deepspeed ZeRO and store only the engine object</span></span>
<span id="cb2-34">ds_engine <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deepspeed.initialize(model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model, config_params<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ds_config)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb2-35">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(model_name)</span></code></pre></div></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> tokenize_function(examples):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> tokenizer(examples[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>], truncation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yelp_review_full"</span>)</span>
<span id="cb3-5">tokenized_datasets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(tokenize_function, batched<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-6">small_train_dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenized_datasets[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train"</span>].shuffle(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>).select(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span>
<span id="cb3-7">small_eval_dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenized_datasets[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>].shuffle(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>).select(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span></code></pre></div></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Trainer</span>
<span id="cb4-2">training_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TrainingArguments(output_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama-3.2-1B"</span>, deepspeed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ds_config)</span>
<span id="cb4-3">trainer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Trainer(model, training_args, train_dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>small_train_dataset, eval_dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>small_eval_dataset, tokenizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer)</span></code></pre></div></div>
</section>
<section id="older" class="level2">
<h2 class="anchored" data-anchor-id="older">Older</h2>
<p>Current status:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1][üëª aurora_nre_models_frameworks-2024.2.1_u1]</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][03:39:06 PM][foremans]@[x4407c6s7b0n0][/f/A/f/p/a/Megatron-DeepSpeed][üå±hzheng-data-fix][üìùü§∑üèéüí®]</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> _conversion_args=<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hf-ckpt-num-shards 1"</span></span>
<span id="cb5-4"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hf-ckpt-dir /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512"</span></span>
<span id="cb5-5"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--load-mode auto"</span></span>
<span id="cb5-6"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--save ckpt-mds-llama-3/"</span></span>
<span id="cb5-7"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tensor-model-parallel-size 1"</span></span>
<span id="cb5-8"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--pipeline-model-parallel-size 1"</span></span>
<span id="cb5-9"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-warmup-iters 2000"</span></span>
<span id="cb5-10"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--weight-decay 0.1"</span></span>
<span id="cb5-11"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--clip-grad 1"</span></span>
<span id="cb5-12"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-layers 32"</span></span>
<span id="cb5-13"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hidden-size 4096"</span></span>
<span id="cb5-14"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-attention-heads 32"</span></span>
<span id="cb5-15"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--ffn-hidden-size 14336"</span></span>
<span id="cb5-16"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--attention-dropout 0"</span></span>
<span id="cb5-17"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hidden-dropout 0"</span></span>
<span id="cb5-18"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-query-key-layer-scaling"</span></span>
<span id="cb5-19"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-key-value-heads 8"</span></span>
<span id="cb5-20"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--disable-bias-linear"</span></span>
<span id="cb5-21"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--normalization rmsnorm"</span></span>
<span id="cb5-22"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--use-rotary-position-embeddings"</span></span>
<span id="cb5-23"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--untie-embeddings-and-output-weights"</span></span>
<span id="cb5-24"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--swiglu"</span></span>
<span id="cb5-25"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--seq-length 2048"</span></span>
<span id="cb5-26"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--max-position-embeddings 2048"</span></span>
<span id="cb5-27"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--micro-batch-size 1"</span></span>
<span id="cb5-28"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--global-batch-size 24"</span></span>
<span id="cb5-29"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--train-iters 3500"</span></span>
<span id="cb5-30"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr 2e-5"</span></span>
<span id="cb5-31"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tensorboard-dir tensorboard_output"</span></span>
<span id="cb5-32"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-decay-iters 320000"</span></span>
<span id="cb5-33"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-decay-style cosine"</span></span>
<span id="cb5-34"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--log-interval 1"</span></span>
<span id="cb5-35"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--eval-iters 100"</span></span>
<span id="cb5-36"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--eval-interval 100"</span></span>
<span id="cb5-37"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--data-path /lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document"</span></span>
<span id="cb5-38"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--save-interval 1500"</span></span>
<span id="cb5-39"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--split 100,0,0"</span></span>
<span id="cb5-40"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--bf16"</span></span>
<span id="cb5-41"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tokenizer-type HFTokenizer"</span></span>
<span id="cb5-42"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tokenizer-model ALCF/custom_tokenizer.model"</span></span>
<span id="cb5-43"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--deepspeed_config ./examples_deepspeed/finetune_hf_llama/ds_config.json"</span></span>
<span id="cb5-44"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--deepspeed"</span></span>
<span id="cb5-45"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--distributed-backend ccl"</span></span>
<span id="cb5-46"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-masked-softmax-fusion"</span></span>
<span id="cb5-47"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-bias-gelu-fusion"</span></span>
<span id="cb5-48"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-bias-dropout-fusion"</span></span>
<span id="cb5-49"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-gradient-accumulation-fusion"</span></span>
<span id="cb5-50"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--repeated-dataloader"</span></span>
<span id="cb5-51"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--data-cache-path ./.cache"</span></span>
<span id="cb5-52"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--make-vocab-size-divisible-by 128512"</span></span>
<span id="cb5-53"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--vocab-size 128512"</span></span>
<span id="cb5-54"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-55"></span>
<span id="cb5-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">($(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s\n'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${_conversion_args</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb5-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--attention-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-cache-path</span> ./.cache <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> /lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span> ./examples_deepspeed/finetune_hf_llama/ds_config.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linear</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> ccl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> 100 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> 100 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> 14336 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hf-ckpt-dir</span> /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hf-ckpt-num-shards</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> 4096 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--load-mode</span> auto <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> 2e-5 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-iters</span> 320000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> cosine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> 2000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--make-vocab-size-divisible-by</span> 128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-bias-dropout-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-bias-gelu-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-gradient-accumulation-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-masked-softmax-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> rmsnorm <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--repeated-dataloader</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> ckpt-mds-llama-3/ <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> 1500 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> 100,0,0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglu</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> tensorboard_output <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> ALCF/custom_tokenizer.model <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> HFTokenizer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> 3500 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weights</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-size</span> 128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> 0.1</span></code></pre></div></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1][üëª aurora_nre_models_frameworks-2024.2.1_u1]</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][03:39:18 PM][foremans]@[x4407c6s7b0n0][/f/A/f/p/a/Megatron-DeepSpeed][üå±hzheng-data-fix][üìùü§∑üèéüí®]</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 tools/hf2megads_weight_converter.py <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div></div>
<details closed="">
<summary>
output:
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Disabling</span> local launch: multi-node application</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /flare/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/python3</span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application bdbd987f-b27b-4922-928b-5d1a166e800b</span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,424] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,457] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,568] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,571] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,575] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,578] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,584] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,608] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,614] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,615] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,630] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,686] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,698] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,711] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,716] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,723] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,724] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,726] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,731] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,737] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,755] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,766] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,780] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,798] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,840] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,870] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,870] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,872] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,873] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,877] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,896] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,902] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,932] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,934] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,957] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,028] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,029] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,150] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,218] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,218] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,219] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,078] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,078] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,103] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,104] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,104] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,106] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=13, local_rank=1, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=15, local_rank=3, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=16, local_rank=4, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=17, local_rank=5, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=12, local_rank=0, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=14, local_rank=2, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=0, local_rank=0, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:683:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb7-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=18, local_rank=6, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=19, local_rank=7, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=20, local_rank=8, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=21, local_rank=9, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=22, local_rank=10, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=23, local_rank=11, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=1, local_rank=1, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=2, local_rank=2, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=3, local_rank=3, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=4, local_rank=4, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=5, local_rank=5, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=6, local_rank=6, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=7, local_rank=7, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=8, local_rank=8, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=9, local_rank=9, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=10, local_rank=10, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=11, local_rank=11, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.116490]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=15/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.117455]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34466</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169066</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.120281]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=10/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.120280]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=11/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169075</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169076</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.124730]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=4/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.125260]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=6/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.125427]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169069</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169068</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169071</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.127167]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=8/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.127199]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=21/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169073</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34472</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129097]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=14/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129281]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=9/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129345]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=22/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=20/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34465</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.130518]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=13/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34473</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169074</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34471</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34464</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.131822]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=18/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.131816]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=19/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34469</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.133183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=7/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34470</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169072</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.192746]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.192682]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=5/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.193446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=17/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169067</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.193506]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=12/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169070</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.194435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=23/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.194529]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=16/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34468</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34463</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34467</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34474</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.198383]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:92</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb7-197"></span>
<span id="cb7-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb7-199">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=xpu</span>
<span id="cb7-200">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=xpu:0</span>
<span id="cb7-201">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=ccl</span>
<span id="cb7-202">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=12</span>
<span id="cb7-203">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4308c2s5b0n0.hostmgmt2308.cm.aurora.alcf.anl.gov'</span>]</span>
<span id="cb7-204">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/886439.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-205">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov</span>
<span id="cb7-206">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb7-207">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Aurora</span>
<span id="cb7-208">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=2</span>
<span id="cb7-209">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=24</span>
<span id="cb7-210">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=24</span>
<span id="cb7-211">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb7-212">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb7-213">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb7-214">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=24</span>
<span id="cb7-215">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=24</span>
<span id="cb7-216">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/886439.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb7-217"></span>
<span id="cb7-218"></span>
<span id="cb7-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DeepSpeed</span> C++/CUDA extension op report</span>
<span id="cb7-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NOTE:</span> Ops not installed will be just-in-time <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compiled</span> at</span>
<span id="cb7-223">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">runtime</span> if needed. Op compatibility means that your system</span>
<span id="cb7-224">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">meet</span> the required dependencies to JIT install the op.</span>
<span id="cb7-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span> compiled ops requires ninja</span>
<span id="cb7-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ninja</span> .................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">op</span> name ................ installed .. compatible</span>
<span id="cb7-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_not_implemented</span>  <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-232"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING]</span>  async_io requires the dev libaio .so object and headers but these were not found.</span>
<span id="cb7-233"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING]</span>  If libaio is already installed <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">perhaps</span> from source<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> try setting the CFLAGS and LDFLAGS environment variables to where it can be found.</span>
<span id="cb7-234"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">async_io</span> ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_adagrad</span> ............ <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_adam</span> ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">flash_attn</span> ............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused_adam</span> ............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_inference</span> .. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pack_bits</span> .............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DeepSpeed</span> general environment info:</span>
<span id="cb7-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> install path ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> version .................... 2.3.1+cxx11.abi</span>
<span id="cb7-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> install path ........... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/deps/DeepSpeed/deepspeed'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> info ................... 0.15.3+unknown, unknown, unknown</span>
<span id="cb7-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> wheel compiled w. ...... torch 2.3</span>
<span id="cb7-248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shared</span> memory <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/dev/shm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">size</span> .... 503.18 GB</span>
<span id="cb7-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.319255]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs.py:272</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">****</span> Git info for DeepSpeed: git_hash=7ef26bf git_branch=hzheng-data-fix <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">****</span></span>
<span id="cb7-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.319927]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using oneccl_bindings from: /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/oneccl_bindings_for_pytorch/__init__.py</span>
<span id="cb7-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.320347]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:727</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using ipex from: /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/intel_extension_for_pytorch/__init__.py</span>
<span id="cb7-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.320734]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:728</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/24</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb7-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.325748]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.326291]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_logger.py:68</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [24 / 24] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span> devices !!</span>
<span id="cb7-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_KVS_MODE changed to be mpi <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:pmi</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_KVS_CONNECTION_TIMEOUT changed to be 3600 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:120</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_BCAST changed to be double_tree <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_ENABLE_SYCL_KERNELS changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_SYCL_ESIMD changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_PROCESS_LAUNCHER changed to be pmix <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:hydra</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_ZE_CACHE_OPEN_IPC_HANDLES_THRESHOLD changed to be 32768 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:1000</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CCL_ALLGATHERV_MEDIUM_SIZE_THRESHOLD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.</span>
<span id="cb7-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CCL_SKIP_SCHEDULER</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.</span>
<span id="cb7-264"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">using</span> world size: 24, data-parallel-size: 24, sequence-parallel size: 1, tensor-model-parallel size: 1, pipeline-model-parallel size: 1</span>
<span id="cb7-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">accumulate</span> and all-reduce gradients in fp32 for bfloat16 data type.</span>
<span id="cb7-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">using</span> torch.bfloat16 for parameters ...</span>
<span id="cb7-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">------------------------</span> arguments <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">------------------------</span></span>
<span id="cb7-269">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">accumulate_allreduce_grads_in_fp32</span> .............. True</span>
<span id="cb7-270">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_beta1</span> ...................................... 0.9</span>
<span id="cb7-271">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_beta2</span> ...................................... 0.999</span>
<span id="cb7-272">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_eps</span> ........................................ 1e-08</span>
<span id="cb7-273">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add_bias_linear</span> ................................. False</span>
<span id="cb7-274">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add_position_embedding</span> .......................... False</span>
<span id="cb7-275">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adlr_autoresume</span> ................................. False</span>
<span id="cb7-276">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adlr_autoresume_interval</span> ........................ 1000</span>
<span id="cb7-277">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aml_data_download_path</span> .......................... None</span>
<span id="cb7-278">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_layernorm_1p</span> .............................. False</span>
<span id="cb7-279">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_query_key_layer_scaling</span> ................... False</span>
<span id="cb7-280">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_residual_connection_post_layernorm</span> ........ False</span>
<span id="cb7-281">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">async_tensor_model_parallel_allreduce</span> ........... False</span>
<span id="cb7-282">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span> ............................... 0.0</span>
<span id="cb7-283">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_softmax_in_fp32</span> ....................... False</span>
<span id="cb7-284">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">barrier_with_L1_time</span> ............................ True</span>
<span id="cb7-285">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_binary_head</span> ................................ True</span>
<span id="cb7-286">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_embedder_type</span> .............................. megatron</span>
<span id="cb7-287">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_load</span> ....................................... None</span>
<span id="cb7-288">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bf16</span> ............................................ True</span>
<span id="cb7-289">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bias_dropout_fusion</span> ............................. False</span>
<span id="cb7-290">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bias_gelu_fusion</span> ................................ False</span>
<span id="cb7-291">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">biencoder_projection_dim</span> ........................ 0</span>
<span id="cb7-292">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">biencoder_shared_query_context_model</span> ............ False</span>
<span id="cb7-293">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">block_data_path</span> ................................. None</span>
<span id="cb7-294">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_activations</span> .......................... False</span>
<span id="cb7-295">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_in_cpu</span> ............................... False</span>
<span id="cb7-296">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_num_layers</span> ........................... 1</span>
<span id="cb7-297">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">classes_fraction</span> ................................ 1.0</span>
<span id="cb7-298">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad</span> ....................................... 1.0</span>
<span id="cb7-299">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compression_training</span> ............................ False</span>
<span id="cb7-300">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_train_samples</span> .......................... 0</span>
<span id="cb7-301">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_train_tokens</span> ........................... 0</span>
<span id="cb7-302">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_valid_samples</span> .......................... 0</span>
<span id="cb7-303">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">contigious_checkpointing</span> ........................ False</span>
<span id="cb7-304">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_optimizer</span> ................................... False</span>
<span id="cb7-305">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_torch_adam</span> .................................. False</span>
<span id="cb7-306">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">create_moe_param_group</span> .......................... False</span>
<span id="cb7-307">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curriculum_learning_legacy</span> ...................... False</span>
<span id="cb7-308">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_cache_path</span> ................................. ./.cache</span>
<span id="cb7-309">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_efficiency_curriculum_learning</span> ............. False</span>
<span id="cb7-310">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_file_list</span> .................................. None</span>
<span id="cb7-311">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_impl</span> ....................................... infer</span>
<span id="cb7-312">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_parallel_random_init</span> ....................... False</span>
<span id="cb7-313">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_parallel_size</span> .............................. 24</span>
<span id="cb7-314">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_path</span> ....................................... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-315">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_per_class_fraction</span> ......................... 1.0</span>
<span id="cb7-316">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_sharding</span> ................................... True</span>
<span id="cb7-317">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataloader_type</span> ................................. single</span>
<span id="cb7-318">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DDP_impl</span> ........................................ local</span>
<span id="cb7-319">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">decoder_num_layers</span> .............................. None</span>
<span id="cb7-320">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">decoder_seq_length</span> .............................. None</span>
<span id="cb7-321">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepscale</span> ....................................... False</span>
<span id="cb7-322">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepscale_config</span> ................................ None</span>
<span id="cb7-323">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> ....................................... True</span>
<span id="cb7-324">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_activation_checkpointing</span> .............. False</span>
<span id="cb7-325">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_config</span> ................................ ./examples_deepspeed/finetune_hf_llama/ds_config.json</span>
<span id="cb7-326">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_bottleneck_size</span> ............................ 256</span>
<span id="cb7-327">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_freeze_last_layer</span> .......................... 1</span>
<span id="cb7-328">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_head_hidden_size</span> ........................... 2048</span>
<span id="cb7-329">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_local_crops_number</span> ......................... 10</span>
<span id="cb7-330">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_local_img_size</span> ............................. 96</span>
<span id="cb7-331">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_norm_last_layer</span> ............................ False</span>
<span id="cb7-332">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_teacher_temp</span> ............................... 0.07</span>
<span id="cb7-333">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_warmup_teacher_temp</span> ........................ 0.04</span>
<span id="cb7-334">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_warmup_teacher_temp_epochs</span> ................. 30</span>
<span id="cb7-335">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distribute_checkpointed_activations</span> ............. False</span>
<span id="cb7-336">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distribute_saved_activations</span> .................... False</span>
<span id="cb7-337">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distributed_backend</span> ............................. ccl</span>
<span id="cb7-338">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distributed_timeout_minutes</span> ..................... 10</span>
<span id="cb7-339">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_fused_adam</span> ................................... False</span>
<span id="cb7-340">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_inference</span> .................................... False</span>
<span id="cb7-341">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_pipeline_enabled</span> ............................. True</span>
<span id="cb7-342">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_sequence_parallel_size</span> ....................... 1</span>
<span id="cb7-343">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_path</span> .................................. None</span>
<span id="cb7-344">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_weights_in_fp32</span> ....................... False</span>
<span id="cb7-345">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">empty_unused_memory_level</span> ....................... 0</span>
<span id="cb7-346">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_expert_tensor_parallelism</span> ................ False</span>
<span id="cb7-347">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_zbh1_exact_semantics</span> ..................... False</span>
<span id="cb7-348">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_zbh1_pipeline</span> ............................ False</span>
<span id="cb7-349">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encoder_num_layers</span> .............................. 32</span>
<span id="cb7-350">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encoder_seq_length</span> .............................. 2048</span>
<span id="cb7-351">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">end_weight_decay</span> ................................ 0.1</span>
<span id="cb7-352">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eod_mask_loss</span> ................................... False</span>
<span id="cb7-353">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_interval</span> ................................... 100</span>
<span id="cb7-354">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_iters</span> ...................................... 100</span>
<span id="cb7-355">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">evidence_data_path</span> .............................. None</span>
<span id="cb7-356">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_duration_in_mins</span> ........................... None</span>
<span id="cb7-357">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_interval</span> ................................... None</span>
<span id="cb7-358">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_on_missing_checkpoint</span> ...................... False</span>
<span id="cb7-359">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_signal_handler</span> ............................. False</span>
<span id="cb7-360">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">expert_interval</span> ................................. 2</span>
<span id="cb7-361">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffn_hidden_size</span> ................................. 14336</span>
<span id="cb7-362">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">finetune</span> ........................................ False</span>
<span id="cb7-363">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">force_ds_sequence_parallel</span> ...................... False</span>
<span id="cb7-364">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp16</span> ............................................ False</span>
<span id="cb7-365">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp16_lm_cross_entropy</span> ........................... False</span>
<span id="cb7-366">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp32_residual_connection</span> ........................ False</span>
<span id="cb7-367">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_amax_compute_algo</span> ........................... most_recent</span>
<span id="cb7-368">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_amax_history_len</span> ............................ 1</span>
<span id="cb7-369">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_e4m3</span> ........................................ False</span>
<span id="cb7-370">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_hybrid</span> ...................................... False</span>
<span id="cb7-371">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_interval</span> .................................... 1</span>
<span id="cb7-372">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_margin</span> ...................................... 0</span>
<span id="cb7-373">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_wgrad</span> ....................................... True</span>
<span id="cb7-374">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global_batch_size</span> ............................... 24</span>
<span id="cb7-375">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_fusion</span> .................... False</span>
<span id="cb7-376">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">head_lr_mult</span> .................................... 1.0</span>
<span id="cb7-377">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hf_ckpt_dir</span> ..................................... /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512</span>
<span id="cb7-378">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hf_ckpt_num_shards</span> .............................. 1</span>
<span id="cb7-379">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_dropout</span> .................................. 0.0</span>
<span id="cb7-380">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size</span> ..................................... 4096</span>
<span id="cb7-381">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size_teacher</span> ............................. None</span>
<span id="cb7-382">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hysteresis</span> ...................................... 2</span>
<span id="cb7-383">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ict_head_size</span> ................................... None</span>
<span id="cb7-384">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ict_load</span> ........................................ None</span>
<span id="cb7-385">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">img_h</span> ........................................... 224</span>
<span id="cb7-386">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">img_w</span> ........................................... 224</span>
<span id="cb7-387">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indexer_batch_size</span> .............................. 128</span>
<span id="cb7-388">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indexer_log_interval</span> ............................ 1000</span>
<span id="cb7-389">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">inference</span> ....................................... False</span>
<span id="cb7-390">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">inference_batch_times_seqlen_threshold</span> .......... 512</span>
<span id="cb7-391">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">init_method_std</span> ................................. 0.02</span>
<span id="cb7-392">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">init_method_xavier_uniform</span> ...................... False</span>
<span id="cb7-393">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">initial_loss_scale</span> .............................. 4294967296</span>
<span id="cb7-394">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">iter_per_epoch</span> .................................. 1250</span>
<span id="cb7-395">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd</span> .............................................. False</span>
<span id="cb7-396">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_alpha_ce</span> ..................................... 1</span>
<span id="cb7-397">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_beta_ce</span> ...................................... 1</span>
<span id="cb7-398">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_temp</span> ......................................... 1.0</span>
<span id="cb7-399">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kill_switch_file</span> ................................ None</span>
<span id="cb7-400">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kv_channels</span> ..................................... 128</span>
<span id="cb7-401">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layernorm_epsilon</span> ............................... 1e-05</span>
<span id="cb7-402">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lazy_mpu_init</span> ................................... None</span>
<span id="cb7-403">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load</span> ............................................ None</span>
<span id="cb7-404">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_mode</span> ....................................... auto</span>
<span id="cb7-405">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_tag</span> ........................................ None</span>
<span id="cb7-406">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_teacher</span> .................................... None</span>
<span id="cb7-407">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">local_rank</span> ...................................... None</span>
<span id="cb7-408">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_batch_size_to_tensorboard</span> ................... False</span>
<span id="cb7-409">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_interval</span> .................................... 1</span>
<span id="cb7-410">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_learning_rate_to_tensorboard</span> ................ True</span>
<span id="cb7-411">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_loss_scale_to_tensorboard</span> ................... True</span>
<span id="cb7-412">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_memory_to_tensorboard</span> ....................... False</span>
<span id="cb7-413">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_num_zeros_in_grad</span> ........................... False</span>
<span id="cb7-414">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_optimizer_states_to_tensorboard</span> ............. False</span>
<span id="cb7-415">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_params_norm</span> ................................. False</span>
<span id="cb7-416">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_timers_to_tensorboard</span> ....................... False</span>
<span id="cb7-417">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_validation_ppl_to_tensorboard</span> ............... False</span>
<span id="cb7-418">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_world_size_to_tensorboard</span> ................... False</span>
<span id="cb7-419">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss_scale</span> ...................................... None</span>
<span id="cb7-420">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss_scale_window</span> ............................... 1000</span>
<span id="cb7-421">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr</span> .............................................. 2e-05</span>
<span id="cb7-422">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_iters</span> .................................. 320000</span>
<span id="cb7-423">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_samples</span> ................................ None</span>
<span id="cb7-424">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_style</span> .................................. cosine</span>
<span id="cb7-425">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_tokens</span> ................................. None</span>
<span id="cb7-426">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_fraction</span> .............................. None</span>
<span id="cb7-427">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_iters</span> ................................. 2000</span>
<span id="cb7-428">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_samples</span> ............................... 0</span>
<span id="cb7-429">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_tokens</span> ................................ None</span>
<span id="cb7-430">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make_vocab_size_divisible_by</span> .................... 128512</span>
<span id="cb7-431">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_factor</span> ..................................... 1.0</span>
<span id="cb7-432">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_prob</span> ....................................... 0.15</span>
<span id="cb7-433">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_type</span> ....................................... random</span>
<span id="cb7-434">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">masked_softmax_fusion</span> ........................... False</span>
<span id="cb7-435">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_position_embeddings</span> ......................... 2048</span>
<span id="cb7-436">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_tokens_to_oom</span> ............................... 12000</span>
<span id="cb7-437">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mem_efficient_ln</span> ................................ True</span>
<span id="cb7-438">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">memory_centric_tiled_linear</span> ..................... False</span>
<span id="cb7-439">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">merge_file</span> ...................................... None</span>
<span id="cb7-440">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">micro_batch_size</span> ................................ 1</span>
<span id="cb7-441">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min_loss_scale</span> .................................. 1.0</span>
<span id="cb7-442">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min_lr</span> .......................................... 0.0</span>
<span id="cb7-443">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp_type</span> ........................................ standard</span>
<span id="cb7-444">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mmap_warmup</span> ..................................... False</span>
<span id="cb7-445">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_eval_capacity_factor</span> ........................ 1.0</span>
<span id="cb7-446">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_expert_parallel_size</span> ........................ 1</span>
<span id="cb7-447">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_loss_coeff</span> .................................. 0.1</span>
<span id="cb7-448">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_min_capacity</span> ................................ 4</span>
<span id="cb7-449">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_token_dropping</span> .............................. True</span>
<span id="cb7-450">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_top2_2nd_expert_sampling</span> .................... True</span>
<span id="cb7-451">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_train_capacity_factor</span> ....................... 1.0</span>
<span id="cb7-452">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mos</span> ............................................. False</span>
<span id="cb7-453">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiprocessing_context</span> ......................... fork</span>
<span id="cb7-454">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_lr_state</span> ................................ False</span>
<span id="cb7-455">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_optim</span> ................................... None</span>
<span id="cb7-456">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_rng</span> ..................................... None</span>
<span id="cb7-457">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_persist_layer_norm</span> ........................... False</span>
<span id="cb7-458">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_pipeline_parallel</span> ............................ False</span>
<span id="cb7-459">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_save_optim</span> ................................... None</span>
<span id="cb7-460">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_save_rng</span> ..................................... None</span>
<span id="cb7-461">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">normalization</span> ................................... rmsnorm</span>
<span id="cb7-462">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads</span> ............................. 32</span>
<span id="cb7-463">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_teacher</span> ..................... None</span>
<span id="cb7-464">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_channels</span> .................................... 3</span>
<span id="cb7-465">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_classes</span> ..................................... 1000</span>
<span id="cb7-466">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts</span> ..................................... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-467">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts_switch</span> .............................. None</span>
<span id="cb7-468">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts_teacher</span> ............................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-469">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_key_value_heads</span> ............................. 8</span>
<span id="cb7-470">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers</span> ...................................... 32</span>
<span id="cb7-471">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers_per_virtual_pipeline_stage</span> ........... None</span>
<span id="cb7-472">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers_teacher</span> .............................. None</span>
<span id="cb7-473">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_workers</span> ..................................... 2</span>
<span id="cb7-474">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">onnx_safe</span> ....................................... None</span>
<span id="cb7-475">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">openai_gelu</span> ..................................... False</span>
<span id="cb7-476">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ....................................... adam</span>
<span id="cb7-477">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_bert_embeddings</span> .......................... False</span>
<span id="cb7-478">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">overlap_p2p_comm</span> ................................ False</span>
<span id="cb7-479">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">override_opt_param_scheduler</span> .................... False</span>
<span id="cb7-480">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params_dtype</span> .................................... torch.bfloat16</span>
<span id="cb7-481">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">partition_activations</span> ........................... False</span>
<span id="cb7-482">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">patch_dim</span> ....................................... 16</span>
<span id="cb7-483">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">perform_initialization</span> .......................... True</span>
<span id="cb7-484">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline_model_parallel_size</span> .................... 1</span>
<span id="cb7-485">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline_model_parallel_split_rank</span> .............. None</span>
<span id="cb7-486">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile</span> ......................................... None</span>
<span id="cb7-487">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_backward</span> ................................ False</span>
<span id="cb7-488">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_ranks</span> ................................... None</span>
<span id="cb7-489">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_steps</span> ................................... 2,3</span>
<span id="cb7-490">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_in_block_prob</span> ............................. 0.1</span>
<span id="cb7-491">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rampup_batch_size</span> ............................... None</span>
<span id="cb7-492">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">random_ltd</span> ...................................... False</span>
<span id="cb7-493">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rank</span> ............................................ 0</span>
<span id="cb7-494">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_granularity</span> ........................... None</span>
<span id="cb7-495">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_method</span> ................................ None</span>
<span id="cb7-496">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_num_layers</span> ............................ 1</span>
<span id="cb7-497">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote_device</span> ................................... none</span>
<span id="cb7-498">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">repeated_dataloader</span> ............................. True</span>
<span id="cb7-499">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_attention_mask</span> ............................ False</span>
<span id="cb7-500">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_iteration</span> ................................. False</span>
<span id="cb7-501">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_position_ids</span> .............................. False</span>
<span id="cb7-502">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_report_topk_accuracies</span> ................ []</span>
<span id="cb7-503">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_score_scaling</span> ......................... False</span>
<span id="cb7-504">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_seq_length</span> ............................ 256</span>
<span id="cb7-505">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_add_retriever</span> ............................. False</span>
<span id="cb7-506">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_cyclic_train_iters</span> ........................ None</span>
<span id="cb7-507">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_attention_dropout</span> ................. 0.1</span>
<span id="cb7-508">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_hidden_dropout</span> .................... 0.1</span>
<span id="cb7-509">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_layers</span> ............................ 2</span>
<span id="cb7-510">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_num_neighbors</span> ............................. 2</span>
<span id="cb7-511">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_num_retrieved_chunks</span> ...................... 2</span>
<span id="cb7-512">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_return_doc_ids</span> ............................ False</span>
<span id="cb7-513">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_workdir</span> ................................... None</span>
<span id="cb7-514">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">return_data_index</span> ............................... False</span>
<span id="cb7-515">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rope_theta</span> ...................................... 10000</span>
<span id="cb7-516">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rotary_percent</span> .................................. 1.0</span>
<span id="cb7-517">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_rate</span> ..................................... 1.0</span>
<span id="cb7-518">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">save</span> ............................................ ckpt-mds-llama-3/</span>
<span id="cb7-519">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">save_interval</span> ................................... 1500</span>
<span id="cb7-520">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scatter_gather_tensors_in_pipeline</span> .............. True</span>
<span id="cb7-521">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scattered_embeddings</span> ............................ False</span>
<span id="cb7-522">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">schedulefree_for_each</span> ........................... False</span>
<span id="cb7-523">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed</span> ............................................ 1234</span>
<span id="cb7-524">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seq_length</span> ...................................... 2048</span>
<span id="cb7-525">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sequence_parallel</span> ............................... False</span>
<span id="cb7-526">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sgd_momentum</span> .................................... 0.9</span>
<span id="cb7-527">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">short_seq_prob</span> .................................. 0.1</span>
<span id="cb7-528">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle_sample</span> .................................. False</span>
<span id="cb7-529">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">skip_train</span> ...................................... False</span>
<span id="cb7-530">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_beta1</span> ................................... 0.9</span>
<span id="cb7-531">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_beta2</span> ................................... 0.95</span>
<span id="cb7-532">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_rho</span> ..................................... 0.01</span>
<span id="cb7-533">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">split</span> ........................................... 100,0,0</span>
<span id="cb7-534">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">split_transformers</span> .............................. False</span>
<span id="cb7-535">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">squared_relu</span> .................................... False</span>
<span id="cb7-536">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">standalone_embedding_stage</span> ...................... False</span>
<span id="cb7-537">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">start_weight_decay</span> .............................. 0.1</span>
<span id="cb7-538">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">swiglu</span> .......................................... True</span>
<span id="cb7-539">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">swin_backbone_type</span> .............................. tiny</span>
<span id="cb7-540">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">synchronize_each_layer</span> .......................... False</span>
<span id="cb7-541">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor_model_parallel_size</span> ...................... 1</span>
<span id="cb7-542">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_dir</span> ................................. tensorboard_output</span>
<span id="cb7-543">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_log_interval</span> ........................ 1</span>
<span id="cb7-544">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_queue_size</span> .......................... 1000</span>
<span id="cb7-545">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">test_data_path</span> .................................. None</span>
<span id="cb7-546">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tile_factor</span> ..................................... 1</span>
<span id="cb7-547">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">timing_log_level</span> ................................ 0</span>
<span id="cb7-548">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">timing_log_option</span> ............................... minmax</span>
<span id="cb7-549">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">titles_data_path</span> ................................ None</span>
<span id="cb7-550">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to_hf_ckpt</span> ...................................... False</span>
<span id="cb7-551">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer_model</span> ................................. ALCF/custom_tokenizer.model</span>
<span id="cb7-552">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer_type</span> .................................. HFTokenizer</span>
<span id="cb7-553">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">topk</span> ............................................ 1</span>
<span id="cb7-554">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trace_dir</span> ....................................... ./trace/</span>
<span id="cb7-555">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_exact_num_epochs</span> ..................... None</span>
<span id="cb7-556">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_path</span> ................................. None</span>
<span id="cb7-557">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_desc_path</span> ................................. None</span>
<span id="cb7-558">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_doc_idx_path</span> .............................. None</span>
<span id="cb7-559">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_idx_path</span> .................................. None</span>
<span id="cb7-560">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iters</span> ..................................... 3500</span>
<span id="cb7-561">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iters_to_skip</span> ............................. None</span>
<span id="cb7-562">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_range_to_skip</span> ............................. None</span>
<span id="cb7-563">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_sample_idx_path</span> ........................... None</span>
<span id="cb7-564">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_samples</span> ................................... None</span>
<span id="cb7-565">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_shuffle_idx_path</span> .......................... None</span>
<span id="cb7-566">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_tokens</span> .................................... None</span>
<span id="cb7-567">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_impl</span> ................................ local</span>
<span id="cb7-568">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_pipeline_model_parallel_size</span> ........ 1</span>
<span id="cb7-569">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trust_remote_code</span> ............................... False</span>
<span id="cb7-570">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">universal_checkpoint</span> ............................ False</span>
<span id="cb7-571">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">untie_embeddings_and_output_weights</span> ............. True</span>
<span id="cb7-572">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_checkpoint_args</span> ............................. False</span>
<span id="cb7-573">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_checkpoint_opt_param_scheduler</span> .............. False</span>
<span id="cb7-574">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_contiguous_buffers_in_local_ddp</span> ............. True</span>
<span id="cb7-575">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_cpu_initialization</span> .......................... None</span>
<span id="cb7-576">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_dataset_only</span> ................................ False</span>
<span id="cb7-577">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_distributed_optimizer</span> ....................... False</span>
<span id="cb7-578">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn</span> .................................. False</span>
<span id="cb7-579">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_builder</span> .......................... False</span>
<span id="cb7-580">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_triton</span> ........................... False</span>
<span id="cb7-581">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_v1</span> ............................... False</span>
<span id="cb7-582">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_v2</span> ............................... False</span>
<span id="cb7-583">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_mics</span> ........................................ False</span>
<span id="cb7-584">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_one_sent_docs</span> ............................... False</span>
<span id="cb7-585">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_pin_memory</span> .................................. False</span>
<span id="cb7-586">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_ring_exchange_p2p</span> ........................... False</span>
<span id="cb7-587">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_rotary_position_embeddings</span> .................. True</span>
<span id="cb7-588">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_tutel</span> ....................................... False</span>
<span id="cb7-589">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">valid_data_path</span> ................................. None</span>
<span id="cb7-590">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">variable_seq_lengths</span> ............................ False</span>
<span id="cb7-591">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">virtual_pipeline_model_parallel_size</span> ............ None</span>
<span id="cb7-592">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_backbone_type</span> ............................ vit</span>
<span id="cb7-593">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_pretraining</span> .............................. False</span>
<span id="cb7-594">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_pretraining_type</span> ......................... classify</span>
<span id="cb7-595">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_extra_ids</span> ................................. 0</span>
<span id="cb7-596">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_file</span> ...................................... None</span>
<span id="cb7-597">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_size</span> ...................................... 128512</span>
<span id="cb7-598">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_exp_name</span> ..................................</span>
<span id="cb7-599">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_project</span> ...................................</span>
<span id="cb7-600">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_save_dir</span> ..................................</span>
<span id="cb7-601">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay</span> .................................... 0.1</span>
<span id="cb7-602">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay_incr_style</span> ......................... constant</span>
<span id="cb7-603">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">world_size</span> ...................................... 24</span>
<span id="cb7-604">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_allgather_bucket_size</span> ...................... 0.0</span>
<span id="cb7-605">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_contigious_gradients</span> ....................... False</span>
<span id="cb7-606">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_reduce_bucket_size</span> ......................... 0.0</span>
<span id="cb7-607">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_reduce_scatter</span> ............................. False</span>
<span id="cb7-608">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_stage</span> ...................................... 1.0</span>
<span id="cb7-609"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------</span> end of arguments <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">---------------------</span></span>
<span id="cb7-610"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">setting</span> number of micro-batches to constant 1</span>
<span id="cb7-611"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HFTokenizer</span> tokenizer ...</span>
<span id="cb7-612"> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> padded <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">size:</span> 128000<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> 512 dummy tokens <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> size: 128512<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-613"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> distributed is already initialized, skipping initialization ...</span>
<span id="cb7-614"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initialized <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor</span> model parallel with size 1</span>
<span id="cb7-615"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initialized <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline</span> model parallel with size 1</span>
<span id="cb7-616"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> setting <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">random</span> seeds to 1234 ...</span>
<span id="cb7-617"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initializing <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model</span> parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234</span>
<span id="cb7-618"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-619"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-620"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-621"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-622"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-623"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-624"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-625"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-626"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-627"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,879] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-628"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-629"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-630"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-631"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-632"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-633"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,882] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-634"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-635"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,882] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-636"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Entering directory <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/megatron/data'</span></span>
<span id="cb7-637"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-638"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,884] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-639"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-640"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,922] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-641"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-642"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,929] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-643"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-644"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,930] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-645"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-646"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,931] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-647"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-648"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,935] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-649"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-650"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,937] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-651"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-652"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,939] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-653"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-654"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,939] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-655"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-656"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,940] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-657"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-658"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,941] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-659"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-660"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,946] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-661"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-662"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,949] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-663"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Nothing to be done for <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'default'</span>.</span>
<span id="cb7-664"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Leaving directory <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/megatron/data'</span></span>
<span id="cb7-665"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> compiling <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset</span> index builder ...</span>
<span id="cb7-666"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> done <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> dataset index builder. Compilation time: 0.080 seconds</span>
<span id="cb7-667"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-668"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36.956560]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:479</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> building model ...</span>
<span id="cb7-669"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Before Building Model</span>
<span id="cb7-670"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB</span>
<span id="cb7-671"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 105.24 GB, percent = 9.3%</span>
<span id="cb7-672"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-673"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SEED_LAYERS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BASE_SEED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1234 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SEED_FN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None</span>
<span id="cb7-674"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> topology: {ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>4, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 4, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>5, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 6, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 7, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 8, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 9, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 10, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>11, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 11, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>13, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 13, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>14, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 14, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>15, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 15, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>16, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 16, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>17, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 17, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 18, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>19, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 19, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>20, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 20, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>21, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 21, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>22, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 22, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>23, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 23}</span>
<span id="cb7-675"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,139] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">module.py:396:_partition_layers</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Partitioning pipeline stages with method type:transformer</span>
<span id="cb7-676"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.212904: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered</span>
<span id="cb7-677"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.212925: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered</span>
<span id="cb7-678"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.213970: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered</span>
<span id="cb7-679"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.704522: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT</span>
<span id="cb7-680"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]1 GPTModelPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-681">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tied_modules</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-682">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> EmbeddingPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-683">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">word_embeddings</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> VocabParallelEmbedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-684">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-685">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-686">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-687">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-688">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-689">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-690">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-691">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-692">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-693">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-694">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-695">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-696">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-697">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-698">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-699">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-700">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-701">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-702">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-703">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-704">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-705">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-706">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-707">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-708">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-709">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-710">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-711">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-712">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-713">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-714">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-715">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-716">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-717">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-718">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-719">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-720">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-721">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-722">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-723">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-724">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-725">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-726">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-727">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-728">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-729">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-730">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-731">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-732">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-733">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-734">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-735">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-736">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-737">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-738">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-739">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-740">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-741">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-742">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-743">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-744">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-745">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-746">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-747">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-748">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-749">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-750">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-751">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-752">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-753">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-754">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-755">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-756">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-757">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-758">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-759">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-760">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-761">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-762">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-763">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-764">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-765">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-766">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-767">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-768">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-769">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-770">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-771">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-772">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-773">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-774">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-775">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-776">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-777">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-778">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-779">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-780">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-781">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-782">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-783">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-784">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-785">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-786">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-787">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-788">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-789">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-790">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-791">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-792">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-793">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-794">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-795">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-796">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-797">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-798">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-799">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-800">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-801">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-802">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-803">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-804">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-805">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-806">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-807">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-808">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-809">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-810">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-811">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-812">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-813">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-814">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-815">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-816">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-817">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-818">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-819">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-820">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-821">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-822">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-823">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-824">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-825">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-826">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-827">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-828">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-829">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-830">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-831">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-832">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-833">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-834">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-835">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-836">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-837">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-838">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-839">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-840">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-841">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-842">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-843">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-844">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-845">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-846">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-847">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-848">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-849">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-850">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-851">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-852">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-853">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-854">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-855">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-856">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-857">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-858">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-859">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-860">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-861">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-862">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-863">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-864">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-865">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-866">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-867">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-868">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-869">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-870">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-871">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-872">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-873">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-874">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-875">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-876">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-877">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-878">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-879">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-880">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-881">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-882">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-883">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-884">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-885">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-886">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-887">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-888">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-889">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-890">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-891">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-892">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-893">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-894">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-895">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-896">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-897">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-898">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-899">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-900">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-901">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-902">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-903">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-904">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-905">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-906">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-907">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-908">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-909">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-910">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-911">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-912">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-913">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-914">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-915">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-916">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-917">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-918">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-919">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-920">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-921">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-922">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-923">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-924">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-925">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-926">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-927">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-928">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-929">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-930">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-931">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-932">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-933">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-934">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-935">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-936">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-937">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-938">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-939">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-940">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-941">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-942">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-943">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-944">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-945">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-946">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-947">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-948">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-949">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-950">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-951">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-952">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-953">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-954">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-955">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-956">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-957">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-958">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-959">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-960">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-961">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-962">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-963">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-964">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-965">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-966">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-967">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-968">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-969">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-970">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-971">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-972">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-973">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-974">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-975">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-976">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-977">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-978">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-979">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-980">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-981">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-982">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-983">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-984">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-985">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-986">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-987">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-988">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-989">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-990">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-991">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-992">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-993">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-994">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-995">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-996">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-997">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-998">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-999">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1000">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1001">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1002">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1003">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1004">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1005">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1006">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1007">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1008">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1009">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1010">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1011">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1012">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1013">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1014">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1015">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1016">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1017">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1018">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1019">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1020">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1021">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1022">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1023">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1024">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1025">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1026">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1027">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1028">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1029">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1030">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1031">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1032">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1033">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1034">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1035">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1036">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1037">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1038">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1039">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1040">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1041">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1042">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1043">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1044">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1045">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1046">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1047">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1048">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1049">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1050">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1051">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1052">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1053">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1054">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1055">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1056">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1057">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1058">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1059">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1060">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1061">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1062">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1063">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1064">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1065">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1066">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1067">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1068">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1069">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1070">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1071">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1072">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1073">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1074">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1075">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1076">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1077">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1078">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1079">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1080">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1081">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1082">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1083">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1084">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1085">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1086">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1087">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1088">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1089">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1090">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1091">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1092">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1093">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1094">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1095">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1096">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1097">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1098">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1099">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1100">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1101">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1102">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1103">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1104">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1105">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1106">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1107">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1108">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1109">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1110">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1111">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1112">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1113">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1114">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1115">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1116">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1117">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1118">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1119">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1120">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1121">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1122">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1123">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1124">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1125">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1126">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1127">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1128">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1129">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1130">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1131">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1132">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1133">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1134">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1135">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1136">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1137">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1138">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1139">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1140">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1141">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1142">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1143">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1144">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1145">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1146">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1147">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1148">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1149">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1150">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1151">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1152">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1153">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1154">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1155">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1156">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1157">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1158">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1159">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1160">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1161">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1162">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1163">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1164">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1165">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1166">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1167">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1168">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1169">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1170">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1171">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1172">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1173">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1174">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1175">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1176">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1177">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1178">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1179">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1180">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1181">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1182">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1183">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1184">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1185">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1186">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1187">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1188">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1189">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1190">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1191">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1192">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1193">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1194">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1195">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1196">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1197">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1198">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1199">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LMHeadPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1200">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1201">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb7-1203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]stage=0 layers=37</span>
<span id="cb7-1204">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0:</span> _to_float16</span>
<span id="cb7-1205">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1:</span> EmbeddingPipe</span>
<span id="cb7-1206">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1207">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1208">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1209">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1210">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1211">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1212">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1213">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1214">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1215">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1216">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1217">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1218">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1219">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1220">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1221">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1222">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1223">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1224">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1225">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1226">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1227">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1228">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1229">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1230">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1231">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1232">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1233">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1234">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1235">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1236">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1237">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1238">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34:</span> RMSNorm</span>
<span id="cb7-1239">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35:</span> LMHeadPipe</span>
<span id="cb7-1240">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">36:</span> float16_to_fp32</span>
<span id="cb7-1241">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span> loss_func</span>
<span id="cb7-1242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> After Building Model</span>
<span id="cb7-1243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-1244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 105.4 GB, percent = 9.3%</span>
<span id="cb7-1245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> GPTModelPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1246">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tied_modules</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1247">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> EmbeddingPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1248">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">word_embeddings</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> VocabParallelEmbedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1249">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1250">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1251">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1252">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1253">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1254">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1255">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1256">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1257">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1258">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1259">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1260">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1261">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1262">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1263">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1264">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1265">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1266">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1267">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1268">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1269">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1270">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1271">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1272">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1273">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1274">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1275">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1276">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1277">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1278">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1279">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1280">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1281">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1282">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1283">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1284">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1285">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1286">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1287">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1288">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1289">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1290">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1291">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1292">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1293">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1294">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1295">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1296">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1297">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1298">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1299">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1300">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1301">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1302">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1303">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1304">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1305">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1306">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1307">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1308">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1309">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1310">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1311">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1312">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1313">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1314">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1315">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1316">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1317">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1318">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1319">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1320">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1321">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1322">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1323">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1324">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1325">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1326">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1327">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1328">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1329">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1330">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1331">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1332">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1333">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1334">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1335">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1336">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1337">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1338">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1339">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1340">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1341">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1342">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1343">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1344">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1345">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1346">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1347">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1348">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1349">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1350">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1351">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1352">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1353">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1354">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1355">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1356">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1357">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1358">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1359">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1360">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1361">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1362">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1363">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1364">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1365">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1366">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1367">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1368">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1369">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1370">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1371">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1372">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1373">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1374">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1375">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1376">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1377">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1378">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1379">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1380">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1381">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1382">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1383">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1384">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1385">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1386">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1387">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1388">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1389">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1390">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1391">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1392">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1393">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1394">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1395">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1396">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1397">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1398">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1399">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1400">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1401">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1402">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1403">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1404">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1405">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1406">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1407">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1408">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1409">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1410">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1411">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1412">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1413">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1414">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1415">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1416">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1417">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1418">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1419">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1420">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1421">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1422">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1423">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1424">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1425">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1426">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1427">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1428">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1429">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1430">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1431">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1432">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1433">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1434">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1435">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1436">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1437">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1438">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1439">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1440">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1441">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1442">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1443">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1444">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1445">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1446">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1447">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1448">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1449">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1450">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1451">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1452">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1453">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1454">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1455">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1456">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1457">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1458">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1459">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1460">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1461">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1462">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1463">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1464">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1465">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1466">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1467">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1468">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1469">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1470">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1471">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1472">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1473">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1474">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1475">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1476">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1477">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1478">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1479">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1480">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1481">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1482">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1483">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1484">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1485">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1486">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1487">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1488">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1489">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1490">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1491">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1492">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1493">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1494">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1495">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1496">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1497">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1498">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1499">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1500">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1501">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1502">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1503">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1504">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1505">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1506">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1507">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1508">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1509">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1510">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1511">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1512">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1513">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1514">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1515">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1516">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1517">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1518">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1519">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1520">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1521">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1522">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1523">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1524">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1525">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1526">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1527">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1528">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1529">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1530">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1531">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1532">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1533">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1534">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1535">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1536">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1537">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1538">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1539">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1540">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1541">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1542">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1543">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1544">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1545">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1546">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1547">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1548">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1549">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1550">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1551">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1552">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1553">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1554">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1555">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1556">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1557">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1558">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1559">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1560">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1561">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1562">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1563">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1564">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1565">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1566">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1567">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1568">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1569">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1570">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1571">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1572">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1573">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1574">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1575">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1576">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1577">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1578">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1579">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1580">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1581">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1582">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1583">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1584">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1585">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1586">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1587">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1588">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1589">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1590">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1591">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1592">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1593">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1594">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1595">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1596">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1597">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1598">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1599">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1600">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1601">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1602">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1603">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1604">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1605">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1606">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1607">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1608">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1609">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1610">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1611">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1612">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1613">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1614">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1615">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1616">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1617">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1618">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1619">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1620">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1621">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1622">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1623">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1624">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1625">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1626">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1627">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1628">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1629">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1630">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1631">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1632">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1633">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1634">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1635">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1636">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1637">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1638">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1639">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1640">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1641">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1642">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1643">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1644">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1645">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1646">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1647">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1648">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1649">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1650">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1651">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1652">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1653">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1654">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1655">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1656">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1657">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1658">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1659">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1660">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1661">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1662">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1663">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1664">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1665">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1666">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1667">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1668">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1669">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1670">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1671">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1672">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1673">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1674">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1675">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1676">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1677">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1678">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1679">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1680">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1681">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1682">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1683">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1684">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1685">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1686">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1687">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1688">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1689">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1690">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1691">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1692">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1693">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1694">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1695">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1696">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1697">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1698">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1699">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1700">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1701">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1702">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1703">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1704">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1705">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1706">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1707">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1708">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1709">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1710">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1711">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1712">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1713">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1714">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1715">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1716">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1717">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1718">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1719">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1720">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1721">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1722">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1723">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1724">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1725">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1726">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1727">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1728">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1729">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1730">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1731">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1732">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1733">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1734">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1735">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1736">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1737">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1738">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1739">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1740">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1741">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1742">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1743">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1744">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1745">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1746">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1747">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1748">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1749">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1750">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1751">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1752">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1753">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1754">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1755">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1756">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1757">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1758">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1759">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1760">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1761">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1762">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1763">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1764">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LMHeadPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1765">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1766">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1767"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1768"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]2024-10-16 15:39:39.334375: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /tensorflow/core/bfc_allocator_delay. The old value will be erased inorder to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1769"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.334561: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /xla/service/gpu/compiled_programs_count. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1770"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.335711: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /jax/pjrt/pjrt_executable_executions. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1771"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.335722: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /jax/pjrt/pjrt_executable_execution_time_usecs. The old value will be erased in order to register a new one. Please check if you linkthe metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1772"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.587872: I itex/core/wrapper/itex_gpu_wrapper.cc:38] Intel Extension for Tensorflow<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> GPU backend is loaded.</span>
<span id="cb7-1773"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631109: I itex/core/devices/gpu/itex_gpu_runtime.cc:130] Selected platform: Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Level-Zero</span></span>
<span id="cb7-1774"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631594: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1775"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631598: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1776"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631600: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1777"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631602: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1778"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631604: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1779"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631607: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1780"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631609: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1781"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631611: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1782"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631613: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1783"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631615: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1784"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631617: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1785"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631619: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1786"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> setting <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard</span> ...</span>
<span id="cb7-1787"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WARNING:</span> WANDB writing requested but no legit wandb project or experiment name provided, therefore no WANDB logs will be written according to random generated project or experiment name.</span>
<span id="cb7-1788"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-1789"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:39,835] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-1790"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:35<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 30.78s/it]</span>
<span id="cb7-1791"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.654241]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:108</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">----------------------------hf</span> weight list----------------------------</span>
<span id="cb7-1792"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.705041]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.embed_tokens.weight</span>
<span id="cb7-1793"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.708051]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.q_proj.weight</span>
<span id="cb7-1794"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.710201]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.k_proj.weight</span>
<span id="cb7-1795"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.711855]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.v_proj.weight</span>
<span id="cb7-1796"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.714676]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.o_proj.weight</span>
<span id="cb7-1797"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.721608]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.gate_proj.weight</span>
<span id="cb7-1798"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.728527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.up_proj.weight</span>
<span id="cb7-1799"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.735447]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.down_proj.weight</span>
<span id="cb7-1800"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.736224]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.input_layernorm.weight</span>
<span id="cb7-1801"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.736764]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.post_attention_layernorm.weight</span>
<span id="cb7-1802"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.739392]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.q_proj.weight</span>
<span id="cb7-1803"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.741013]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.k_proj.weight</span>
<span id="cb7-1804"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.742600]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.v_proj.weight</span>
<span id="cb7-1805"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.745359]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.o_proj.weight</span>
<span id="cb7-1806"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.752286]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.gate_proj.weight</span>
<span id="cb7-1807"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.759192]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.up_proj.weight</span>
<span id="cb7-1808"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.766054]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.down_proj.weight</span>
<span id="cb7-1809"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.766785]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.input_layernorm.weight</span>
<span id="cb7-1810"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.767321]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.post_attention_layernorm.weight</span>
<span id="cb7-1811"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.769938]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.q_proj.weight</span>
<span id="cb7-1812"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.771536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.k_proj.weight</span>
<span id="cb7-1813"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.773107]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.v_proj.weight</span>
<span id="cb7-1814"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.775861]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.o_proj.weight</span>
<span id="cb7-1815"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.782733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.gate_proj.weight</span>
<span id="cb7-1816"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.789559]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.up_proj.weight</span>
<span id="cb7-1817"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.796385]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.down_proj.weight</span>
<span id="cb7-1818"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.797080]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.input_layernorm.weight</span>
<span id="cb7-1819"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.797626]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.post_attention_layernorm.weight</span>
<span id="cb7-1820"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.800331]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.q_proj.weight</span>
<span id="cb7-1821"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.801911]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.k_proj.weight</span>
<span id="cb7-1822"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.803453]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.v_proj.weight</span>
<span id="cb7-1823"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.806474]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.o_proj.weight</span>
<span id="cb7-1824"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:35<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 30.84s/it]</span>
<span id="cb7-1825"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.813328]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.gate_proj.weight</span>
<span id="cb7-1826"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.820151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.up_proj.weight</span>
<span id="cb7-1827"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.826971]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.down_proj.weight</span>
<span id="cb7-1828"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.827640]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.input_layernorm.weight</span>
<span id="cb7-1829"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.828185]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.post_attention_layernorm.weight</span>
<span id="cb7-1830"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.831062]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.q_proj.weight</span>
<span id="cb7-1831"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.832590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.k_proj.weight</span>
<span id="cb7-1832"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.834171]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.v_proj.weight</span>
<span id="cb7-1833"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.837147]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.o_proj.weight</span>
<span id="cb7-1834"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.843970]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.gate_proj.weight</span>
<span id="cb7-1835"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.850793]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.up_proj.weight</span>
<span id="cb7-1836"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.857596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.down_proj.weight</span>
<span id="cb7-1837"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.858284]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.input_layernorm.weight</span>
<span id="cb7-1838"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.858810]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.post_attention_layernorm.weight</span>
<span id="cb7-1839"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.861661]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.q_proj.weight</span>
<span id="cb7-1840"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.863209]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.k_proj.weight</span>
<span id="cb7-1841"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.864753]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.v_proj.weight</span>
<span id="cb7-1842"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.867739]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.o_proj.weight</span>
<span id="cb7-1843"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.874537]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.gate_proj.weight</span>
<span id="cb7-1844"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.881318]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.up_proj.weight</span>
<span id="cb7-1845"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.888097]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.down_proj.weight</span>
<span id="cb7-1846"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.888767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.input_layernorm.weight</span>
<span id="cb7-1847"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.889295]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.post_attention_layernorm.weight</span>
<span id="cb7-1848"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.892151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.q_proj.weight</span>
<span id="cb7-1849"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.893641]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.k_proj.weight</span>
<span id="cb7-1850"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.895211]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.v_proj.weight</span>
<span id="cb7-1851"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.898154]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.o_proj.weight</span>
<span id="cb7-1852"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.904976]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.gate_proj.weight</span>
<span id="cb7-1853"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.911767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.up_proj.weight</span>
<span id="cb7-1854"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.918536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.down_proj.weight</span>
<span id="cb7-1855"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.919201]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.input_layernorm.weight</span>
<span id="cb7-1856"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.919795]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.post_attention_layernorm.weight</span>
<span id="cb7-1857"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.922646]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.q_proj.weight</span>
<span id="cb7-1858"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.924200]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.k_proj.weight</span>
<span id="cb7-1859"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.925687]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.v_proj.weight</span>
<span id="cb7-1860"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.928651]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.o_proj.weight</span>
<span id="cb7-1861"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.935432]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.gate_proj.weight</span>
<span id="cb7-1862"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.942178]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.up_proj.weight</span>
<span id="cb7-1863"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.948916]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.down_proj.weight</span>
<span id="cb7-1864"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.949547]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.input_layernorm.weight</span>
<span id="cb7-1865"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.950059]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.post_attention_layernorm.weight</span>
<span id="cb7-1866"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.952902]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.q_proj.weight</span>
<span id="cb7-1867"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.954461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.k_proj.weight</span>
<span id="cb7-1868"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.955985]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.v_proj.weight</span>
<span id="cb7-1869"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.958931]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.o_proj.weight</span>
<span id="cb7-1870"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.965709]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.gate_proj.weight</span>
<span id="cb7-1871"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.972481]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.up_proj.weight</span>
<span id="cb7-1872"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.979242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.down_proj.weight</span>
<span id="cb7-1873"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.979876]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.input_layernorm.weight</span>
<span id="cb7-1874"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.980381]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.post_attention_layernorm.weight</span>
<span id="cb7-1875"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.983353]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.q_proj.weight</span>
<span id="cb7-1876"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.984910]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.k_proj.weight</span>
<span id="cb7-1877"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.986401]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.v_proj.weight</span>
<span id="cb7-1878"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.989279]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.o_proj.weight</span>
<span id="cb7-1879"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.996056]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.gate_proj.weight</span>
<span id="cb7-1880"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.002856]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.up_proj.weight</span>
<span id="cb7-1881"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.009601]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.down_proj.weight</span>
<span id="cb7-1882"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.010234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.input_layernorm.weight</span>
<span id="cb7-1883"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.010742]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.post_attention_layernorm.weight</span>
<span id="cb7-1884"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.013552]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.q_proj.weight</span>
<span id="cb7-1885"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.015117]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.k_proj.weight</span>
<span id="cb7-1886"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.016607]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.v_proj.weight</span>
<span id="cb7-1887"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.019542]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.o_proj.weight</span>
<span id="cb7-1888"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.026297]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.gate_proj.weight</span>
<span id="cb7-1889"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.033038]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.up_proj.weight</span>
<span id="cb7-1890"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.039752]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.down_proj.weight</span>
<span id="cb7-1891"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.040455]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.input_layernorm.weight</span>
<span id="cb7-1892"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.040966]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.post_attention_layernorm.weight</span>
<span id="cb7-1893"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.043760]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.q_proj.weight</span>
<span id="cb7-1894"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.045346]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.k_proj.weight</span>
<span id="cb7-1895"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.046849]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.v_proj.weight</span>
<span id="cb7-1896"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.049725]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.o_proj.weight</span>
<span id="cb7-1897"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.056435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.gate_proj.weight</span>
<span id="cb7-1898"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.063163]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.up_proj.weight</span>
<span id="cb7-1899"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.069898]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.down_proj.weight</span>
<span id="cb7-1900"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.070561]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.input_layernorm.weight</span>
<span id="cb7-1901"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.071084]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.post_attention_layernorm.weight</span>
<span id="cb7-1902"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.073869]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.q_proj.weight</span>
<span id="cb7-1903"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.075363]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.k_proj.weight</span>
<span id="cb7-1904"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.076918]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.v_proj.weight</span>
<span id="cb7-1905"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.079777]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.o_proj.weight</span>
<span id="cb7-1906"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.086497]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.gate_proj.weight</span>
<span id="cb7-1907"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.093183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.up_proj.weight</span>
<span id="cb7-1908"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.099869]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.down_proj.weight</span>
<span id="cb7-1909"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.100523]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.input_layernorm.weight</span>
<span id="cb7-1910"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.101038]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.post_attention_layernorm.weight</span>
<span id="cb7-1911"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.103823]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.q_proj.weight</span>
<span id="cb7-1912"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.105335]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.k_proj.weight</span>
<span id="cb7-1913"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.106828]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.v_proj.weight</span>
<span id="cb7-1914"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.109698]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.o_proj.weight</span>
<span id="cb7-1915"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.116395]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.gate_proj.weight</span>
<span id="cb7-1916"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.123086]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.up_proj.weight</span>
<span id="cb7-1917"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.129807]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.down_proj.weight</span>
<span id="cb7-1918"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.130474]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.input_layernorm.weight</span>
<span id="cb7-1919"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.130997]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.post_attention_layernorm.weight</span>
<span id="cb7-1920"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.133762]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.q_proj.weight</span>
<span id="cb7-1921"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.135290]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.k_proj.weight</span>
<span id="cb7-1922"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.136791]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.v_proj.weight</span>
<span id="cb7-1923"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.139860]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.o_proj.weight</span>
<span id="cb7-1924"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.146560]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.gate_proj.weight</span>
<span id="cb7-1925"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.153229]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.up_proj.weight</span>
<span id="cb7-1926"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.160012]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.down_proj.weight</span>
<span id="cb7-1927"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.160681]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.input_layernorm.weight</span>
<span id="cb7-1928"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.161212]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.post_attention_layernorm.weight</span>
<span id="cb7-1929"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.164011]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.q_proj.weight</span>
<span id="cb7-1930"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.165550]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.k_proj.weight</span>
<span id="cb7-1931"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.167029]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.v_proj.weight</span>
<span id="cb7-1932"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.169860]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.o_proj.weight</span>
<span id="cb7-1933"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.176522]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.gate_proj.weight</span>
<span id="cb7-1934"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.183206]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.up_proj.weight</span>
<span id="cb7-1935"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.189866]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.down_proj.weight</span>
<span id="cb7-1936"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.190530]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.input_layernorm.weight</span>
<span id="cb7-1937"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.191065]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.post_attention_layernorm.weight</span>
<span id="cb7-1938"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.193838]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.q_proj.weight</span>
<span id="cb7-1939"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.195331]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.k_proj.weight</span>
<span id="cb7-1940"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.196892]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.v_proj.weight</span>
<span id="cb7-1941"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.199748]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.o_proj.weight</span>
<span id="cb7-1942"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.206446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.gate_proj.weight</span>
<span id="cb7-1943"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.213109]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.up_proj.weight</span>
<span id="cb7-1944"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.219783]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.down_proj.weight</span>
<span id="cb7-1945"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.220402]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.input_layernorm.weight</span>
<span id="cb7-1946"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.220932]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.post_attention_layernorm.weight</span>
<span id="cb7-1947"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.223676]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.q_proj.weight</span>
<span id="cb7-1948"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.225232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.k_proj.weight</span>
<span id="cb7-1949"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.226737]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.v_proj.weight</span>
<span id="cb7-1950"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.229543]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.o_proj.weight</span>
<span id="cb7-1951"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.236240]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.gate_proj.weight</span>
<span id="cb7-1952"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.242898]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.up_proj.weight</span>
<span id="cb7-1953"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.249590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.down_proj.weight</span>
<span id="cb7-1954"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.250235]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.input_layernorm.weight</span>
<span id="cb7-1955"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.250747]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.post_attention_layernorm.weight</span>
<span id="cb7-1956"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.253465]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.q_proj.weight</span>
<span id="cb7-1957"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.255062]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.k_proj.weight</span>
<span id="cb7-1958"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.256546]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.v_proj.weight</span>
<span id="cb7-1959"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.259362]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.o_proj.weight</span>
<span id="cb7-1960"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.266006]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.gate_proj.weight</span>
<span id="cb7-1961"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.272677]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.up_proj.weight</span>
<span id="cb7-1962"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.279406]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.down_proj.weight</span>
<span id="cb7-1963"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.280055]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.input_layernorm.weight</span>
<span id="cb7-1964"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.280566]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.post_attention_layernorm.weight</span>
<span id="cb7-1965"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.283295]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.q_proj.weight</span>
<span id="cb7-1966"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.284803]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.k_proj.weight</span>
<span id="cb7-1967"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.286350]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.v_proj.weight</span>
<span id="cb7-1968"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.289142]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.o_proj.weight</span>
<span id="cb7-1969"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.295818]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.gate_proj.weight</span>
<span id="cb7-1970"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.302488]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.up_proj.weight</span>
<span id="cb7-1971"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.309098]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.down_proj.weight</span>
<span id="cb7-1972"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.309731]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.input_layernorm.weight</span>
<span id="cb7-1973"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.310234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.post_attention_layernorm.weight</span>
<span id="cb7-1974"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.312927]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.q_proj.weight</span>
<span id="cb7-1975"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.314505]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.k_proj.weight</span>
<span id="cb7-1976"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.315992]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.v_proj.weight</span>
<span id="cb7-1977"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.318788]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.o_proj.weight</span>
<span id="cb7-1978"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.325390]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.gate_proj.weight</span>
<span id="cb7-1979"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.332020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.up_proj.weight</span>
<span id="cb7-1980"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.338682]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.down_proj.weight</span>
<span id="cb7-1981"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.339334]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.input_layernorm.weight</span>
<span id="cb7-1982"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.339845]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.post_attention_layernorm.weight</span>
<span id="cb7-1983"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.342562]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.q_proj.weight</span>
<span id="cb7-1984"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.344113]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.k_proj.weight</span>
<span id="cb7-1985"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.345593]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.v_proj.weight</span>
<span id="cb7-1986"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.348370]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.o_proj.weight</span>
<span id="cb7-1987"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.355167]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.gate_proj.weight</span>
<span id="cb7-1988"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.361823]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.up_proj.weight</span>
<span id="cb7-1989"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.368428]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.down_proj.weight</span>
<span id="cb7-1990"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.369055]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.input_layernorm.weight</span>
<span id="cb7-1991"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.369558]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.post_attention_layernorm.weight</span>
<span id="cb7-1992"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.372269]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.q_proj.weight</span>
<span id="cb7-1993"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.373830]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.k_proj.weight</span>
<span id="cb7-1994"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.375316]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.v_proj.weight</span>
<span id="cb7-1995"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.378084]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.o_proj.weight</span>
<span id="cb7-1996"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.384700]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.gate_proj.weight</span>
<span id="cb7-1997"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.391366]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.up_proj.weight</span>
<span id="cb7-1998"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.398053]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.down_proj.weight</span>
<span id="cb7-1999"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.398695]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.input_layernorm.weight</span>
<span id="cb7-2000"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.399206]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.post_attention_layernorm.weight</span>
<span id="cb7-2001"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.401929]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.q_proj.weight</span>
<span id="cb7-2002"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.403487]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.k_proj.weight</span>
<span id="cb7-2003"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.404961]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.v_proj.weight</span>
<span id="cb7-2004"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.407720]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.o_proj.weight</span>
<span id="cb7-2005"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.414356]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.gate_proj.weight</span>
<span id="cb7-2006"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.421000]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.up_proj.weight</span>
<span id="cb7-2007"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.427610]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.down_proj.weight</span>
<span id="cb7-2008"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.428269]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.input_layernorm.weight</span>
<span id="cb7-2009"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.428783]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.post_attention_layernorm.weight</span>
<span id="cb7-2010"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.431461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.q_proj.weight</span>
<span id="cb7-2011"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.432995]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.k_proj.weight</span>
<span id="cb7-2012"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.434507]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.v_proj.weight</span>
<span id="cb7-2013"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.437268]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.o_proj.weight</span>
<span id="cb7-2014"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.443850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.gate_proj.weight</span>
<span id="cb7-2015"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.450632]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.up_proj.weight</span>
<span id="cb7-2016"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.457242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.down_proj.weight</span>
<span id="cb7-2017"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.457890]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.input_layernorm.weight</span>
<span id="cb7-2018"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.458409]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.post_attention_layernorm.weight</span>
<span id="cb7-2019"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.461063]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.q_proj.weight</span>
<span id="cb7-2020"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.462620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.k_proj.weight</span>
<span id="cb7-2021"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.464102]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.v_proj.weight</span>
<span id="cb7-2022"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.466871]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.o_proj.weight</span>
<span id="cb7-2023"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.473435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.gate_proj.weight</span>
<span id="cb7-2024"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.480017]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.up_proj.weight</span>
<span id="cb7-2025"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.486605]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.down_proj.weight</span>
<span id="cb7-2026"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.487227]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.input_layernorm.weight</span>
<span id="cb7-2027"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.487743]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.post_attention_layernorm.weight</span>
<span id="cb7-2028"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.490427]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.q_proj.weight</span>
<span id="cb7-2029"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.491946]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.k_proj.weight</span>
<span id="cb7-2030"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.493433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.v_proj.weight</span>
<span id="cb7-2031"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.496192]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.o_proj.weight</span>
<span id="cb7-2032"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.502792]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.gate_proj.weight</span>
<span id="cb7-2033"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.509329]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.up_proj.weight</span>
<span id="cb7-2034"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.515980]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.down_proj.weight</span>
<span id="cb7-2035"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.516659]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.input_layernorm.weight</span>
<span id="cb7-2036"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.517200]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.post_attention_layernorm.weight</span>
<span id="cb7-2037"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.519874]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.q_proj.weight</span>
<span id="cb7-2038"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.521415]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.k_proj.weight</span>
<span id="cb7-2039"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.522879]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.v_proj.weight</span>
<span id="cb7-2040"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.525620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.o_proj.weight</span>
<span id="cb7-2041"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.532202]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.gate_proj.weight</span>
<span id="cb7-2042"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.538768]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.up_proj.weight</span>
<span id="cb7-2043"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.545303]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.down_proj.weight</span>
<span id="cb7-2044"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.545921]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.input_layernorm.weight</span>
<span id="cb7-2045"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.546440]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.post_attention_layernorm.weight</span>
<span id="cb7-2046"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.549101]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.q_proj.weight</span>
<span id="cb7-2047"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.550596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.k_proj.weight</span>
<span id="cb7-2048"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.552114]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.v_proj.weight</span>
<span id="cb7-2049"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.554821]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.o_proj.weight</span>
<span id="cb7-2050"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.561373]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.gate_proj.weight</span>
<span id="cb7-2051"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.567945]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.up_proj.weight</span>
<span id="cb7-2052"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.574713]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.down_proj.weight</span>
<span id="cb7-2053"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.575333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.input_layernorm.weight</span>
<span id="cb7-2054"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.575833]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.post_attention_layernorm.weight</span>
<span id="cb7-2055"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.578469]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.q_proj.weight</span>
<span id="cb7-2056"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.580020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.k_proj.weight</span>
<span id="cb7-2057"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.581498]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.v_proj.weight</span>
<span id="cb7-2058"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.584217]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.o_proj.weight</span>
<span id="cb7-2059"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.590850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.gate_proj.weight</span>
<span id="cb7-2060"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.597375]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.up_proj.weight</span>
<span id="cb7-2061"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.603899]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.down_proj.weight</span>
<span id="cb7-2062"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.604548]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.input_layernorm.weight</span>
<span id="cb7-2063"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.605067]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.post_attention_layernorm.weight</span>
<span id="cb7-2064"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.607694]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.q_proj.weight</span>
<span id="cb7-2065"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.609232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.k_proj.weight</span>
<span id="cb7-2066"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.610733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.v_proj.weight</span>
<span id="cb7-2067"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.613448]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.o_proj.weight</span>
<span id="cb7-2068"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.619991]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.gate_proj.weight</span>
<span id="cb7-2069"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.626559]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.up_proj.weight</span>
<span id="cb7-2070"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.633070]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.down_proj.weight</span>
<span id="cb7-2071"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.633733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.input_layernorm.weight</span>
<span id="cb7-2072"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.634259]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.post_attention_layernorm.weight</span>
<span id="cb7-2073"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.636877]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.q_proj.weight</span>
<span id="cb7-2074"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.638487]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.k_proj.weight</span>
<span id="cb7-2075"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.639954]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.v_proj.weight</span>
<span id="cb7-2076"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.642672]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.o_proj.weight</span>
<span id="cb7-2077"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.649190]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.gate_proj.weight</span>
<span id="cb7-2078"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.655715]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.up_proj.weight</span>
<span id="cb7-2079"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.662234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.down_proj.weight</span>
<span id="cb7-2080"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.662858]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.input_layernorm.weight</span>
<span id="cb7-2081"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.663389]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.post_attention_layernorm.weight</span>
<span id="cb7-2082"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.663915]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.norm.weight</span>
<span id="cb7-2083"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,693] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2084"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.713565]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> lm_head.weight</span>
<span id="cb7-2085"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.714574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:504</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> before deepspeed init</span>
<span id="cb7-2086"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] DeepSpeed info: version=0.15.3+unknown, git-hash=unknown, git-branch=unknown</span>
<span id="cb7-2087"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2088"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:57<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 33.97s/it]</span>
<span id="cb7-2089"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:36,676] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2090"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.36s/it]</span>
<span id="cb7-2091"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.38s/it]</span>
<span id="cb7-2092"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.40s/it]</span>
<span id="cb7-2093"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.39s/it]</span>
<span id="cb7-2094"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2095"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.43s/it]</span>
<span id="cb7-2096"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.40s/it]</span>
<span id="cb7-2097"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2098"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2099"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.46s/it]</span>
<span id="cb7-2102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.43s/it]</span>
<span id="cb7-2104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:58<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.12s/it]</span>
<span id="cb7-2109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.51s/it]</span>
<span id="cb7-2111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,455] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,666] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,739] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,801] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,842] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,860] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,862] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,920] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,138] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,153] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,174] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,175] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,205] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,212] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,224] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,251] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,255] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,256] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,417] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,538] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:56,920] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] DeepSpeed Flops Profiler Enabled: False</span>
<span id="cb7-2133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:56,921] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] Creating BF16 optimizer</span>
<span id="cb7-2134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> begin bf16_optimizer</span>
<span id="cb7-2135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-2136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 490.74 GB, percent = 43.3%</span>
<span id="cb7-2137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,290] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> end bf16_ optimizer</span>
<span id="cb7-2138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-2139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 490.74 GB, percent = 43.3%</span>
<span id="cb7-2140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:999:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> DeepSpeedEngine configuration:</span>
<span id="cb7-2141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   activation_checkpointing_config  {</span>
<span id="cb7-2142">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"partition_activations"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2143">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contiguous_memory_optimization"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2144">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu_checkpointing"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2145">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number_checkpoints"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2146">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"synchronize_checkpoint_boundary"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2147">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"profile"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb7-2148"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   aio_config ................... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'block_size'</span>: 1048576, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'queue_depth'</span>: 8, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'thread_count'</span>: 1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single_submit'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'overlap_events'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'use_gds'</span>: False}</span>
<span id="cb7-2150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   amp_enabled .................. False</span>
<span id="cb7-2151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   amp_params ................... False</span>
<span id="cb7-2152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   autotuning_config ............ {</span>
<span id="cb7-2153">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2154">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2155">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2156">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2157">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"arg_mappings"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2158">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"throughput"</span>,</span>
<span id="cb7-2159">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_info"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2160">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"results_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"autotuning_results"</span>,</span>
<span id="cb7-2161">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exps_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"autotuning_exps"</span>,</span>
<span id="cb7-2162">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2163">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fast"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2164">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start_profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3,</span>
<span id="cb7-2165">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end_profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5,</span>
<span id="cb7-2166">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_type"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gridsearch"</span>,</span>
<span id="cb7-2167">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_early_stopping"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5,</span>
<span id="cb7-2168">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_num_trials"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 50,</span>
<span id="cb7-2169">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_info_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2170">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mp_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2171">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2172">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2173">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.024000e+03,</span>
<span id="cb7-2174">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2175">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_tuning_micro_batch_sizes"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3</span>
<span id="cb7-2176"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   bfloat16_enabled ............. True</span>
<span id="cb7-2178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   bfloat16_immediate_grad_update  False</span>
<span id="cb7-2179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_parallel_write_pipeline  False</span>
<span id="cb7-2180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_tag_validation_enabled  True</span>
<span id="cb7-2181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_tag_validation_fail  False</span>
<span id="cb7-2182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   comms_config ................. <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>deepspeed.comm.config.DeepSpeedCommsConfig object at 0x145ea0815900<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb7-2183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   communication_data_type ...... None</span>
<span id="cb7-2184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   compression_config ........... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weight_quantization'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantizer_kernel'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_groups'</span>: 1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_verbose'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantization_type'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'symmetric'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_weight_in_forward'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rounding'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nearest'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fp16_mixed_quantize'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_change_ratio'</span>: 0.001}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'activation_quantization'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantization_type'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'symmetric'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'range_calibration'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dynamic'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sparse_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'head_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'topk'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channel_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'layer_reduction'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}</span>
<span id="cb7-2185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   curriculum_enabled_legacy .... False</span>
<span id="cb7-2186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   curriculum_params_legacy ..... False</span>
<span id="cb7-2187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   data_efficiency_config ....... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seed'</span>: 1234, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_sampling'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>: 1000, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_workers'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'curriculum_learning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_routing'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'random_ltd'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'layer_token_lr_schedule'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}}}</span>
<span id="cb7-2188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   data_efficiency_enabled ...... False</span>
<span id="cb7-2189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dataloader_drop_last ......... False</span>
<span id="cb7-2190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   disable_allgather ............ False</span>
<span id="cb7-2191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dump_state ................... False</span>
<span id="cb7-2192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dynamic_loss_scale_args ...... None</span>
<span id="cb7-2193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_enabled ........... False</span>
<span id="cb7-2194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_gas_boundary_resolution  1</span>
<span id="cb7-2195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_layer_name ........ bert.encoder.layer</span>
<span id="cb7-2196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_layer_num ......... 0</span>
<span id="cb7-2197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_max_iter .......... 100</span>
<span id="cb7-2198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_stability ......... 1e-06</span>
<span id="cb7-2199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_tol ............... 0.01</span>
<span id="cb7-2200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_verbose ........... False</span>
<span id="cb7-2201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   elasticity_enabled ........... False</span>
<span id="cb7-2202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   flops_profiler_config ........ {</span>
<span id="cb7-2203">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2204">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recompute_fwd_factor"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0,</span>
<span id="cb7-2205">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2206">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"module_depth"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1,</span></span>
<span id="cb7-2207">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top_modules"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2208">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"detailed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2209">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_file"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb7-2210"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_auto_cast ............... None</span>
<span id="cb7-2212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_enabled ................. False</span>
<span id="cb7-2213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_master_weights_and_gradients  False</span>
<span id="cb7-2214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   global_rank .................. 0</span>
<span id="cb7-2215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   grad_accum_dtype ............. None</span>
<span id="cb7-2216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_accumulation_steps .. 1</span>
<span id="cb7-2217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_clipping ............ 0.0</span>
<span id="cb7-2218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_predivide_factor .... 1.0</span>
<span id="cb7-2219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   graph_harvesting ............. False</span>
<span id="cb7-2220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8</span>
<span id="cb7-2221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   initial_dynamic_scale ........ 1</span>
<span id="cb7-2222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   load_universal_checkpoint .... False</span>
<span id="cb7-2223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   loss_scale ................... 1.0</span>
<span id="cb7-2224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   memory_breakdown ............. False</span>
<span id="cb7-2225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   mics_hierarchial_params_gather  False</span>
<span id="cb7-2226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   mics_shard_size .............. <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span></span>
<span id="cb7-2227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   monitor_config ............... tensorboard=TensorBoardConfig<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">job_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DeepSpeedJobName'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comet</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>CometConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_log_interval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">project</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">workspace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">experiment_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">experiment_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">online</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mode</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wandb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">group</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">team</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">project</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">csv_monitor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>CSVConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">job_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DeepSpeedJobName'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   nebula_config ................ {</span>
<span id="cb7-2229">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2230">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"persistent_storage_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2231">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"persistent_time_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb7-2232">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_of_version_in_retention"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2,</span>
<span id="cb7-2233">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enable_nebula_load"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2234">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"load_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb7-2235"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_legacy_fusion ...... False</span>
<span id="cb7-2237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_name ............... None</span>
<span id="cb7-2238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_params ............. None</span>
<span id="cb7-2239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pipeline ..................... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'stages'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'partition'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seed_layers'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'activation_checkpoint_interval'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pipe_partitioned'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_partitioned'</span>: True}</span>
<span id="cb7-2240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pld_enabled .................. False</span>
<span id="cb7-2241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pld_params ................... False</span>
<span id="cb7-2242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   prescale_gradients ........... False</span>
<span id="cb7-2243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   scheduler_name ............... None</span>
<span id="cb7-2244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   scheduler_params ............. None</span>
<span id="cb7-2245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   seq_parallel_communication_data_type  torch.float32</span>
<span id="cb7-2246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   sparse_attention ............. None</span>
<span id="cb7-2247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   sparse_gradients_enabled ..... False</span>
<span id="cb7-2248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   steps_per_print .............. 100</span>
<span id="cb7-2249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   timers_config ................ enabled=True synchronized=True</span>
<span id="cb7-2250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   train_batch_size ............. 24</span>
<span id="cb7-2251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   train_micro_batch_size_per_gpu  1</span>
<span id="cb7-2252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   use_data_before_expert_parallel_  False</span>
<span id="cb7-2253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   use_node_local_storage ....... False</span>
<span id="cb7-2254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   wall_clock_breakdown ......... False</span>
<span id="cb7-2255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   weight_quantization_config ... None</span>
<span id="cb7-2256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   world_size ................... 24</span>
<span id="cb7-2257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_allow_untested_optimizer  False</span>
<span id="cb7-2258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True</span>
<span id="cb7-2259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_enabled ................. False</span>
<span id="cb7-2260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_force_ds_cpu_optimizer .. True</span>
<span id="cb7-2261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_optimization_stage ...... 0</span>
<span id="cb7-2262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:989:print_user_config</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   json = {</span>
<span id="cb7-2263">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb7-2264">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2265">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steps_per_print"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb7-2266">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero_optimization"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb7-2267">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stage"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0</span>
<span id="cb7-2268">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb7-2269">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb7-2270">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true</span>
<span id="cb7-2271">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2272"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:105:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CONFIG: micro_batches=1 micro_batch_size=1</span>
<span id="cb7-2274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,294] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,298] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:165:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> RANK=0 STAGE=0 LAYERS=37 [0, 37<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STAGE_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TOTAL_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">UNIQUE_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.298751]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:511</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> after deepspeed init</span>
<span id="cb7-2277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.299527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:162</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> hf_w.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=128512</span>
<span id="cb7-2278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.299951]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:163</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> self.token_vocab=128000</span>
<span id="cb7-2279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,373] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,410] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,525] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2282">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--hidden-size</span> HIDDEN_SIZE]</span>
<span id="cb7-2283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">!!!</span> ATTENTION !!!</span>
<span id="cb7-2284">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--num-attention-heads</span> NUM_ATTENTION_HEADS]</span>
<span id="cb7-2285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'up'</span> to get to the frame that called dist.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2286">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--kv-channels</span> KV_CHANNELS]</span>
<span id="cb7-2287"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/__init__.py<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">breakpoint()</span></span>
<span id="cb7-2288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2289"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,531] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,539] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,677] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,689] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,689] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,694] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,694] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,733] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,769] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,823] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,857] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,869] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,057] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,058] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,102] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2308"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,102] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2309">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--ffn-hidden-size</span> FFN_HIDDEN_SIZE]</span>
<span id="cb7-2310"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">l</span></span>
<span id="cb7-2311"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">84</span>                pdb.message<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2312"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">85</span>                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n!!! ATTENTION !!!\n\n"</span></span>
<span id="cb7-2313"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">86</span>                    f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type 'up' to get to the frame that called dist.breakpoint(rank={rank})\n"</span></span>
<span id="cb7-2314"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">87</span>                <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2315"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">88</span>                pdb.set_trace<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2316"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>        barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2317"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">90</span>     </span>
<span id="cb7-2318"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">91</span>        if sys.platform != <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"win32"</span>:</span>
<span id="cb7-2319"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">92</span>            from torch._C._distributed_c10d import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2320"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">93</span>                HashStore,</span>
<span id="cb7-2321"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">94</span>                _round_robin_process_groups,</span>
<span id="cb7-2322"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ll</span></span>
<span id="cb7-2323"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">74</span>        def breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rank:</span> int = 0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2324"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">75</span>            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb7-2325"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 76            Set a breakpoint, but only on a single rank.  All other ranks will wait for you to be</span></span>
<span id="cb7-2326"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 77            done with the breakpoint before continuing.</span></span>
<span id="cb7-2327"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 78     </span></span>
<span id="cb7-2328"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 79            Args:</span></span>
<span id="cb7-2329"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 80                rank (int): Which rank to break on.  Default: </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">``</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">``</span></span>
<span id="cb7-2330"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 81            """</span></span>
<span id="cb7-2331"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82</span>            if get_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==</span> rank:</span>
<span id="cb7-2332"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">83</span>                pdb = _DistributedPdb<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2333"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">84</span>                pdb.message<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2334"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">85</span>                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n!!! ATTENTION !!!\n\n"</span></span>
<span id="cb7-2335"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">86</span>                    f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type 'up' to get to the frame that called dist.breakpoint(rank={rank})\n"</span></span>
<span id="cb7-2336"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">87</span>                <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2337"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">88</span>                pdb.set_trace<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2338"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>        barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2339"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">up</span></span>
<span id="cb7-2340"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/tools/hf2megads_weight_converter.py<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">224</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">_qkv_refactor()</span></span>
<span id="cb7-2341"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> torch.distributed.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2342"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ll</span></span>
<span id="cb7-2343"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">194</span>        def _qkv_refactor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> pname, p, hf_layer<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2344"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">195</span>            hf_wq_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.q_proj.weight"</span></span>
<span id="cb7-2345"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">196</span>            hf_wk_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.k_proj.weight"</span></span>
<span id="cb7-2346"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">197</span>            hf_wv_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.v_proj.weight"</span></span>
<span id="cb7-2347"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">198</span>            wq = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wq_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2348"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">199</span>            wk = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wk_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">200</span>            wv = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wv_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2350"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">201</span>     </span>
<span id="cb7-2351"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">202</span>            hidden_size = wq.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2352"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">203</span>            per_partition_size, start_index, end_index = compute_partition_range<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2353"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">204</span>                hidden_size, self.tp_rank, self.tp_size<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2354"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">205</span>            hidden_size_per_attention_head = divide<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size,</span></span>
<span id="cb7-2355"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">206</span>                                                    self.config.num_attention_heads<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2356"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">207</span>            num_attention_heads_per_partition = divide<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self.config.num_attention_heads,</span></span>
<span id="cb7-2357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">208</span>                                                       self.tp_size<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2358"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">209</span>     </span>
<span id="cb7-2359"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">210</span>            new_w = torch.zeros<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per_partition_size</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> 3, wq.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> dtype=wq.dtype<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">211</span>     </span>
<span id="cb7-2361"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">212</span>            for i in range<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_per_partition</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">213</span>                try:</span>
<span id="cb7-2363"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">214</span>                    current_index = start_index + i <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head</span>
<span id="cb7-2364"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">215</span>                    next_index = current_index + hidden_size_per_attention_head</span>
<span id="cb7-2365"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">216</span>                    new_w_index = i <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2366"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">217</span>                    new_w[new_w_index: new_w_index + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> :] = <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2367">218                        torch.cat<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb7-2368">219                            wq[current_index: next_index, <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">:],</span></span>
<span id="cb7-2369"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">220</span>                            wk[current_index: next_index, :],</span>
<span id="cb7-2370"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">221</span>                            wv[current_index: next_index, :]</span>
<span id="cb7-2371"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">222</span>                        ], dim=0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2372"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">223</span>                except Exception:</span>
<span id="cb7-2373"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">224</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>                torch.distributed.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2374"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">225</span>            self.record_mapping_info<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2375"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">226</span>                f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mega-ds:{pname,p.data.shape}&lt;--hf{hf_wq_name,hf_wk_name,hf_wv_name,}  cat q,k,v [{current_index}:{next_index},:]  of q,k,v{wq.shape}"</span></span>
<span id="cb7-2376"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">227</span>            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2377"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">228</span>            return new_w</span>
<span id="cb7-2378"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">current_index</span></span>
<span id="cb7-2379"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb7-2380"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">next_index</span></span>
<span id="cb7-2381"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1152</span></span>
<span id="cb7-2382"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w_index</span></span>
<span id="cb7-2383"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3072</span></span>
<span id="cb7-2384"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2385"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2386"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wq</span></span>
<span id="cb7-2387"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 0.0053, -0.0291, -0.0058,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0095,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0420,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0272],</span></span>
<span id="cb7-2388">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0142,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0679,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0049,</span>  ..., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0142,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0498,</span>  0.0192],</span>
<span id="cb7-2389">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0162,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0393,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0026,</span>  ...,  0.0115, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0126,</span>  0.0071],</span>
<span id="cb7-2390">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...,</span></span>
<span id="cb7-2391">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0039,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0393,</span>  0.0806,  ...,  0.0061, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0013,</span>  0.0023],</span>
<span id="cb7-2392">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0035,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0101,</span>  0.0459,  ...,  0.0049, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0011,</span>  0.0011],</span>
<span id="cb7-2393">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0018,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0153,</span>  0.0347,  ...,  0.0110,  0.0004,  0.0044]],</span>
<span id="cb7-2394">       <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dtype</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_fn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=&lt;</span>CloneBackward0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2395"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wq.shape</span></span>
<span id="cb7-2396"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4096,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2397"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wk.shape</span></span>
<span id="cb7-2398"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1024,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2399"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wv.shape</span></span>
<span id="cb7-2400"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1024,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2401"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size</span></span>
<span id="cb7-2402"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span></span>
<span id="cb7-2403"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per_partition_size</span></span>
<span id="cb7-2404"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span></span>
<span id="cb7-2405"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_per_partition</span></span>
<span id="cb7-2406"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb7-2407"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2408"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2409"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2410"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2411"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div>
</details>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Converting {Checkpoints}},
  date = {2024-10-17},
  url = {https://samforeman.me/posts/AuroraGPT/checkpoints},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúConverting Checkpoints.‚Äù</span> October 17,
2024. <a href="https://samforeman.me/posts/AuroraGPT/checkpoints">https://samforeman.me/posts/AuroraGPT/checkpoints</a>.
</div></div></section></div> ]]></description>
  <category>ALCF</category>
  <category>AuroraGPT</category>
  <category>Aurora</category>
  <category>Megatron-DeepSpeed</category>
  <category>XPU</category>
  <guid>https://samforeman.me/posts/AuroraGPT/checkpoints/</guid>
  <pubDate>Thu, 17 Oct 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üèîÔ∏è Spike Skipper</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/spike-skipper/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="callout callout-style-simple callout-caution callout-titled" title="Details" style="width:100%">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Details
</div>
</div>
<div class="callout-body-container callout-body">
<p>We describe below our implementation for skipping individual steps during training.</p>
</div>
</div>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">üìù Example</h2>
<p>Suppose we observe a large spike in our loss curve, as shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/spike-skipper.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="spike-skipper"><img src="https://samforeman.me/posts/AuroraGPT/spike-skipper/assets/spike-skipper.png" class="img-fluid figure-img" alt="spike-skipper"></a></p>
<figcaption>spike-skipper</figcaption>
</figure>
</div>
<p>Seemingly, this spike is being caused by a batch of ‚Äúbad data‚Äù. In order to prevent this ‚Äúbad data‚Äù sample from corrupting our training, we would like to ‚Äúskip‚Äù that particular training step.</p>
<p>This can be accomplished by passing the keyword argument <code>--train-range-to-skip</code> and specifying the endpoints of the ranges to be skipped.</p>
<p>e.g., if you would like to skip all steps from <code>[10, 20]</code> and from <code>[25, 30]</code>, we would specify:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PBS_O_WORKDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> train_aGPT_7B.sh <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-range-to-skip</span> 10 20 25 30</span></code></pre></div></div>
</section>
<section id="implementation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="implementation">üß™ Implementation</h2>
<p>We discuss below the details of the implementation, and provide some simple results to confirm things are behaving how we expect.</p>
<ol type="1">
<li><p>Check if <code>args.train_range_to_skip is not None</code> [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1032">here</a>]</p>
<ul>
<li><p>Assert <code>len(args.train_range_to_skip) % 2 == 0</code> [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1033-L1037">here</a>]</p>
</li>
<li><p>Zip these up into pairs [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1038-L1043">here</a>]:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1">ranges_to_skip <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(</span>
<span id="cb2-3">        args.train_range_to_skip[::<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb2-4">        args.train_range_to_skip[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>::<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb2-5">    )</span>
<span id="cb2-6">)</span></code></pre></div></div></li>
</ul></li>
<li><p>If current iteration is in any of these pairs [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1066-L1085">here</a>]</p>
<ul>
<li><p>For each <code>micro_step</code> in <code>range(gradient_accumulation_steps)</code>, explicitly:</p>
<ul>
<li>draw a new batch of data [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1074-L1076">here</a>] from our <code>train_data_iterator</code></li>
<li>immediately discard it (instead of propagating it through the network)</li>
</ul></li>
<li><p>Increment [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1087-L1094">here</a>]:</p>
<ul>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1090"><code>DeepSpeedEngine.skipped_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1091"><code>DeepSpeedEngine.global_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1092"><code>DeepSpeedEngine.micro_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1093"><code>DeepSpeedEngine.global_samples</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1094"><code>lr_scheduler</code></a></li>
</ul></li>
</ul></li>
</ol>
<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Must be even since we‚Äôre specifying the <em>endpoint<strong>s</strong></em> of intervals to skip</p>
</div></div></section>
<section id="sanity-check" class="level2">
<h2 class="anchored" data-anchor-id="sanity-check">‚úÖ Sanity Check</h2>
<p>In order to confirm things are behaving as expected, we can explicitly look at the tokens drawn for each step, and ensure that they are the same regardless of whether or not that iteration was skipped.</p>
<ul>
<li><p>In particular, we see that:</p>
<ul>
<li><p>test 1:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 23:09:09.059118][INFO][training:1083] - iteration=2 [0/8]: (torch.Size([4, 4097]))</span></span>
<span id="cb3-2">_tokens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb3-3">    [[ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1858</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3851</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29889</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>],</span>
<span id="cb3-4">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">349</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6156</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1650</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5806</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28557</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3519</span>],</span>
<span id="cb3-5">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16554</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1653</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">322</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6934</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14722</span>],</span>
<span id="cb3-6">     [ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4955</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10465</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1438</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3841</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>]]</span>
<span id="cb3-7">)</span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 23:09:09.061999][INFO][training:1083] - iteration=2 [1/8]: (torch.Size([4, 4097]))</span></span>
<span id="cb3-9">_tokens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb3-10">    [[  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">363</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1302</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16453</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7967</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29891</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">484</span>],</span>
<span id="cb3-11">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">367</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">766</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4752</span>,  ...,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29871</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30143</span>],</span>
<span id="cb3-12">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29899</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">855</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1503</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3786</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5100</span>],</span>
<span id="cb3-13">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">465</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1974</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">289</span>,  ..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21588</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">533</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>]]</span>
<span id="cb3-14">)</span></code></pre></div></div></li>
<li><p>test 2:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:27.752277][INFO][pretrain_gpt_alcf:198] - args.iteration=2:</span></span>
<span id="cb4-2">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb4-3">    [[ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1858</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3851</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29889</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>],</span>
<span id="cb4-4">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">349</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6156</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1650</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5806</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28557</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3519</span>],</span>
<span id="cb4-5">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16554</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1653</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">322</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6934</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14722</span>],</span>
<span id="cb4-6">     [ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4955</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10465</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1438</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3841</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>]]</span>
<span id="cb4-7">)</span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:27,755] [INFO] [profiler.py:81:start_profile] Flops profiler started</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:28.568805][INFO][pretrain_gpt_alcf:198] - args.iteration=2:</span></span>
<span id="cb4-10">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb4-11">    [[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">363</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1302</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16453</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7967</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29891</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">484</span>],</span>
<span id="cb4-12">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">367</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">766</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4752</span>,  ...,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29871</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30143</span>],</span>
<span id="cb4-13">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29899</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">855</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1503</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3786</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5100</span>],</span>
<span id="cb4-14">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">465</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1974</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">289</span>,  ..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21588</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">533</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>]]</span>
<span id="cb4-15">)</span></code></pre></div></div></li>
</ul>
<p>as expected.</p></li>
</ul>
<section id="details" class="level3">
<h3 class="anchored" data-anchor-id="details">üîç Details</h3>
<ul>
<li><p>First 4 steps:</p>
<details closed="">
<summary>
<p><code>tokens</code>:</p>
</summary>
<ul>
<li><p>Iteration 0:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:58:50.168667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,  7344,  5146,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9776,</span> 29914, 26419],</span>
<span id="cb5-2">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,  4706,  ...,  9280, 30004,    13],</span>
<span id="cb5-3">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29943,</span> 20774, 29908,  ...,   304, 27391,   322],</span>
<span id="cb5-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2645,   445, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16888,</span>  4656, 10070]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:58:58.866409]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2768,   596,  1788,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27274,</span>   393, 30010],</span>
<span id="cb5-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5613,  4192,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">362,</span>   310,  1950],</span>
<span id="cb5-7">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[28038,</span> 29892,  2022,  ...,  3160,   278,  2087],</span>
<span id="cb5-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4149,   907, 29888,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29896,</span> 29892, 29896]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:02.043059]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  424,   322, 16232,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">366,</span>   748,   467],</span>
<span id="cb5-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,   462,  1678,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2084,</span> 29892,  3497],</span>
<span id="cb5-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7562,   310, 19320,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8973,</span> 22684,   358],</span>
<span id="cb5-12">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2089,  3633,   292,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13774,</span>   269,  2375]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:03.456919]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[21411,</span>   322,  3896,  ...,  2610, 29889,   319],</span>
<span id="cb5-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8003, 29898, 29900,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12,</span>  6658,   529],</span>
<span id="cb5-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  4148,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span> 12212,   282],</span>
<span id="cb5-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5977, 29871, 29906,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15332,</span>   310,  1749]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:04.596630]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  278,  1473, 24987,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  2217,  3804],</span>
<span id="cb5-18">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2973,   263, 18778,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  4642,  6673],</span>
<span id="cb5-19">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  309,   323,   804,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1063,</span> 15296,   327],</span>
<span id="cb5-20">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5864,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9409,</span> 29889,  2178]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:05.486913]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29892,</span> 13731,  6617,  ..., 29871, 29896, 29946],</span>
<span id="cb5-22">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2892,  1012,  1266,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4036,</span>  7512,  2068],</span>
<span id="cb5-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1473,  1556,  3619,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3762,</span>   338,   263],</span>
<span id="cb5-24">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[23353,</span> 29918,  2177,  ...,   501,   567,   814]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:06.361333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5400, 14378,  4768,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2107,</span> 18677, 29889],</span>
<span id="cb5-26">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9200, 29887, 29914,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">293,</span> 24235,   322],</span>
<span id="cb5-27">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[30143,</span>  4746,  2184,  ..., 11891, 29974, 25760],</span>
<span id="cb5-28">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[19263,</span> 29914,   303,  ...,   358, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:07.230671]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  309,  1306,   681,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span> 23186, 21809],</span>
<span id="cb5-30">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29896,</span> 29929,    13,  ..., 29871, 29900,    13],</span>
<span id="cb5-31">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9558,   964,   263,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   282,   682],</span>
<span id="cb5-32">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 23904, 21767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">313,</span> 29929, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 1:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.287338]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       1/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3145728</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>29570.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9.4372e-09 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.167250 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>25.972 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>4432.597 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=20.30</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=26.18</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.289582]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:207</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> [Rank 0] <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">after</span> 1 iterations<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">memory</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MB</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">allocated:</span> 1894.57666015625 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max</span> allocated: 9752.35498046875 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reserved:</span> 11342.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max</span> reserved: 11342.0</span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26094.39,</span> 26095.09<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3407.56,</span> 3409.92<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.297183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1472, 29892,   408,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1584,   363],</span>
<span id="cb6-7">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  967, 19475,  6593,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8093,</span> 29899, 11249],</span>
<span id="cb6-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1006,  2218, 13326,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2355,</span>  1304,   304],</span>
<span id="cb6-9">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 29916, 29947,  ...,   353,  1870, 29936]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.104352]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2354,   274,  1041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 13049,  9098],</span>
<span id="cb6-11">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8798,  9547, 10353,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">303,</span>  3143, 29889],</span>
<span id="cb6-12">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1373,  4056,  7236,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3186,</span>   297,  5837],</span>
<span id="cb6-13">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1738, 29920,  7355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29871,  3776]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977036]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> building dataset for /flare/Aurora_deployment/AuroraGPT/datasets/dolma/data_v1.7_Llama2Tokenizer/c4-0000_text_document</span>
<span id="cb6-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977877]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building dataset index ...</span>
<span id="cb6-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977147]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2020,   306,  1016,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   920,   372],</span>
<span id="cb6-17">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5921,  1749,  7306,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19252,</span>   297,  5664],</span>
<span id="cb6-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  970,   770, 28547,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">970,</span>   894,  2577],</span>
<span id="cb6-19">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1907,   363, 14188,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">756,</span>  3646,   287]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:21.851620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  715, 25392,  3104,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">289,</span>  5761,   616],</span>
<span id="cb6-21">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  426,    13,  9651,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9651,</span>  1815, 22603],</span>
<span id="cb6-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7714,  1213,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29876,   457],</span>
<span id="cb6-23">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span> 28663,  1230,  ...,  1546,   278,  6586]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:22.720945]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29929,</span>    13,    13,  ..., 10739,  4770, 11277],</span>
<span id="cb6-25">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4528,   304,  2367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2501,</span>   385,  4203],</span>
<span id="cb6-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  869,   319,   794,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3158,</span> 29889,  3115],</span>
<span id="cb6-27">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  592,   260,  4125,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">284,</span>  1135, 18655]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:23.590149]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[14338,</span> 25323,  3321,  ...,  5607,  1806,  1164],</span>
<span id="cb6-29">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  322,   278, 15352,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6462,</span>   313,  1552],</span>
<span id="cb6-30">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[25738,</span>   714, 29889,  ..., 29915, 29879, 24842],</span>
<span id="cb6-31">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5122,   399, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29947,</span>  7284,  2305]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:24.457646]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  367, 19310,  1891,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2408,</span>   292,   263],</span>
<span id="cb6-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  470,  3307,  5713,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">568,</span>  2594, 19385],</span>
<span id="cb6-34">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29953,</span> 29905,  1631,  ...,  1118,   343, 29897],</span>
<span id="cb6-35">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10261,</span>   373,  5490,  ...,   511,   297,  1760]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:25.326699]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1006,   326, 29901,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14834,</span>  6694,  9595],</span>
<span id="cb6-37">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12058,</span>  5446, 29892,  ..., 29889,  8246,  3310],</span>
<span id="cb6-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7483,   310,   278,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">402,</span>  9851,  4423],</span>
<span id="cb6-39">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8041,   813,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3303,</span>  3900,   393]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 2:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27.744603]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       2/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1536</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6291456</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8457.2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.88744e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.164009 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.271 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>90.810 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>15498.234 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=70.98</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=91.53</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8384.83,</span> 8385.57<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">55.03,</span> 55.61<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27.752277]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1858,  3851, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">500,</span>    13,    13],</span>
<span id="cb7-6">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  349,  6156,  1650,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5806,</span> 28557,  3519],</span>
<span id="cb7-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16554,</span>   304,  1653,  ...,   322,  6934, 14722],</span>
<span id="cb7-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4955,   310, 10465,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1438,</span>  3841, 29892]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27,755] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:28.568805]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  363,  1302, 16453,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7967,</span> 29891,   484],</span>
<span id="cb7-11">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  367,   766,  4752,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 29871, 30143],</span>
<span id="cb7-12">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>   855,  1503,  ...,  3786, 29892,  5100],</span>
<span id="cb7-13">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  465,  1974,   289,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21588,</span>   533,   304]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:28,571] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:29.440843]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span>    13,  4806,  ...,  3086, 26040,  9220],</span>
<span id="cb7-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  293,  7207,   355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18131,</span>   520,  1247],</span>
<span id="cb7-17">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8619, 29889, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">304,</span> 10029,   266],</span>
<span id="cb7-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  363, 15202, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">482,</span> 17162, 19104]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:29,443] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:30.313403]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[25561,</span>   411,   278,  ...,   297,  2898, 26163],</span>
<span id="cb7-21">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[22574,</span>  2607, 18134,  ...,    13,  4706,   500],</span>
<span id="cb7-22">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[20190,</span> 24820,  1623,  ...,   310,   901, 29892],</span>
<span id="cb7-23">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>  1951,  4486,  ...,   869,   887, 30010]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:30,316] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:31.185339]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5371, 22417, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span>  6716,   901],</span>
<span id="cb7-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  353,  1565, 29936,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29878,</span>  3567,  7196],</span>
<span id="cb7-27">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[17296,</span>   338,  1985,  ...,  3741,  9089,   422],</span>
<span id="cb7-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  694, 13331,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21180,</span> 29892,   607]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:31,188] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32.057207]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  292,  8818,   267,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 11275,  7407],</span>
<span id="cb7-31">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1870, 29897,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2697,</span> 29901,    13],</span>
<span id="cb7-32">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29913,</span>   338,   263,  ..., 29892,   591,  3394],</span>
<span id="cb7-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2253,   472,  1554,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">982,</span>   304,   376]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32,060] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32.930293]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  391,  2598, 29883,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22629,</span>   346,   440],</span>
<span id="cb7-36">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29896, 29906,  ...,   407,   583,  2833],</span>
<span id="cb7-37">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4262,  1836,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   263, 10608],</span>
<span id="cb7-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1199,   411, 24770,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">272,</span>  2153, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32,932] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:33.803567]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  620, 20503,   428,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">297,</span>  1009,  9443],</span>
<span id="cb7-41">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  950, 25078,   892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span> 10636,   284],</span>
<span id="cb7-42">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1012,  2003,   364,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7313,</span> 29912, 19303],</span>
<span id="cb7-43">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29892, 29945,  ...,   967, 26414,   472]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 3:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:34.881265]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       3/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2304</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9437184</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7136.5 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2.83116e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.164038 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.279 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>107.615 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18366.372 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=84.12</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=108.46</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb8-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb8-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7078.48,</span> 7079.28<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">38.62,</span> 43.08<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:34.888870]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  496,   313, 29941,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1316,</span>   408,  4857],</span>
<span id="cb8-6">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>  3204, 29889,  ...,  1074,   330,  2547],</span>
<span id="cb8-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29916,</span> 29900, 29946,  ..., 18455, 29889,  4002],</span>
<span id="cb8-8">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[26406,</span>   338,  1641,  ...,   670,  1914,  6900]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:35.719630]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29945,</span> 29900,   867,  ...,  7601, 12091,   310],</span>
<span id="cb8-10">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  975, 29871, 29896,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3573,</span>   825,   306],</span>
<span id="cb8-11">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29900,  4638,  ..., 29227, 23145, 29892],</span>
<span id="cb8-12">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 14368,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14909,</span> 29936, 25913]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:36.591343]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  988,   306,  1033,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">437,</span>   408,  1532],</span>
<span id="cb8-14">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  450, 10317,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   752, 13036],</span>
<span id="cb8-15">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11405,</span>  8020, 29889,  ...,   471, 18096,   287],</span>
<span id="cb8-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  288,  3594, 19284,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">910,</span>   338,   385]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:37.463941]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  322, 15151, 29946,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11648,</span>  1497, 29889],</span>
<span id="cb8-18">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[24233,</span>   362,   467,  ...,  4513,  1353,   322],</span>
<span id="cb8-19">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 3311, 13605, 29912,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">945,</span> 29899,  4181],</span>
<span id="cb8-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1951,   366,   508,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6589,</span>   491,   777]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:38.343307]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span> 29900,    13,  ...,  6017,   424,  1711],</span>
<span id="cb8-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  5500,  1489,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>  3802,  7875],</span>
<span id="cb8-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8078,  5314,   515,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">373,</span>   278,  6991],</span>
<span id="cb8-24">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[13763,</span>  6204,  6359,  ...,  4706,  2024,  1347]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:39.214871]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>   13,  4806,  3512,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">278,</span>  7824,  6438],</span>
<span id="cb8-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2294,   938,   903,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4537,</span>  3047,   449],</span>
<span id="cb8-27">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1230,  4123,   767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   963, 21003],</span>
<span id="cb8-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1152,  2319, 10365,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">367,</span> 14040,   363]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.085368]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> building dataset for /flare/Aurora_deployment/AuroraGPT/datasets/dolma/data_v1.7_Llama2Tokenizer/tulu_flan-0000_text_document</span>
<span id="cb8-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.086224]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building dataset index ...</span>
<span id="cb8-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.085475]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[27297,</span> 29924,   801,  ..., 28947, 29892,   470],</span>
<span id="cb8-32">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12542,</span>  5568,   703,  ...,   426,    13,  4706],</span>
<span id="cb8-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 6907,   800,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1661, 30304],</span>
<span id="cb8-34">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 13630,   293,  ..., 26552,   363,   975]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.958071]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>   13, 29946, 29953,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29953,</span> 29945, 29871],</span>
<span id="cb8-36">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1283, 16578,  1156,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span>  2215,   408],</span>
<span id="cb8-37">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span>  4229,  7671,  ...,    13,  1576,  1014],</span>
<span id="cb8-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  526,  2898,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">471,</span>  4802, 29991]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 4:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.028460]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       4/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3072</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12582912</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7147.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3.77488e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.171233 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.272 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>107.458 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18339.524 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=84.00</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=108.31</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb9-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7091.77,</span> 7092.56<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">39.21,</span> 40.11<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.035716]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  443,   666, 10170,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">278,</span>   619,  7323],</span>
<span id="cb9-6">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13, 11008,   338,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2472,</span>   363, 22049],</span>
<span id="cb9-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span>    13, 29938,  ..., 29962,  8521, 29896],</span>
<span id="cb9-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1165,  2280,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">306,</span>   471,  2086]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.860756]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,   679,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1475,</span> 29889,  1570],</span>
<span id="cb9-10">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2184, 29936,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4706,</span>   970,  1780],</span>
<span id="cb9-11">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29872,</span>   352, 29901,  ..., 29905,  4915, 29912],</span>
<span id="cb9-12">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16809,</span>   304,  1438,  ..., 13457, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:43.731208]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[12015,</span> 29901, 20549,  ...,   322, 10752, 17906],</span>
<span id="cb9-14">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  372, 30010, 29879,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 14595,   653],</span>
<span id="cb9-15">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[18280,</span> 29958,    13,  ..., 18884,   736,  6251],</span>
<span id="cb9-16">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,    13,  ...,   599,   373, 17097]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:44.605047]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 3367,   567,   964,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3353,</span> 24870,  2181],</span>
<span id="cb9-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1262,  2609,   367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29974,</span> 29896,  7570],</span>
<span id="cb9-19">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29941, 29900,  ...,   341,   555,   265],</span>
<span id="cb9-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4225,   526,  6041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1925,</span>  1623,  2748]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:45.479433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2283, 10162,  1496,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30656,</span> 30317, 30605],</span>
<span id="cb9-22">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29879,</span>  9228,   292,  ...,  7968, 29899,  7052],</span>
<span id="cb9-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  884,   599,   367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>   278,  6054],</span>
<span id="cb9-24">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29879,</span>   411,   278,  ...,   367,  5019,  1183]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:46.351707]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 3867,   281,   761,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11949,</span>   338,  4922],</span>
<span id="cb9-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  1432,  2586,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5414,</span>   278, 29811],</span>
<span id="cb9-27">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>   278, 15562,  ..., 10296,   310,   394],</span>
<span id="cb9-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1451,  2960,  3505,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">657,</span> 14346,  8003]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:47.222016]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 6601,  2874,   414,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">302,</span>   317,  7390],</span>
<span id="cb9-30">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16415,</span>   297,  5146,  ...,   763,   372,   471],</span>
<span id="cb9-31">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29941,</span> 29906,  1118,  ..., 29900, 29889, 29953],</span>
<span id="cb9-32">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4893,   304,  4808,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2284,</span>  2164, 18690]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:48.094752]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  901,   310,  2994,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29873,</span>  1641,   766],</span>
<span id="cb9-34">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  304,  1716,  2562,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3489,</span>   304,   367],</span>
<span id="cb9-35">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1949,  6736, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29965,</span> 29909,   353],</span>
<span id="cb9-36">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,    13, 29930,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16497,</span>   316,   474]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
</ul>
</details></li>
<li><p>Skipping steps <code>[2, 3]</code>:</p>
<details closed="">
<summary>
<p><code>tokens</code>:</p>
</summary>
<ul>
<li><p>Iteration 0:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:47.749839]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,  7344,  5146,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9776,</span> 29914, 26419],</span>
<span id="cb10-2">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,  4706,  ...,  9280, 30004,    13],</span>
<span id="cb10-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29943,</span> 20774, 29908,  ...,   304, 27391,   322],</span>
<span id="cb10-4">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2645,   445, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16888,</span>  4656, 10070]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:51.451183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2768,   596,  1788,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27274,</span>   393, 30010],</span>
<span id="cb10-6">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5613,  4192,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">362,</span>   310,  1950],</span>
<span id="cb10-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[28038,</span> 29892,  2022,  ...,  3160,   278,  2087],</span>
<span id="cb10-8">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4149,   907, 29888,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29896,</span> 29892, 29896]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:54.073597]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  424,   322, 16232,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">366,</span>   748,   467],</span>
<span id="cb10-10">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,   462,  1678,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2084,</span> 29892,  3497],</span>
<span id="cb10-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7562,   310, 19320,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8973,</span> 22684,   358],</span>
<span id="cb10-12">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2089,  3633,   292,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13774,</span>   269,  2375]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:56.212476]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[21411,</span>   322,  3896,  ...,  2610, 29889,   319],</span>
<span id="cb10-14">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8003, 29898, 29900,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12,</span>  6658,   529],</span>
<span id="cb10-15">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  4148,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span> 12212,   282],</span>
<span id="cb10-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5977, 29871, 29906,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15332,</span>   310,  1749]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:57.207940]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  278,  1473, 24987,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  2217,  3804],</span>
<span id="cb10-18">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2973,   263, 18778,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  4642,  6673],</span>
<span id="cb10-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  309,   323,   804,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1063,</span> 15296,   327],</span>
<span id="cb10-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5864,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9409,</span> 29889,  2178]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:58.083935]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29892,</span> 13731,  6617,  ..., 29871, 29896, 29946],</span>
<span id="cb10-22">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2892,  1012,  1266,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4036,</span>  7512,  2068],</span>
<span id="cb10-23">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1473,  1556,  3619,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3762,</span>   338,   263],</span>
<span id="cb10-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[23353,</span> 29918,  2177,  ...,   501,   567,   814]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:58.951793]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5400, 14378,  4768,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2107,</span> 18677, 29889],</span>
<span id="cb10-26">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9200, 29887, 29914,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">293,</span> 24235,   322],</span>
<span id="cb10-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[30143,</span>  4746,  2184,  ..., 11891, 29974, 25760],</span>
<span id="cb10-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[19263,</span> 29914,   303,  ...,   358, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:59.820234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  309,  1306,   681,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span> 23186, 21809],</span>
<span id="cb10-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29896,</span> 29929,    13,  ..., 29871, 29900,    13],</span>
<span id="cb10-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9558,   964,   263,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   282,   682],</span>
<span id="cb10-32">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 23904, 21767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">313,</span> 29929, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 1:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.943867]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       1/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3145728</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>21224.4 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9.4372e-09 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.167250 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>36.185 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6175.523 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=28.29</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=36.47</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.953432]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1472, 29892,   408,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1584,   363],</span>
<span id="cb11-4">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  967, 19475,  6593,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8093,</span> 29899, 11249],</span>
<span id="cb11-5">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1006,  2218, 13326,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2355,</span>  1304,   304],</span>
<span id="cb11-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 29916, 29947,  ...,   353,  1870, 29936]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.957524]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 2354,   274,  1041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 13049,  9098],</span>
<span id="cb11-9">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8798,  9547, 10353,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">303,</span>  3143, 29889],</span>
<span id="cb11-10">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1373,  4056,  7236,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3186,</span>   297,  5837],</span>
<span id="cb11-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1738, 29920,  7355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29871,  3776]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.966648]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 2020,   306,  1016,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   920,   372],</span>
<span id="cb11-14">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5921,  1749,  7306,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19252,</span>   297,  5664],</span>
<span id="cb11-15">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  970,   770, 28547,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">970,</span>   894,  2577],</span>
<span id="cb11-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1907,   363, 14188,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">756,</span>  3646,   287]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.969989]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  715, 25392,  3104,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">289,</span>  5761,   616],</span>
<span id="cb11-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  426,    13,  9651,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9651,</span>  1815, 22603],</span>
<span id="cb11-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7714,  1213,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29876,   457],</span>
<span id="cb11-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span> 28663,  1230,  ...,  1546,   278,  6586]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.990736]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29929,</span>    13,    13,  ..., 10739,  4770, 11277],</span>
<span id="cb11-24">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4528,   304,  2367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2501,</span>   385,  4203],</span>
<span id="cb11-25">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  869,   319,   794,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3158,</span> 29889,  3115],</span>
<span id="cb11-26">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  592,   260,  4125,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">284,</span>  1135, 18655]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.993101]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">5/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[14338,</span> 25323,  3321,  ...,  5607,  1806,  1164],</span>
<span id="cb11-29">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  322,   278, 15352,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6462,</span>   313,  1552],</span>
<span id="cb11-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[25738,</span>   714, 29889,  ..., 29915, 29879, 24842],</span>
<span id="cb11-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5122,   399, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29947,</span>  7284,  2305]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.036896]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">6/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  367, 19310,  1891,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2408,</span>   292,   263],</span>
<span id="cb11-34">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  470,  3307,  5713,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">568,</span>  2594, 19385],</span>
<span id="cb11-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29953,</span> 29905,  1631,  ...,  1118,   343, 29897],</span>
<span id="cb11-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10261,</span>   373,  5490,  ...,   511,   297,  1760]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.039401]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">7/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1006,   326, 29901,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14834,</span>  6694,  9595],</span>
<span id="cb11-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12058,</span>  5446, 29892,  ..., 29889,  8246,  3310],</span>
<span id="cb11-40">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7483,   310,   278,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">402,</span>  9851,  4423],</span>
<span id="cb11-41">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8041,   813,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3303,</span>  3900,   393]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 2:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.050766]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       2/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1536</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6291456</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>106.8 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.88744e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7190.781 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1227226.651 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=5620.92</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=7247.49</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb12-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.055864]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1069</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Caught 3 in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ranges_to_skip'</span>, skipping!</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.057929]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1082</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> torch.Size<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> len<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_iterator</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=490723200</span></span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.059118]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1858,  3851, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">500,</span>    13,    13],</span>
<span id="cb12-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  349,  6156,  1650,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5806,</span> 28557,  3519],</span>
<span id="cb12-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16554,</span>   304,  1653,  ...,   322,  6934, 14722],</span>
<span id="cb12-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4955,   310, 10465,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1438,</span>  3841, 29892]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.061999]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  363,  1302, 16453,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7967,</span> 29891,   484],</span>
<span id="cb12-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  367,   766,  4752,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 29871, 30143],</span>
<span id="cb12-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>   855,  1503,  ...,  3786, 29892,  5100],</span>
<span id="cb12-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  465,  1974,   289,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21588,</span>   533,   304]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.065494]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span>    13,  4806,  ...,  3086, 26040,  9220],</span>
<span id="cb12-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  293,  7207,   355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18131,</span>   520,  1247],</span>
<span id="cb12-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8619, 29889, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">304,</span> 10029,   266],</span>
<span id="cb12-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  363, 15202, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">482,</span> 17162, 19104]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.069035]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[25561,</span>   411,   278,  ...,   297,  2898, 26163],</span>
<span id="cb12-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[22574,</span>  2607, 18134,  ...,    13,  4706,   500],</span>
<span id="cb12-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[20190,</span> 24820,  1623,  ...,   310,   901, 29892],</span>
<span id="cb12-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>  1951,  4486,  ...,   869,   887, 30010]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.072577]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 5371, 22417, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span>  6716,   901],</span>
<span id="cb12-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  353,  1565, 29936,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29878,</span>  3567,  7196],</span>
<span id="cb12-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[17296,</span>   338,  1985,  ...,  3741,  9089,   422],</span>
<span id="cb12-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  694, 13331,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21180,</span> 29892,   607]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.075789]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">5/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  292,  8818,   267,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 11275,  7407],</span>
<span id="cb12-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1870, 29897,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2697,</span> 29901,    13],</span>
<span id="cb12-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29913,</span>   338,   263,  ..., 29892,   591,  3394],</span>
<span id="cb12-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2253,   472,  1554,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">982,</span>   304,   376]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.079052]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">6/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  391,  2598, 29883,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22629,</span>   346,   440],</span>
<span id="cb12-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29896, 29906,  ...,   407,   583,  2833],</span>
<span id="cb12-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4262,  1836,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   263, 10608],</span>
<span id="cb12-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1199,   411, 24770,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">272,</span>  2153, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.082739]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">7/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  620, 20503,   428,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">297,</span>  1009,  9443],</span>
<span id="cb12-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  950, 25078,   892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span> 10636,   284],</span>
<span id="cb12-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1012,  2003,   364,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7313,</span> 29912, 19303],</span>
<span id="cb12-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29892, 29945,  ...,   967, 26414,   472]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
<li><p>Iteration 3:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.135651]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration= 3/ 635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2304</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9437184</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>84.7 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2.83116e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9070.783 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1548080.271 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=7090.49</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=9142.31</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.143511]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[496,</span>   313, 29941,  ...,  1316,   408,  4857],</span>
<span id="cb13-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>  3204, 29889,  ...,  1074,   330,  2547],</span>
<span id="cb13-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29916,</span> 29900, 29946,  ..., 18455, 29889,  4002],</span>
<span id="cb13-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[26406,</span>   338,  1641,  ...,   670,  1914,  6900]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.971988]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29945,</span> 29900,   867,  ...,  7601, 12091,   310],</span>
<span id="cb13-7">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  975, 29871, 29896,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3573,</span>   825,   306],</span>
<span id="cb13-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29900,  4638,  ..., 29227, 23145, 29892],</span>
<span id="cb13-9">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 14368,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14909,</span> 29936, 25913]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:10.843966]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[988,</span>   306,  1033,  ...,   437,   408,  1532],</span>
<span id="cb13-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  450, 10317,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   752, 13036],</span>
<span id="cb13-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11405,</span>  8020, 29889,  ...,   471, 18096,   287],</span>
<span id="cb13-13">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  288,  3594, 19284,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">910,</span>   338,   385]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:11.715513]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[322,</span> 15151, 29946,  ..., 11648,  1497, 29889],</span>
<span id="cb13-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[24233,</span>   362,   467,  ...,  4513,  1353,   322],</span>
<span id="cb13-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 3311, 13605, 29912,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">945,</span> 29899,  4181],</span>
<span id="cb13-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1951,   366,   508,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6589,</span>   491,   777]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:12.584136]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span> 29900,    13,  ...,  6017,   424,  1711],</span>
<span id="cb13-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  5500,  1489,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>  3802,  7875],</span>
<span id="cb13-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8078,  5314,   515,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">373,</span>   278,  6991],</span>
<span id="cb13-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[13763,</span>  6204,  6359,  ...,  4706,  2024,  1347]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:13.450767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[13,</span>  4806,  3512,  ...,   278,  7824,  6438],</span>
<span id="cb13-23">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2294,   938,   903,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4537,</span>  3047,   449],</span>
<span id="cb13-24">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1230,  4123,   767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   963, 21003],</span>
<span id="cb13-25">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1152,  2319, 10365,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">367,</span> 14040,   363]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:14.317517]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[27297,</span> 29924,   801,  ..., 28947, 29892,   470],</span>
<span id="cb13-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12542,</span>  5568,   703,  ...,   426,    13,  4706],</span>
<span id="cb13-28">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 6907,   800,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1661, 30304],</span>
<span id="cb13-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 13630,   293,  ..., 26552,   363,   975]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:15.187191]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[13,</span> 29946, 29953,  ..., 29953, 29945, 29871],</span>
<span id="cb13-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1283, 16578,  1156,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span>  2215,   408],</span>
<span id="cb13-32">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span>  4229,  7671,  ...,    13,  1576,  1014],</span>
<span id="cb13-33">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  526,  2898,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">471,</span>  4802, 29991]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div></li>
</ul>
</details></li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Spike {Skipper}},
  date = {2024-09-17},
  url = {https://samforeman.me/posts/AuroraGPT/spike-skipper},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúSpike Skipper.‚Äù</span> September 17, 2024. <a href="https://samforeman.me/posts/AuroraGPT/spike-skipper">https://samforeman.me/posts/AuroraGPT/spike-skipper</a>.
</div></div></section></div> ]]></description>
  <category>AuroraGPT</category>
  <guid>https://samforeman.me/posts/AuroraGPT/spike-skipper/</guid>
  <pubDate>Tue, 17 Sep 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>AuroraGPT</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/talks/hpc-user-forum/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="auroragpt-goals" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="auroragpt-goals">üéØ AuroraGPT Goals</h2>
<div class="flex-container" style="flex-direction: column; justify-content: space-around;">
<div class="flex-container" style="flex-direction: row; justify-content: space-around; align-items:center;">
<div class="col1">
<div class="blue-card" style="margin-bottom: 0.5em;">
<p><strong>AuroraGPT</strong>: <em>General purpose scientific LLM</em><br>
Broadly trained on a general corpora plus scientific {papers, texts, data}</p>
</div>
<ul>
<li><strong>Explore pathways</strong> towards a ‚ÄúScientific Assistant‚Äù model</li>
<li><strong>Build with international partners</strong> (RIKEN, BSC, others)</li>
<li><strong>Multilingual</strong> English, Êó•Êú¨Ë™û, French, German, Spanish</li>
<li><strong>Multimodal</strong>: images, tables, equations, proofs, time series, graphs, fields, sequences , etc</li>
</ul>
</div>
<div class="col2" style="width:75%; text-align: center;">
<p><a href="./assets/llms.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://samforeman.me/talks/hpc-user-forum/assets/llms.gif" class="img-fluid"></a></p>
<p><span class="dim-text" style="font-size: 75%;">Image from <iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/Hannibal046/Awesome-LLM"><code>Hannibal046/Awesome-LLM</code></a></span></p>
</div>
</div>
<div id="fig-timeline" class="quarto-float quarto-figure quarto-figure-center anchored" style="margin-left:auto;margin-right:auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/timelines.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;1: Credit to the entire AuroraGPT team for slides."><img src="https://samforeman.me/talks/hpc-user-forum/assets/timelines.png" class="img-fluid figure-img" style="margin-left:auto;margin-right:auto;;width:66.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Credit to the entire AuroraGPT team for slides.
</figcaption>
</figure>
</div>
</div>
<div class="notes">
<ul>
<li><p>Here to talk about AuroraGPT, Argonne‚Äôs internal effort to build a general purpose scientific LLM, broadly trained on a general corpora of text + scientific {papers, text, data}</p></li>
<li><p>As part of this effort, we plan to‚Ä¶</p>
<ul>
<li>Explore pathways, build with international partners, multi-{lingual, modal}</li>
</ul></li>
<li><p>Rough timeline of the project and deliverables:</p>
<ul>
<li>202{3,4}: text-only models, plan to release a series of {7B, 70B, 1T} models</li>
<li>202{4,5}: Basic multi-modal models</li>
<li>202{5,6}: Advanced scientific multimodal models</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-open-science-foundation-models" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-open-science-foundation-models">üß™ AuroraGPT: Open Science Foundation Models</h2>
<div style="vertical-align:center;">
<p><a href="./assets/AuroraGPT.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://samforeman.me/talks/hpc-user-forum/assets/AuroraGPT.svg" class="img-fluid"></a></p>
</div>
<div class="notes">
<ul>
<li>AuroraGPT will be a publicly distributed, open source foundation model for open science</li>
<li>Is being trained on:
<ul>
<li>Scientific / engineering structured data</li>
<li>General text, media, news, etc.</li>
<li>Large amounts of low to medium quality data</li>
<li>Much less high quality data (that is publicly available for use)</li>
</ul></li>
<li>This data is then cleaned, processed, de-duplicated and used for the initial pre-training phase of the model</li>
<li>The vast majority of the overall compute is spent during this initial pre-training phase
<ul>
<li>This is the group I help to lead and will be talking a bit about today</li>
</ul></li>
<li>The initial pre-training phase is currently underway
<ul>
<li>Eventually, given a bit of time, effort and magic, the model will be ready for fine-tuning and additional training for a variety of downstream tasks</li>
</ul></li>
<li>The pretrained model will then be handed off for additional fine-tuning on a variety of downstream tasks
<ul>
<li>Scientific discovery</li>
<li>Accelerate scientific tasks</li>
<li>Digital twins</li>
<li>Inverse design</li>
<li>Code optimization</li>
<li>Accelerated simulations</li>
<li>Autonomous experiments</li>
<li>Co-design</li>
</ul></li>
<li>Becoming increasingly clear that LLMs have the potential to drastically accelerate computational science
<ul>
<li>We‚Äôve seen this already for {GenSLMs, Weather / Climate / Earth Systems Modeling, Particle Physics, etc.}</li>
</ul></li>
</ul>
</div>
</section>
<section id="auroragpt-outcomes" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="auroragpt-outcomes">üìä AuroraGPT Outcomes</h2>
<ul>
<li><strong>Datasets and data pipelines</strong> for preparing science training data</li>
<li><strong>Software infrastructure and workflows</strong> to train, evaluate and deploy LLMs at scale for scientific resarch purposes</li>
<li><strong>Evaluation of state-of-the-art LLM Models</strong> to determine where they fall short in deep scientific tasks and where deep data may have an impact</li>
<li><strong>Assessment of the approach</strong> of augmenting web training data with two forms of data specific to science
<ul>
<li>Full text scientific papers</li>
<li>Structured scientific datasets (suitably mapped to narrative form)</li>
</ul></li>
<li><strong>Research grade artifacts</strong> (<strong>models</strong>) for scientific community for adaptation for downstream uses</li>
<li><strong>Promotion of responsible AI</strong> best practices where we can figure them out</li>
<li><strong>International Collaborations</strong> around the long term goal of <em>AGI for science</em></li>
</ul>
<div class="notes">
<ul>
<li><p>Deliverables:</p>
<ul>
<li>datasets, pipelines</li>
<li>software infrastructure, workflows to interface with science applications</li>
<li>checkpoints, models, logs, workbook, insights, etc.</li>
</ul></li>
<li><p>Hope to understand:</p>
<ul>
<li>How different state-of-the-art models perform at different scientific tasks</li>
<li>where deep data may have an impact</li>
<li>feasibility of generically augmenting text with scientific structured data</li>
</ul></li>
<li><p>Huge undertaking that will require large international collaborations around long term goal of AGI for science</p></li>
<li><p>Extra points:</p>
<ul>
<li>Well known that LLMs are good for non-consequential tasks</li>
<li>Known to ‚Äúhallucinate‚Äù and create false information</li>
<li>Can this be mitigated reliably ??</li>
</ul></li>
</ul>
</div>
</section>
<section id="aurora" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="aurora">üåå Aurora</h2>
<div class="flex-container">
<div class="col1">
<div id="tbl-aurora" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Aurora Specs
</figcaption>
<div aria-describedby="tbl-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Racks</td>
<td style="text-align: center;">166</td>
</tr>
<tr class="even">
<td>Nodes</td>
<td style="text-align: center;">10,624</td>
</tr>
<tr class="odd">
<td>CPUs</td>
<td style="text-align: center;">21,248</td>
</tr>
<tr class="even">
<td>GPUs</td>
<td style="text-align: center;">63,744</td>
</tr>
<tr class="odd">
<td>NICs</td>
<td style="text-align: center;">84,992</td>
</tr>
<tr class="even">
<td>HBM</td>
<td style="text-align: center;">8 PB</td>
</tr>
<tr class="odd">
<td>DDR5c</td>
<td style="text-align: center;">10 PB</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div id="fig-aurora" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/aurora.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;2: Aurora Fact Sheet"><img src="https://samforeman.me/talks/hpc-user-forum/assets/aurora.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aurora-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: <a href="https://www.alcf.anl.gov/sites/default/files/2024-07/Aurora_FactSheet_2024.pdf">Aurora Fact Sheet</a>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="alcf-ai-testbed" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="alcf-ai-testbed">ü§ñ ALCF AI Testbed</h2>
<ul>
<li>ALCF AI Testbed Systems are in production and <a href="https://accounts.alcf.anl.gov/#/allocationRequests">available for allocations</a> to the research community</li>
<li>Significant improvement in time-to-solution and energy-efficiency for diverse AI for science applications.</li>
<li><a href="https://nairrpilot.org/">NAIRR Pilot</a></li>
</ul>
<div class="red-card" style="color: #FF5252; font-size:90%;">
<p>Up to 25X improvement for genomic foundation models with 6.5X energy efficiency</p>
</div>
<div class="flex-container" style="margin-bottom: 1em;">
<div id="fig-sambanova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/sambanova.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;3: SambaNova SN-30: 2nd Gen, 8 nodes with 64 AI Accelerators"><img src="https://samforeman.me/talks/hpc-user-forum/assets/sambanova.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sambanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <strong>SambaNova SN-30</strong>: 2nd Gen, 8 nodes with 64 AI Accelerators
</figcaption>
</figure>
</div>
<div id="fig-graphcore" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/graphcore.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;4: Graphcore Bow: generation accelerators: Pod-64 configuration with 64 accelerators"><img src="https://samforeman.me/talks/hpc-user-forum/assets/graphcore.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphcore-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: <strong>Graphcore Bow</strong>: generation accelerators: Pod-64 configuration with 64 accelerators
</figcaption>
</figure>
</div>
<div id="fig-cerebras" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/cerebras.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;5: Cerebras: 2x CS-2 WSE with Memory-X and Swarm-X technologies"><img src="https://samforeman.me/talks/hpc-user-forum/assets/cerebras.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cerebras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: <strong>Cerebras</strong>: 2x CS-2 WSE with Memory-X and Swarm-X technologies
</figcaption>
</figure>
</div>
<div id="fig-groq" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/groq.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;6: GroqRack: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node"><img src="https://samforeman.me/talks/hpc-user-forum/assets/groq.jpeg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>GroqRack</strong>: 9 nodes, 8 GroqChip v1.5 Tensor streaming processors accelerators per node
</figcaption>
</figure>
</div>
</div>
</section>
<section id="team-leads" class="level2 smaller" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="team-leads">üë• Team Leads</h2>
<div style="font-size: 66%;">
<div class="flex-container" style="text-align: center; align-items: center;">
<p><strong>Planning</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rick-stevens.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rick Stevens"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/rick-stevens.png" style="height:1.04167in" alt="Rick Stevens" class="figure-img"></a></p>
<figcaption>Rick Stevens<sup>1</sup></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Ian Foster"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rinku-gupta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rinku Gupta"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/rinku-gupta.png" style="height:1.04167in" alt="Rinku Gupta" class="figure-img"></a></p>
<figcaption>Rinku Gupta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/mike-papka.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Mike Papka"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/mike-papka.png" style="height:1.04167in" alt="Mike Papka" class="figure-img"></a></p>
<figcaption>Mike Papka</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/arvind-ramanathan.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Arvind Ramanathan"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/arvind-ramanathan.png" style="height:1.04167in" alt="Arvind Ramanathan" class="figure-img"></a></p>
<figcaption>Arvind Ramanathan</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/fangfang-xia.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Fangfang Xia"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/fangfang-xia.png" style="height:1.04167in" alt="Fangfang Xia" class="figure-img"></a></p>
<figcaption>Fangfang Xia</figcaption>
</figure>
</div>
</div>
<div class="flex-container" style="text-align: center;">
<div class="col2">
<p><strong>Data</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/ian-foster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Ian Foster"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/ian-foster.png" style="height:1.04167in" alt="Ian Foster" class="figure-img"></a></p>
<figcaption>Ian Foster</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/robert-underwood.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Robert Underwood"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/robert-underwood.png" style="height:1.04167in" alt="Robert Underwood" class="figure-img"></a></p>
<figcaption>Robert Underwood</figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Models / Training</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/venkat-vishwanath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Venkat Vishwanath"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/venkat-vishwanath.png" style="height:1.04167in" alt="Venkat Vishwanath" class="figure-img"></a></p>
<figcaption>Venkat Vishwanath</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sam-foreman.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Sam Foreman"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/sam-foreman.png" style="height:1.04167in" alt="Sam Foreman" class="figure-img"></a></p>
<figcaption><span style="color: #ff1a8f; background-color: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); font-weight: 500;">Sam Foreman</span></figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Evaluation</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/franck-cappello.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Franck Cappello"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/franck-cappello.png" style="height:1.05556in" alt="Franck Cappello" class="figure-img"></a></p>
<figcaption>Franck Cappello</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/sandeep-madireddy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Sandeep Madireddy"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/sandeep-madireddy.png" style="height:1.04167in" alt="Sandeep Madireddy" class="figure-img"></a></p>
<figcaption>Sandeep Madireddy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/bo-li.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Bo Li"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/bo-li.png" style="height:1.04167in" alt="Bo Li" class="figure-img"></a></p>
<figcaption>Bo Li</figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Post</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/eliu-huerta.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Eliu Huerta"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/eliu-huerta.png" style="height:1.04167in" alt="Eliu Huerta" class="figure-img"></a></p>
<figcaption>Eliu Huerta</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/azton-wells.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Azton Wells"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/azton-wells.png" style="height:1.04167in" alt="Azton Wells" class="figure-img"></a></p>
<figcaption>Azton Wells</figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Inference</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/rajeev-thakur.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Rajeev Thakur"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/rajeev-thakur.png" style="height:1.04167in" alt="Rajeev Thakur" class="figure-img"></a></p>
<figcaption>Rajeev Thakur</figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Comms</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/charlie-catlett.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Charlie Catlett"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/charlie-catlett.png" style="height:1.04167in" alt="Charlie Catlett" class="figure-img"></a></p>
<figcaption>Charlie Catlett</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/david-martin.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="David Martin"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/david-martin.png" style="height:1.04167in" alt="David Martin" class="figure-img"></a></p>
<figcaption>David Martin</figcaption>
</figure>
</div>
</div>
<div class="col2">
<p><strong>Distribution</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/team/brad-ullrich.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Brad Ullrich"><img src="https://samforeman.me/talks/hpc-user-forum/assets/team/brad-ullrich.png" style="height:1.04167in" alt="Brad Ullrich" class="figure-img"></a></p>
<figcaption>Brad Ullrich</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="teams" class="level2" data-auto-animate="true" data-background-color="white">
<h2 data-auto-animate="true" data-background-color="white" class="anchored" data-anchor-id="teams">ü§ù Teams</h2>
<div class="flex-container">
<div class="col1">
<ul>
<li><strong>Planning</strong></li>
<li><strong>Data Prep</strong>
<ul>
<li>Accumulate 20+ T tokens of high-quality scientific text and structured data</li>
</ul></li>
<li><span style="background: oklch(from #ff1a8f calc(l * 1.15) c h / 0.1); border: 1px solid #ff1a8f; border-radius: 0.25px;"><strong>Models / Training</strong></span><sup>2</sup>
<ul>
<li>Train (entirely from scratch) a series of models on publicly available data</li>
</ul></li>
<li><strong>Evaluation</strong>
<ul>
<li>Skills, trustworthiness, safety, robustness, privacy, machine ethics</li>
</ul></li>
</ul>
</div>
<div class="col2">
<ul>
<li><strong>Post-Training</strong>
<ul>
<li>Fine-tuning, alignment</li>
</ul></li>
<li><strong>Inference</strong>
<ul>
<li>Model serving, API development / public-facing web services</li>
</ul></li>
<li><strong>Distribution</strong>
<ul>
<li>Licensing, generating and distributing artifacts for public consumption</li>
</ul></li>
<li><strong>Communication</strong></li>
</ul>
</div>
</div>
</section>
<section id="model-training" class="level2 smaller page-columns page-full" data-background-color="white">
<h2 class="smaller anchored" data-background-color="white" data-anchor-id="model-training">ü¶ú Model Training</h2>
<div class="flex-container" style="text-align: left; width: 100%; justify-content: space-around; line-height: 1em;">
<div class="col1" width="48%" style="background: oklch(from #03BD00 calc(l * 1.15) c h / 0.1); border: 1px solid #03BD00; border-radius: 0.25em; padding: 3pt 8pt; margin-left: 5pt; margin-right: 5pt;">
<p>‚úÖ <span style="color: #03BD00;"><strong>Goals</strong></span></p>
<ul>
<li>Want training runs at scale to be:
<ul>
<li>efficient</li>
<li>stable</li>
<li>reproducible</li>
</ul></li>
<li>This requires:
<ul>
<li>robust data pipelines / file IO</li>
<li>effectively overlapping compute with communication</li>
<li>stability across {network, filesystem, machine}</li>
</ul></li>
<li>3D / Multi-dimensional Parallelism strategies</li>
<li>Large batch training</li>
<li>Second order optimizers</li>
<li>Sub-quadratic attention</li>
<li>State space models</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
<div class="col2" width="48%" style="background: oklch(from #E90102 calc(l * 1.15) c h / 0.1); border: 1px solid #E90102; border-radius: 0.25em; padding: 3pt 8pt; margin-left: 5pt; margin-right: 5pt;">
<p>‚ùå <span style="color: #E90102;"><strong>Challenges</strong></span></p>
<ul>
<li><em>Looong time</em> to train, can be:
<ul>
<li>weeks (even months) of continuous training</li>
<li>order of magnitude longer than typical NN training jobs</li>
</ul></li>
<li>Stability issues:
<ul>
<li>failures are expensive (but inevitable)</li>
<li>stragglers common at scale</li>
</ul></li>
<li>Individual jobs are:
<ul>
<li><strong>fragile</strong></li>
<li>only as good as the worst rank</li>
<li>one hang or bad worker can crash job</li>
<li>network / filesystem / other-user(s) dependent</li>
</ul></li>
<li>Cost / benefits of different collective communication algorithms
<ul>
<li>depend on optimized / efficient implementations</li>
</ul></li>
<li>Network performance</li>
<li><em>Highly optimized GPU kernels</em></li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><iconify-icon inline="" icon="fa:github" aria-label="Icon github from fa Iconify.design set." title="Icon github from fa Iconify.design set."></iconify-icon> <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a></p>
</div></div></section>
<section id="accelerating-dataset-processing-at-scale-for-training" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-at-scale-for-training">üöÄ Accelerating Dataset Processing at Scale for Training</h2>
<ul>
<li>To train a fixed model on trillions of tokens requires:
<ul>
<li>Aggregating data from multiple different <em>corpora</em> (e.g.&nbsp;Reddit, StackExchange, GitHub, etc.)</li>
<li>Sampling <em>each training batch</em> according to a fixed distribution across corpora</li>
<li>Building indices that map batches of tokens into these files (indexing)</li>
</ul></li>
<li>The original implementation was slow, and designed to run on a single device
<ul>
<li>Major bottleneck when debugging data pipeline at scale</li>
</ul></li>
<li><label><input type="checkbox" checked="">Completely re-wrote an asynchronous, distributed implementation that <em>significantly</em> improves performance</label></li>
</ul>
</section>
<section id="accelerating-dataset-processing-at-scale-for-training-1" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="accelerating-dataset-processing-at-scale-for-training-1">üöÄ Accelerating Dataset Processing at Scale for Training</h2>
<ul class="task-list">
<li><label><input type="checkbox" checked="">Completely re-wrote an asynchronous, distributed implementation that <em>significantly</em> improves performance</label></li>
</ul>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/blendable.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Time spent building BlendableDataset"><img src="https://samforeman.me/talks/hpc-user-forum/assets/blendable.svg" class="img-fluid figure-img" alt="Time spent building BlendableDataset"></a></p>
<figcaption>Time spent building <code>BlendableDataset</code></figcaption>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/gpt.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Time spent building GPTDataset"><img src="https://samforeman.me/talks/hpc-user-forum/assets/gpt.svg" class="img-fluid figure-img" alt="Time spent building GPTDataset"></a></p>
<figcaption>Time spent building <code>GPTDataset</code></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="references" class="level2" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="references">üìì References</h2>
<div class="flex-container" style="gap: 1em;">
<div class="col1">
<ul>
<li>üè° <a href="https://samforeman.me">samforeman.me</a>:
<ul>
<li>ü¶ú <a href="https://samforeman.me/talks/">Talks</a>:
<ul>
<li><a href="https://samforeman.me/talks/hpc-user-forum/">HPC User Forum</a> [<a href="https://samforeman.me/talks/hpc-user-forum/slides.html">slides</a>]</li>
</ul></li>
</ul></li>
<li>See my other slides on:
<ul>
<li><a href="https://saforem2.github.io/llm-workshop-talk">LLMs from Scratch</a></li>
<li><a href="https://saforem2.github.io/LLM-tutorial">Creating Small(~ish) LLMs</a></li>
<li><a href="https://saforem2.github.io/parallel-training-slides">Parallel Training Techniques</a></li>
<li><a href="https://samforeman.me/talks/llms-on-polaris/#/title-slide">LLMs on Polaris</a></li>
<li><a href="https://samforeman.me/talks/llms-at-scale/">Training LLMs at Scale</a></li>
</ul></li>
</ul>
</div>
<div class="col2">
<ul>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">üèéÔ∏è <code>argonne-lcf/Megatron-DeepSpeed</code></a><br>
<span class="dim-text">For the largest of large language models.</span></li>
<li><a href="https://github.com/saforem2/ezpz">üçã <code>saforem2/ezpz</code></a><br>
<span class="dim-text">Distributed training, ezpz.</span></li>
<li>üëÄ See also:
<ul>
<li><a href="https://www.anl.gov/article/new-international-consortium-formed-to-create-trustworthy-and-reliable-generative-ai-models-for">New international consortium for generative AI models for science</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/dist_overview.html">PyTorch Distributed Overview</a></li>
<li><a href="https://pytorch.org/docs/master/notes/ddp.html">Distributed Data Parallel ‚Äî PyTorch master documentation</a></li>
<li><a href="https://huggingface.co/docs/transformers/en/perf_train_gpu_many">ü§ó Efficient Training on Multiple GPUs</a></li>
<li><a href="https://www.deepspeed.ai/getting-started/">Getting Started - DeepSpeed</a></li>
</ul></li>
</ul>
</div>
</div>
<section id="thank-you" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="thank-you">‚ù§Ô∏è Thank you!</h3>
<ul>
<li><p>Organizers</p></li>
<li><p>Feel free to reach out!</p>
<p><split even=""></split></p>
<p><a href="https://samforeman.me"><i class="fas fa-home"></i></a> <a href="mailto:///foremans@anl.gov"><i class="far fa-paper-plane"></i></a> <a href="https://www.twitter.com/saforem2"><i class="fab fa-twitter"></i></a></p>
<p></p></li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="üôè Acknowledgements">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üôè Acknowledgements
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.</p>
</div>
</div>
</div>
</section>
<section id="bibliography" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="bibliography">üìë Bibliography</h3>
<ul>
<li>Refs:
<ul>
<li><span class="citation" data-cites="wei2022emergentabilitieslargelanguage">Wei et al. (2022)</span></li>
<li>Animations from <a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></li>
</ul></li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-song2023ds4sci" class="csl-entry">
Song, Shuaiwen Leon, Bonnie Kruft, Minjia Zhang, Conglong Li, Shiyang Chen, Chengming Zhang, Masahiro Tanaka, et al. 2023. <span>‚ÄúDeepSpeed4Science Initiative: Enabling Large-Scale Scientific Discovery Through Sophisticated AI System Technologies.‚Äù</span> <a href="https://arxiv.org/abs/2310.04610">https://arxiv.org/abs/2310.04610</a>.
</div>
<div id="ref-wei2022emergentabilitieslargelanguage" class="csl-entry">
Wei, Jason, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, et al. 2022. <span>‚ÄúEmergent Abilities of Large Language Models.‚Äù</span> <a href="https://arxiv.org/abs/2206.07682">https://arxiv.org/abs/2206.07682</a>.
</div>
<div id="ref-yang2023harnessing" class="csl-entry">
Yang, Jingfeng, Hongye Jin, Ruixiang Tang, Xiaotian Han, Qizhang Feng, Haoming Jiang, Bing Yin, and Xia Hu. 2023. <span>‚ÄúHarnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond.‚Äù</span> <a href="https://arxiv.org/abs/2304.13712">https://arxiv.org/abs/2304.13712</a>.
</div>
</div>
</section>
</section>
<section id="extras" class="level2 page-columns page-full" data-background-color="white">
<h2 data-background-color="white" class="anchored" data-anchor-id="extras">üéÅ Extras</h2>
<section id="loooooooooong-sequence-lengths" class="level3 smaller page-columns page-full" data-background-color="#1c1c1c">
<h3 class="smaller anchored" data-background-color="#1c1c1c" data-anchor-id="loooooooooong-sequence-lengths">üöÇ Loooooooooong Sequence Lengths</h3>
<div class="flex-container" style="align-items: center; justify-content: center;">
<p><a href="../../assets/anl.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="https://samforeman.me/assets/anl.svg" class="img-fluid" style="height:50pt;"></a></p>
<p><span class="dim-text" style="font-size: 2.0em;"><iconify-icon inline="" icon="ic:baseline-plus" aria-label="Icon baseline-plus from ic Iconify.design set." title="Icon baseline-plus from ic Iconify.design set."></iconify-icon></span></p>
<p><a href="../../assets/deepspeed-logo-transparent.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="https://samforeman.me/assets/deepspeed-logo-transparent.svg" class="img-fluid" style="height:50pt;"></a></p>
</div>
<ul>
<li>Working with <a href="https://github.com/microsoft/DeepSpeed"><i class="fa-brands fa-microsoft" aria-label="microsoft"></i> Microsoft/DeepSpeed</a> team to enable longer sequence lengths (context windows) for LLMs
<ul>
<li>See my <a href="https://samforeman.me/posts/auroragpt/long-sequences/">blog post</a> for additional details</li>
</ul></li>
</ul>
<div id="fig-long-seq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="flex-container">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="25B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/25B.svg" class="img-fluid figure-img"></a></p>
<figcaption>25B</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="33B"><img src="https://raw.githubusercontent.com/saforem2/scaling4science/main/assets/33B.svg" class="img-fluid figure-img"></a></p>
<figcaption>33B</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-long-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Maximum (achievable) <code>SEQ_LEN</code> for both <code>25B</code> and <code>33B</code> models (See: <span class="citation" data-cites="song2023ds4sci">Song et al. (2023)</span>)
</figcaption>
</figure>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><a href="https://github.com/saforem2/scaling4science"><i class="fa-brands fa-github" aria-label="github"></i> <code>scaling4science</code></a><br>
<a href="https://github.com/saforem2/Megatron-DS-Benchmarking"><i class="fa-brands fa-github" aria-label="github"></i> <code>Megatron-DS-Benchmarking</code></a></p>
</div></div></section>
<section id="life-cycle-of-the-llm" class="level3" data-background-color="white">
<h3 data-background-color="white" class="anchored" data-anchor-id="life-cycle-of-the-llm">‚ôªÔ∏è Life Cycle of the LLM</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" style="text-align:center">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">üìù Pre-training</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">üéÄ Fine-Tuning</a></li></ul>
<div class="tab-content" style="text-align:center">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div id="fig-pretraining" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;8: Pre-training: Virtually all of the compute used during pretraining phase"><img src="https://jalammar.github.io/images/gpt3/03-gpt3-training-step-back-prop.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretraining-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: <strong>Pre-training</strong>: Virtually all of the compute used during pretraining phase
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div id="fig-fine-tuning" class="quarto-float quarto-figure quarto-figure-center anchored" style="width:90%; text-align: center; margin-left: auto; margin-right: auto;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;9: Fine-tuning: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task."><img src="https://jalammar.github.io/images/gpt3/10-gpt3-fine-tuning.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fine-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: <strong>Fine-tuning</strong>: Fine-tuning actually updates the model‚Äôs weights to make the model better at a certain task.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-llms" class="level3 smaller" data-background-color="white">
<h3 class="smaller anchored" data-background-color="white" data-anchor-id="training-llms">üçé Training LLMs</h3>
<div class="flex-container" style="align-items: flex-end;">
<div class="col1" style="width:33%;">
<div id="fig-it-hungers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;10: It‚Äôs hungry!"><img src="https://github.com/saforem2/llm-lunch-talk/blob/main/docs/assets/it_hungers.jpeg?raw=true" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-it-hungers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: It‚Äôs hungry!
</figcaption>
</figure>
</div>
</div>
<div class="col2" style="width:60%;">
<div id="fig-evolution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;11: Visualization from @yang2023harnessing"><img src="https://github.com/Mooler0410/LLMsPracticalGuide/raw/main/imgs/survey-gif-test.gif" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-evolution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Visualization from <span class="citation" data-cites="yang2023harnessing">Yang et al. (2023)</span>
</figcaption>
</figure>
</div>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Lead‚Ü©Ô∏é</p></li>
<li id="fn2"><p>Co-led by: Venkat Vishwanath, Sam Foreman‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@unpublished{foreman2024,
  author = {Foreman, Sam},
  title = {AuroraGPT},
  date = {2024-09-04},
  url = {https://samforeman.me/talks/hpc-user-forum/slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúAuroraGPT.‚Äù</span> September 4. <a href="https://samforeman.me/talks/hpc-user-forum/slides">https://samforeman.me/talks/hpc-user-forum/slides</a>.
</div></div></section></div> ]]></description>
  <guid>https://samforeman.me/talks/hpc-user-forum/</guid>
  <pubDate>Wed, 04 Sep 2024 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/talks/hpc-user-forum/assets/thumbnail.png" medium="image" type="image/png" height="90" width="144"/>
</item>
</channel>
</rss>
