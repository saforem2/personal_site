<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Sam Foreman</title>
<link>https://samforeman.me/posts/</link>
<atom:link href="https://samforeman.me/posts/index.xml" rel="self" type="application/rss+xml"/>
<description>Sam Foreman&#39;s Blog</description>
<image>
<url>https://samforeman.me/assets/thumbnail.png</url>
<title>Sam Foreman</title>
<link>https://samforeman.me/posts/</link>
<height>90</height>
<width>144</width>
</image>
<generator>quarto-1.8.14</generator>
<lastBuildDate>Sat, 14 Jun 2025 05:00:00 GMT</lastBuildDate>
<item>
  <title>üèóÔ∏è Building PyTorch 2.8 from Source on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/14/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="helper-functions" class="level2">
<h2 class="anchored" data-anchor-id="helper-functions">üöë Helper Functions</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tstamp()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> +<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d-%H%M%S"</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_day()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> +<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d"</span></span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="shell-environment" class="level2">
<h2 class="anchored" data-anchor-id="shell-environment">üèñÔ∏è Shell Environment</h2>
<ol type="1">
<li><p>Load <code>frameworks</code> module:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks</span></code></pre></div></li>
<li><p>Deactivate <code>conda</code> environment:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> deactivate</span></code></pre></div></li>
<li><p>Create new <code>conda</code> environment:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ENV_PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/datascience/foremans/miniconda/2025-06-15"</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--prefix</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ENV_PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--y</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--solver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>libmamba <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> python=3.12</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ENV_PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div></li>
</ol>
</section>
<section id="build-libraries" class="level2">
<h2 class="anchored" data-anchor-id="build-libraries">üî® Build Libraries</h2>
<section id="pytorch" class="level3">
<h3 class="anchored" data-anchor-id="pytorch">PyTorch</h3>
<ol type="1">
<li><p>Clone <a href="https://github.com/pytorch/pytorch">pytorch/<code>pytorch</code></a></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/pytorch</span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> pytorch</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span></code></pre></div></li>
<li><p>Install dependencies:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install cmake ninja</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install mkl-static mkl-include</span></code></pre></div></li>
<li><p>Make triton:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for Intel GPU support</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> triton</span></code></pre></div></li>
<li><p>Set environment variables for PyTorch build:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span></span>
<span id="cb8-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span></span>
<span id="cb8-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKLDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_FBGEMM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_QNNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_CAFFE2_OPS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_TEST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_DISTRIBUTED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NUMA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb8-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MPI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb8-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTEL_MKL_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$MKLROOT</span></span>
<span id="cb8-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_AOT_DEVLIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb8-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TORCH_XPU_ARCH_LIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb8-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OCLOC_VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24.39.1</span>
<span id="cb8-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> gcc</span>
<span id="cb8-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> g++</span></code></pre></div></li>
<li><p>Build PyTorch (takes ~ 30 mins):</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></li>
<li><p>[Optional] Install {<code>torchvision</code>, <code>torchaudio</code>, <code>torchdata</code>} with no dependencies:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install torchvision torchaudio <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-deps</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--index-url</span> https://download.pytorch.org/whl/xpu</span>
<span id="cb10-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install torchdata <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-deps</span></span></code></pre></div></li>
</ol>
</section>
<section id="intel-libraries" class="level3">
<h3 class="anchored" data-anchor-id="intel-libraries">Intel Libraries</h3>
<ol type="1">
<li><p><a href="https://github.com/intel/intel-extension-for-pytorch">intel/<code>intel-extension-for-pytorch</code></a></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/intel/intel-extension-for-pytorch</span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> intel-extension-for-pytorch</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout xpu-main</span>
<span id="cb11-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb11-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span></span>
<span id="cb11-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span></span>
<span id="cb11-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MAX_JOBS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>48</span>
<span id="cb11-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTELONEAPIROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ONEAPI_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ipex-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb11-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></li>
<li><p><a href="https://github.com/intel/torch-ccl">intel/<code>torch-ccl</code></a></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/intel/torch-ccl</span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> torch-ccl</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout c27ded5</span>
<span id="cb12-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule sync</span>
<span id="cb12-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span></span>
<span id="cb12-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># see:</span></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/intel/torch-ccl/blob/c27ded5190a6b115ec68c7a8c28f40cfe7f0a32a/version.txt</span></span>
<span id="cb12-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ONECCL_BINDINGS_FOR_PYTORCH_BACKEND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>xpu <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-10">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTELONEAPIROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ONEAPI_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-11">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_SYSTEM_ONECCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ON <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-12">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">COMPUTE_BACKEND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dpcpp <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb12-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch-ccl-build-whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb12-14"></span>
<span id="cb12-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/oneccl_bind_pt-2.8.0+xpu-cp312-cp312-linux_x86_64.whl</span>
<span id="cb12-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div></li>
</ol>
</section>
<section id="mpi4py-install" class="level3">
<h3 class="anchored" data-anchor-id="mpi4py-install"><code>mpi4py</code> Install</h3>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/mpi4py/mpi4py</span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> mpi4py</span>
<span id="cb13-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicc <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicxx <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py build <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span>
<span id="cb13-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicc <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mpicxx <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py install <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> install.log</span>
<span id="cb13-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ..</span></code></pre></div>
</section>
</section>
<section id="verify-installation" class="level2">
<h2 class="anchored" data-anchor-id="verify-installation">‚úÖ Verify Installation</h2>
<ul>
<li><p>Command:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import torch; print(torch.__file__); print(*torch.__config__.show().split("\n"), sep="\n") ; print(f"{torch.__version__=}"); print(f"{torch.xpu.is_available()=}"); print(f"{torch.xpu.device_count()=}") ; import torch.distributed; print(f"{torch.distributed.is_xccl_available()=}"); import torch; import intel_extension_for_pytorch as ipex; print(f"{torch.__version__=}"); print(f"{ipex.__version__=}"); import oneccl_bindings_for_pytorch as oneccl_bpt; print(f"{oneccl_bpt.__version__=}") ; [print(f"[{i}]: {torch.xpu.get_device_properties(i)}") for i in range(torch.xpu.device_count())]'</span></span></code></pre></div></li>
<li><p>Output:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/datascience/foremans/micromamba/envs/2025-06-12/lib/python3.12/site-packages/torch/__init__.py</span></span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PyTorch</span> built with:</span>
<span id="cb15-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> GCC 13.3</span>
<span id="cb15-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> C++ Version: 201703</span>
<span id="cb15-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneAPI</span> Math Kernel Library Version 2025.0.1-Product Build 20241031 for Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">64</span> architecture applications</span>
<span id="cb15-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MKL-DNN</span> v3.7.1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Git</span> Hash 8d263e693366ef8db40acc569cc7d8edf644556d<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> OpenMP 201511 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a.k.a.</span> OpenMP 4.5<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> LAPACK is enabled <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">usually</span> provided by MKL<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> NNPACK is enabled</span>
<span id="cb15-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> CPU capability usage: AVX512</span>
<span id="cb15-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> backend  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Build settings: BLAS_INFO=mkl, BUILD_TYPE=Debug, COMMIT_SHA=ce9ba071fd29013e72100dd97728d01c860720d9, CXX_COMPILER=/opt/aurora/24.347.0/spack/unified/0.9.2/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/g++, CXX_FLAGS= <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fvisibility-inlines-hidden</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_PTHREADPOOL</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_KINETO</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOCUPTI</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOROCTRACER</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DLIBKINETO_NOXPUPTI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>OFF <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_FBGEMM</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_PYTORCH_QNNPACK</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_XNNPACK</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DSYMBOLICATE_MOBILE_DEBUG_HANDLE</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DC10_NODEPRECATED</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wextra</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>return-type <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>non-virtual-dtor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>range-loop-construct <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>bool-operation <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wnarrowing</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-missing-field-initializers</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unknown-pragmas</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unused-parameter</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-strict-overflow</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-strict-aliasing</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-stringop-overflow</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wsuggest-override</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-psabi</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-error</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>old-style-cast <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fdiagnostics-color</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>always <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-faligned-new</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-maybe-uninitialized</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fno-math-errno</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fno-trapping-math</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Werror</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>format <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-dangling-reference</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-error</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dangling-reference <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DUSE_XPU</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-stringop-overflow,</span> LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, TORCH_VERSION=2.8.0, USE_CUDA=0, USE_CUDNN=OFF, USE_CUSPARSELT=OFF, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=1, USE_MPI=1, USE_NCCL=OFF, USE_NNPACK=1,USE_OPENMP=ON, USE_ROCM=0, USE_ROCM_KERNEL_ASSERT=OFF, USE_XCCL=1, USE_XPU=1,</span>
<span id="cb15-12"></span>
<span id="cb15-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0a0+gitce9ba07'</span></span>
<span id="cb15-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.xpu.is_available()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=True</span></span>
<span id="cb15-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.xpu.device_count()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=12</span></span>
<span id="cb15-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">torch.distributed.is_xccl_available()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=True</span></span>
<span id="cb15-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W614</span> 13:30:37.237440877 OperatorEntry.cpp:217] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb15-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb15-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::geometric_<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> float p, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>, Generator<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span> generator=None<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-12/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb15-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb15-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-12/pytorch/aten/src/ATen/VmapModeRegistrations.cpp:37</span>
<span id="cb15-23">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /lus/flare/projects/datascience/foremans/AuroraBuilds/2025-06-12/intel/intel-extension-for-pytorch/build/Release/csrc/gpu/csrc/gpu/xpu/ATen/RegisterXPU_0.cpp:186 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0a0+gitce9ba07'</span></span>
<span id="cb15-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ipex.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.10+git57bb68a'</span></span>
<span id="cb15-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneccl_bpt.__version__=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.8.0+xpu'</span></span>
<span id="cb15-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[0]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[3]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[5]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[6]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[7]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[8]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[9]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11]:</span> _XpuDeviceProperties<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) Data Center GPU Max 1550'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">platform_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intel(R) oneAPI Unified Runtime over Level-Zero'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gpu'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">driver_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1.6.32567+18'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_memory</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>65536MB, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_compute_units</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_eu_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>448, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gpu_subslice_count</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>56, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_work_group_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max_num_sub_groups</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>64, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sub_group_sizes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[16 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32],</span> has_fp16=1, has_fp64=1, has_atomic64=1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:20s</span></code></pre></div></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üèóÔ∏è {Building} {PyTorch} 2.8 from {Source} on {Aurora}},
  date = {2025-06-14},
  url = {https://samforeman.me/posts/2025/06/14/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚ÄúüèóÔ∏è Building PyTorch 2.8 from Source on
Aurora.‚Äù</span> June 14, 2025. <a href="https://samforeman.me/posts/2025/06/14/">https://samforeman.me/posts/2025/06/14/</a>.
</div></div></section></div> ]]></description>
  <category>pytorch</category>
  <category>Aurora</category>
  <guid>https://samforeman.me/posts/2025/06/14/</guid>
  <pubDate>Sat, 14 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üßú‚Äç‚ôÄÔ∏è Mermaid</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/02/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    subgraph D["`Data`"]
        direction TB
        x("`x‚ÇÄ`")
        x1("`x‚ÇÅ`")
        x2("`x‚ÇÇ`")
    end
    direction LR
    subgraph G0["`GPU0`"]
        direction LR
        subgraph N0["`NN`"]
        end
        L0["`L0`"]
    end
    subgraph G1["`GPU1`"]
        direction LR
        subgraph N1["`NN`"]
        end
        L1["`L1`"]
    end
    subgraph G2["`GPU2`"]
        direction LR
        subgraph N2["`NN`"]
        end
        L2["`L2`"]
    end
    %%subgraph AR["`Average Grads`"]
    %%    direction LR
    %%    ar("`(1/N) ‚àë g‚Çô`")
    %%    %%ar --&gt; bc
    %%end
    subgraph AR["`&amp;nbsp;`"]
        direction TB
        ar("`Avg Grads&lt;br&gt;(1/N) ‚àë g‚Çô`")
        %% bc("`Update Weights`")
    end
    %%subgraph UW["Update Weights"]
    %%    bc("`Update Weights`")
    %%end
    x --&gt; G0
    x1 --&gt; G1
    x2 --&gt; G2
    N0 --&gt; L0
    N1 --&gt; L1
    N2 --&gt; L2
    L0 -.-&gt; ar
    L1 -.-&gt; ar
    L2 -.-&gt; ar
    %% ar -.-&gt; bc
    %% bc -.-&gt; 
    %%bc -.-&gt; G1
    %%bc -.-&gt; G2
    %%G0 -.-&gt; ar
    %%G1 -.-&gt; ar
    %%G2 -.-&gt; ar
    %%G0 &lt;-.- bc
    %%bc -.-&gt; G0
    %%bc -.-&gt; G1
    %%bc -.-&gt; G2
    %%G2 -.-&gt; ar
    %%X1 --&gt;|"`x‚ÇÄ W‚ÇÄ &lt;br&gt;+ x‚ÇÅ W‚ÇÅ`"|X2

classDef block fill:#CCCCCC02,stroke:#838383,stroke-width:1px,color:#838383
classDef grey fill:#cccccc,stroke:#333,stroke-width:1px,color:#000
classDef red fill:#ff8181,stroke:#333,stroke-width:1px,color:#000
classDef orange fill:#FFC47F,stroke:#333,stroke-width:1px,color:#000
classDef yellow fill:#FFFF7F,stroke:#333,stroke-width:1px,color:#000
classDef green fill:#98E6A5,stroke:#333,stroke-width:1px,color:#000
classDef blue fill:#7DCAFF,stroke:#333,stroke-width:1px,color:#000
classDef purple fill:#FFCBE6,stroke:#333,stroke-width:1px,color:#000
classDef text fill:#CCCCCC02,stroke:#838383,stroke-width:0px,color:#838383
class x,y0,L0 red
class x1,L1 green
class x2,L2 blue
class x3,ar grey
class D,N0,N1,N2,G0,G1,G2,GU block
class AR block
class bc text
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üßú‚Äç‚ôÄÔ∏è {Mermaid}},
  date = {2025-06-02},
  url = {https://samforeman.me/posts/2025/06/02/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüßú‚Äç‚ôÄÔ∏è Mermaid.‚Äù</span> June 2, 2025. <a href="https://samforeman.me/posts/2025/06/02/">https://samforeman.me/posts/2025/06/02/</a>.
</div></div></section></div> ]]></description>
  <category>style</category>
  <category>personal</category>
  <guid>https://samforeman.me/posts/2025/06/02/</guid>
  <pubDate>Mon, 02 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üì∞ Nice Headings</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/06/01/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>I like headings. They help organize content and make it easier to read.</p>
<p>Inspired by my neovim config, I wanted to recreate a similar style for headings in my website.</p>
<div id="fig-headings-neovim" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-headings-neovim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-headings-neovim" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-light-theme" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-light-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../../assets/nvim-headings-light.png" class="lightbox" data-gallery="fig-headings-neovim" title="Figure&nbsp;1&nbsp;(a): Light Theme"><img src="https://samforeman.me/assets/nvim-headings-light.png" class="img-fluid figure-img" data-ref-parent="fig-headings-neovim"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-light-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Light Theme
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-headings-neovim" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-dark-theme" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-dark-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../../../assets/nvim-headings-dark.png" class="lightbox" data-gallery="fig-headings-neovim" title="Figure&nbsp;1&nbsp;(b): Dark Theme"><img src="https://samforeman.me/assets/nvim-headings-dark.png" class="img-fluid figure-img" data-ref-parent="fig-headings-neovim"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-dark-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Dark Theme
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-headings-neovim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: My neovim headings in light and dark themes.
</figcaption>
</figure>
</div>
<p>I think they turned out pretty well!</p>
<section id="heading-1" class="level1">
<h1>Heading 1</h1>
<section id="heading-2" class="level2">
<h2 class="anchored" data-anchor-id="heading-2">Heading 2</h2>
<section id="heading-3" class="level3">
<h3 class="anchored" data-anchor-id="heading-3">Heading 3</h3>
<section id="heading-4" class="level4">
<h4 class="anchored" data-anchor-id="heading-4">Heading 4</h4>
<section id="heading-5" class="level5">
<h5 class="anchored" data-anchor-id="heading-5">Heading 5</h5>
<section id="heading-6" class="level6">
<h6 class="anchored" data-anchor-id="heading-6">Heading 6</h6>



</section>
</section>
</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üì∞ {Nice} {Headings}},
  date = {2025-06-01},
  url = {https://samforeman.me/posts/2025/06/01/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüì∞ Nice Headings.‚Äù</span> June 1, 2025. <a href="https://samforeman.me/posts/2025/06/01/">https://samforeman.me/posts/2025/06/01/</a>.
</div></div></section></div> ]]></description>
  <category>style</category>
  <category>personal</category>
  <guid>https://samforeman.me/posts/2025/06/01/</guid>
  <pubDate>Sun, 01 Jun 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üöß Frameworks Issue with numpy &gt; 2</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/05/03/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>Something I just learned</p>
<p>The TensorFlow that is included in the new frameworks module (<code>aurora_nre_models_frameworks-2025.0.0</code>) was built with <code>numpy==1.26.4 (&lt; 2)</code>.</p>
<p>Unfortunately, if you then (for whatever reason) then tries to install / upgrade a package<sup>1</sup> that has <code>numpy</code> in its dependencies, e.g.:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span> transformers</span></code></pre></div>
<p>This will pull in <code>numpy &gt; 2</code>, effectively breaking the frameworks module.</p>
<p>In particular, any application that uses <a href="https://github.com/intel/intel-extension-for-pytorch"><code>intel/extension_for_pytorch</code></a>:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span></code></pre></div>
<p>Will crash with:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">A</span> module that was compiled using NumPy 1.x cannot be run in</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NumPy</span> 2.2.5 as it may crash. To support both 1.x and 2.x</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">versions</span> of NumPy, modules must be compiled with NumPy 2.0.</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Some</span> module may need to rebuild instead e.g. with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pybind11&gt;=2.12'</span>.</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> is obviously frustrating for an application that is only using PyTorch.</span></code></pre></div>
<p>Following through the stack trace, I see that the error is actually coming from <a href="https://github.com/huggingface/transformers/image_transforms.py#L47">huggingface/transformers/image_transforms.py#L47</a>.</p>
<p>Digging around a bit more I found there is a flag in <code>transformers</code> that allows you to bypass the entire <code>import tensorflow as tf</code> logic:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_TORCH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span></code></pre></div>
<p>which not only prevents things from crashing with <code>numpy &gt; 2</code>, but is also noticeably quicker.</p>
<section id="reinstall-modules-built-with-numpy-2" class="level2">
<h2 class="anchored" data-anchor-id="reinstall-modules-built-with-numpy-2">Reinstall Modules built with <code>numpy &lt; 2</code></h2>
<p>In addition to <code>tensorflow</code>, it seems that: { <code>jax</code>, <code>jaxlib</code>, <code>ml-dtypes</code>, <code>opt-einsum</code>, <code>scipy</code> } were <em>all</em> built with <code>numpy &lt; 2</code>, and so need to be rebuilt after upgrading numpy.</p>
<p>To do so:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span>  numpy jax jaxlib ml-dtypes opt-einsum scipy transformers</span></code></pre></div>
<p>‚úÖ Now, we‚Äôre able to successfully:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/03/25 @ 12:12:29][x4515c7s4b0n0][/f/d/f/p/s/ezpz][üå± update-utils][üì¶ü§∑‚úì] [‚è±Ô∏è 25s]</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_TORCH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import numpy as np; print(np.__version__) ; import ezpz '</span></span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.2.5</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W503</span> 12:12:34.201673197 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb6-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb6-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb6-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb6-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb6-11">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-05-03</span> 12:13:18]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils/_logger:68:ezpz</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Unable to import deepspeed. Please install it to use DeepSpeed features.</span>
<span id="cb6-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:48s</span></code></pre></div>
</section>
<section id="profiles-and-timing-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="profiles-and-timing-comparisons">Profiles and Timing Comparisons</h2>
<p>Below we present timing profiles obtained from</p>
<ul>
<li><a href="https://github.com/sharkdp/hyperfine"><code>hyperfine</code></a>: A command-line benchmarking tool</li>
<li><a href="https://github.com/joerick/pyinstrument"><code>pyinstrument</code></a>: A call stack profiler for Python</li>
</ul>
<p>Below we present the profiles obtained by the usual mechanism, i.e.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"venvs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_PREFIX})</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> venvs/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_PREFIX})</span>/bin/activate</span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz"</span></span></code></pre></div>
<section id="default-behavior" class="level3">
<h3 class="anchored" data-anchor-id="default-behavior">DEFAULT BEHAVIOR</h3>
<section id="bash-profile-hyperfine" class="level5">
<h5 class="anchored" data-anchor-id="bash-profile-hyperfine">Bash Profile (<code>hyperfine</code>)</h5>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> hyperfine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-runs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--shell</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>zsh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--show-output</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz_init() { $(which python3) -c "import ezpz" }; ezpz_init'</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mean</span> ¬± œÉ<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>     10.754 s ¬±  0.122 s    [User: 14.574 s, System: 12.795 s]</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Range</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min</span> ‚Ä¶ max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>   10.467 s ‚Ä¶ 10.910 s    10 runs</span></code></pre></div>
</section>
<section id="python-profile-pyinstrument" class="level4">
<h4 class="anchored" data-anchor-id="python-profile-pyinstrument">Python Profile (<code>pyinstrument</code>)</h4>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> pyinstrument <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import ezpz'</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12.021</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/__init__.py:1</span>
<span id="cb9-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 8.624 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/dist.py:1</span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 8.542 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  intel_extension_for_pytorch/__init__.py:1</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [206 frames hidden]  intel_extension_for_pytorch, transfor...</span>
<span id="cb9-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           0.247 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  torch/utils/_sympy/functions.py:1</span>
<span id="cb9-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚îî‚îÄ 0.241 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/__init__.py:1</span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>              ‚îî‚îÄ 0.126 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/polys/__init__.py:1</span></code></pre></div>
</section>
</section>
<section id="with-use_torch1-and-numpy2.2.5" class="level3">
<h3 class="anchored" data-anchor-id="with-use_torch1-and-numpy2.2.5">WITH <code>USE_TORCH=1</code> and <code>numpy==2.2.5</code></h3>
<p>Below we present the profiles and timing measurements obtained:</p>
<ol type="1">
<li><p>After upgrading <code>numpy==2.25</code></p></li>
<li><p>Skipping the <code>import tensorflow as tf</code> logic in <code>transformers</code> by specifying <code>USE_TORCH=1</code>, explicitly.</p></li>
</ol>
<section id="bash-profile-hyperfine-1" class="level4">
<h4 class="anchored" data-anchor-id="bash-profile-hyperfine-1">Bash Profile (<code>hyperfine</code>)</h4>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> hyperfine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-runs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--shell</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>zsh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--show-output</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz_init() { USE_TORCH=1 $(which python3) -c "import ezpz" }; ezpz_init'</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mean</span> ¬± œÉ<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>      7.491 s ¬±  0.162 s    [User: 12.130 s, System: 11.940 s]</span>
<span id="cb10-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Range</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min</span> ‚Ä¶ max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>    7.311 s ‚Ä¶  7.883 s    10 runs</span></code></pre></div>
</section>
<section id="python-profile-pyinstrument-1" class="level4">
<h4 class="anchored" data-anchor-id="python-profile-pyinstrument-1">Python Profile (<code>pyinstrument</code>)</h4>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> USE_TORCH=1 pyinstrument <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import ezpz'</span></span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.478</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/__init__.py:1</span>
<span id="cb11-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 5.109 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/dist.py:1</span>
<span id="cb11-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 5.016 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  intel_extension_for_pytorch/__init__.py:1</span>
<span id="cb11-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [174 frames hidden]  intel_extension_for_pytorch, transfor...</span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           0.249 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  torch/utils/_sympy/functions.py:1</span>
<span id="cb11-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚îî‚îÄ 0.241 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/__init__.py:1</span>
<span id="cb11-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>              ‚îî‚îÄ 0.124 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  sympy/polys/__init__.py:1</span></code></pre></div>
</section>
</section>
</section>
<section id="stack-trace-from-numpy-2-issue" class="level2">
<h2 class="anchored" data-anchor-id="stack-trace-from-numpy-2-issue">Stack Trace from <code>numpy &gt; 2</code> issue</h2>
<details closed="">
<summary>
Stack Trace
</summary>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2025.0.0](üëª aurora_nre_models_frameworks-2025.0.0)</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[05/02/25 @ 15:46:43][x4005c2s6b0n0][/f/d/f/p/s/t/2/ezpz][üå± update-utils][‚úì] [‚è±Ô∏è 19s]</span></span>
<span id="cb12-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-test</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--profile</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tp</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pp</span> 4</span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W502</span> 16:00:18.739960487 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb12-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb12-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb12-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb12-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb12-10">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-11"></span>
<span id="cb12-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">A</span> module that was compiled using NumPy 1.x cannot be run in</span>
<span id="cb12-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NumPy</span> 2.2.5 as it may crash. To support both 1.x and 2.x</span>
<span id="cb12-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">versions</span> of NumPy, modules must be compiled with NumPy 2.0.</span>
<span id="cb12-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Some</span> module may need to rebuild instead e.g. with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pybind11&gt;=2.12'</span>.</span>
<span id="cb12-16"></span>
<span id="cb12-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">If</span> you are a user of the module, the easiest solution will be to</span>
<span id="cb12-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">downgrade</span> to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'numpy&lt;2'</span> or try to upgrade the affected module.</span>
<span id="cb12-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">We</span> expect that some modules will need time to support NumPy 2.</span>
<span id="cb12-20"></span>
<span id="cb12-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Traceback</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span>  File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/bin/ezpz-test"</span>, line 6, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-22">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz.test import main</span>
<span id="cb12-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/src/ezpz/__init__.py"</span>, line 102, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-24">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz.dist import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/src/ezpz/dist.py"</span>, line 42, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch as ipex  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type:ignore[missingTypeStubs]</span></span>
<span id="cb12-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/__init__.py"</span>, line 128, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> . import xpu</span>
<span id="cb12-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/xpu/__init__.py"</span>, line 20, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-30">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .utils import <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb12-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/xpu/utils.py"</span>, line 7, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .. import frontend</span>
<span id="cb12-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/frontend.py"</span>, line 9, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-34">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .nn import utils</span>
<span id="cb12-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/__init__.py"</span>, line 6, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-36">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .modules import FrozenBatchNorm2d</span>
<span id="cb12-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/modules/__init__.py"</span>, line 11, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-38">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ...cpu.nn.linear_fuse_eltwise import IPEXLinearEltwise</span>
<span id="cb12-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/nn/linear_fuse_eltwise.py"</span>, line 3, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-40">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.nn.utils._weight_prepack import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/utils/__init__.py"</span>, line 1, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.nn.utils import _weight_prepack</span>
<span id="cb12-43">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/nn/utils/_weight_prepack.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> intel_extension_for_pytorch.cpu.tpp.utils.blocked_layout import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb12-45">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/tpp/__init__.py"</span>, line 2, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> . import fused_bert</span>
<span id="cb12-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/intel_extension_for_pytorch/cpu/tpp/fused_bert.py"</span>, line 16, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-48">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_utils import apply_chunking_to_forward</span>
<span id="cb12-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/modeling_utils.py"</span>, line 69, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-50">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .loss.loss_utils import LOSS_MAPPING</span>
<span id="cb12-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/loss/loss_utils.py"</span>, line 21, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-52">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> .loss_deformable_detr import DeformableDetrForObjectDetectionLoss, DeformableDetrForSegmentationLoss</span>
<span id="cb12-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/loss/loss_deformable_detr.py"</span>, line 4, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-54">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ..image_transforms import center_to_corners_format</span>
<span id="cb12-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/datascience/foremans/projects/saforem2/tmp/2025-05-02-150121/ezpz/venvs/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/transformers/image_transforms.py"</span>, line 47, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-56">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> tensorflow as tf</span>
<span id="cb12-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/__init__.py"</span>, line 48, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-58">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow._api.v2 import __internal__</span>
<span id="cb12-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/_api/v2/__internal__/__init__.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-60">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow._api.v2.__internal__ import autograph</span>
<span id="cb12-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/_api/v2/__internal__/autograph/__init__.py"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-62">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.core.ag_ctx import control_status_ctx <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># line: 34</span></span>
<span id="cb12-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/core/ag_ctx.py"</span>, line 21, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-64">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.utils import ag_logging</span>
<span id="cb12-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/utils/__init__.py"</span>, line 17, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-66">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.autograph.utils.context_managers import control_dependency_on_returns</span>
<span id="cb12-67">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/autograph/utils/context_managers.py"</span>, line 19, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-68">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python.framework import ops</span>
<span id="cb12-69">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/framework/ops.py"</span>, line 41, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-70">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python import pywrap_tfe</span>
<span id="cb12-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.347.0/frameworks/aurora_nre_models_frameworks-2025.0.0/lib/python3.10/site-packages/tensorflow/python/pywrap_tfe.py"</span>, line 25, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb12-72">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorflow.python._pywrap_tfe import <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb12-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AttributeError:</span> _ARRAY_API not found</span>
<span id="cb12-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AttributeError:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MessageFactory'</span> object has no attribute <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetPrototype'</span></span>
<span id="cb12-75"></span>
<span id="cb12-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ...[clipped]...</span></span></code></pre></div>
</details>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This is a lot of packages, including: { <code>torch</code>, <code>jax</code>, <code>tensorflow</code>, <code>scipy</code>, <code>jaxlib</code>, <code>numpy</code>, <code>ml-dtypes</code>, <code>opt-einsum</code>, ‚Ä¶, }.‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üöß {Frameworks} {Issue} with \textless Code\textgreater numpy
    \textgreater{} 2\textless/Code\textgreater{}},
  date = {2025-05-03},
  url = {https://samforeman.me/posts/2025/05/03/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüöß Frameworks Issue with &lt;Code&gt;numpy
&gt; 2&lt;/Code&gt;.‚Äù</span> May 3, 2025. <a href="https://samforeman.me/posts/2025/05/03/">https://samforeman.me/posts/2025/05/03/</a>.
</div></div></section></div> ]]></description>
  <category>frameworks</category>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/2025/05/03/</guid>
  <pubDate>Sat, 03 May 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üî• Building PyTorch 2.6 from Source on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/2025/04/28/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="pytorch-2.6-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="pytorch-2.6-on-aurora">PyTorch 2.6 on Aurora</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> https://bit.ly/ezpz-utils<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKLDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MKL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_ROCM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDNN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_FBGEMM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_QNNPACK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_CAFFE2_OPS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BUILD_TEST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_DISTRIBUTED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-19"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_NUMA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb1-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_MPI</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XPU</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-22"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1</span>
<span id="cb1-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INTEL_MKL_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$MKLROOT</span></span>
<span id="cb1-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_AOT_DEVLIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb1-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TORCH_XPU_ARCH_LIST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pvc'</span></span>
<span id="cb1-26"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OCLOC_VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>24.39.1</span>
<span id="cb1-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> gcc</span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /opt/aurora/24.347.0/spack/unified/0.9.1/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/gcc</span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/usr/bin/gcc</span></span>
<span id="cb1-30"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> g++</span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/opt/aurora/24.347.0/spack/unified/0.9.1/install/linux-sles15-x86_64/gcc-13.3.0/gcc-13.3.0-4enwbrb/bin/g++</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#/usr/bin/g++</span></span>
<span id="cb1-33"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pytorch/pytorch.git</span>
<span id="cb1-34"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> pytorch</span>
<span id="cb1-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout v2.6.0</span>
<span id="cb1-36"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> submodule update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--init</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--recursive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force</span></span>
<span id="cb1-37"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> triton</span>
<span id="cb1-38"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_XCCL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DEBUG</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REL_WITH_DEB_INFO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USE_CUDA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> gcc<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CXX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span> g++<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> setup.py bdist_wheel <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"build_whl-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NOW}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.log"</span></span>
<span id="cb1-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install dist/torch-2.6.0a0+git1eba9b3-cp310-cp310-linux_x86_64.whl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--force-reinstall</span></span>
<span id="cb1-40"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install intel-extension-for-pytorch==2.6.10+xpu oneccl_bind_pt==2.6.0+xpu <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--extra-index-url</span> https://pytorch-extension.intel.com/release-whl/stable/xpu/us/</span></code></pre></div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üî• {Building} {PyTorch} 2.6 from {Source} on {Aurora}},
  date = {2025-04-28},
  url = {https://samforeman.me/posts/2025/04/28/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüî• Building PyTorch 2.6 from Source on
Aurora.‚Äù</span> April 28, 2025. <a href="https://samforeman.me/posts/2025/04/28/">https://samforeman.me/posts/2025/04/28/</a>.
</div></div></section></div> ]]></description>
  <category>pytorch</category>
  <category>Aurora</category>
  <guid>https://samforeman.me/posts/2025/04/28/</guid>
  <pubDate>Mon, 28 Apr 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üë§ R√©sum√©</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/resume/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="sam-foreman" class="level2">
<h2 class="anchored" data-anchor-id="sam-foreman">Sam Foreman</h2>
<p>Computational Scientist<br>
<a href="https://samforeman.me">samforeman.me</a><br>
<a href="https://github.com/saforem2">GitHub</a> ‚Ä¢ <a href="https://scholar.google.com/citations?user=vV_1zDwAAAAJ&amp;hl=en">Google Scholar</a> ‚Ä¢ <a href="https://orcid.org/0000-0002-9981-0876">ORCID</a> ‚Ä¢ <a href="https://twitter.com/saforem2">Twitter</a></p>
<section id="r√©sum√©" class="level3">
<h3 class="anchored" data-anchor-id="r√©sum√©">R√©sum√©</h3>
<section id="education" class="level4">
<h4 class="anchored" data-anchor-id="education">üéì Education</h4>
<ul>
<li><strong>Ph.D., Physics</strong>
<ul>
<li>University of Iowa, 2019<br>
</li>
<li><a href="https://www.proquest.com/openview/95d7f7c12da8da8aa5ead3ac0f6ca0e8/1?cbl=18750&amp;diss=y&amp;pq-origsite=gscholar"><em>Learning Better Physics: A Machine Learning Approach to Lattice Gauge Theory</em></a></li>
</ul></li>
<li><strong>B.S. in Engineering Physics</strong>
<ul>
<li>University of Illinois at Urbana-Champaign, 2015</li>
<li><a href="https://patents.google.com/patent/US9741492B2/en">Energy Storage in Quantum Resonators (US Patent #US9741492B2)</a></li>
</ul></li>
<li><strong>B.S. in Applied Mathematics</strong>
<ul>
<li>University of Illinois at Urbana-Champaign, 2015</li>
</ul></li>
</ul>
</section>
<section id="professional-experience" class="level4">
<h4 class="anchored" data-anchor-id="professional-experience">üßë‚Äçüî¨ Professional Experience</h4>
<ul>
<li><strong>Assistant Computational Scientist</strong>
<ul>
<li>Argonne National Laboratory, Argonne Leadership Computing Facility (ALCF)<br>
</li>
<li><em>Lemont, IL | 2022 ‚Äì Present</em>
<ul>
<li>Research lead on scaling large language models (LLMs) and generative AI for science on supercomputers (Aurora, Frontier, LUMI, Leonardo, ‚Ä¶).</li>
<li>Optimize large-scale training of foundation models and language models for scientific applications.<br>
</li>
<li>Collaborate with interdisciplinary teams to enhance simulation efficiency and scalability.</li>
<li>Focus on AI and HPC for scientific applications, including:
<ul>
<li>Developing improved sampling algorithms for lattice quantum chromodynamics (QCD)</li>
<li>Training large language models on supercomputers</li>
</ul></li>
<li><a href="https://www.alcf.anl.gov/about/people/sam-foreman">https://www.alcf.anl.gov/about/people/sam-foreman</a></li>
</ul></li>
</ul></li>
<li><strong>Postdoctoral Researcher</strong>
<ul>
<li>Argonne National Laboratory, Argonne Leadership Computing Facility (ALCF)<br>
</li>
<li><em>Lemont, IL | 2019 ‚Äì 2022</em>
<ul>
<li>Applied deep learning to lattice gauge theory and quantum field simulations.</li>
<li>Developed ML-enhanced Monte Carlo methods for QCD.</li>
<li>Engaged in AI-for-Science collaborations with national labs and university partners.</li>
</ul></li>
</ul></li>
<li><strong>Graduate Researcher</strong>
<ul>
<li>Argonne National Laboratory, Math and Computer Sciences (MCS)</li>
<li><em>Lemont, IL | 2018 ‚Äì 2019</em><br>
</li>
<li>Collaborated with ALCF while completing Ph.D., integrating ML into physical sciences workflows.</li>
</ul></li>
</ul>
</section>
<section id="awards-and-honors" class="level4">
<h4 class="anchored" data-anchor-id="awards-and-honors">üèÜ Awards and Honors</h4>
<ul>
<li><strong>ACM Gordon Bell Special Prize for High Performance Computing-Based COVID-19 Research</strong>, 2022
<ul>
<li>Recognized for contributions to the GenSLMs project, which developed genome-scale language models to study SARS-CoV-2 evolutionary dynamics.</li>
<li><a href="https://www.acm.org/media-center/2022/november/gordon-bell-special-prize-covid-research-2022">https://www.acm.org/media-center/2022/november/gordon-bell-special-prize-covid-research-2022</a></li>
</ul></li>
<li><strong>Finalist, ACM Gordon Bell Prize</strong>, 2024
<ul>
<li>Acknowledged for the MProt-DPO project, which achieved over 4 ExaFLOP sustained performance in multimodal protein design workflows using Direct Preference Optimization.</li>
<li><a href="https://sc.cels.anl.gov/gordon-bell-argonne-team-breaks-new-ground-in-ai-driven-protein-design/">https://sc.cels.anl.gov/gordon-bell-argonne-team-breaks-new-ground-in-ai-driven-protein-design/</a></li>
</ul></li>
<li><strong>DOE Office of Science Graduate Student Research Fellow</strong>, 2018
<ul>
<li>Awarded by the Department of Energy for outstanding research contributions during graduate studies.</li>
</ul></li>
</ul>
</section>
<section id="publicationspublications" class="level4">
<h4 class="anchored" data-anchor-id="publicationspublications">üìö Publications<sup>1</sup></h4>
<ul>
<li><a href="https://www.researchgate.net/publication/387390653_MProt-DPO_Breaking_the_ExaFLOPS_Barrier_for_Multimodal_Protein_Design_Workflows_with_Direct_Preference_Optimization"><strong>MProt-DPO: Breaking the ExaFLOPS Barrier for Multimodal Protein Design Workflows with Direct Preference Optimization</strong></a></li>
<li><a href="https://doi.org/10.1177/10943420231184990"><strong>GenSLMs: Genome-Scale Language Models Reveal SARS-CoV-2 Evolutionary Dynamics</strong></a></li>
<li><a href="https://arxiv.org/abs/2202.05838"><strong>Applications of Machine Learning to Lattice Quantum Field Theory</strong></a></li>
<li><a href="https://arxiv.org/abs/2112.01586"><strong>HMC with Normalizing Flows</strong></a></li>
<li><a href="https://arxiv.org/abs/2105.03418"><strong>Deep Learning Hamiltonian Monte Carlo</strong></a></li>
<li><a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.98.052129"><strong>Examples of Renormalization Group Transformations for Image Sets</strong></a></li>
</ul>
</section>
<section id="selected-talkstalks" class="level4">
<h4 class="anchored" data-anchor-id="selected-talkstalks">üé§ Selected Talks<sup>2</sup></h4>
<ul>
<li><a href="https://samforeman.me/talks/aurora-gpt-fm-for-electric-grid/"><strong>AuroraGPT: Foundation Models for Science</strong></a> @ <a href="https://www.alcf.anl.gov/alcf-ai-science-training-series"><em>Foundation Models for the Electric Grid</em></a> [02/2025]</li>
<li><a href="https://samforeman.me/talks/ai-for-science-2024/"><strong>Parallel Training Methods</strong></a> @ <a href="https://www.alcf.anl.gov/alcf-ai-science-training-series"><em>AI-for-Science on Supercomputers</em></a> [11/2024]</li>
<li><a href="https://samforeman.me/talks/hpc-user-forum/"><strong>AuroraGPT</strong></a> @ <a href="https://www.hpcuserforum.com/hpc-user-forum-fall-2024/"><em>HPC User Forum</em>, 2024</a> [09/2024]</li>
<li><a href="https://samforeman.me/talks/alcf-hpc-workshop-2024/"><strong>Machine Learning and Foundation Models at Scale</strong></a> @ <a href="https://www.alcf.anl.gov/events/2024-alcf-hands-hpc-workshop"><em>2024 ALCF Hands-On HPC Workshop</em></a> [10/2024]</li>
<li><a href="https://samforeman.me/talks/llms-at-scale/"><strong>Training LLMs at Scale</strong></a> @ <a href="https://extremecomputingtraining.anl.gov/atpesc-2024/"><em>ATPESC</em>, 2024</a> [08/2024]</li>
<li><a href="https://saforem2.github.io/llm-workshop-talk"><strong>LLMs from Scratch</strong></a> @ <a href="https://github.com/argonne-lcf/llm-workshop">LLM Tutorial Workshop</a> [02/2024]</li>
<li><a href="https://saforem2.github.io/oneapi-talk"><strong>Exascale Science on Aurora</strong></a> @ <a href="https://www.alcf.anl.gov/events/alcf-hands-hpc-workshop">Intel oneAPI Workshop @ UIC</a> [10/2023]</li>
<li><a href="https://saforem2.github.io/scaling4science"><strong>Scaling LLMs for Science</strong></a> @ <a href="https://events.cels.anl.gov/event/426/overview">Data-Intensive Computing + AI/ML at Scale</a> [08/2023]</li>
<li><a href="https://saforem2.github.io/lattice23"><strong>MLMC: Machine Learning Monte Carlo</strong></a> @ <a href="https://indico.fnal.gov/event/57249/contributions/271305/">Lattice 2023</a> [07/2023]</li>
<li><a href="https://saforem2.github.io/lqcd-pasc23/"><strong>Generative Modeling and Efficient Sampling</strong></a> @ <a href="https://pasc23.pasc-conference.org/">PASC23</a> [07/2023]</li>
</ul>



</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><em>See full list on <a href="https://scholar.google.com/citations?user=7vBs2ZwAAAAJ">Google Scholar</a></em>‚Ü©Ô∏é</p></li>
<li id="fn2"><p><em>See full list at: <a href="https://samforeman.me/talks/">samforeman.me/talks</a></em>‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üë§ {R√©sum√©}},
  date = {2025-04-26},
  url = {https://samforeman.me/posts/resume/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüë§ R√©sum√©.‚Äù</span> April 26, 2025. <a href="https://samforeman.me/posts/resume/">https://samforeman.me/posts/resume/</a>.
</div></div></section></div> ]]></description>
  <category>CV</category>
  <category>personal</category>
  <category>r√©sum√©</category>
  <guid>https://samforeman.me/posts/resume/</guid>
  <pubDate>Sat, 26 Apr 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>ü™õ Torchtune on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/torchtune-aurora/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="patch-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="patch-on-aurora">Patch on Aurora</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource diff number-lines code-with-copy"><code class="sourceCode diff"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">diff --git a/torchtune/training/_distributed.py b/torchtune/training/_distributed.py</span></span>
<span id="cb1-2">index ff959c5f..c3966290 100644</span>
<span id="cb1-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">--- a/torchtune/training/_distributed.py</span></span>
<span id="cb1-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">+++ b/torchtune/training/_distributed.py</span></span>
<span id="cb1-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -14,7 +14,11 @@ import torch</span></span>
<span id="cb1-6"> import torch.distributed as dist</span>
<span id="cb1-7"> from torch import nn</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-from torch.distributed._composable.fsdp import CPUOffloadPolicy, fully_shard</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+try:</span></span>
<span id="cb1-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp import fully_shard</span></span>
<span id="cb1-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp.fully_shard import fully_shard</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15"> from torch.distributed._tensor import distribute_tensor, DTensor</span>
<span id="cb1-16"> from torch.distributed._tensor.placement_types import DTensorSpec, TensorMeta</span>
<span id="cb1-17"> from torch.distributed.checkpoint.state_dict import (</span>
<span id="cb1-18"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -532,6 +536,11 @@ def shard_model(</span></span>
<span id="cb1-19">     """</span>
<span id="cb1-20">     fsdp_kwargs = {"reshard_after_forward": reshard_after_forward}</span>
<span id="cb1-21">     if cpu_offload:</span>
<span id="cb1-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        try:</span></span>
<span id="cb1-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp import CPUOffloadPolicy</span></span>
<span id="cb1-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp._fsdp_api import MixedPrecisionPolicy, CPUOffloadPolicy</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            # from torch.distributed._composable import CPUOffloadPolicy</span></span>
<span id="cb1-27">         fsdp_kwargs["offload_policy"] = CPUOffloadPolicy()</span>
<span id="cb1-28"></span>
<span id="cb1-29">     # Shard the model with FSDP, iterating in reverse to start with</span></code></pre></div>
</section>
<section id="using-pytorch-2.5" class="level2">
<h2 class="anchored" data-anchor-id="using-pytorch-2.5">Using PyTorch 2.5</h2>
<p>Using the new enviroment with <code>pytorch==2.5</code> and after applying the above patch, I am almost able to get things working before ultimately crashing with:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: Tried to instantiate dummy base class Stream</span></code></pre></div>
<p>The full command (and output) are included below:</p>
<ul>
<li><p>Command:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç anl_2024_12_release_2](üëª anl_2024_12_release_2)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:47:46 AM][x4204c5s6b0n0][/f/A/f/p/p/torchtune][üå± main][!?][‚è±Ô∏è 2s]</span></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full optimizer.fused=False</span></code></pre></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output:</p>
</summary>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[W128</span> 08:49:19.162113524 OperatorEntry.cpp:155] Warning: Warning only once for all operators,  other operators may also be overridden.</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Overriding</span> a previously registered kernel for the same operator and the same dispatch key</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">operator:</span> aten::_cummax_helper<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Tensor</span> self, Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">a!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">values,</span> Tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">b!</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indices,</span> int dim<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">registered</span> at /build/pytorch/build/aten/src/ATen/RegisterSchema.cpp:6</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dispatch</span> key: XPU</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">previous</span> kernel: registered at /build/pytorch/build/aten/src/ATen/RegisterCPU.cpp:30476</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> kernel: registered at /build/intel-pytorch-extension/build/Release/csrc/gpu/csrc/aten/generated/ATen/RegisterXPU.cpp:2971 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"> operator()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:823</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gloo'</span> for distributed training.</span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:869</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4204c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config/_utils:28:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running FullFinetuneRecipeDistributed with resolved config:</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">batch_size:</span> 2</span>
<span id="cb4-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpointer:</span></span>
<span id="cb4-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.FullModelHFCheckpointer</span>
<span id="cb4-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_dir:</span> Meta-Llama-3.1-8B-Instruct/</span>
<span id="cb4-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_files:</span></span>
<span id="cb4-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00001-of-00004.safetensors</span>
<span id="cb4-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00002-of-00004.safetensors</span>
<span id="cb4-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00003-of-00004.safetensors</span>
<span id="cb4-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00004-of-00004.safetensors</span>
<span id="cb4-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model_type:</span> LLAMA3</span>
<span id="cb4-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb4-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_checkpoint:</span> null</span>
<span id="cb4-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad_norm:</span> null</span>
<span id="cb4-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compile:</span> false</span>
<span id="cb4-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">custom_sharded_layers:</span></span>
<span id="cb4-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> tok_embeddings</span>
<span id="cb4-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> output</span>
<span id="cb4-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset:</span></span>
<span id="cb4-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.datasets.alpaca_dataset</span>
<span id="cb4-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">packed:</span> false</span>
<span id="cb4-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">device:</span> xpu</span>
<span id="cb4-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtype:</span> bf16</span>
<span id="cb4-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_checkpointing:</span> false</span>
<span id="cb4-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_offloading:</span> false</span>
<span id="cb4-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epochs:</span> 1</span>
<span id="cb4-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_steps:</span> 1</span>
<span id="cb4-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_every_n_steps:</span> 1</span>
<span id="cb4-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_peak_memory_stats:</span> true</span>
<span id="cb4-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span></span>
<span id="cb4-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.modules.loss.CEWithChunkedOutputLoss</span>
<span id="cb4-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_steps_per_epoch:</span> null</span>
<span id="cb4-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">metric_logger:</span></span>
<span id="cb4-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.metric_logging.DiskLogger</span>
<span id="cb4-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_dir:</span> /tmp/torchtune/llama3_1_8B/full/logs</span>
<span id="cb4-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model:</span></span>
<span id="cb4-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3_1.llama3_1_8b</span>
<span id="cb4-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer:</span></span>
<span id="cb4-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torch.optim.AdamW</span>
<span id="cb4-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> false</span>
<span id="cb4-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 2.0e-05</span>
<span id="cb4-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer_in_bwd:</span> false</span>
<span id="cb4-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb4-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profiler:</span></span>
<span id="cb4-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.setup_torch_profiler</span>
<span id="cb4-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">active_steps:</span> 2</span>
<span id="cb4-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu:</span> true</span>
<span id="cb4-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cuda:</span> true</span>
<span id="cb4-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled:</span> false</span>
<span id="cb4-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_cycles:</span> 1</span>
<span id="cb4-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full/profiling_outputs</span>
<span id="cb4-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_memory:</span> false</span>
<span id="cb4-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">record_shapes:</span> true</span>
<span id="cb4-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wait_steps:</span> 5</span>
<span id="cb4-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warmup_steps:</span> 3</span>
<span id="cb4-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_flops:</span> false</span>
<span id="cb4-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_stack:</span> false</span>
<span id="cb4-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume_from_checkpoint:</span> false</span>
<span id="cb4-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed:</span> null</span>
<span id="cb4-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle:</span> true</span>
<span id="cb4-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer:</span></span>
<span id="cb4-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3.llama3_tokenizer</span>
<span id="cb4-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_seq_len:</span> null</span>
<span id="cb4-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path:</span> Meta-Llama-3.1-8B-Instruct/original/tokenizer.model</span>
<span id="cb4-75"></span>
<span id="cb4-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:141:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> log_peak_memory_stats was set to True, however, training does not use cuda. Setting log_peak_memory_stats=False.</span>
<span id="cb4-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/training/checkpointing/_checkpoint_client.py:75:</span> FutureWarning: get_world_size_and_rank is deprecated and will be removed in future versions. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> will move to <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils._device</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> in future releases. Please use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils.get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> instead.</span>
<span id="cb4-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_,</span> self._rank = training.get_world_size_and_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">D</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/seed:60:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting manual seed to local seed 4028640460. Local seed is seed + rank = 4028640460 + 0</span>
<span id="cb4-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Writing</span> logs to /tmp/torchtune/llama3_1_8B/full/logs/log_1738075777.txt</span>
<span id="cb4-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:39]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:499:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> FSDP is enabled. Instantiating model and loading checkpoint on Rank 0 ...</span>
<span id="cb4-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/tensor/_random.py:45:</span> UserWarning: DTensor random operators may not have complete support on cpu device mesh</span>
<span id="cb4-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warnings.warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb4-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:568:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Instantiating model and loading checkpoint took 13.79 secs</span>
<span id="cb4-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/memory:301:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Memory stats after model init:</span>
<span id="cb4-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory allocation: 1.04 GiB</span>
<span id="cb4-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory reserved: 1.14 GiB</span>
<span id="cb4-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory active: 1.04 GiB</span>
<span id="cb4-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:632:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Optimizer is initialized.</span>
<span id="cb4-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:53]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:317:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Loss is initialized.</span>
<span id="cb4-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:685:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Dataset and Sampler are initialized.</span>
<span id="cb4-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:382:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> No learning rate scheduler configured. Using constant learning rate.</span>
<span id="cb4-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/_profiler:53:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiling disabled.</span>
<span id="cb4-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:49:55]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:467:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiler config after instantiation: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}</span>
<span id="cb4-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: Traceback <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb4-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/venvs/anl_2024_12_release_2/bin/tune"</span>, line 8, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb4-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 49, in main</span>
<span id="cb4-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     parser.run<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 43, in run</span>
<span id="cb4-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args.func<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 214, in _run_cmd</span>
<span id="cb4-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._run_single_device<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args,</span> is_builtin=is_builtin<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 108, in _run_single_device</span>
<span id="cb4-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     runpy.run_path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args.recipe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> run_name=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 289, in run_path</span>
<span id="cb4-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return _run_module_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> init_globals, run_name,</span>
<span id="cb4-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 96, in _run_module_code</span>
<span id="cb4-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     _run_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> mod_globals, init_globals,</span>
<span id="cb4-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/runpy.py"</span>, line 86, in _run_code</span>
<span id="cb4-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     exec<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> run_globals<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 928, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb4-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe_main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/config/_parse.py"</span>, line 99, in wrapper</span>
<span id="cb4-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_main</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb4-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 923, in recipe_main</span>
<span id="cb4-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     recipe.train<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 749, in train</span>
<span id="cb4-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     logits = self._model<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">**batch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1736, in _wrapped_call_impl</span>
<span id="cb4-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return self._call_impl<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1844, in _call_impl</span>
<span id="cb4-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return inner<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1769, in inner</span>
<span id="cb4-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args_kwargs_result = hook<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type: ignore[misc]</span></span>
<span id="cb4-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 66, in fsdp_hook_wrapper</span>
<span id="cb4-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return torch._dynamo.disable<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func,</span> recursive=True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py"</span>, line 632, in _fn</span>
<span id="cb4-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return fn<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 224, in _pre_forward</span>
<span id="cb4-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args, kwargs = self._root_pre_forward<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 117, in _root_pre_forward</span>
<span id="cb4-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 175, in _lazy_init</span>
<span id="cb4-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._init_shared_state<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 183, in _init_shared_state</span>
<span id="cb4-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._comm_ctx.lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/micromamba/envs/anl_2024_12_release_2/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_param_group.py"</span>, line 48, in lazy_init</span>
<span id="cb4-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     raise RuntimeError<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FSDP requires CUDA for streams"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb4-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: FSDP requires CUDA for streams</span>
<span id="cb4-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb4-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    135144 exit 1     tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full</span>
<span id="cb4-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:55s</span></code></pre></div>
</details></li>
</ul>
</section>
<section id="using-pytorch-2.3" class="level2">
<h2 class="anchored" data-anchor-id="using-pytorch-2.3">Using PyTorch 2.3</h2>
<ul>
<li><p>Command:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1](:ghost: aurora_nre_models_frameworks-2024.2.1_u1)</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:07:29 AM][x4204c5s6b0n0][/f/A/f/p/p/torchtune][:seedling: main][!?][:stopwatch: 13s]</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama4_1/8B_full optimizer.fused=False</span></code></pre></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output:</p>
</summary>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:823</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ezpz/dist:869</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4204c5s6b0n0'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOCAL_RANK changed to be 0 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:-1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_LOCAL_SIZE changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:-1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2025:01:28-08:07:38:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">115657</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_PROCESS_LAUNCHER changed to be none <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:hydra</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config/_utils:28:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running FullFinetuneRecipeDistributed with resolved config:</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">batch_size:</span> 2</span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpointer:</span></span>
<span id="cb6-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.FullModelHFCheckpointer</span>
<span id="cb6-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_dir:</span> Meta-Llama-3.1-8B-Instruct/</span>
<span id="cb6-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_files:</span></span>
<span id="cb6-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00001-of-00004.safetensors</span>
<span id="cb6-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00002-of-00004.safetensors</span>
<span id="cb6-16">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00003-of-00004.safetensors</span>
<span id="cb6-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> model-00004-of-00004.safetensors</span>
<span id="cb6-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model_type:</span> LLAMA3</span>
<span id="cb6-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb6-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_checkpoint:</span> null</span>
<span id="cb6-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad_norm:</span> null</span>
<span id="cb6-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compile:</span> false</span>
<span id="cb6-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">custom_sharded_layers:</span></span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> tok_embeddings</span>
<span id="cb6-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> output</span>
<span id="cb6-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset:</span></span>
<span id="cb6-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.datasets.alpaca_dataset</span>
<span id="cb6-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">packed:</span> false</span>
<span id="cb6-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">device:</span> xpu</span>
<span id="cb6-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dtype:</span> bf16</span>
<span id="cb6-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_checkpointing:</span> false</span>
<span id="cb6-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_activation_offloading:</span> false</span>
<span id="cb6-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">epochs:</span> 1</span>
<span id="cb6-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_steps:</span> 1</span>
<span id="cb6-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_every_n_steps:</span> 1</span>
<span id="cb6-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_peak_memory_stats:</span> true</span>
<span id="cb6-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span></span>
<span id="cb6-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.modules.loss.CEWithChunkedOutputLoss</span>
<span id="cb6-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_steps_per_epoch:</span> null</span>
<span id="cb6-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">metric_logger:</span></span>
<span id="cb6-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.metric_logging.DiskLogger</span>
<span id="cb6-42">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_dir:</span> /tmp/torchtune/llama3_1_8B/full/logs</span>
<span id="cb6-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model:</span></span>
<span id="cb6-44">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3_1.llama3_1_8b</span>
<span id="cb6-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer:</span></span>
<span id="cb6-46">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torch.optim.AdamW</span>
<span id="cb6-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused:</span> false</span>
<span id="cb6-48">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr:</span> 2.0e-05</span>
<span id="cb6-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer_in_bwd:</span> false</span>
<span id="cb6-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full</span>
<span id="cb6-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profiler:</span></span>
<span id="cb6-52">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.training.setup_torch_profiler</span>
<span id="cb6-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">active_steps:</span> 2</span>
<span id="cb6-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu:</span> true</span>
<span id="cb6-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cuda:</span> true</span>
<span id="cb6-56">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled:</span> false</span>
<span id="cb6-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_cycles:</span> 1</span>
<span id="cb6-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_dir:</span> /tmp/torchtune/llama3_1_8B/full/profiling_outputs</span>
<span id="cb6-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_memory:</span> false</span>
<span id="cb6-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">record_shapes:</span> true</span>
<span id="cb6-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wait_steps:</span> 5</span>
<span id="cb6-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warmup_steps:</span> 3</span>
<span id="cb6-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_flops:</span> false</span>
<span id="cb6-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with_stack:</span> false</span>
<span id="cb6-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume_from_checkpoint:</span> false</span>
<span id="cb6-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed:</span> null</span>
<span id="cb6-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle:</span> true</span>
<span id="cb6-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer:</span></span>
<span id="cb6-69">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_component_:</span> torchtune.models.llama3.llama3_tokenizer</span>
<span id="cb6-70">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_seq_len:</span> null</span>
<span id="cb6-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path:</span> Meta-Llama-3.1-8B-Instruct/original/tokenizer.model</span>
<span id="cb6-72"></span>
<span id="cb6-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:141:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> log_peak_memory_stats was set to True, however, training does not use cuda. Setting log_peak_memory_stats=False.</span>
<span id="cb6-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/training/checkpointing/_checkpoint_client.py:75:</span> FutureWarning: get_world_size_and_rank is deprecated and will be removed in future versions. <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> will move to <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils._device</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> in future releases. Please use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchtune.utils.get_world_size_and_rank</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> instead.</span>
<span id="cb6-75">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_,</span> self._rank = training.get_world_size_and_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:38]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">D</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/seed:60:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting manual seed to local seed 2201534845. Local seed is seed + rank = 2201534845 + 0</span>
<span id="cb6-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Writing</span> logs to /tmp/torchtune/llama3_1_8B/full/logs/log_1738073258.txt</span>
<span id="cb6-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:39]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:499:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> FSDP is enabled. Instantiating model and loading checkpoint on Rank 0 ...</span>
<span id="cb6-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_tensor/random.py:36:</span> UserWarning: DTensor random operators may not have complete support on cpu device mesh</span>
<span id="cb6-80">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warnings.warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb6-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:568:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Instantiating model and loading checkpoint took 5.74 secs</span>
<span id="cb6-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/memory:301:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Memory stats after model init:</span>
<span id="cb6-83">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory allocation: 1.04 GiB</span>
<span id="cb6-84">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory reserved: 1.14 GiB</span>
<span id="cb6-85">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">XPU</span> peak memory active: 1.04 GiB</span>
<span id="cb6-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:632:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Optimizer is initialized.</span>
<span id="cb6-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:45]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:317:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Loss is initialized.</span>
<span id="cb6-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">README.md:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7.47k/7.47k</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 85.6MB/s]</span>
<span id="cb6-89"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¶</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-00000-of-00001-a09b74b3ef9c3b56.parquet:</span> 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24.2M/24.2M</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 105MB/s]</span>
<span id="cb6-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Generating</span> train split: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">52002/52002</span> [00:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 45116.86 examples/s]</span>
<span id="cb6-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:685:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Dataset and Sampler are initialized.</span>
<span id="cb6-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:382:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> No learning rate scheduler configured. Using constant learning rate.</span>
<span id="cb6-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">W</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training/_profiler:53:torchtune.utils._logging</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiling disabled.</span>
<span id="cb6-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2025-01-28</span> 08:07:49]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">I</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">recipes/full_finetune_distributed:467:__main__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  Profiler config after instantiation: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}</span>
<span id="cb6-95">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                                                                                                                       <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: Traceback <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/tune"</span>, line 10, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 49, in main</span>
<span id="cb6-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     parser.run<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/tune.py"</span>, line 43, in run</span>
<span id="cb6-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args.func<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 214, in _run_cmd</span>
<span id="cb6-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._run_single_device<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args,</span> is_builtin=is_builtin<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/_cli/run.py"</span>, line 108, in _run_single_device</span>
<span id="cb6-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     runpy.run_path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">str</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">args.recipe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> run_name=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 289, in run_path</span>
<span id="cb6-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return _run_module_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> init_globals, run_name,</span>
<span id="cb6-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 96, in _run_module_code</span>
<span id="cb6-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     _run_code<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> mod_globals, init_globals,</span>
<span id="cb6-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/runpy.py"</span>, line 86, in _run_code</span>
<span id="cb6-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     exec<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">code,</span> run_globals<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 928, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe_main()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/torchtune/config/_parse.py"</span>, line 99, in wrapper</span>
<span id="cb6-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     sys.exit<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recipe_main</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb6-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 923, in recipe_main</span>
<span id="cb6-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     recipe.train<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/flare/projects/Aurora_deployment/foremans/projects/pytorch/torchtune/recipes/full_finetune_distributed.py"</span>, line 749, in train</span>
<span id="cb6-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     logits = self._model<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">**batch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1532, in _wrapped_call_impl</span>
<span id="cb6-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return self._call_impl<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/nn/modules/module.py"</span>, line 1561, in _call_impl</span>
<span id="cb6-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args_kwargs_result = hook<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># type: ignore[misc]</span></span>
<span id="cb6-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 153, in _pre_forward</span>
<span id="cb6-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     args, kwargs = self._root_pre_forward<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module,</span> args, kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 67, in _root_pre_forward</span>
<span id="cb6-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._lazy_init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 112, in _lazy_init</span>
<span id="cb6-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._init_shared_state<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_state.py"</span>, line 120, in _init_shared_state</span>
<span id="cb6-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self._comm_ctx.init<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/_composable/fsdp/_fsdp_param_group.py"</span>, line 49, in init</span>
<span id="cb6-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     self.all_gather_copy_in_stream = torch.cuda.Stream<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">priority</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>high_priority<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/cuda/streams.py"</span>, line 34, in __new__</span>
<span id="cb6-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     return super<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.__new__</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cls,</span> priority=priority, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/aurora/24.180.3/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/_utils.py"</span>, line 907, in err_fn</span>
<span id="cb6-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span>     raise RuntimeError<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tried to instantiate dummy base class {class_name}"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[rank0]:</span> RuntimeError: Tried to instantiate dummy base class Stream</span>
<span id="cb6-139">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0%</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>                                                                                                                                                                                                                                                       <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/26001</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb6-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    115657 exit 1     tune run full_finetune_distributed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--config</span> llama3_1/8B_full</span></code></pre></div>
</details></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{foreman2025,
  author = {Foreman, Sam},
  title = {ü™õ {Torchtune} on {Aurora}},
  date = {2025-03-23},
  url = {https://samforeman.me/posts/torchtune-aurora},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúü™õ Torchtune on Aurora,‚Äù</span> March. <a href="https://samforeman.me/posts/torchtune-aurora">https://samforeman.me/posts/torchtune-aurora</a>.
</div></div></section></div> ]]></description>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/torchtune-aurora/</guid>
  <pubDate>Sun, 23 Mar 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üöë Torchtune Patch on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/torchtune-patch-aurora/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="patch-to-get-torchtune-working-on-aurora" class="level2">
<h2 class="anchored" data-anchor-id="patch-to-get-torchtune-working-on-aurora">Patch to get <code>torchtune</code> working on Aurora</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource diff number-lines code-with-copy"><code class="sourceCode diff"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">diff --git a/torchtune/training/_distributed.py b/torchtune/training/_distributed.py</span></span>
<span id="cb1-2">index ff959c5f..c3966290 100644</span>
<span id="cb1-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">--- a/torchtune/training/_distributed.py</span></span>
<span id="cb1-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">+++ b/torchtune/training/_distributed.py</span></span>
<span id="cb1-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -14,7 +14,11 @@ import torch</span></span>
<span id="cb1-6"> import torch.distributed as dist</span>
<span id="cb1-7"> from torch import nn</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-from torch.distributed._composable.fsdp import CPUOffloadPolicy, fully_shard</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+try:</span></span>
<span id="cb1-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp import fully_shard</span></span>
<span id="cb1-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    from torch.distributed._composable.fsdp.fully_shard import fully_shard</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15"> from torch.distributed._tensor import distribute_tensor, DTensor</span>
<span id="cb1-16"> from torch.distributed._tensor.placement_types import DTensorSpec, TensorMeta</span>
<span id="cb1-17"> from torch.distributed.checkpoint.state_dict import (</span>
<span id="cb1-18"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">@@ -532,6 +536,11 @@ def shard_model(</span></span>
<span id="cb1-19">     """</span>
<span id="cb1-20">     fsdp_kwargs = {"reshard_after_forward": reshard_after_forward}</span>
<span id="cb1-21">     if cpu_offload:</span>
<span id="cb1-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        try:</span></span>
<span id="cb1-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp import CPUOffloadPolicy</span></span>
<span id="cb1-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        except (ImportError, ModuleNotFoundError):</span></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            from torch.distributed._composable.fsdp._fsdp_api import MixedPrecisionPolicy, CPUOffloadPolicy</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+            # from torch.distributed._composable import CPUOffloadPolicy</span></span>
<span id="cb1-27">         fsdp_kwargs["offload_policy"] = CPUOffloadPolicy()</span>
<span id="cb1-28"></span>
<span id="cb1-29">     # Shard the model with FSDP, iterating in reverse to start with</span></code></pre></div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2025,
  author = {Foreman, Sam},
  title = {üöë {Torchtune} {Patch} on {Aurora}},
  date = {2025-03-23},
  url = {https://samforeman.me/posts/torchtune-patch-aurora/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2025" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2025. <span>‚Äúüöë Torchtune Patch on Aurora.‚Äù</span> March
23, 2025. <a href="https://samforeman.me/posts/torchtune-patch-aurora/">https://samforeman.me/posts/torchtune-patch-aurora/</a>.
</div></div></section></div> ]]></description>
  <category>Aurora</category>
  <category>pytorch</category>
  <category>bug</category>
  <guid>https://samforeman.me/posts/torchtune-patch-aurora/</guid>
  <pubDate>Sun, 23 Mar 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>ü´• svgbob</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/svgbob/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>Playing with <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/ivanceras/svgbob">ivanceras/<code>svgbob</code></a> as an alternative to Mermaid</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="456" height="304" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="456" height="304"></rect>
  <rect x="156" y="40" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="60">Network</text>
  <rect x="332" y="40" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="60">Loss</text>
  <path d="M 384,48 A 16,16 0,0,0 384,64" class="nofill"></path>
  <text x="386" y="60">x0</text>
  <path d="M 400,48 A 16,16 0,0,1 400,64" class="nofill"></path>
  <rect x="156" y="136" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="156">Network</text>
  <rect x="332" y="136" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="156">Loss</text>
  <path d="M 384,144 A 16,16 0,0,0 384,160" class="nofill"></path>
  <text x="386" y="156">x1</text>
  <path d="M 400,144 A 16,16 0,0,1 400,160" class="nofill"></path>
  <rect x="156" y="232" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="170" y="252">Network</text>
  <rect x="332" y="232" width="88" height="32" class="solid nofill" rx="4"></rect>
  <text x="346" y="252">Loss</text>
  <path d="M 384,240 A 16,16 0,0,0 384,256" class="nofill"></path>
  <text x="386" y="252">x2</text>
  <path d="M 400,240 A 16,16 0,0,1 400,256" class="nofill"></path>
  <text x="34" y="28">Data</text>
  <text x="138" y="28">GPU0</text>
  <text x="42" y="60">x0</text>
  <polygon points="136,52 144,56 136,60" class="filled"></polygon>
  <line x1="92" y1="64" x2="92" y2="144" class="solid"></line>
  <text x="138" y="124">GPU1</text>
  <polygon points="296,132 288,136 296,140" class="filled"></polygon>
  <text x="42" y="156">x1</text>
  <polygon points="136,148 144,152 136,156" class="filled"></polygon>
  <line x1="92" y1="160" x2="92" y2="240" class="solid"></line>
  <polygon points="272,164 280,168 272,172" class="filled"></polygon>
  <text x="138" y="220">GPU2</text>
  <polygon points="296,228 288,232 296,236" class="filled"></polygon>
  <text x="42" y="252">x2</text>
  <polygon points="136,244 144,248 136,252" class="filled"></polygon>
  <polygon points="272,260 280,264 272,268" class="filled"></polygon>
  <polygon points="256,36 248,40 256,44" class="filled"></polygon>
  <line x1="256" y1="40" x2="308" y2="40" class="solid end_marked_open_circle"></line>
  <line x1="264" y1="56" x2="252" y2="56" class="solid end_marked_open_circle"></line>
  <line x1="264" y1="56" x2="312" y2="56" class="solid"></line>
  <polygon points="312,52 320,56 312,60" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="276" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="48" class="solid"></line>
    <path d="M 4,276 A 4,4 0,0,0 8,280" class="nofill"></path>
    <line x1="8" y1="280" x2="88" y2="280" class="solid"></line>
    <line x1="92" y1="256" x2="92" y2="276" class="solid"></line>
    <path d="M 92,276 A 4,4 0,0,1 88,280" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,8 A 4,4 0,0,0 124,12" class="nofill"></path>
    <line x1="124" y1="12" x2="124" y2="48" class="solid"></line>
    <line x1="128" y1="8" x2="440" y2="8" class="solid"></line>
    <path d="M 440,8 A 4,4 0,0,1 444,12" class="nofill"></path>
    <line x1="444" y1="12" x2="444" y2="84" class="solid"></line>
    <line x1="124" y1="64" x2="124" y2="84" class="solid"></line>
    <path d="M 124,84 A 4,4 0,0,0 128,88" class="nofill"></path>
    <line x1="128" y1="88" x2="440" y2="88" class="solid"></line>
    <path d="M 444,84 A 4,4 0,0,1 440,88" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,40 A 4,4 0,0,0 20,44" class="nofill"></path>
    <line x1="20" y1="44" x2="20" y2="68" class="solid"></line>
    <line x1="24" y1="40" x2="72" y2="40" class="solid"></line>
    <path d="M 72,40 A 4,4 0,0,1 76,44" class="nofill"></path>
    <line x1="76" y1="44" x2="76" y2="68" class="solid"></line>
    <line x1="76" y1="56" x2="136" y2="56" class="solid"></line>
    <path d="M 20,68 A 4,4 0,0,0 24,72" class="nofill"></path>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 76,68 A 4,4 0,0,1 72,72" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,104 A 4,4 0,0,0 124,108" class="nofill"></path>
    <line x1="124" y1="108" x2="124" y2="144" class="solid"></line>
    <line x1="128" y1="104" x2="440" y2="104" class="solid"></line>
    <path d="M 440,104 A 4,4 0,0,1 444,108" class="nofill"></path>
    <line x1="444" y1="108" x2="444" y2="180" class="solid"></line>
    <line x1="124" y1="160" x2="124" y2="180" class="solid"></line>
    <path d="M 124,180 A 4,4 0,0,0 128,184" class="nofill"></path>
    <line x1="128" y1="184" x2="440" y2="184" class="solid"></line>
    <path d="M 444,180 A 4,4 0,0,1 440,184" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,136 A 4,4 0,0,0 20,140" class="nofill"></path>
    <line x1="20" y1="140" x2="20" y2="164" class="solid"></line>
    <line x1="24" y1="136" x2="72" y2="136" class="solid"></line>
    <path d="M 72,136 A 4,4 0,0,1 76,140" class="nofill"></path>
    <line x1="76" y1="140" x2="76" y2="164" class="solid"></line>
    <line x1="76" y1="152" x2="136" y2="152" class="solid"></line>
    <path d="M 20,164 A 4,4 0,0,0 24,168" class="nofill"></path>
    <line x1="24" y1="168" x2="72" y2="168" class="solid"></line>
    <path d="M 76,164 A 4,4 0,0,1 72,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,136 A 8,8 0,0,0 266,140" class="nofill"></path>
    <line x1="266" y1="140" x2="264" y2="144" class="solid"></line>
    <path d="M 264,144 A 16,16 0,0,0 264,160" class="nofill"></path>
    <line x1="264" y1="160" x2="266" y2="164" class="solid"></line>
    <path d="M 266,164 A 8,8 0,0,0 272,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 296,136 A 8,8 0,0,1 302,140" class="nofill"></path>
    <line x1="302" y1="140" x2="304" y2="144" class="solid"></line>
    <path d="M 304,144 A 16,16 0,0,1 304,160" class="nofill"></path>
    <line x1="304" y1="160" x2="302" y2="164" class="solid"></line>
    <path d="M 302,164 A 8,8 0,0,1 296,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 128,200 A 4,4 0,0,0 124,204" class="nofill"></path>
    <line x1="124" y1="204" x2="124" y2="240" class="solid"></line>
    <line x1="128" y1="200" x2="440" y2="200" class="solid"></line>
    <path d="M 440,200 A 4,4 0,0,1 444,204" class="nofill"></path>
    <line x1="444" y1="204" x2="444" y2="276" class="solid"></line>
    <line x1="124" y1="256" x2="124" y2="276" class="solid"></line>
    <path d="M 124,276 A 4,4 0,0,0 128,280" class="nofill"></path>
    <line x1="128" y1="280" x2="440" y2="280" class="solid"></line>
    <path d="M 444,276 A 4,4 0,0,1 440,280" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,232 A 4,4 0,0,0 20,236" class="nofill"></path>
    <line x1="20" y1="236" x2="20" y2="260" class="solid"></line>
    <line x1="24" y1="232" x2="72" y2="232" class="solid"></line>
    <path d="M 72,232 A 4,4 0,0,1 76,236" class="nofill"></path>
    <line x1="76" y1="236" x2="76" y2="260" class="solid"></line>
    <line x1="76" y1="248" x2="136" y2="248" class="solid"></line>
    <path d="M 20,260 A 4,4 0,0,0 24,264" class="nofill"></path>
    <line x1="24" y1="264" x2="72" y2="264" class="solid"></line>
    <path d="M 76,260 A 4,4 0,0,1 72,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,232 A 8,8 0,0,0 266,236" class="nofill"></path>
    <line x1="266" y1="236" x2="264" y2="240" class="solid"></line>
    <path d="M 264,240 A 16,16 0,0,0 264,256" class="nofill"></path>
    <line x1="264" y1="256" x2="266" y2="260" class="solid"></line>
    <path d="M 266,260 A 8,8 0,0,0 272,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 296,232 A 8,8 0,0,1 302,236" class="nofill"></path>
    <line x1="302" y1="236" x2="304" y2="240" class="solid"></line>
    <path d="M 304,240 A 16,16 0,0,1 304,256" class="nofill"></path>
    <line x1="304" y1="256" x2="302" y2="260" class="solid"></line>
    <path d="M 302,260 A 8,8 0,0,1 296,264" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="480" height="560" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="480" height="560"></rect>
  <rect x="220" y="56" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="76">Network</text>
  <rect x="372" y="56" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="76">Loss</text>
  <rect x="220" y="248" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="268">Network</text>
  <rect x="372" y="248" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="268">Loss</text>
  <rect x="220" y="440" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="460">Network</text>
  <rect x="372" y="440" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="386" y="460">Loss</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <text x="42" y="76">x0</text>
  <polygon points="200,68 208,72 200,76" class="filled"></polygon>
  <line x1="92" y1="80" x2="92" y2="256" class="solid"></line>
  <polygon points="256,108 260,96 264,108" class="filled"></polygon>
  <text x="202" y="204">GPU1</text>
  <polygon points="400,228 408,228 404,240" class="filled"></polygon>
  <text x="42" y="268">x1</text>
  <polygon points="200,260 208,264 200,268" class="filled"></polygon>
  <line x1="92" y1="272" x2="92" y2="448" class="solid"></line>
  <polygon points="256,300 260,288 264,300" class="filled"></polygon>
  <text x="202" y="396">GPU2</text>
  <polygon points="400,420 408,420 404,432" class="filled"></polygon>
  <text x="42" y="460">x2</text>
  <polygon points="200,452 208,456 200,460" class="filled"></polygon>
  <polygon points="256,492 260,480 264,492" class="filled"></polygon>
  <line x1="328" y1="72" x2="316" y2="72" class="solid end_marked_open_circle"></line>
  <line x1="328" y1="72" x2="352" y2="72" class="solid"></line>
  <polygon points="352,68 360,72 352,76" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="532" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="64" class="solid"></line>
    <path d="M 4,532 A 4,4 0,0,0 8,536" class="nofill"></path>
    <line x1="8" y1="536" x2="88" y2="536" class="solid"></line>
    <line x1="92" y1="464" x2="92" y2="532" class="solid"></line>
    <path d="M 92,532 A 4,4 0,0,1 88,536" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="64" class="solid"></line>
    <line x1="192" y1="8" x2="464" y2="8" class="solid"></line>
    <path d="M 464,8 A 4,4 0,0,1 468,12" class="nofill"></path>
    <line x1="468" y1="12" x2="468" y2="148" class="solid"></line>
    <line x1="188" y1="80" x2="188" y2="148" class="solid"></line>
    <path d="M 188,148 A 4,4 0,0,0 192,152" class="nofill"></path>
    <line x1="192" y1="152" x2="464" y2="152" class="solid"></line>
    <path d="M 468,148 A 4,4 0,0,1 464,152" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,56 A 4,4 0,0,0 20,60" class="nofill"></path>
    <line x1="20" y1="60" x2="20" y2="84" class="solid"></line>
    <line x1="24" y1="56" x2="72" y2="56" class="solid"></line>
    <path d="M 72,56 A 4,4 0,0,1 76,60" class="nofill"></path>
    <line x1="76" y1="60" x2="76" y2="84" class="solid"></line>
    <line x1="76" y1="72" x2="200" y2="72" class="solid"></line>
    <path d="M 20,84 A 4,4 0,0,0 24,88" class="nofill"></path>
    <line x1="24" y1="88" x2="72" y2="88" class="solid"></line>
    <path d="M 76,84 A 4,4 0,0,1 72,88" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="108" x2="260" y2="132" class="solid"></line>
    <path d="M 260,132 A 4,4 0,0,0 264,136" class="nofill"></path>
    <line x1="264" y1="136" x2="400" y2="136" class="solid"></line>
    <line x1="404" y1="96" x2="404" y2="132" class="solid"></line>
    <path d="M 404,132 A 4,4 0,0,1 400,136" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,184 A 4,4 0,0,0 188,188" class="nofill"></path>
    <line x1="188" y1="188" x2="188" y2="256" class="solid"></line>
    <line x1="192" y1="184" x2="464" y2="184" class="solid"></line>
    <path d="M 464,184 A 4,4 0,0,1 468,188" class="nofill"></path>
    <line x1="468" y1="188" x2="468" y2="340" class="solid"></line>
    <line x1="188" y1="272" x2="188" y2="340" class="solid"></line>
    <path d="M 188,340 A 4,4 0,0,0 192,344" class="nofill"></path>
    <line x1="192" y1="344" x2="464" y2="344" class="solid"></line>
    <path d="M 468,340 A 4,4 0,0,1 464,344" class="nofill"></path>
  </g>
  <g>
    <path d="M 264,200 A 4,4 0,0,0 260,204" class="nofill"></path>
    <line x1="260" y1="204" x2="260" y2="240" class="solid"></line>
    <line x1="264" y1="200" x2="400" y2="200" class="solid"></line>
    <path d="M 400,200 A 4,4 0,0,1 404,204" class="nofill"></path>
    <line x1="404" y1="204" x2="404" y2="228" class="solid"></line>
  </g>
  <g>
    <path d="M 24,248 A 4,4 0,0,0 20,252" class="nofill"></path>
    <line x1="20" y1="252" x2="20" y2="276" class="solid"></line>
    <line x1="24" y1="248" x2="72" y2="248" class="solid"></line>
    <path d="M 72,248 A 4,4 0,0,1 76,252" class="nofill"></path>
    <line x1="76" y1="252" x2="76" y2="276" class="solid"></line>
    <line x1="76" y1="264" x2="200" y2="264" class="solid"></line>
    <path d="M 20,276 A 4,4 0,0,0 24,280" class="nofill"></path>
    <line x1="24" y1="280" x2="72" y2="280" class="solid"></line>
    <path d="M 76,276 A 4,4 0,0,1 72,280" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="300" x2="260" y2="324" class="solid"></line>
    <path d="M 260,324 A 4,4 0,0,0 264,328" class="nofill"></path>
    <line x1="264" y1="328" x2="400" y2="328" class="solid"></line>
    <line x1="404" y1="288" x2="404" y2="324" class="solid"></line>
    <path d="M 404,324 A 4,4 0,0,1 400,328" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,376 A 4,4 0,0,0 188,380" class="nofill"></path>
    <line x1="188" y1="380" x2="188" y2="448" class="solid"></line>
    <line x1="192" y1="376" x2="464" y2="376" class="solid"></line>
    <path d="M 464,376 A 4,4 0,0,1 468,380" class="nofill"></path>
    <line x1="468" y1="380" x2="468" y2="532" class="solid"></line>
    <line x1="188" y1="464" x2="188" y2="532" class="solid"></line>
    <path d="M 188,532 A 4,4 0,0,0 192,536" class="nofill"></path>
    <line x1="192" y1="536" x2="464" y2="536" class="solid"></line>
    <path d="M 468,532 A 4,4 0,0,1 464,536" class="nofill"></path>
  </g>
  <g>
    <path d="M 264,392 A 4,4 0,0,0 260,396" class="nofill"></path>
    <line x1="260" y1="396" x2="260" y2="432" class="solid"></line>
    <line x1="264" y1="392" x2="400" y2="392" class="solid"></line>
    <path d="M 400,392 A 4,4 0,0,1 404,396" class="nofill"></path>
    <line x1="404" y1="396" x2="404" y2="420" class="solid"></line>
  </g>
  <g>
    <path d="M 24,440 A 4,4 0,0,0 20,444" class="nofill"></path>
    <line x1="20" y1="444" x2="20" y2="468" class="solid"></line>
    <line x1="24" y1="440" x2="72" y2="440" class="solid"></line>
    <path d="M 72,440 A 4,4 0,0,1 76,444" class="nofill"></path>
    <line x1="76" y1="444" x2="76" y2="468" class="solid"></line>
    <line x1="76" y1="456" x2="200" y2="456" class="solid"></line>
    <path d="M 20,468 A 4,4 0,0,0 24,472" class="nofill"></path>
    <line x1="24" y1="472" x2="72" y2="472" class="solid"></line>
    <path d="M 76,468 A 4,4 0,0,1 72,472" class="nofill"></path>
  </g>
  <g>
    <line x1="260" y1="492" x2="260" y2="516" class="solid"></line>
    <path d="M 260,516 A 4,4 0,0,0 264,520" class="nofill"></path>
    <line x1="264" y1="520" x2="400" y2="520" class="solid"></line>
    <line x1="404" y1="480" x2="404" y2="516" class="solid"></line>
    <path d="M 404,516 A 4,4 0,0,1 400,520" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="232" height="192" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="232" height="192"></rect>
  <rect x="108" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="172" y="56" width="16" height="16" class="solid nofill" rx="4"></rect>
  <polygon points="176,36 184,36 180,48" class="filled"></polygon>
  <polygon points="96,68 104,72 96,76" class="filled"></polygon>
  <line x1="120" y1="80" x2="130" y2="100" class="solid"></line>
  <line x1="176" y1="80" x2="166" y2="100" class="solid"></line>
  <polygon points="127,100 134,108 134,97" class="filled"></polygon>
  <polygon points="169,100 162,108 162,97" class="filled"></polygon>
  <polygon points="168,164 176,168 168,172" class="filled"></polygon>
  <g>
    <path d="M 184,8 A 4,4 0,0,0 180,12" class="nofill"></path>
    <line x1="180" y1="12" x2="180" y2="36" class="solid"></line>
    <line x1="184" y1="8" x2="200" y2="8" class="solid"></line>
    <path d="M 200,8 A 4,4 0,0,1 204,12" class="nofill"></path>
    <line x1="204" y1="12" x2="204" y2="128" class="solid"></line>
    <path d="M 80,72 A 4,4 0,0,0 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="128" class="solid"></line>
    <line x1="80" y1="72" x2="96" y2="72" class="solid"></line>
    <line x1="148" y1="104" x2="136" y2="128" class="solid"></line>
    <line x1="148" y1="104" x2="160" y2="128" class="solid"></line>
    <line x1="76" y1="128" x2="136" y2="128" class="solid"></line>
    <line x1="160" y1="128" x2="204" y2="128" class="solid"></line>
    <line x1="136" y1="128" x2="148" y2="152" class="solid"></line>
    <line x1="160" y1="128" x2="148" y2="152" class="solid"></line>
    <line x1="148" y1="152" x2="148" y2="164" class="solid"></line>
    <path d="M 148,164 A 4,4 0,0,0 152,168" class="nofill"></path>
    <line x1="152" y1="168" x2="168" y2="168" class="solid"></line>
  </g>
  <g>
    <line x1="148" y1="80" x2="148" y2="100" class="solid"></line>
    <path d="M 148,100 A 16,16 0,0,1 146,108" class="nofill"></path>
    <path d="M 148,100 A 16,16 0,0,0 150,108" class="nofill"></path>
  </g>
  <g>
    <line x1="192" y1="160" x2="224" y2="160" class="solid"></line>
    <line x1="192" y1="160" x2="184" y2="176" class="solid"></line>
    <line x1="184" y1="176" x2="216" y2="176" class="solid"></line>
    <line x1="224" y1="160" x2="216" y2="176" class="solid"></line>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="432" height="288" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="432" height="288"></rect>
  <rect x="84" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="188" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="244" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="316" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="84" y="72" width="104" height="32" class="solid nofill" rx="4"></rect>
  <text x="98" y="92">Filesystem</text>
  <rect x="220" y="72" width="96" height="32" class="solid nofill" rx="4"></rect>
  <text x="234" y="92">Scheduler</text>
  <rect x="116" y="152" width="40" height="32" class="solid nofill" rx="4"></rect>
  <text x="130" y="172">IO</text>
  <rect x="300" y="152" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="314" y="172">Network</text>
  <rect x="100" y="232" width="320" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="252">HAL</text>
  <rect x="372" y="8" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="356" y="72" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="370" y="92">MMU</text>
  <line x1="100" y1="32" x2="100" y2="52" class="solid"></line>
  <polygon points="96,52 104,52 100,64" class="filled"></polygon>
  <line x1="156" y1="32" x2="156" y2="52" class="solid"></line>
  <polygon points="152,52 160,52 156,64" class="filled"></polygon>
  <polygon points="168,164 160,168 168,172" class="filled"></polygon>
  <line x1="260" y1="32" x2="260" y2="52" class="solid"></line>
  <polygon points="256,52 264,52 260,64" class="filled"></polygon>
  <line x1="332" y1="32" x2="332" y2="132" class="solid"></line>
  <polygon points="328,132 336,132 332,144" class="filled"></polygon>
  <line x1="140" y1="112" x2="140" y2="132" class="solid"></line>
  <polygon points="136,132 144,132 140,144" class="filled"></polygon>
  <line x1="260" y1="112" x2="260" y2="212" class="solid"></line>
  <polygon points="256,212 264,212 260,224" class="filled"></polygon>
  <line x1="140" y1="192" x2="140" y2="212" class="solid"></line>
  <polygon points="136,212 144,212 140,224" class="filled"></polygon>
  <line x1="340" y1="192" x2="340" y2="212" class="solid"></line>
  <polygon points="336,212 344,212 340,224" class="filled"></polygon>
  <line x1="388" y1="32" x2="388" y2="52" class="solid"></line>
  <polygon points="384,52 392,52 388,64" class="filled"></polygon>
  <text x="10" y="28">OS</text>
  <text x="34" y="28">API</text>
  <g>
    <line x1="204" y1="32" x2="204" y2="164" class="solid"></line>
    <line x1="168" y1="168" x2="200" y2="168" class="solid"></line>
    <path d="M 204,164 A 4,4 0,0,1 200,168" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="560" height="288" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="560" height="288"></rect>
  <rect x="236" y="72" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="92">Network</text>
  <rect x="388" y="72" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="92">Loss</text>
  <rect x="20" y="136" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="42" y="156">x1</text>
  <rect x="20" y="200" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="42" y="220">x2</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <polygon points="416,52 424,52 420,64" class="filled"></polygon>
  <text x="42" y="92">x0</text>
  <polygon points="216,84 224,88 216,92" class="filled"></polygon>
  <polygon points="272,124 276,112 280,124" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="260" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="80" class="solid"></line>
    <path d="M 4,260 A 4,4 0,0,0 8,264" class="nofill"></path>
    <line x1="8" y1="264" x2="88" y2="264" class="solid"></line>
    <line x1="92" y1="96" x2="92" y2="260" class="solid"></line>
    <path d="M 92,260 A 4,4 0,0,1 88,264" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="80" class="solid"></line>
    <line x1="192" y1="8" x2="540" y2="8" class="solid"></line>
    <path d="M 540,8 A 8,8 0,0,1 548,16" class="nofill"></path>
    <line x1="548" y1="16" x2="548" y2="160" class="solid"></line>
    <line x1="188" y1="96" x2="188" y2="164" class="solid"></line>
    <path d="M 188,164 A 4,4 0,0,0 192,168" class="nofill"></path>
    <line x1="192" y1="168" x2="540" y2="168" class="solid"></line>
    <path d="M 548,160 A 8,8 0,0,1 540,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,24 A 4,4 0,0,0 276,28" class="nofill"></path>
    <line x1="276" y1="28" x2="276" y2="64" class="solid"></line>
    <line x1="280" y1="24" x2="416" y2="24" class="solid"></line>
    <path d="M 416,24 A 4,4 0,0,1 420,28" class="nofill"></path>
    <line x1="420" y1="28" x2="420" y2="52" class="solid"></line>
  </g>
  <g>
    <path d="M 24,72 A 4,4 0,0,0 20,76" class="nofill"></path>
    <line x1="20" y1="76" x2="20" y2="100" class="solid"></line>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 72,72 A 4,4 0,0,1 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="100" class="solid"></line>
    <line x1="76" y1="88" x2="216" y2="88" class="solid"></line>
    <path d="M 20,100 A 4,4 0,0,0 24,104" class="nofill"></path>
    <line x1="24" y1="104" x2="72" y2="104" class="solid"></line>
    <path d="M 76,100 A 4,4 0,0,1 72,104" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="124" x2="276" y2="148" class="solid"></line>
    <path d="M 276,148 A 4,4 0,0,0 280,152" class="nofill"></path>
    <line x1="280" y1="152" x2="416" y2="152" class="solid"></line>
    <line x1="420" y1="112" x2="420" y2="148" class="solid"></line>
    <path d="M 420,148 A 4,4 0,0,1 416,152" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="496" height="576" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="496" height="576"></rect>
  <rect x="388" y="72" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="92">Loss</text>
  <rect x="236" y="264" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="284">Network</text>
  <rect x="388" y="264" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="284">Loss</text>
  <rect x="236" y="456" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="250" y="476">Network</text>
  <rect x="388" y="456" width="56" height="32" class="solid nofill" rx="4"></rect>
  <text x="402" y="476">Loss</text>
  <text x="34" y="28">Data</text>
  <text x="202" y="28">GPU0</text>
  <text x="42" y="92">x0</text>
  <polygon points="216,84 224,88 216,92" class="filled"></polygon>
  <text x="250" y="92">Network</text>
  <polygon points="376,84 384,88 376,92" class="filled"></polygon>
  <line x1="92" y1="96" x2="92" y2="272" class="solid"></line>
  <polygon points="272,124 276,112 280,124" class="filled"></polygon>
  <polygon points="321,124 314,116 314,127" class="filled"></polygon>
  <text x="202" y="220">GPU1</text>
  <polygon points="416,244 424,244 420,256" class="filled"></polygon>
  <text x="42" y="284">x1</text>
  <polygon points="216,276 224,280 216,284" class="filled"></polygon>
  <line x1="92" y1="288" x2="92" y2="464" class="solid"></line>
  <polygon points="272,316 276,304 280,316" class="filled"></polygon>
  <text x="202" y="412">GPU2</text>
  <polygon points="416,436 424,436 420,448" class="filled"></polygon>
  <text x="42" y="476">x2</text>
  <polygon points="216,468 224,472 216,476" class="filled"></polygon>
  <polygon points="272,508 276,496 280,508" class="filled"></polygon>
  <g>
    <path d="M 8,8 A 4,4 0,0,0 4,12" class="nofill"></path>
    <line x1="4" y1="12" x2="4" y2="548" class="solid"></line>
    <line x1="8" y1="8" x2="88" y2="8" class="solid"></line>
    <path d="M 88,8 A 4,4 0,0,1 92,12" class="nofill"></path>
    <line x1="92" y1="12" x2="92" y2="80" class="solid"></line>
    <path d="M 4,548 A 4,4 0,0,0 8,552" class="nofill"></path>
    <line x1="8" y1="552" x2="88" y2="552" class="solid"></line>
    <line x1="92" y1="480" x2="92" y2="548" class="solid"></line>
    <path d="M 92,548 A 4,4 0,0,1 88,552" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,8 A 4,4 0,0,0 188,12" class="nofill"></path>
    <line x1="188" y1="12" x2="188" y2="80" class="solid"></line>
    <line x1="192" y1="8" x2="480" y2="8" class="solid"></line>
    <path d="M 480,8 A 4,4 0,0,1 484,12" class="nofill"></path>
    <line x1="484" y1="12" x2="484" y2="164" class="solid"></line>
    <line x1="188" y1="96" x2="188" y2="164" class="solid"></line>
    <path d="M 188,164 A 4,4 0,0,0 192,168" class="nofill"></path>
    <line x1="192" y1="168" x2="480" y2="168" class="solid"></line>
    <path d="M 484,164 A 4,4 0,0,1 480,168" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,72 A 4,4 0,0,0 20,76" class="nofill"></path>
    <line x1="20" y1="76" x2="20" y2="100" class="solid"></line>
    <line x1="24" y1="72" x2="72" y2="72" class="solid"></line>
    <path d="M 72,72 A 4,4 0,0,1 76,76" class="nofill"></path>
    <line x1="76" y1="76" x2="76" y2="100" class="solid"></line>
    <line x1="76" y1="88" x2="216" y2="88" class="solid"></line>
    <path d="M 20,100 A 4,4 0,0,0 24,104" class="nofill"></path>
    <line x1="24" y1="104" x2="72" y2="104" class="solid"></line>
    <path d="M 76,100 A 4,4 0,0,1 72,104" class="nofill"></path>
  </g>
  <g>
    <path d="M 240,72 A 4,4 0,0,0 236,76" class="nofill"></path>
    <line x1="236" y1="76" x2="236" y2="100" class="solid"></line>
    <line x1="240" y1="72" x2="312" y2="72" class="solid"></line>
    <path d="M 312,72 A 4,4 0,0,1 316,76" class="nofill"></path>
    <line x1="316" y1="76" x2="316" y2="100" class="solid"></line>
    <line x1="316" y1="88" x2="376" y2="88" class="solid"></line>
    <path d="M 236,100 A 4,4 0,0,0 240,104" class="nofill"></path>
    <line x1="240" y1="104" x2="312" y2="104" class="solid"></line>
    <path d="M 316,100 A 4,4 0,0,1 312,104" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="124" x2="276" y2="148" class="solid"></line>
    <path d="M 276,148 A 4,4 0,0,0 280,152" class="nofill"></path>
    <line x1="280" y1="152" x2="416" y2="152" class="solid"></line>
    <line x1="420" y1="112" x2="420" y2="148" class="solid"></line>
    <path d="M 420,148 A 4,4 0,0,1 416,152" class="nofill"></path>
  </g>
  <g>
    <line x1="318" y1="124" x2="328" y2="144" class="solid"></line>
    <line x1="384" y1="112" x2="368" y2="144" class="solid"></line>
    <line x1="328" y1="144" x2="368" y2="144" class="solid"></line>
  </g>
  <g>
    <path d="M 192,200 A 4,4 0,0,0 188,204" class="nofill"></path>
    <line x1="188" y1="204" x2="188" y2="272" class="solid"></line>
    <line x1="192" y1="200" x2="480" y2="200" class="solid"></line>
    <path d="M 480,200 A 4,4 0,0,1 484,204" class="nofill"></path>
    <line x1="484" y1="204" x2="484" y2="356" class="solid"></line>
    <line x1="188" y1="288" x2="188" y2="356" class="solid"></line>
    <path d="M 188,356 A 4,4 0,0,0 192,360" class="nofill"></path>
    <line x1="192" y1="360" x2="480" y2="360" class="solid"></line>
    <path d="M 484,356 A 4,4 0,0,1 480,360" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,216 A 4,4 0,0,0 276,220" class="nofill"></path>
    <line x1="276" y1="220" x2="276" y2="256" class="solid"></line>
    <line x1="280" y1="216" x2="416" y2="216" class="solid"></line>
    <path d="M 416,216 A 4,4 0,0,1 420,220" class="nofill"></path>
    <line x1="420" y1="220" x2="420" y2="244" class="solid"></line>
  </g>
  <g>
    <path d="M 24,264 A 4,4 0,0,0 20,268" class="nofill"></path>
    <line x1="20" y1="268" x2="20" y2="292" class="solid"></line>
    <line x1="24" y1="264" x2="72" y2="264" class="solid"></line>
    <path d="M 72,264 A 4,4 0,0,1 76,268" class="nofill"></path>
    <line x1="76" y1="268" x2="76" y2="292" class="solid"></line>
    <line x1="76" y1="280" x2="216" y2="280" class="solid"></line>
    <path d="M 20,292 A 4,4 0,0,0 24,296" class="nofill"></path>
    <line x1="24" y1="296" x2="72" y2="296" class="solid"></line>
    <path d="M 76,292 A 4,4 0,0,1 72,296" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="316" x2="276" y2="340" class="solid"></line>
    <path d="M 276,340 A 4,4 0,0,0 280,344" class="nofill"></path>
    <line x1="280" y1="344" x2="416" y2="344" class="solid"></line>
    <line x1="420" y1="304" x2="420" y2="340" class="solid"></line>
    <path d="M 420,340 A 4,4 0,0,1 416,344" class="nofill"></path>
  </g>
  <g>
    <path d="M 192,392 A 4,4 0,0,0 188,396" class="nofill"></path>
    <line x1="188" y1="396" x2="188" y2="464" class="solid"></line>
    <line x1="192" y1="392" x2="480" y2="392" class="solid"></line>
    <path d="M 480,392 A 4,4 0,0,1 484,396" class="nofill"></path>
    <line x1="484" y1="396" x2="484" y2="548" class="solid"></line>
    <line x1="188" y1="480" x2="188" y2="548" class="solid"></line>
    <path d="M 188,548 A 4,4 0,0,0 192,552" class="nofill"></path>
    <line x1="192" y1="552" x2="480" y2="552" class="solid"></line>
    <path d="M 484,548 A 4,4 0,0,1 480,552" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,408 A 4,4 0,0,0 276,412" class="nofill"></path>
    <line x1="276" y1="412" x2="276" y2="448" class="solid"></line>
    <line x1="280" y1="408" x2="416" y2="408" class="solid"></line>
    <path d="M 416,408 A 4,4 0,0,1 420,412" class="nofill"></path>
    <line x1="420" y1="412" x2="420" y2="436" class="solid"></line>
  </g>
  <g>
    <path d="M 24,456 A 4,4 0,0,0 20,460" class="nofill"></path>
    <line x1="20" y1="460" x2="20" y2="484" class="solid"></line>
    <line x1="24" y1="456" x2="72" y2="456" class="solid"></line>
    <path d="M 72,456 A 4,4 0,0,1 76,460" class="nofill"></path>
    <line x1="76" y1="460" x2="76" y2="484" class="solid"></line>
    <line x1="76" y1="472" x2="216" y2="472" class="solid"></line>
    <path d="M 20,484 A 4,4 0,0,0 24,488" class="nofill"></path>
    <line x1="24" y1="488" x2="72" y2="488" class="solid"></line>
    <path d="M 76,484 A 4,4 0,0,1 72,488" class="nofill"></path>
  </g>
  <g>
    <line x1="276" y1="508" x2="276" y2="532" class="solid"></line>
    <path d="M 276,532 A 4,4 0,0,0 280,536" class="nofill"></path>
    <line x1="280" y1="536" x2="416" y2="536" class="solid"></line>
    <line x1="420" y1="496" x2="420" y2="532" class="solid"></line>
    <path d="M 420,532 A 4,4 0,0,1 416,536" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="576" height="704" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

.svgbob .r{ 
    fill: #FF8180;
 }
.svgbob .g{ 
    fill: #97E6A5;
 }
.svgbob .b{ 
    fill: #7DCAFF;
 }
.svgbob .t{ 
    fill: none;
    stroke: #838383;
    color: #838383;
 }
.svgbob .r1{ 
    fill: papayawhip;
 }
.svgbob .r2{ 
    fill: crimson;
 }
.svgbob .a{ 
    stroke-dasharray: 8;
    fill: lightblue;
 }
.svgbob .bigrect{ 
    fill: yellow;
    stroke: red;
 }
.svgbob .red{ 
    fill:red;
    stroke:blue;
 }
.svgbob .container{ 
    fill: rgba(100,100,100, 0.1);
    stroke: #000;
 }</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="576" height="704"></rect>
  <rect x="4" y="40" width="560" height="448" class="broken nofill g container" rx="4"></rect>
  <rect x="36" y="72" width="56" height="32" class="solid nofill r1" rx="0"></rect>
  <rect x="124" y="72" width="56" height="32" class="solid nofill r2" rx="4"></rect>
  <rect x="308" y="72" width="216" height="160" class="solid nofill bigrect" rx="4"></rect>
  <circle cx="68" cy="304" r="36" class="nofill a"></circle>
  <text x="66" y="300">8</text>
  <circle cx="160" cy="304" r="40" class="nofill b"></circle>
  <text x="154" y="300">9</text>
  <circle cx="264" cy="312" r="44" class="nofill red"></circle>
  <text x="258" y="316">10</text>
  <circle cx="384" cy="312" r="44" class="nofill a b"></circle>
  <text x="378" y="316">11</text>
  <circle cx="96" cy="416" r="52" class="nofill c"></circle>
  <text x="90" y="412">12</text>
  <line x1="16" y1="8" x2="4" y2="8" class="solid end_marked_open_circle"></line>
  <polygon points="16,4 24,8 16,12" class="filled"></polygon>
  <text x="34" y="12">Latest</text>
  <text x="90" y="12">addition:</text>
  <text x="170" y="12">Styling</text>
  <text x="234" y="12">of</text>
  <text x="258" y="12">tagged</text>
  <text x="314" y="12">shapes</text>
  <text x="26" y="572">Advantages:</text>
  <line x1="8" y1="600" x2="20" y2="600" class="solid end_marked_circle"></line>
  <line x1="16" y1="600" x2="20" y2="600" class="solid"></line>
  <text x="34" y="604">Plain</text>
  <text x="82" y="604">text</text>
  <text x="122" y="604">format</text>
  <text x="34" y="620">Ultimately</text>
  <text x="122" y="620">portable,</text>
  <text x="34" y="636">Degrades</text>
  <text x="106" y="636">gracefully</text>
  <text x="34" y="652">Even</text>
  <text x="74" y="652">when</text>
  <text x="114" y="652">not</text>
  <text x="146" y="652">using</text>
  <text x="194" y="652">a</text>
  <text x="210" y="652">graphical</text>
  <text x="290" y="652">renderer,</text>
  <text x="370" y="652">it</text>
  <text x="394" y="652">would</text>
  <text x="442" y="652">still</text>
  <text x="490" y="652">looks</text>
  <text x="34" y="668">as</text>
  <text x="58" y="668">text</text>
  <text x="98" y="668">based</text>
  <text x="146" y="668">diagrams.</text>
  <text x="226" y="668">Paste</text>
  <text x="274" y="668">the</text>
  <text x="306" y="668">text</text>
  <text x="346" y="668">in</text>
  <text x="370" y="668">your</text>
  <text x="410" y="668">source</text>
  <text x="466" y="668">code.</text>
  <text x="34" y="684">Easiest</text>
  <text x="98" y="684">to</text>
  <text x="122" y="684">use.</text>
  <text x="162" y="684">Anyone</text>
  <text x="218" y="684">knows</text>
  <text x="266" y="684">how</text>
  <text x="298" y="684">to</text>
  <text x="322" y="684">edit</text>
  <text x="362" y="684">text.</text>
  <text x="202" y="620">backward</text>
  <text x="274" y="620">compatible</text>
  <text x="362" y="620">and</text>
  <text x="394" y="620">future</text>
  <text x="450" y="620">proof.</text>
  <line x1="8" y1="632" x2="20" y2="632" class="solid end_marked_circle"></line>
  <line x1="16" y1="632" x2="20" y2="632" class="solid"></line>
  <text x="538" y="652">good</text>
  <line x1="8" y1="680" x2="20" y2="680" class="solid end_marked_circle"></line>
  <line x1="16" y1="680" x2="20" y2="680" class="solid"></line>
  <g>
    <line x1="48" y1="128" x2="104" y2="128" class="solid"></line>
    <line x1="48" y1="128" x2="32" y2="160" class="solid"></line>
    <line x1="104" y1="128" x2="120" y2="160" class="solid"></line>
    <line x1="32" y1="160" x2="48" y2="192" class="solid"></line>
    <line x1="120" y1="160" x2="104" y2="192" class="solid"></line>
    <line x1="48" y1="192" x2="104" y2="192" class="solid"></line>
  </g>
  <g>
    <path d="M 224,72 A 8,8 0,0,0 218,76" class="nofill"></path>
    <line x1="218" y1="76" x2="216" y2="80" class="solid"></line>
    <line x1="224" y1="72" x2="272" y2="72" class="solid"></line>
    <path d="M 272,72 A 8,8 0,0,1 278,76" class="nofill"></path>
    <line x1="278" y1="76" x2="280" y2="80" class="solid"></line>
    <path d="M 216,80 A 16,16 0,0,0 216,96" class="nofill"></path>
    <path d="M 280,80 A 16,16 0,0,1 280,96" class="nofill"></path>
    <line x1="216" y1="96" x2="218" y2="100" class="solid"></line>
    <path d="M 218,100 A 8,8 0,0,0 224,104" class="nofill"></path>
    <line x1="224" y1="104" x2="272" y2="104" class="solid"></line>
    <line x1="280" y1="96" x2="278" y2="100" class="solid"></line>
    <path d="M 278,100 A 8,8 0,0,1 272,104" class="nofill"></path>
  </g>
  <g>
    <line x1="200" y1="128" x2="264" y2="128" class="solid"></line>
    <line x1="200" y1="128" x2="208" y2="144" class="solid"></line>
    <line x1="264" y1="128" x2="272" y2="144" class="solid"></line>
    <path d="M 208,144 A 16,16 0,0,1 208,160" class="nofill"></path>
    <path d="M 272,144 A 16,16 0,0,1 272,160" class="nofill"></path>
    <line x1="208" y1="160" x2="200" y2="176" class="solid"></line>
    <line x1="200" y1="176" x2="264" y2="176" class="solid"></line>
    <line x1="272" y1="160" x2="264" y2="176" class="solid"></line>
  </g>
  <g>
    <line x1="168" y1="128" x2="152" y2="160" class="solid"></line>
    <line x1="168" y1="128" x2="184" y2="160" class="solid"></line>
    <line x1="152" y1="160" x2="168" y2="192" class="solid"></line>
    <line x1="184" y1="160" x2="168" y2="192" class="solid"></line>
  </g>
  <g>
    <path d="M 184,392 A 3,3 0,0,0 182,396" class="nofill"></path>
    <line x1="182" y1="396" x2="204" y2="440" class="solid"></line>
    <line x1="184" y1="392" x2="224" y2="392" class="solid"></line>
    <path d="M 224,392 A 3,3 0,0,1 226,396" class="nofill"></path>
    <line x1="226" y1="396" x2="204" y2="440" class="solid"></line>
  </g>
  <g>
    <path d="M 248,392 A 3,3 0,0,0 246,396" class="nofill"></path>
    <line x1="246" y1="396" x2="266" y2="436" class="solid"></line>
    <line x1="248" y1="392" x2="280" y2="392" class="solid"></line>
    <path d="M 280,392 A 8,8 0,0,1 286,396" class="nofill"></path>
    <line x1="286" y1="396" x2="306" y2="436" class="solid"></line>
    <path d="M 266,436 A 8,8 0,0,0 272,440" class="nofill"></path>
    <line x1="272" y1="440" x2="304" y2="440" class="solid"></line>
    <path d="M 306,436 A 3,3 0,0,1 304,440" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,552 A 8,8 0,0,0 18,556" class="nofill"></path>
    <line x1="18" y1="556" x2="6" y2="580" class="solid"></line>
    <line x1="24" y1="552" x2="128" y2="552" class="solid"></line>
    <path d="M 128,552 A 3,3 0,0,1 130,556" class="nofill"></path>
    <line x1="130" y1="556" x2="118" y2="580" class="solid"></line>
    <path d="M 6,580 A 3,3 0,0,0 8,584" class="nofill"></path>
    <line x1="8" y1="584" x2="112" y2="584" class="solid"></line>
    <path d="M 118,580 A 8,8 0,0,1 112,584" class="nofill"></path>
  </g>
</svg>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="760" height="7520" class="svgbob">
  <style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: #838383;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: #838383;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: rgba(0,0,0,0.0);
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: #838383;
}

.svgbob .bg_filled {
  fill: rgba(0,0,0,0.0);
  stroke-width: 1;
}

.svgbob .nofill {
  fill: rgba(0,0,0,0.0);
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style>
  <defs>
    <marker id="arrow" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,0 0,4 4,2 0,0"></polygon>
    </marker>
    <marker id="diamond" viewbox="-2 -2 8 8" refx="4" refy="2" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
    </marker>
    <marker id="circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="filled"></circle>
    </marker>
    <marker id="open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
    </marker>
    <marker id="big_open_circle" viewbox="0 0 8 8" refx="4" refy="4" markerwidth="7" markerheight="7" orient="auto-start-reverse">
      <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
    </marker>
  </defs>
  <rect class="backdrop" x="0" y="0" width="760" height="7520"></rect>
  <rect x="68" y="312" width="56" height="32" class="solid nofill" rx="0"></rect>
  <rect x="156" y="312" width="56" height="32" class="solid nofill" rx="4"></rect>
  <path d="M 88,468 A 20,20 0,0,0 88,508" class="nofill"></path>
  <circle cx="72" cy="536" r="4" class="nofill"></circle>
  <circle cx="444" cy="568" r="24" class="nofill"></circle>
  <circle cx="520" cy="568" r="28" class="nofill"></circle>
  <circle cx="156" cy="568" r="16" class="nofill"></circle>
  <circle cx="208" cy="568" r="20" class="nofill"></circle>
  <circle cx="264" cy="568" r="20" class="nofill"></circle>
  <path d="M 272,560 A 16,16 0,0,0 272,576" class="nofill"></path>
  <circle cx="360" cy="568" r="20" class="nofill"></circle>
  <circle cx="76" cy="568" r="8" class="nofill"></circle>
  <circle cx="100" cy="656" r="36" class="nofill"></circle>
  <circle cx="192" cy="656" r="40" class="nofill"></circle>
  <circle cx="296" cy="664" r="44" class="nofill"></circle>
  <circle cx="420" cy="664" r="48" class="nofill"></circle>
  <circle cx="128" cy="768" r="52" class="nofill"></circle>
  <rect x="146" y="1176" width="28" height="36" class="solid nofill" rx="0"></rect>
  <rect x="150" y="1180" width="12" height="12" class="solid nofill" rx="0"></rect>
  <rect x="166" y="1180" width="4" height="12" class="solid nofill" rx="0"></rect>
  <rect x="150" y="1196" width="12" height="12" class="solid nofill" rx="0"></rect>
  <rect x="166" y="1196" width="4" height="12" class="solid nofill" rx="0"></rect>
  <circle cx="72" cy="1376" r="40" class="nofill"></circle>
  <path d="M 200,1336 A 40,40 0,0,0 160,1376" class="nofill"></path>
  <path d="M 216,1336 A 40,40 0,0,1 256,1376" class="nofill"></path>
  <path d="M 312,1376 A 40,40 0,0,1 392,1376" class="nofill"></path>
  <path d="M 480,1352 A 40,40 0,0,0 480,1432" class="nofill"></path>
  <path d="M 504,1352 A 40,40 0,0,1 504,1432" class="nofill"></path>
  <path d="M 160,1392 A 40,40 0,0,0 200,1432" class="nofill"></path>
  <path d="M 256,1392 A 40,40 0,0,1 216,1432" class="nofill"></path>
  <path d="M 312,1392 A 40,40 0,0,0 392,1392" class="nofill"></path>
  <path d="M 112,1488 A 40,40 0,1,0 72,1528" class="nofill"></path>
  <path d="M 208,1448 A 40,40 0,1,0 248,1488" class="nofill"></path>
  <path d="M 352,1448 A 40,40 0,1,1 312,1488" class="nofill"></path>
  <path d="M 456,1488 A 40,40 0,1,1 496,1528" class="nofill"></path>
  <circle cx="516" cy="2168" r="16" class="nofill"></circle>
  <line x1="520" y1="2160" x2="512" y2="2176" class="solid"></line>
  <rect x="92" y="2296" width="104" height="32" class="solid nofill" rx="4"></rect>
  <rect x="228" y="2296" width="96" height="32" class="solid nofill" rx="4"></rect>
  <rect x="364" y="2296" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="378" y="2316">MMU</text>
  <rect x="212" y="2520" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="212" y="2712" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="108" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="140" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="172" y="4456" width="16" height="16" class="solid nofill" rx="4"></rect>
  <rect x="308" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="364" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="412" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="468" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="540" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="308" y="4472" width="104" height="32" class="solid nofill" rx="4"></rect>
  <text x="322" y="4492">Filesystem</text>
  <rect x="444" y="4472" width="96" height="32" class="solid nofill" rx="4"></rect>
  <text x="458" y="4492">Scheduler</text>
  <rect x="340" y="4552" width="40" height="32" class="solid nofill" rx="4"></rect>
  <text x="354" y="4572">IO</text>
  <rect x="524" y="4552" width="80" height="32" class="solid nofill" rx="4"></rect>
  <text x="538" y="4572">Network</text>
  <rect x="308" y="4632" width="320" height="32" class="solid nofill" rx="4"></rect>
  <text x="458" y="4652">HAL</text>
  <rect x="596" y="4408" width="32" height="16" class="solid nofill" rx="4"></rect>
  <rect x="580" y="4472" width="48" height="32" class="solid nofill" rx="4"></rect>
  <text x="594" y="4492">MMU</text>
  <rect x="580" y="4800" width="24" height="48" class="solid nofill" rx="0"></rect>
  <line x1="584" y1="4806" x2="600" y2="4806" class="solid"></line>
  <line x1="584" y1="4810" x2="600" y2="4810" class="solid"></line>
  <rect x="36" y="6856" width="560" height="448" class="broken nofill container" rx="4"></rect>
  <rect x="68" y="6888" width="56" height="32" class="solid nofill r1" rx="0"></rect>
  <rect x="156" y="6888" width="56" height="32" class="solid nofill r2" rx="4"></rect>
  <rect x="340" y="6888" width="216" height="160" class="solid nofill bigrect" rx="4"></rect>
  <circle cx="100" cy="7120" r="36" class="nofill a"></circle>
  <text x="98" y="7116">8</text>
  <circle cx="192" cy="7120" r="40" class="nofill b"></circle>
  <text x="186" y="7116">9</text>
  <circle cx="296" cy="7128" r="44" class="nofill red"></circle>
  <text x="290" y="7132">10</text>
  <circle cx="416" cy="7128" r="44" class="nofill a b"></circle>
  <text x="410" y="7132">11</text>
  <circle cx="128" cy="7232" r="52" class="nofill c"></circle>
  <text x="122" y="7228">12</text>
  <text x="2" y="12">Svgbob</text>
  <text x="58" y="12">is</text>
  <text x="82" y="12">a</text>
  <text x="98" y="12">diagramming</text>
  <text x="194" y="12">model</text>
  <text x="2" y="28">which</text>
  <text x="50" y="28">uses</text>
  <text x="90" y="28">a</text>
  <text x="106" y="28">set</text>
  <text x="138" y="28">of</text>
  <text x="162" y="28">typing</text>
  <text x="218" y="28">characters</text>
  <text x="2" y="44">to</text>
  <text x="26" y="44">approximate</text>
  <text x="122" y="44">the</text>
  <text x="154" y="44">intended</text>
  <text x="226" y="44">shape.</text>
  <line x1="58" y1="76" x2="36" y2="120" class="solid end_marked_circle"></line>
  <line x1="52" y1="88" x2="68" y2="88" class="solid end_marked_open_circle"></line>
  <line x1="72" y1="88" x2="104" y2="88" class="solid"></line>
  <polygon points="88,100 96,104 88,108" class="filled"></polygon>
  <text x="2" y="188">It</text>
  <text x="26" y="188">uses</text>
  <text x="66" y="188">a</text>
  <text x="2" y="204">which</text>
  <text x="50" y="204">are</text>
  <text x="82" y="188">combination</text>
  <text x="178" y="188">of</text>
  <text x="202" y="188">characters</text>
  <text x="82" y="204">readily</text>
  <text x="146" y="204">available</text>
  <text x="226" y="204">on</text>
  <text x="250" y="204">your</text>
  <text x="290" y="204">keyboards.</text>
  <text x="2" y="236">What</text>
  <text x="42" y="236">can</text>
  <text x="74" y="236">it</text>
  <text x="98" y="236">do?</text>
  <line x1="24" y1="264" x2="12" y2="264" class="solid end_marked_open_circle"></line>
  <polygon points="24,260 32,264 24,268" class="filled"></polygon>
  <text x="50" y="268">Basic</text>
  <text x="98" y="268">shapes</text>
  <line x1="56" y1="280" x2="64" y2="280" class="solid"></line>
  <line x1="72" y1="280" x2="80" y2="280" class="solid"></line>
  <line x1="88" y1="280" x2="96" y2="280" class="solid"></line>
  <line x1="104" y1="280" x2="112" y2="280" class="solid"></line>
  <line x1="120" y1="280" x2="128" y2="280" class="solid"></line>
  <line x1="136" y1="280" x2="144" y2="280" class="solid"></line>
  <line x1="152" y1="280" x2="160" y2="280" class="solid"></line>
  <line x1="168" y1="280" x2="176" y2="280" class="solid"></line>
  <line x1="184" y1="280" x2="192" y2="280" class="solid"></line>
  <line x1="200" y1="280" x2="208" y2="280" class="solid"></line>
  <line x1="216" y1="280" x2="224" y2="280" class="solid"></line>
  <line x1="232" y1="280" x2="240" y2="280" class="solid"></line>
  <line x1="248" y1="280" x2="256" y2="280" class="solid"></line>
  <line x1="264" y1="280" x2="272" y2="280" class="solid"></line>
  <line x1="280" y1="280" x2="288" y2="280" class="solid"></line>
  <line x1="296" y1="280" x2="304" y2="280" class="solid"></line>
  <line x1="312" y1="280" x2="320" y2="280" class="solid"></line>
  <line x1="328" y1="280" x2="336" y2="280" class="solid"></line>
  <line x1="344" y1="280" x2="352" y2="280" class="solid"></line>
  <line x1="360" y1="280" x2="368" y2="280" class="solid"></line>
  <line x1="376" y1="280" x2="384" y2="280" class="solid"></line>
  <line x1="392" y1="280" x2="400" y2="280" class="solid"></line>
  <line x1="408" y1="280" x2="416" y2="280" class="solid"></line>
  <line x1="424" y1="280" x2="432" y2="280" class="solid"></line>
  <line x1="440" y1="280" x2="448" y2="280" class="solid"></line>
  <line x1="456" y1="280" x2="464" y2="280" class="solid"></line>
  <text x="458" y="300">.</text>
  <text x="426" y="332">.</text>
  <text x="490" y="332">.</text>
  <text x="458" y="364">.</text>
  <line x1="472" y1="280" x2="480" y2="280" class="solid"></line>
  <line x1="488" y1="280" x2="496" y2="280" class="solid"></line>
  <line x1="504" y1="280" x2="512" y2="280" class="solid"></line>
  <line x1="520" y1="280" x2="528" y2="280" class="solid"></line>
  <line x1="536" y1="280" x2="544" y2="280" class="solid"></line>
  <polygon points="519,332 526,324 526,335" class="filled"></polygon>
  <line x1="522" y1="332" x2="502" y2="372" class="solid"></line>
  <polygon points="550.8,348 550.8,340 545.2,340 545.2,348" class="filled"></polygon>
  <line x1="546" y1="348" x2="526" y2="388" class="solid"></line>
  <polygon points="519,364 526,356 526,367" class="filled"></polygon>
  <line x1="522" y1="364" x2="504" y2="400" class="solid"></line>
  <polygon points="502.8,380 502.8,372 497.2,372 497.2,380" class="filled"></polygon>
  <polygon points="529,388 522,396 522,385" class="filled"></polygon>
  <rect x="416" y="356" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="420" y1="364" x2="420" y2="404" class="solid"></line>
  <polygon points="416,404 424,404 420,416" class="filled"></polygon>
  <line x1="360" y1="376" x2="348" y2="376" class="solid end_marked_open_circle"></line>
  <line x1="360" y1="376" x2="384" y2="376" class="solid"></line>
  <polygon points="384,372 392,376 384,380" class="filled"></polygon>
  <polygon points="352,388 344,392 352,396" class="filled"></polygon>
  <line x1="352" y1="392" x2="384" y2="392" class="solid"></line>
  <rect x="384" y="388" width="8" height="8" class="solid filled" rx="0"></rect>
  <polygon points="432,380 436,368 440,380" class="filled"></polygon>
  <line x1="436" y1="380" x2="436" y2="424" class="solid end_marked_open_circle"></line>
  <polygon points="456,396 460,384 464,396" class="filled"></polygon>
  <line x1="460" y1="396" x2="460" y2="432" class="broken"></line>
  <line x1="476" y1="384" x2="476" y2="420" class="broken"></line>
  <polygon points="472,420 480,420 476,432" class="filled"></polygon>
  <line x1="478" y1="460" x2="476" y2="456" class="solid end_marked_big_open_circle"></line>
  <line x1="480" y1="464" x2="498" y2="500" class="solid"></line>
  <polygon points="495,500 502,508 502,497" class="filled"></polygon>
  <polygon points="240,500 248,504 240,508" class="filled"></polygon>
  <polygon points="272,468 264,472 272,476" class="filled"></polygon>
  <polygon points="336,468 344,472 336,476" class="filled"></polygon>
  <polygon points="360,500 352,504 360,508" class="filled"></polygon>
  <polygon points="465,476 458,468 458,479" class="filled"></polygon>
  <line x1="462" y1="476" x2="484" y2="520" class="solid end_marked_circle"></line>
  <line x1="24" y1="888" x2="12" y2="888" class="solid end_marked_open_circle"></line>
  <polygon points="24,884 32,888 24,892" class="filled"></polygon>
  <text x="50" y="892">Quick</text>
  <text x="98" y="892">logo</text>
  <line x1="66" y1="908" x2="44" y2="952" class="solid end_marked_circle"></line>
  <line x1="60" y1="920" x2="76" y2="920" class="solid end_marked_open_circle"></line>
  <line x1="80" y1="920" x2="112" y2="920" class="solid"></line>
  <polygon points="96,932 104,936 96,940" class="filled"></polygon>
  <text x="138" y="892">scribbles</text>
  <line x1="276" y1="944" x2="276" y2="968" class="solid end_marked_circle"></line>
  <line x1="172" y1="956" x2="172" y2="952" class="solid end_marked_big_open_circle"></line>
  <line x1="416" y1="952" x2="436" y2="952" class="solid end_marked_circle"></line>
  <line x1="432" y1="952" x2="448" y2="952" class="solid"></line>
  <polygon points="344,948 352,952 344,956" class="filled"></polygon>
  <text x="58" y="1100">.::::.</text>
  <line x1="24" y1="1160" x2="12" y2="1160" class="solid end_marked_open_circle"></line>
  <polygon points="24,1156 32,1160 24,1164" class="filled"></polygon>
  <text x="50" y="1164">Even</text>
  <text x="90" y="1164">unicode</text>
  <text x="154" y="1164">box</text>
  <text x="186" y="1164">drawing</text>
  <text x="250" y="1164">characters</text>
  <text x="338" y="1164">are</text>
  <text x="370" y="1164">supported</text>
  <line x1="24" y1="1288" x2="12" y2="1288" class="solid end_marked_open_circle"></line>
  <polygon points="24,1284 32,1288 24,1292" class="filled"></polygon>
  <text x="42" y="1292">Circle,</text>
  <text x="106" y="1292">quarter</text>
  <text x="170" y="1292">arcs,</text>
  <text x="218" y="1292">half</text>
  <text x="258" y="1292">circles,</text>
  <text x="330" y="1292">3</text>
  <line x1="344" y1="1280" x2="336" y2="1296" class="solid"></line>
  <text x="346" y="1292">4</text>
  <text x="362" y="1292">quarter</text>
  <text x="426" y="1292">arcs</text>
  <line x1="24" y1="1560" x2="12" y2="1560" class="solid end_marked_open_circle"></line>
  <polygon points="24,1556 32,1560 24,1564" class="filled"></polygon>
  <text x="42" y="1564">Grids</text>
  <text x="42" y="1660">{r}</text>
  <text x="42" y="1724">{g}</text>
  <line x1="24" y1="2024" x2="12" y2="2024" class="solid end_marked_open_circle"></line>
  <polygon points="24,2020 32,2024 24,2028" class="filled"></polygon>
  <text x="42" y="2028">Graphics</text>
  <text x="114" y="2028">Diagram</text>
  <line x1="618" y1="2060" x2="620" y2="2056" class="solid end_marked_circle"></line>
  <polygon points="569,2076 562,2068 562,2079" class="filled"></polygon>
  <line x1="566" y1="2076" x2="586" y2="2116" class="solid"></line>
  <line x1="616" y1="2064" x2="598" y2="2100" class="solid"></line>
  <polygon points="601,2100 594,2108 594,2097" class="filled"></polygon>
  <line x1="520" y1="2120" x2="588" y2="2120" class="solid end_marked_circle"></line>
  <line x1="584" y1="2120" x2="656" y2="2120" class="solid"></line>
  <text x="34" y="2076">0</text>
  <text x="98" y="2076">3</text>
  <line x1="44" y1="2088" x2="44" y2="2088" class="solid end_marked_circle"></line>
  <line x1="42" y1="2092" x2="28" y2="2120" class="solid end_marked_circle"></line>
  <line x1="44" y1="2092" x2="44" y2="2152" class="solid end_marked_circle"></line>
  <line x1="48" y1="2088" x2="108" y2="2088" class="solid end_marked_circle"></line>
  <line x1="104" y1="2088" x2="108" y2="2088" class="solid"></line>
  <line x1="106" y1="2092" x2="94" y2="2116" class="solid"></line>
  <line x1="108" y1="2092" x2="108" y2="2148" class="solid"></line>
  <text x="18" y="2108">1</text>
  <text x="82" y="2108">2</text>
  <line x1="28" y1="2120" x2="92" y2="2120" class="solid end_marked_circle"></line>
  <line x1="88" y1="2120" x2="92" y2="2120" class="solid"></line>
  <line x1="28" y1="2124" x2="28" y2="2180" class="solid"></line>
  <line x1="92" y1="2124" x2="92" y2="2180" class="solid"></line>
  <text x="50" y="2140">4</text>
  <text x="114" y="2140">7</text>
  <line x1="44" y1="2152" x2="108" y2="2152" class="solid end_marked_circle"></line>
  <line x1="104" y1="2152" x2="108" y2="2152" class="solid"></line>
  <line x1="42" y1="2156" x2="28" y2="2184" class="solid end_marked_circle"></line>
  <line x1="106" y1="2156" x2="94" y2="2180" class="solid"></line>
  <line x1="28" y1="2184" x2="92" y2="2184" class="solid end_marked_circle"></line>
  <line x1="88" y1="2184" x2="92" y2="2184" class="solid"></line>
  <text x="18" y="2204">5</text>
  <text x="82" y="2204">6</text>
  <text x="314" y="2076">P</text>
  <line x1="334" y1="2076" x2="332" y2="2072" class="solid end_marked_circle"></line>
  <line x1="336" y1="2080" x2="370" y2="2148" class="solid"></line>
  <text x="306" y="2124">v0</text>
  <text x="418" y="2124">v3</text>
  <line x1="324" y1="2136" x2="324" y2="2136" class="solid end_marked_circle"></line>
  <line x1="322" y1="2140" x2="292" y2="2200" class="solid end_marked_circle"></line>
  <line x1="328" y1="2136" x2="412" y2="2136" class="solid end_marked_circle"></line>
  <line x1="408" y1="2136" x2="412" y2="2136" class="solid"></line>
  <line x1="414" y1="2140" x2="442" y2="2196" class="solid"></line>
  <polygon points="367,2148 374,2156 374,2145" class="filled"></polygon>
  <text x="386" y="2156">X</text>
  <line x1="384" y1="2160" x2="380" y2="2168" class="solid end_marked_open_circle"></line>
  <line x1="292" y1="2200" x2="444" y2="2200" class="solid end_marked_circle"></line>
  <line x1="440" y1="2200" x2="444" y2="2200" class="solid"></line>
  <text x="450" y="2076">Eye</text>
  <path d="M 480,2080 A 16,16 0,0,1 480,2096" class="nofill"></path>
  <text x="162" y="2092">+y</text>
  <polygon points="168,2108 172,2096 176,2108" class="filled"></polygon>
  <polygon points="192,2132 184,2136 192,2140" class="filled"></polygon>
  <path d="M 160,2148 A 4,4 0,0,0 156,2156" class="nofill"></path>
  <polygon points="159,2159 157,2155 155,2157" class="filled"></polygon>
  <polygon points="216,2148 224,2152 216,2156" class="filled"></polygon>
  <text x="178" y="2172">‚§¥</text>
  <polygon points="161,2180 154,2188 154,2177" class="filled"></polygon>
  <text x="138" y="2204">+z</text>
  <text x="626" y="2092">Reflection</text>
  <text x="234" y="2156">+x</text>
  <polygon points="536,2148 528,2152 536,2156" class="filled"></polygon>
  <line x1="536" y1="2152" x2="600" y2="2152" class="solid"></line>
  <text x="546" y="2172">Refraction</text>
  <line x1="508" y1="2192" x2="508" y2="2212" class="solid"></line>
  <polygon points="504,2212 512,2212 508,2224" class="filled"></polygon>
  <line x1="666" y1="2156" x2="668" y2="2152" class="solid end_marked_open_circle"></line>
  <line x1="670" y1="2156" x2="690" y2="2196" class="solid"></line>
  <line x1="664" y1="2160" x2="644" y2="2200" class="solid end_marked_open_circle"></line>
  <line x1="648" y1="2200" x2="692" y2="2200" class="solid end_marked_open_circle"></line>
  <text x="266" y="2204">v1</text>
  <text x="458" y="2204">v2</text>
  <line x1="24" y1="2264" x2="12" y2="2264" class="solid end_marked_open_circle"></line>
  <polygon points="24,2260 32,2264 24,2268" class="filled"></polygon>
  <text x="42" y="2268">CJK</text>
  <text x="74" y="2268">characters</text>
  <line x1="212" y1="2288" x2="212" y2="2336" class="solid"></line>
  <line x1="340" y1="2288" x2="340" y2="2336" class="solid"></line>
  <line x1="24" y1="2360" x2="12" y2="2360" class="solid end_marked_open_circle"></line>
  <polygon points="24,2356 32,2360 24,2364" class="filled"></polygon>
  <text x="50" y="2364">Sequence</text>
  <text x="122" y="2364">Diagrams</text>
  <polygon points="312,2388 320,2392 312,2396" class="filled"></polygon>
  <text x="82" y="2412">A</text>
  <text x="146" y="2412">B</text>
  <text x="202" y="2412">C</text>
  <text x="226" y="2412">D</text>
  <line x1="84" y1="2424" x2="84" y2="2424" class="solid end_marked_circle"></line>
  <line x1="88" y1="2424" x2="148" y2="2424" class="solid end_marked_circle"></line>
  <line x1="144" y1="2424" x2="196" y2="2424" class="solid end_marked_circle"></line>
  <line x1="150" y1="2428" x2="162" y2="2452" class="solid"></line>
  <line x1="192" y1="2424" x2="228" y2="2424" class="solid end_marked_circle"></line>
  <line x1="224" y1="2424" x2="268" y2="2424" class="solid end_marked_circle"></line>
  <line x1="264" y1="2424" x2="312" y2="2424" class="solid"></line>
  <polygon points="312,2420 320,2424 312,2428" class="filled"></polygon>
  <polygon points="255,2444 262,2436 262,2447" class="filled"></polygon>
  <polygon points="159,2452 166,2460 166,2449" class="filled"></polygon>
  <polygon points="312,2452 320,2456 312,2460" class="filled"></polygon>
  <text x="170" y="2476">B</text>
  <text x="338" y="2396">F</text>
  <text x="338" y="2428">E</text>
  <text x="338" y="2460">G</text>
  <line x1="184" y1="2472" x2="200" y2="2472" class="solid"></line>
  <polygon points="200,2468 208,2472 200,2476" class="filled"></polygon>
  <text x="218" y="2476">C</text>
  <line x1="216" y1="2544" x2="208" y2="2560" class="solid"></line>
  <line x1="224" y1="2544" x2="232" y2="2560" class="solid"></line>
  <text x="82" y="2588">Bob</text>
  <text x="202" y="2604">Alice</text>
  <text x="130" y="2620">hello</text>
  <line x1="220" y1="2608" x2="220" y2="2688" class="solid"></line>
  <polygon points="208,2628 216,2632 208,2636" class="filled"></polygon>
  <text x="114" y="2668">Is</text>
  <polygon points="104,2676 96,2680 104,2684" class="filled"></polygon>
  <line x1="104" y1="2680" x2="112" y2="2680" class="solid"></line>
  <line x1="120" y1="2680" x2="128" y2="2680" class="solid"></line>
  <line x1="200" y1="2680" x2="208" y2="2680" class="solid"></line>
  <text x="202" y="2700">Alice</text>
  <text x="82" y="2716">Bob</text>
  <line x1="216" y1="2736" x2="208" y2="2752" class="solid"></line>
  <line x1="224" y1="2736" x2="232" y2="2752" class="solid"></line>
  <text x="138" y="2668">it</text>
  <text x="162" y="2668">ok?</text>
  <line x1="136" y1="2680" x2="144" y2="2680" class="solid"></line>
  <line x1="152" y1="2680" x2="160" y2="2680" class="solid"></line>
  <line x1="168" y1="2680" x2="176" y2="2680" class="solid"></line>
  <line x1="184" y1="2680" x2="192" y2="2680" class="solid"></line>
  <text x="122" y="2844">0</text>
  <line x1="104" y1="2864" x2="86" y2="2900" class="solid"></line>
  <polygon points="89,2900 82,2908 82,2897" class="filled"></polygon>
  <text x="82" y="2940">1</text>
  <line x1="88" y1="2960" x2="106" y2="2996" class="solid"></line>
  <polygon points="103,2996 110,3004 110,2993" class="filled"></polygon>
  <text x="114" y="3036">3</text>
  <line x1="144" y1="2864" x2="162" y2="2900" class="solid"></line>
  <polygon points="159,2900 166,2908 166,2897" class="filled"></polygon>
  <text x="178" y="2940">4</text>
  <text x="202" y="2956">.</text>
  <line x1="172" y1="2960" x2="172" y2="3012" class="solid"></line>
  <line x1="192" y1="2960" x2="218" y2="3012" class="solid"></line>
  <line x1="204" y1="2952" x2="252" y2="3000" class="broken"></line>
  <text x="250" y="3004">.</text>
  <polygon points="168,3012 176,3012 172,3024" class="filled"></polygon>
  <polygon points="215,3012 222,3020 222,3009" class="filled"></polygon>
  <polygon points="256,3012 264,3016 260,3008" class="filled"></polygon>
  <text x="178" y="3052">5</text>
  <text x="226" y="3052">6</text>
  <text x="274" y="3052">7</text>
  <line x1="64" y1="2960" x2="46" y2="2996" class="solid"></line>
  <polygon points="49,2996 42,3004 42,2993" class="filled"></polygon>
  <text x="42" y="3036">2</text>
  <line x1="24" y1="3128" x2="12" y2="3128" class="solid end_marked_open_circle"></line>
  <polygon points="24,3124 32,3128 24,3132" class="filled"></polygon>
  <text x="42" y="3132">Plot</text>
  <text x="82" y="3132">diagrams</text>
  <polygon points="64,3164 68,3152 72,3164" class="filled"></polygon>
  <line x1="68" y1="3164" x2="68" y2="3224" class="broken end_marked_circle"></line>
  <polygon points="296,3220 304,3224 296,3228" class="filled"></polygon>
  <text x="34" y="3180">Uin</text>
  <text x="42" y="3260">Udc</text>
  <polygon points="64,3260 68,3248 72,3260" class="filled"></polygon>
  <line x1="68" y1="3260" x2="68" y2="3320" class="broken end_marked_circle"></line>
  <line x1="140" y1="3280" x2="140" y2="3344" class="broken"></line>
  <line x1="144" y1="3320" x2="296" y2="3320" class="broken"></line>
  <polygon points="296,3316 304,3320 296,3324" class="filled"></polygon>
  <polygon points="152,3332 144,3336 152,3340" class="filled"></polygon>
  <line x1="152" y1="3336" x2="192" y2="3336" class="solid"></line>
  <polygon points="192,3332 200,3336 192,3340" class="filled"></polygon>
  <line x1="204" y1="3328" x2="204" y2="3376" class="broken"></line>
  <polygon points="64,3356 68,3344 72,3356" class="filled"></polygon>
  <line x1="68" y1="3356" x2="68" y2="3432" class="broken end_marked_circle"></line>
  <text x="154" y="3356">500ms</text>
  <text x="226" y="3404">Inactive</text>
  <text x="106" y="3420">Active</text>
  <polygon points="296,3428 304,3432 296,3436" class="filled"></polygon>
  <text x="2" y="3388">Cpu.Qon</text>
  <line x1="24" y1="3464" x2="12" y2="3464" class="solid end_marked_open_circle"></line>
  <polygon points="24,3460 32,3464 24,3468" class="filled"></polygon>
  <text x="42" y="3468">Railroad</text>
  <text x="114" y="3468">diagrams</text>
  <line x1="80" y1="3512" x2="68" y2="3512" class="solid end_marked_open_circle"></line>
  <text x="138" y="3516">elem</text>
  <text x="218" y="3516">;</text>
  <text x="266" y="3516">n</text>
  <line x1="312" y1="3512" x2="332" y2="3512" class="solid end_marked_open_circle"></line>
  <polygon points="160,3540 168,3544 160,3548" class="filled"></polygon>
  <line x1="112" y1="3576" x2="120" y2="3576" class="solid"></line>
  <text x="162" y="3580">x</text>
  <line x1="208" y1="3576" x2="216" y2="3576" class="solid"></line>
  <line x1="308" y1="3584" x2="308" y2="3616" class="solid"></line>
  <text x="162" y="3628">,</text>
  <polygon points="304,3628 308,3616 312,3628" class="filled"></polygon>
  <polygon points="184,3652 192,3656 184,3660" class="filled"></polygon>
  <text x="162" y="3692">x</text>
  <text x="218" y="3692">,</text>
  <polygon points="200,3716 192,3720 200,3724" class="filled"></polygon>
  <polygon points="416,3732 424,3736 416,3740" class="filled"></polygon>
  <text x="50" y="3772">O</text>
  <text x="106" y="3772">struct</text>
  <line x1="152" y1="3776" x2="160" y2="3776" class="solid"></line>
  <text x="162" y="3772">name</text>
  <text x="234" y="3772">:</text>
  <line x1="256" y1="3776" x2="264" y2="3776" class="solid"></line>
  <line x1="284" y1="3760" x2="284" y2="3776" class="solid"></line>
  <text x="354" y="3772">name</text>
  <text x="426" y="3772">:</text>
  <text x="482" y="3772">tpe</text>
  <line x1="596" y1="3760" x2="596" y2="3776" class="solid"></line>
  <text x="650" y="3772">body</text>
  <text x="746" y="3772">O</text>
  <polygon points="432,3812 424,3816 432,3820" class="filled"></polygon>
  <line x1="432" y1="3816" x2="480" y2="3816" class="solid"></line>
  <text x="498" y="3820">,</text>
  <line x1="24" y1="3880" x2="12" y2="3880" class="solid end_marked_open_circle"></line>
  <polygon points="24,3876 32,3880 24,3884" class="filled"></polygon>
  <text x="42" y="3884">Statistical</text>
  <text x="138" y="3884">charts</text>
  <text x="34" y="3932">E</text>
  <text x="34" y="3948">D</text>
  <text x="34" y="3964">C</text>
  <text x="34" y="3980">B</text>
  <text x="34" y="3996">A</text>
  <line x1="52" y1="3928" x2="260" y2="3928" class="solid end_marked_circle"></line>
  <line x1="52" y1="3928" x2="52" y2="3992" class="solid"></line>
  <line x1="52" y1="3944" x2="212" y2="3944" class="solid end_marked_circle"></line>
  <line x1="208" y1="3944" x2="236" y2="3944" class="solid end_marked_circle"></line>
  <line x1="232" y1="3944" x2="284" y2="3944" class="solid end_marked_circle"></line>
  <line x1="280" y1="3944" x2="284" y2="3944" class="solid"></line>
  <line x1="52" y1="3960" x2="164" y2="3960" class="solid end_marked_circle"></line>
  <line x1="160" y1="3960" x2="188" y2="3960" class="solid end_marked_circle"></line>
  <line x1="184" y1="3960" x2="188" y2="3960" class="solid"></line>
  <line x1="52" y1="3976" x2="116" y2="3976" class="solid end_marked_circle"></line>
  <line x1="112" y1="3976" x2="140" y2="3976" class="solid end_marked_circle"></line>
  <line x1="136" y1="3976" x2="140" y2="3976" class="solid"></line>
  <line x1="52" y1="3992" x2="68" y2="3992" class="solid end_marked_circle"></line>
  <line x1="64" y1="3992" x2="92" y2="3992" class="solid end_marked_circle"></line>
  <text x="66" y="4012">5</text>
  <text x="82" y="4012">10</text>
  <text x="106" y="4012">15</text>
  <text x="130" y="4012">20</text>
  <text x="154" y="4012">25</text>
  <text x="178" y="4012">30</text>
  <text x="202" y="4012">35</text>
  <text x="226" y="4012">40</text>
  <text x="250" y="4012">45</text>
  <text x="274" y="4012">50</text>
  <text x="330" y="3932">E</text>
  <text x="330" y="3948">D</text>
  <text x="330" y="3964">C</text>
  <text x="330" y="3980">B</text>
  <text x="330" y="3996">A</text>
  <line x1="348" y1="3920" x2="348" y2="3992" class="solid"></line>
  <line x1="556" y1="3932" x2="556" y2="3928" class="solid end_marked_open_circle"></line>
  <line x1="508" y1="3948" x2="508" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="532" y1="3948" x2="532" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="556" y1="3936" x2="556" y2="4000" class="solid"></line>
  <line x1="580" y1="3948" x2="580" y2="3944" class="solid end_marked_open_circle"></line>
  <line x1="460" y1="3964" x2="460" y2="3960" class="solid end_marked_open_circle"></line>
  <line x1="484" y1="3964" x2="484" y2="3960" class="solid end_marked_open_circle"></line>
  <line x1="508" y1="3952" x2="508" y2="4000" class="solid"></line>
  <line x1="532" y1="3952" x2="532" y2="4000" class="solid"></line>
  <line x1="412" y1="3980" x2="412" y2="3976" class="solid end_marked_open_circle"></line>
  <line x1="436" y1="3980" x2="436" y2="3976" class="solid end_marked_open_circle"></line>
  <line x1="460" y1="3968" x2="460" y2="4000" class="solid"></line>
  <line x1="484" y1="3968" x2="484" y2="4000" class="solid"></line>
  <line x1="348" y1="3992" x2="364" y2="3992" class="solid end_marked_open_circle"></line>
  <line x1="368" y1="3992" x2="388" y2="3992" class="solid end_marked_open_circle"></line>
  <line x1="412" y1="3984" x2="412" y2="4000" class="solid"></line>
  <line x1="436" y1="3984" x2="436" y2="4000" class="solid"></line>
  <text x="362" y="4012">5</text>
  <text x="378" y="4012">10</text>
  <text x="402" y="4012">15</text>
  <text x="426" y="4012">20</text>
  <text x="450" y="4012">25</text>
  <text x="474" y="4012">30</text>
  <text x="498" y="4012">35</text>
  <text x="522" y="4012">40</text>
  <text x="546" y="4012">45</text>
  <text x="570" y="4012">50</text>
  <text x="18" y="4076">85.67</text>
  <text x="18" y="4092">78.20</text>
  <text x="18" y="4108">70.73</text>
  <text x="18" y="4124">63.27</text>
  <text x="18" y="4140">55.80</text>
  <text x="18" y="4156">48.33</text>
  <text x="18" y="4172">40.87</text>
  <text x="18" y="4188">33.40</text>
  <text x="18" y="4204">25.93</text>
  <text x="18" y="4220">18.47</text>
  <text x="18" y="4236">11.00</text>
  <text x="50" y="4268">2011</text>
  <text x="146" y="4268">2012</text>
  <text x="242" y="4268">2013</text>
  <text x="338" y="4268">2014</text>
  <text x="434" y="4268">2015</text>
  <text x="530" y="4268">2016</text>
  <line x1="24" y1="4392" x2="12" y2="4392" class="solid end_marked_open_circle"></line>
  <polygon points="24,4388 32,4392 24,4396" class="filled"></polygon>
  <text x="50" y="4396">Flow</text>
  <text x="90" y="4396">charts</text>
  <polygon points="176,4436 184,4436 180,4448" class="filled"></polygon>
  <polygon points="96,4468 104,4472 96,4476" class="filled"></polygon>
  <line x1="120" y1="4480" x2="130" y2="4500" class="solid"></line>
  <line x1="176" y1="4480" x2="166" y2="4500" class="solid"></line>
  <polygon points="127,4500 134,4508 134,4497" class="filled"></polygon>
  <polygon points="169,4500 162,4508 162,4497" class="filled"></polygon>
  <polygon points="168,4564 176,4568 168,4572" class="filled"></polygon>
  <line x1="324" y1="4432" x2="324" y2="4452" class="solid"></line>
  <polygon points="320,4452 328,4452 324,4464" class="filled"></polygon>
  <line x1="380" y1="4432" x2="380" y2="4452" class="solid"></line>
  <polygon points="376,4452 384,4452 380,4464" class="filled"></polygon>
  <polygon points="392,4564 384,4568 392,4572" class="filled"></polygon>
  <line x1="484" y1="4432" x2="484" y2="4452" class="solid"></line>
  <polygon points="480,4452 488,4452 484,4464" class="filled"></polygon>
  <line x1="556" y1="4432" x2="556" y2="4532" class="solid"></line>
  <polygon points="552,4532 560,4532 556,4544" class="filled"></polygon>
  <line x1="364" y1="4512" x2="364" y2="4532" class="solid"></line>
  <polygon points="360,4532 368,4532 364,4544" class="filled"></polygon>
  <line x1="484" y1="4512" x2="484" y2="4612" class="solid"></line>
  <polygon points="480,4612 488,4612 484,4624" class="filled"></polygon>
  <line x1="364" y1="4592" x2="364" y2="4612" class="solid"></line>
  <polygon points="360,4612 368,4612 364,4624" class="filled"></polygon>
  <line x1="564" y1="4592" x2="564" y2="4612" class="solid"></line>
  <polygon points="560,4612 568,4612 564,4624" class="filled"></polygon>
  <line x1="612" y1="4432" x2="612" y2="4452" class="solid"></line>
  <polygon points="608,4452 616,4452 612,4464" class="filled"></polygon>
  <text x="234" y="4428">OS</text>
  <text x="258" y="4428">API</text>
  <line x1="24" y1="4712" x2="12" y2="4712" class="solid end_marked_open_circle"></line>
  <polygon points="24,4708 32,4712 24,4716" class="filled"></polygon>
  <text x="50" y="4716">Block</text>
  <text x="98" y="4716">diagrams</text>
  <text x="50" y="4764">vncviewer</text>
  <line x1="56" y1="4784" x2="72" y2="4784" class="solid"></line>
  <text x="50" y="4796">[</text>
  <line x1="56" y1="4800" x2="72" y2="4800" class="solid"></line>
  <text x="74" y="4796">]</text>
  <line x1="88" y1="4790" x2="96" y2="4790" class="solid"></line>
  <line x1="88" y1="4794" x2="96" y2="4794" class="solid"></line>
  <line x1="48" y1="4800" x2="40" y2="4816" class="solid"></line>
  <text x="210" y="4764">,</text>
  <path d="M 224,4752 A 16,16 0,0,0 224,4768" class="nofill"></path>
  <line x1="120" y1="4792" x2="152" y2="4792" class="solid"></line>
  <polygon points="152,4788 160,4792 152,4796" class="filled"></polygon>
  <path d="M 192,4800 A 16,16 0,0,0 192,4816" class="nofill"></path>
  <path d="M 240,4752 A 16,16 0,0,1 240,4768" class="nofill"></path>
  <text x="250" y="4764">,</text>
  <text x="386" y="4780">gateway</text>
  <text x="530" y="4780">vncserver</text>
  <text x="298" y="4796">)</text>
  <line x1="304" y1="4792" x2="360" y2="4792" class="solid"></line>
  <polygon points="360,4788 368,4792 360,4796" class="filled"></polygon>
  <line x1="376" y1="4800" x2="456" y2="4800" class="solid"></line>
  <line x1="464" y1="4792" x2="512" y2="4792" class="solid"></line>
  <polygon points="512,4788 520,4792 512,4796" class="filled"></polygon>
  <text x="282" y="4812">.</text>
  <line x1="288" y1="4808" x2="296" y2="4808" class="solid"></line>
  <text x="298" y="4812">'</text>
  <text x="370" y="4812">[</text>
  <line x1="376" y1="4816" x2="384" y2="4816" class="solid"></line>
  <text x="386" y="4812">...</text>
  <line x1="408" y1="4816" x2="424" y2="4816" class="solid"></line>
  <path d="M 240,4816 A 16,16 0,0,1 240,4832" class="nofill"></path>
  <text x="250" y="4828">.</text>
  <line x1="568" y1="4832" x2="560" y2="4848" class="solid"></line>
  <text x="202" y="4796">internet</text>
  <text x="202" y="4828">'</text>
  <line x1="208" y1="4824" x2="216" y2="4824" class="solid"></line>
  <text x="218" y="4828">.</text>
  <path d="M 232,4816 A 16,16 0,0,0 232,4832" class="nofill"></path>
  <text x="242" y="4892">Valveless</text>
  <text x="226" y="4908">Pulsejet</text>
  <text x="298" y="4908">engine</text>
  <polygon points="377,4916 370,4924 370,4913" class="filled"></polygon>
  <line x1="328" y1="4984" x2="420" y2="4984" class="solid end_marked_open_circle"></line>
  <line x1="420" y1="4988" x2="420" y2="5192" class="solid end_marked_circle"></line>
  <text x="338" y="5004">'</text>
  <polygon points="264,5020 268,5008 272,5020" class="filled"></polygon>
  <text x="338" y="5020">.</text>
  <text x="426" y="5052">GND</text>
  <line x1="188" y1="5176" x2="268" y2="5176" class="solid end_marked_open_circle"></line>
  <line x1="188" y1="5176" x2="188" y2="5216" class="solid"></line>
  <line x1="204" y1="5176" x2="204" y2="5216" class="solid"></line>
  <line x1="220" y1="5176" x2="220" y2="5216" class="solid"></line>
  <line x1="296" y1="5176" x2="372" y2="5176" class="solid end_marked_circle"></line>
  <line x1="368" y1="5176" x2="540" y2="5176" class="solid end_marked_big_open_circle"></line>
  <line x1="372" y1="5180" x2="372" y2="5220" class="solid"></line>
  <text x="266" y="5196">power</text>
  <line x1="420" y1="5192" x2="540" y2="5192" class="solid end_marked_big_open_circle"></line>
  <line x1="420" y1="5196" x2="420" y2="5220" class="solid"></line>
  <text x="266" y="5212">switch</text>
  <line x1="348" y1="5224" x2="372" y2="5224" class="solid end_marked_open_circle"></line>
  <line x1="376" y1="5224" x2="420" y2="5224" class="solid end_marked_open_circle"></line>
  <text x="186" y="5244">HHO</text>
  <text x="178" y="5260">Generator</text>
  <text x="370" y="5260">+</text>
  <line x1="416" y1="5256" x2="424" y2="5256" class="solid"></line>
  <text x="370" y="5292">Battery</text>
  <line x1="488" y1="4952" x2="552" y2="4952" class="solid"></line>
  <polygon points="552,4948 560,4952 552,4956" class="filled"></polygon>
  <text x="498" y="4972">thrust</text>
  <line x1="544" y1="4968" x2="560" y2="4968" class="solid"></line>
  <polygon points="560,4964 568,4968 560,4972" class="filled"></polygon>
  <line x1="496" y1="4984" x2="560" y2="4984" class="solid"></line>
  <polygon points="560,4980 568,4984 560,4988" class="filled"></polygon>
  <text x="154" y="5052">fuel</text>
  <text x="146" y="5068">intake</text>
  <line x1="200" y1="5056" x2="216" y2="5056" class="solid"></line>
  <text x="218" y="5052">^</text>
  <text x="282" y="5052">^</text>
  <line x1="288" y1="5056" x2="304" y2="5056" class="solid"></line>
  <text x="306" y="5052">spark</text>
  <text x="306" y="5068">plug</text>
  <polygon points="120,5188 128,5192 120,5196" class="filled"></polygon>
  <text x="82" y="5228">Water</text>
  <text x="82" y="5244">intake</text>
  <text x="546" y="5260">Solar</text>
  <text x="594" y="5260">panel</text>
  <line x1="120" y1="5318" x2="176" y2="5318" class="solid"></line>
  <line x1="120" y1="5322" x2="176" y2="5322" class="solid"></line>
  <line x1="128" y1="5334" x2="168" y2="5334" class="solid"></line>
  <line x1="128" y1="5338" x2="168" y2="5338" class="solid"></line>
  <line x1="136" y1="5350" x2="160" y2="5350" class="solid"></line>
  <line x1="136" y1="5354" x2="160" y2="5354" class="solid"></line>
  <line x1="144" y1="5366" x2="152" y2="5366" class="solid"></line>
  <line x1="144" y1="5370" x2="152" y2="5370" class="solid"></line>
  <line x1="148" y1="5376" x2="148" y2="5520" class="solid"></line>
  <text x="234" y="5404">micro</text>
  <text x="282" y="5404">henry</text>
  <text x="234" y="5420">coil</text>
  <text x="274" y="5420">w</text>
  <line x1="288" y1="5408" x2="280" y2="5424" class="solid"></line>
  <text x="290" y="5420">tuning</text>
  <text x="202" y="5452">'</text>
  <text x="282" y="5484">pico</text>
  <text x="322" y="5484">farad</text>
  <text x="370" y="5484">cap</text>
  <path d="M 312,5488 A 16,16 0,0,0 312,5504" class="nofill"></path>
  <text x="314" y="5500">trimmable</text>
  <path d="M 384,5488 A 16,16 0,0,1 384,5504" class="nofill"></path>
  <text x="138" y="5564">ground</text>
  <text x="194" y="5564">plane</text>
  <path d="M 248,5552 A 16,16 0,0,0 248,5568" class="nofill"></path>
  <text x="250" y="5564">foil</text>
  <path d="M 280,5552 A 16,16 0,0,1 280,5568" class="nofill"></path>
  <text x="186" y="5340">symbolic</text>
  <text x="258" y="5340">antenna</text>
  <text x="346" y="5420">lug</text>
  <text x="66" y="5532">PC</text>
  <line x1="104" y1="5528" x2="112" y2="5528" class="solid"></line>
  <polygon points="112,5524 120,5528 112,5532" class="filled"></polygon>
  <text x="66" y="5548">Board</text>
  <line x1="24" y1="5640" x2="12" y2="5640" class="solid end_marked_open_circle"></line>
  <polygon points="24,5636 32,5640 24,5644" class="filled"></polygon>
  <text x="42" y="5644">Mindmaps</text>
  <line x1="354" y1="5676" x2="284" y2="5816" class="solid end_marked_open_circle"></line>
  <polygon points="376,5668 384,5672 376,5676" class="filled"></polygon>
  <polygon points="376,5700 384,5704 376,5708" class="filled"></polygon>
  <line x1="156" y1="5720" x2="156" y2="5720" class="solid end_marked_circle"></line>
  <line x1="222" y1="5724" x2="268" y2="5816" class="solid end_marked_open_circle"></line>
  <line x1="300" y1="5784" x2="376" y2="5784" class="solid"></line>
  <polygon points="376,5780 384,5784 376,5788" class="filled"></polygon>
  <line x1="300" y1="5832" x2="300" y2="5832" class="solid end_marked_circle"></line>
  <line x1="360" y1="5848" x2="412" y2="5848" class="solid end_marked_big_open_circle"></line>
  <line x1="416" y1="5848" x2="424" y2="5848" class="solid"></line>
  <polygon points="424,5844 432,5848 424,5852" class="filled"></polygon>
  <line x1="302" y1="5868" x2="300" y2="5864" class="solid end_marked_open_circle"></line>
  <line x1="250" y1="5884" x2="252" y2="5880" class="solid end_marked_open_circle"></line>
  <line x1="278" y1="5884" x2="276" y2="5880" class="solid end_marked_open_circle"></line>
  <line x1="294" y1="5884" x2="292" y2="5880" class="solid end_marked_open_circle"></line>
  <polygon points="384,5924 392,5928 384,5932" class="filled"></polygon>
  <line x1="192" y1="5952" x2="174" y2="5988" class="solid"></line>
  <polygon points="424,5956 432,5960 424,5964" class="filled"></polygon>
  <polygon points="177,5988 170,5996 170,5985" class="filled"></polygon>
  <polygon points="392,5988 400,5992 392,5996" class="filled"></polygon>
  <polygon points="177,6020 170,6028 170,6017" class="filled"></polygon>
  <text x="106" y="6044">Worklaod</text>
  <polygon points="376,6036 384,6040 376,6044" class="filled"></polygon>
  <polygon points="384,6036 392,6040 384,6044" class="filled"></polygon>
  <polygon points="177,6052 170,6060 170,6049" class="filled"></polygon>
  <polygon points="177,6084 170,6092 170,6081" class="filled"></polygon>
  <text x="402" y="5676">Alpha</text>
  <text x="402" y="5708">Initial</text>
  <polygon points="448,5732 456,5736 448,5740" class="filled"></polygon>
  <polygon points="456,5764 464,5768 456,5772" class="filled"></polygon>
  <text x="466" y="5708">Release</text>
  <text x="82" y="5724">Planning</text>
  <text x="466" y="5740">Patch</text>
  <text x="514" y="5740">1</text>
  <text x="50" y="5756">Initial</text>
  <text x="114" y="5756">research</text>
  <line x1="134" y1="5772" x2="132" y2="5768" class="solid end_marked_circle"></line>
  <polygon points="224,5844 232,5848 224,5852" class="filled"></polygon>
  <text x="482" y="5772">Patch</text>
  <text x="530" y="5772">2</text>
  <text x="394" y="5788">Beta</text>
  <text x="450" y="5852">.</text>
  <text x="466" y="5852">Release</text>
  <text x="530" y="5852">.</text>
  <text x="410" y="5932">Push</text>
  <text x="450" y="5932">backs</text>
  <text x="442" y="5964">Setbacks</text>
  <text x="410" y="5996">Reception</text>
  <text x="130" y="6012">Team</text>
  <text x="402" y="6044">Career</text>
  <text x="458" y="6044">change</text>
  <text x="138" y="6076">PTO</text>
  <text x="138" y="6108">Bug</text>
  <line x1="24" y1="6152" x2="12" y2="6152" class="solid end_marked_open_circle"></line>
  <polygon points="24,6148 32,6152 24,6156" class="filled"></polygon>
  <text x="50" y="6156">It</text>
  <text x="74" y="6156">can</text>
  <text x="106" y="6156">do</text>
  <text x="130" y="6156">complex</text>
  <text x="194" y="6156">stuff</text>
  <text x="242" y="6156">such</text>
  <text x="282" y="6156">as</text>
  <text x="306" y="6156">circuit</text>
  <text x="370" y="6156">diagrams</text>
  <text x="58" y="6204">+10</text>
  <line x1="80" y1="6200" x2="88" y2="6200" class="solid"></line>
  <text x="90" y="6204">15V</text>
  <text x="226" y="6204">0,047R</text>
  <line x1="52" y1="6216" x2="52" y2="6216" class="solid end_marked_circle"></line>
  <line x1="52" y1="6220" x2="52" y2="6240" class="solid"></line>
  <line x1="56" y1="6216" x2="132" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="136" y1="6216" x2="180" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="228" y1="6216" x2="244" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="248" y1="6216" x2="268" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="272" y1="6216" x2="348" y2="6216" class="solid end_marked_open_circle"></line>
  <line x1="352" y1="6216" x2="388" y2="6216" class="solid end_marked_open_circle"></line>
  <text x="34" y="6236">+</text>
  <line x1="32" y1="6248" x2="40" y2="6248" class="solid"></line>
  <line x1="40" y1="6246" x2="64" y2="6246" class="solid"></line>
  <line x1="40" y1="6250" x2="64" y2="6250" class="solid"></line>
  <line x1="64" y1="6248" x2="72" y2="6248" class="solid"></line>
  <line x1="32" y1="6264" x2="40" y2="6264" class="solid"></line>
  <line x1="40" y1="6262" x2="64" y2="6262" class="solid"></line>
  <line x1="40" y1="6266" x2="64" y2="6266" class="solid"></line>
  <line x1="64" y1="6264" x2="72" y2="6264" class="solid"></line>
  <text x="122" y="6268">.</text>
  <line x1="32" y1="6280" x2="40" y2="6280" class="solid"></line>
  <line x1="40" y1="6278" x2="64" y2="6278" class="solid"></line>
  <line x1="40" y1="6282" x2="64" y2="6282" class="solid"></line>
  <line x1="64" y1="6280" x2="72" y2="6280" class="solid"></line>
  <text x="106" y="6284">470</text>
  <line x1="132" y1="6272" x2="132" y2="6308" class="solid"></line>
  <text x="146" y="6284">+</text>
  <line x1="32" y1="6296" x2="40" y2="6296" class="solid"></line>
  <line x1="52" y1="6288" x2="52" y2="6312" class="solid"></line>
  <text x="114" y="6300">uF</text>
  <line x1="52" y1="6312" x2="132" y2="6312" class="solid end_marked_open_circle"></line>
  <text x="210" y="6316">6</text>
  <text x="250" y="6316">7</text>
  <text x="274" y="6316">8</text>
  <line x1="112" y1="6344" x2="152" y2="6344" class="solid"></line>
  <line x1="120" y1="6348" x2="144" y2="6348" class="solid"></line>
  <line x1="128" y1="6360" x2="136" y2="6360" class="solid"></line>
  <text x="298" y="6364">1</text>
  <text x="122" y="6380">GND</text>
  <line x1="292" y1="6376" x2="348" y2="6376" class="solid end_marked_open_circle"></line>
  <text x="378" y="6396">`</text>
  <polygon points="384,6388 392,6392 384,6396" class="filled"></polygon>
  <line x1="388" y1="6400" x2="388" y2="6424" class="solid end_marked_open_circle"></line>
  <text x="306" y="6428">220R</text>
  <polygon points="448,6436 456,6440 448,6444" class="filled"></polygon>
  <line x1="452" y1="6456" x2="452" y2="6488" class="solid end_marked_open_circle"></line>
  <text x="474" y="6476">BYV29</text>
  <line x1="552" y1="6472" x2="560" y2="6472" class="solid"></line>
  <text x="562" y="6476">12V6</text>
  <line x1="452" y1="6492" x2="452" y2="6512" class="solid"></line>
  <polygon points="488,6484 480,6488 488,6492" class="filled"></polygon>
  <line x1="488" y1="6488" x2="500" y2="6488" class="solid end_marked_open_circle"></line>
  <line x1="500" y1="6492" x2="500" y2="6612" class="solid"></line>
  <line x1="504" y1="6488" x2="540" y2="6488" class="solid end_marked_open_circle"></line>
  <line x1="540" y1="6492" x2="540" y2="6528" class="solid"></line>
  <line x1="544" y1="6488" x2="564" y2="6488" class="solid"></line>
  <text x="578" y="6492">OUT</text>
  <line x1="104" y1="6504" x2="112" y2="6504" class="solid"></line>
  <text x="138" y="6508">+</text>
  <text x="298" y="6508">2</text>
  <line x1="292" y1="6520" x2="316" y2="6520" class="solid end_marked_open_circle"></line>
  <text x="450" y="6524">C</text>
  <line x1="460" y1="6512" x2="460" y2="6560" class="solid"></line>
  <line x1="96" y1="6536" x2="104" y2="6536" class="broken"></line>
  <line x1="112" y1="6536" x2="120" y2="6536" class="broken"></line>
  <line x1="128" y1="6536" x2="136" y2="6536" class="broken"></line>
  <line x1="144" y1="6536" x2="152" y2="6536" class="broken"></line>
  <line x1="160" y1="6536" x2="168" y2="6536" class="broken"></line>
  <text x="306" y="6540">GND</text>
  <text x="450" y="6540">C</text>
  <line x1="528" y1="6536" x2="552" y2="6536" class="solid"></line>
  <text x="298" y="6556">3</text>
  <text x="354" y="6556">1nF</text>
  <text x="450" y="6556">C</text>
  <rect x="528" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <rect x="536" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="540" y1="6556" x2="540" y2="6576" class="solid"></line>
  <rect x="544" y="6548" width="8" height="8" class="solid filled" rx="0"></rect>
  <line x1="452" y1="6560" x2="452" y2="6576" class="solid"></line>
  <text x="554" y="6572">+</text>
  <text x="442" y="6588">GND</text>
  <text x="530" y="6588">GND</text>
  <text x="226" y="6604">5</text>
  <text x="266" y="6604">4</text>
  <line x1="280" y1="6616" x2="388" y2="6616" class="solid end_marked_open_circle"></line>
  <line x1="392" y1="6616" x2="500" y2="6616" class="solid end_marked_open_circle"></line>
  <line x1="128" y1="6648" x2="236" y2="6648" class="solid end_marked_circle"></line>
  <line x1="324" y1="6648" x2="428" y2="6648" class="solid end_marked_open_circle"></line>
  <text x="298" y="6668">2k</text>
  <text x="490" y="6668">1k0</text>
  <text x="418" y="6764">GND</text>
  <text x="290" y="6268">2k2</text>
  <text x="474" y="6300">LED</text>
  <text x="314" y="6316">1k</text>
  <text x="402" y="6364">BC</text>
  <text x="402" y="6380">547</text>
  <text x="474" y="6428">IRF9Z34</text>
  <text x="210" y="6460">MC34063</text>
  <text x="10" y="6508">6000</text>
  <text x="50" y="6508">micro</text>
  <text x="10" y="6524">Farad,</text>
  <text x="66" y="6524">40V</text>
  <text x="10" y="6540">Capacitor</text>
  <text x="402" y="6540">30uH</text>
  <text x="562" y="6540">470</text>
  <text x="570" y="6556">uF</text>
  <text x="450" y="6700">5k6</text>
  <text x="482" y="6700">+</text>
  <text x="498" y="6700">3k3</text>
  <text x="450" y="6716">in</text>
  <text x="474" y="6716">Serie</text>
  <line x1="16" y1="6824" x2="4" y2="6824" class="solid end_marked_open_circle"></line>
  <polygon points="16,6820 24,6824 16,6828" class="filled"></polygon>
  <text x="34" y="6828">Latest</text>
  <text x="90" y="6828">addition:</text>
  <text x="170" y="6828">Styling</text>
  <text x="234" y="6828">of</text>
  <text x="258" y="6828">tagged</text>
  <text x="314" y="6828">shapes</text>
  <text x="26" y="7388">Advantages:</text>
  <line x1="8" y1="7416" x2="20" y2="7416" class="solid end_marked_circle"></line>
  <line x1="16" y1="7416" x2="20" y2="7416" class="solid"></line>
  <text x="34" y="7420">Plain</text>
  <text x="82" y="7420">text</text>
  <text x="122" y="7420">format</text>
  <text x="34" y="7436">Ultimately</text>
  <text x="122" y="7436">portable,</text>
  <text x="34" y="7452">Degrades</text>
  <text x="106" y="7452">gracefully</text>
  <text x="34" y="7468">Even</text>
  <text x="74" y="7468">when</text>
  <text x="114" y="7468">not</text>
  <text x="146" y="7468">using</text>
  <text x="194" y="7468">a</text>
  <text x="210" y="7468">graphical</text>
  <text x="290" y="7468">renderer,</text>
  <text x="370" y="7468">it</text>
  <text x="394" y="7468">would</text>
  <text x="442" y="7468">still</text>
  <text x="490" y="7468">looks</text>
  <text x="34" y="7484">as</text>
  <text x="58" y="7484">text</text>
  <text x="98" y="7484">based</text>
  <text x="146" y="7484">diagrams.</text>
  <text x="226" y="7484">Paste</text>
  <text x="274" y="7484">the</text>
  <text x="306" y="7484">text</text>
  <text x="346" y="7484">in</text>
  <text x="370" y="7484">your</text>
  <text x="410" y="7484">source</text>
  <text x="466" y="7484">code.</text>
  <text x="34" y="7500">Easiest</text>
  <text x="98" y="7500">to</text>
  <text x="122" y="7500">use.</text>
  <text x="162" y="7500">Anyone</text>
  <text x="218" y="7500">knows</text>
  <text x="266" y="7500">how</text>
  <text x="298" y="7500">to</text>
  <text x="322" y="7500">edit</text>
  <text x="362" y="7500">text.</text>
  <text x="202" y="7436">backward</text>
  <text x="274" y="7436">compatible</text>
  <text x="362" y="7436">and</text>
  <text x="394" y="7436">future</text>
  <text x="450" y="7436">proof.</text>
  <line x1="8" y1="7448" x2="20" y2="7448" class="solid end_marked_circle"></line>
  <line x1="16" y1="7448" x2="20" y2="7448" class="solid"></line>
  <text x="538" y="7468">good</text>
  <line x1="8" y1="7496" x2="20" y2="7496" class="solid end_marked_circle"></line>
  <line x1="16" y1="7496" x2="20" y2="7496" class="solid"></line>
  <text x="362" y="748">.--------------.</text>
  <text x="362" y="764">| Don't draw me|</text>
  <text x="362" y="780">|              |</text>
  <text x="362" y="796">'--------------'</text>
  <text x="2" y="3276">Udc_OK</text>
  <g>
    <path d="M 64,72 A 8,8 0,0,0 58,76" class="nofill"></path>
    <line x1="64" y1="72" x2="88" y2="72" class="solid"></line>
    <path d="M 88,72 A 3,3 0,0,1 90,76" class="nofill"></path>
    <line x1="90" y1="76" x2="64" y2="128" class="solid"></line>
    <line x1="76" y1="104" x2="88" y2="104" class="solid"></line>
    <line x1="66" y1="92" x2="56" y2="112" class="solid"></line>
    <line x1="56" y1="112" x2="72" y2="144" class="solid"></line>
    <path d="M 32,104 A 8,8 0,0,0 26,108" class="nofill"></path>
    <line x1="26" y1="108" x2="24" y2="112" class="solid"></line>
    <line x1="32" y1="104" x2="44" y2="104" class="solid"></line>
    <path d="M 24,112 A 16,16 0,0,0 24,128" class="nofill"></path>
    <line x1="24" y1="128" x2="26" y2="132" class="solid"></line>
    <path d="M 26,132 A 8,8 0,0,0 32,136" class="nofill"></path>
    <line x1="32" y1="136" x2="40" y2="136" class="solid"></line>
    <path d="M 40,136 A 8,8 0,0,1 46,140" class="nofill"></path>
    <line x1="46" y1="140" x2="60" y2="168" class="solid"></line>
    <line x1="72" y1="144" x2="60" y2="168" class="solid"></line>
  </g>
  <g>
    <path d="M 40,280 A 4,4 0,0,0 36,284" class="nofill"></path>
    <line x1="36" y1="284" x2="36" y2="836" class="broken"></line>
    <line x1="40" y1="280" x2="48" y2="280" class="solid"></line>
    <path d="M 36,836 A 4,4 0,0,0 40,840" class="nofill"></path>
    <line x1="40" y1="840" x2="560" y2="840" class="broken"></line>
    <line x1="552" y1="280" x2="560" y2="280" class="solid"></line>
    <path d="M 560,280 A 4,4 0,0,1 564,284" class="nofill"></path>
    <line x1="564" y1="284" x2="564" y2="836" class="broken"></line>
    <path d="M 564,836 A 4,4 0,0,1 560,840" class="nofill"></path>
  </g>
  <g>
    <line x1="460" y1="296" x2="428" y2="328" class="broken"></line>
    <line x1="460" y1="296" x2="492" y2="328" class="broken"></line>
    <line x1="428" y1="328" x2="460" y2="360" class="broken"></line>
    <line x1="492" y1="328" x2="460" y2="360" class="broken"></line>
  </g>
  <g>
    <line x1="80" y1="368" x2="136" y2="368" class="solid"></line>
    <line x1="80" y1="368" x2="64" y2="400" class="solid"></line>
    <line x1="136" y1="368" x2="152" y2="400" class="solid"></line>
    <line x1="64" y1="400" x2="80" y2="432" class="solid"></line>
    <line x1="152" y1="400" x2="136" y2="432" class="solid"></line>
    <line x1="80" y1="432" x2="136" y2="432" class="solid"></line>
  </g>
  <g>
    <path d="M 256,312 A 8,8 0,0,0 250,316" class="nofill"></path>
    <line x1="250" y1="316" x2="248" y2="320" class="solid"></line>
    <line x1="256" y1="312" x2="304" y2="312" class="solid"></line>
    <path d="M 304,312 A 8,8 0,0,1 310,316" class="nofill"></path>
    <line x1="310" y1="316" x2="312" y2="320" class="solid"></line>
    <path d="M 248,320 A 16,16 0,0,0 248,336" class="nofill"></path>
    <path d="M 312,320 A 16,16 0,0,1 312,336" class="nofill"></path>
    <line x1="248" y1="336" x2="250" y2="340" class="solid"></line>
    <path d="M 250,340 A 8,8 0,0,0 256,344" class="nofill"></path>
    <line x1="256" y1="344" x2="304" y2="344" class="solid"></line>
    <line x1="312" y1="336" x2="310" y2="340" class="solid"></line>
    <path d="M 310,340 A 8,8 0,0,1 304,344" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="368" x2="296" y2="368" class="solid"></line>
    <line x1="232" y1="368" x2="240" y2="384" class="solid"></line>
    <line x1="296" y1="368" x2="304" y2="384" class="solid"></line>
    <path d="M 240,384 A 16,16 0,0,1 240,400" class="nofill"></path>
    <path d="M 304,384 A 16,16 0,0,1 304,400" class="nofill"></path>
    <line x1="240" y1="400" x2="232" y2="416" class="solid"></line>
    <line x1="232" y1="416" x2="296" y2="416" class="solid"></line>
    <line x1="304" y1="400" x2="296" y2="416" class="solid"></line>
  </g>
  <g>
    <line x1="368" y1="304" x2="350" y2="340" class="solid"></line>
    <line x1="368" y1="304" x2="386" y2="340" class="solid"></line>
    <path d="M 350,340 A 3,3 0,0,0 352,344" class="nofill"></path>
    <line x1="352" y1="344" x2="384" y2="344" class="solid"></line>
    <path d="M 386,340 A 3,3 0,0,1 384,344" class="nofill"></path>
  </g>
  <g>
    <line x1="200" y1="368" x2="184" y2="400" class="solid"></line>
    <line x1="200" y1="368" x2="216" y2="400" class="solid"></line>
    <line x1="184" y1="400" x2="200" y2="432" class="solid"></line>
    <line x1="216" y1="400" x2="200" y2="432" class="solid"></line>
  </g>
  <g>
    <line x1="88" y1="472" x2="168" y2="472" class="solid"></line>
    <path d="M 168,472 A 8,8 0,0,1 174,476" class="nofill"></path>
    <line x1="174" y1="476" x2="176" y2="480" class="solid"></line>
    <path d="M 176,480 A 16,16 0,0,1 176,496" class="nofill"></path>
    <line x1="176" y1="496" x2="174" y2="500" class="solid"></line>
    <path d="M 144,504 A 8,8 0,0,0 138,508" class="nofill"></path>
    <line x1="138" y1="508" x2="128" y2="528" class="solid"></line>
    <line x1="144" y1="504" x2="168" y2="504" class="solid"></line>
    <path d="M 174,500 A 8,8 0,0,1 168,504" class="nofill"></path>
  </g>
  <g>
    <line x1="88" y1="504" x2="124" y2="504" class="solid"></line>
    <line x1="124" y1="504" x2="124" y2="532" class="solid"></line>
  </g>
  <g>
    <line x1="104" y1="560" x2="120" y2="560" class="solid"></line>
    <path d="M 104,560 A 16,16 0,0,0 104,576" class="nofill"></path>
    <line x1="104" y1="576" x2="120" y2="576" class="solid"></line>
    <path d="M 120,560 A 16,16 0,0,1 120,576" class="nofill"></path>
  </g>
  <g>
    <path d="M 240,472 A 8,8 0,0,0 234,476" class="nofill"></path>
    <line x1="234" y1="476" x2="232" y2="480" class="solid"></line>
    <path d="M 232,480 A 16,16 0,0,0 232,496" class="nofill"></path>
    <line x1="232" y1="496" x2="234" y2="500" class="solid"></line>
    <path d="M 234,500 A 8,8 0,0,0 240,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,472 A 8,8 0,0,1 278,476" class="nofill"></path>
    <line x1="278" y1="476" x2="280" y2="480" class="solid"></line>
    <path d="M 280,480 A 16,16 0,0,1 280,496" class="nofill"></path>
    <line x1="280" y1="496" x2="278" y2="500" class="solid"></line>
    <path d="M 278,500 A 8,8 0,0,1 272,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 336,472 A 8,8 0,0,0 330,476" class="nofill"></path>
    <line x1="330" y1="476" x2="328" y2="480" class="solid"></line>
    <path d="M 328,480 A 16,16 0,0,0 328,496" class="nofill"></path>
    <line x1="328" y1="496" x2="330" y2="500" class="solid"></line>
    <path d="M 330,500 A 8,8 0,0,0 336,504" class="nofill"></path>
  </g>
  <g>
    <path d="M 360,472 A 8,8 0,0,1 366,476" class="nofill"></path>
    <line x1="366" y1="476" x2="368" y2="480" class="solid"></line>
    <path d="M 368,480 A 16,16 0,0,1 368,496" class="nofill"></path>
    <line x1="368" y1="496" x2="366" y2="500" class="solid"></line>
    <path d="M 366,500 A 8,8 0,0,1 360,504" class="nofill"></path>
  </g>
  <g>
    <line x1="280" y1="552" x2="296" y2="552" class="solid"></line>
    <path d="M 296,552 A 8,8 0,0,1 302,556" class="nofill"></path>
    <line x1="302" y1="556" x2="304" y2="560" class="solid"></line>
    <path d="M 304,560 A 16,16 0,0,1 304,576" class="nofill"></path>
    <line x1="304" y1="576" x2="302" y2="580" class="solid"></line>
    <line x1="280" y1="584" x2="296" y2="584" class="solid"></line>
    <path d="M 302,580 A 8,8 0,0,1 296,584" class="nofill"></path>
  </g>
  <g>
    <path d="M 216,744 A 3,3 0,0,0 214,748" class="nofill"></path>
    <line x1="214" y1="748" x2="236" y2="792" class="solid"></line>
    <line x1="216" y1="744" x2="256" y2="744" class="solid"></line>
    <path d="M 256,744 A 3,3 0,0,1 258,748" class="nofill"></path>
    <line x1="258" y1="748" x2="236" y2="792" class="solid"></line>
  </g>
  <g>
    <path d="M 280,744 A 3,3 0,0,0 278,748" class="nofill"></path>
    <line x1="278" y1="748" x2="298" y2="788" class="solid"></line>
    <line x1="280" y1="744" x2="312" y2="744" class="solid"></line>
    <path d="M 312,744 A 8,8 0,0,1 318,748" class="nofill"></path>
    <line x1="318" y1="748" x2="338" y2="788" class="solid"></line>
    <path d="M 298,788 A 8,8 0,0,0 304,792" class="nofill"></path>
    <line x1="304" y1="792" x2="336" y2="792" class="solid"></line>
    <path d="M 338,788 A 3,3 0,0,1 336,792" class="nofill"></path>
  </g>
  <g>
    <path d="M 72,904 A 8,8 0,0,0 66,908" class="nofill"></path>
    <line x1="72" y1="904" x2="96" y2="904" class="solid"></line>
    <path d="M 96,904 A 3,3 0,0,1 98,908" class="nofill"></path>
    <line x1="98" y1="908" x2="72" y2="960" class="solid"></line>
    <line x1="84" y1="936" x2="96" y2="936" class="solid"></line>
    <line x1="74" y1="924" x2="64" y2="944" class="solid"></line>
    <line x1="64" y1="944" x2="80" y2="976" class="solid"></line>
    <path d="M 40,936 A 8,8 0,0,0 34,940" class="nofill"></path>
    <line x1="34" y1="940" x2="32" y2="944" class="solid"></line>
    <line x1="40" y1="936" x2="52" y2="936" class="solid"></line>
    <path d="M 32,944 A 16,16 0,0,0 32,960" class="nofill"></path>
    <line x1="32" y1="960" x2="34" y2="964" class="solid"></line>
    <path d="M 34,964 A 8,8 0,0,0 40,968" class="nofill"></path>
    <line x1="40" y1="968" x2="48" y2="968" class="solid"></line>
    <path d="M 48,968 A 8,8 0,0,1 54,972" class="nofill"></path>
    <line x1="54" y1="972" x2="68" y2="1000" class="solid"></line>
    <line x1="80" y1="976" x2="68" y2="1000" class="solid"></line>
  </g>
  <g>
    <line x1="276" y1="912" x2="292" y2="912" class="solid"></line>
    <line x1="276" y1="912" x2="276" y2="928" class="solid"></line>
    <line x1="276" y1="920" x2="292" y2="920" class="solid"></line>
    <line x1="292" y1="912" x2="292" y2="968" class="solid"></line>
    <path d="M 276,928 A 12,12 0,0,1 276,944" class="nofill"></path>
    <line x1="276" y1="952" x2="292" y2="952" class="solid"></line>
    <line x1="292" y1="968" x2="280" y2="992" class="solid"></line>
    <path d="M 256,936 A 4,4 0,0,0 252,940" class="nofill"></path>
    <line x1="252" y1="940" x2="252" y2="964" class="solid"></line>
    <line x1="256" y1="936" x2="292" y2="936" class="solid"></line>
    <path d="M 252,964 A 16,16 0,0,0 254,972" class="nofill"></path>
    <line x1="254" y1="972" x2="264" y2="992" class="solid"></line>
    <line x1="264" y1="992" x2="280" y2="992" class="solid"></line>
  </g>
  <g>
    <path d="M 176,920 A 8,8 0,0,0 170,924" class="nofill"></path>
    <line x1="170" y1="924" x2="144" y2="976" class="solid"></line>
    <line x1="176" y1="920" x2="192" y2="920" class="solid"></line>
    <path d="M 192,920 A 8,8 0,0,1 198,924" class="nofill"></path>
    <line x1="198" y1="924" x2="204" y2="936" class="solid"></line>
    <line x1="164" y1="936" x2="184" y2="936" class="solid"></line>
    <path d="M 184,936 A 8,8 0,0,1 190,940" class="nofill"></path>
    <line x1="190" y1="940" x2="192" y2="944" class="solid"></line>
    <line x1="204" y1="936" x2="204" y2="952" class="solid"></line>
    <path d="M 192,944 A 16,16 0,0,1 192,960" class="nofill"></path>
    <line x1="204" y1="952" x2="182" y2="996" class="solid"></line>
    <line x1="152" y1="960" x2="162" y2="980" class="solid"></line>
    <line x1="144" y1="976" x2="154" y2="996" class="solid"></line>
    <path d="M 162,980 A 8,8 0,0,0 168,984" class="nofill"></path>
    <path d="M 154,996 A 8,8 0,0,0 160,1000" class="nofill"></path>
    <line x1="160" y1="1000" x2="176" y2="1000" class="solid"></line>
    <path d="M 182,996 A 8,8 0,0,1 176,1000" class="nofill"></path>
    <line x1="172" y1="960" x2="172" y2="984" class="solid"></line>
    <line x1="172" y1="968" x2="188" y2="968" class="solid"></line>
    <line x1="192" y1="960" x2="182" y2="980" class="solid"></line>
    <line x1="168" y1="984" x2="176" y2="984" class="solid"></line>
    <path d="M 182,980 A 8,8 0,0,1 176,984" class="nofill"></path>
  </g>
  <g>
    <path d="M 424,920 A 8,8 0,0,0 418,924" class="nofill"></path>
    <line x1="418" y1="924" x2="408" y2="944" class="solid"></line>
    <line x1="424" y1="920" x2="440" y2="920" class="solid"></line>
    <path d="M 440,920 A 8,8 0,0,1 446,924" class="nofill"></path>
    <line x1="446" y1="924" x2="456" y2="944" class="solid"></line>
    <path d="M 408,944 A 16,16 0,0,0 408,960" class="nofill"></path>
    <path d="M 456,944 A 16,16 0,0,1 456,960" class="nofill"></path>
    <line x1="408" y1="960" x2="418" y2="980" class="solid"></line>
    <line x1="456" y1="960" x2="446" y2="980" class="solid"></line>
    <path d="M 418,980 A 8,8 0,0,0 424,984" class="nofill"></path>
    <line x1="424" y1="984" x2="440" y2="984" class="solid"></line>
    <path d="M 446,980 A 8,8 0,0,1 440,984" class="nofill"></path>
  </g>
  <g>
    <line x1="424" y1="928" x2="412" y2="952" class="solid"></line>
    <line x1="412" y1="952" x2="424" y2="976" class="solid"></line>
  </g>
  <g>
    <path d="M 432,936 A 8,8 0,0,0 426,940" class="nofill"></path>
    <line x1="426" y1="940" x2="424" y2="944" class="solid"></line>
    <line x1="432" y1="936" x2="440" y2="936" class="solid"></line>
    <path d="M 440,936 A 8,8 0,0,1 446,940" class="nofill"></path>
    <line x1="446" y1="940" x2="448" y2="944" class="solid"></line>
    <path d="M 424,944 A 16,16 0,0,0 424,960" class="nofill"></path>
    <path d="M 448,944 A 16,16 0,0,1 448,960" class="nofill"></path>
    <line x1="424" y1="960" x2="426" y2="964" class="solid"></line>
    <path d="M 426,964 A 8,8 0,0,0 432,968" class="nofill"></path>
    <line x1="432" y1="968" x2="440" y2="968" class="solid"></line>
    <line x1="448" y1="960" x2="446" y2="964" class="solid"></line>
    <path d="M 446,964 A 8,8 0,0,1 440,968" class="nofill"></path>
  </g>
  <g>
    <path d="M 336,936 A 4,4 0,0,0 332,940" class="nofill"></path>
    <line x1="332" y1="940" x2="332" y2="964" class="solid"></line>
    <line x1="336" y1="936" x2="352" y2="936" class="solid"></line>
    <path d="M 352,936 A 4,4 0,0,1 356,940" class="nofill"></path>
    <path d="M 360,936 A 4,4 0,0,0 356,940" class="nofill"></path>
    <line x1="356" y1="940" x2="356" y2="964" class="solid"></line>
    <line x1="360" y1="936" x2="368" y2="936" class="solid"></line>
    <path d="M 368,936 A 4,4 0,0,1 372,940" class="nofill"></path>
    <line x1="372" y1="940" x2="372" y2="964" class="solid"></line>
    <line x1="332" y1="952" x2="344" y2="952" class="solid"></line>
    <path d="M 332,964 A 4,4 0,0,0 336,968" class="nofill"></path>
    <line x1="336" y1="968" x2="352" y2="968" class="solid"></line>
    <path d="M 356,964 A 4,4 0,0,1 352,968" class="nofill"></path>
    <path d="M 356,964 A 4,4 0,0,0 360,968" class="nofill"></path>
    <line x1="360" y1="968" x2="368" y2="968" class="solid"></line>
    <path d="M 372,964 A 4,4 0,0,1 368,968" class="nofill"></path>
  </g>
  <g>
    <line x1="344" y1="1024" x2="384" y2="1024" class="solid"></line>
    <line x1="344" y1="1024" x2="340" y2="1032" class="solid"></line>
    <line x1="340" y1="1032" x2="340" y2="1072" class="solid"></line>
    <line x1="312" y1="1072" x2="340" y2="1072" class="solid"></line>
    <line x1="312" y1="1072" x2="296" y2="1104" class="solid"></line>
    <line x1="296" y1="1104" x2="312" y2="1136" class="solid"></line>
    <line x1="368" y1="1040" x2="384" y2="1040" class="solid"></line>
    <path d="M 384,1024 A 16,16 0,0,1 384,1040" class="nofill"></path>
    <line x1="368" y1="1040" x2="364" y2="1048" class="solid"></line>
    <line x1="364" y1="1048" x2="364" y2="1072" class="solid"></line>
    <line x1="384" y1="1040" x2="392" y2="1056" class="solid"></line>
    <line x1="364" y1="1072" x2="384" y2="1072" class="solid"></line>
    <line x1="392" y1="1056" x2="384" y2="1072" class="solid"></line>
  </g>
  <g>
    <line x1="392" y1="1024" x2="408" y2="1056" class="solid"></line>
    <line x1="408" y1="1056" x2="392" y2="1088" class="solid"></line>
    <line x1="384" y1="1088" x2="392" y2="1088" class="solid"></line>
  </g>
  <g>
    <path d="M 328,1072 A 16,16 0,0,0 328,1088" class="nofill"></path>
    <line x1="328" y1="1088" x2="340" y2="1088" class="solid"></line>
    <line x1="340" y1="1088" x2="340" y2="1104" class="solid"></line>
  </g>
  <g>
    <line x1="364" y1="1088" x2="376" y2="1088" class="solid"></line>
    <path d="M 376,1072 A 16,16 0,0,1 376,1088" class="nofill"></path>
    <line x1="364" y1="1088" x2="364" y2="1120" class="solid"></line>
  </g>
  <g>
    <line x1="320" y1="1088" x2="312" y2="1104" class="solid"></line>
    <line x1="312" y1="1104" x2="320" y2="1120" class="solid"></line>
    <line x1="320" y1="1120" x2="336" y2="1120" class="solid"></line>
    <line x1="344" y1="1104" x2="336" y2="1120" class="solid"></line>
    <path d="M 320,1120 A 16,16 0,0,0 320,1136" class="nofill"></path>
    <line x1="320" y1="1136" x2="360" y2="1136" class="solid"></line>
    <line x1="368" y1="1120" x2="360" y2="1136" class="solid"></line>
  </g>
  <g>
    <path d="M 64,1032 A 4,4 0,0,0 60,1036" class="nofill"></path>
    <line x1="60" y1="1036" x2="60" y2="1072" class="solid"></line>
    <line x1="64" y1="1032" x2="96" y2="1032" class="solid"></line>
    <path d="M 96,1032 A 4,4 0,0,1 100,1036" class="nofill"></path>
    <line x1="100" y1="1036" x2="100" y2="1072" class="solid"></line>
    <line x1="36" y1="1072" x2="124" y2="1072" class="solid"></line>
    <line x1="36" y1="1072" x2="36" y2="1092" class="solid"></line>
    <path d="M 36,1092 A 4,4 0,0,0 40,1096" class="nofill"></path>
    <line x1="40" y1="1096" x2="52" y2="1096" class="solid"></line>
    <line x1="56" y1="1088" x2="104" y2="1088" class="solid"></line>
    <line x1="56" y1="1088" x2="46" y2="1108" class="solid"></line>
    <line x1="104" y1="1088" x2="114" y2="1108" class="solid"></line>
    <line x1="108" y1="1096" x2="120" y2="1096" class="solid"></line>
    <path d="M 46,1108 A 3,3 0,0,0 48,1112" class="nofill"></path>
    <line x1="48" y1="1112" x2="112" y2="1112" class="solid"></line>
    <path d="M 114,1108 A 3,3 0,0,1 112,1112" class="nofill"></path>
    <line x1="104" y1="1080" x2="124" y2="1080" class="solid"></line>
    <line x1="124" y1="1072" x2="124" y2="1092" class="solid"></line>
    <path d="M 124,1092 A 4,4 0,0,1 120,1096" class="nofill"></path>
  </g>
  <g>
    <line x1="224" y1="1040" x2="232" y2="1040" class="solid"></line>
    <path d="M 224,1040 A 16,16 0,0,0 224,1056" class="nofill"></path>
    <line x1="224" y1="1056" x2="232" y2="1056" class="solid"></line>
    <path d="M 232,1040 A 16,16 0,0,1 232,1056" class="nofill"></path>
    <line x1="232" y1="1056" x2="240" y2="1072" class="solid"></line>
    <path d="M 240,1072 A 16,16 0,0,1 240,1088" class="nofill"></path>
    <line x1="224" y1="1104" x2="232" y2="1104" class="solid"></line>
    <line x1="240" y1="1088" x2="232" y2="1104" class="solid"></line>
    <path d="M 224,1104 A 16,16 0,0,0 224,1120" class="nofill"></path>
    <line x1="224" y1="1120" x2="232" y2="1120" class="solid"></line>
    <path d="M 232,1104 A 16,16 0,0,1 232,1120" class="nofill"></path>
  </g>
  <g>
    <path d="M 200,1048 A 8,8 0,0,0 194,1052" class="nofill"></path>
    <line x1="194" y1="1052" x2="184" y2="1072" class="solid"></line>
    <line x1="200" y1="1048" x2="216" y2="1048" class="solid"></line>
    <line x1="176" y1="1072" x2="184" y2="1072" class="solid"></line>
    <path d="M 176,1072 A 16,16 0,0,0 176,1088" class="nofill"></path>
    <line x1="176" y1="1088" x2="184" y2="1088" class="solid"></line>
    <path d="M 184,1072 A 16,16 0,0,1 184,1088" class="nofill"></path>
    <line x1="184" y1="1088" x2="194" y2="1108" class="solid"></line>
    <path d="M 194,1108 A 8,8 0,0,0 200,1112" class="nofill"></path>
    <line x1="200" y1="1112" x2="216" y2="1112" class="solid"></line>
  </g>
  <g>
    <path d="M 208,1064 A 8,8 0,0,0 202,1068" class="nofill"></path>
    <line x1="202" y1="1068" x2="200" y2="1072" class="solid"></line>
    <line x1="208" y1="1064" x2="216" y2="1064" class="solid"></line>
    <path d="M 216,1064 A 8,8 0,0,1 222,1068" class="nofill"></path>
    <line x1="222" y1="1068" x2="224" y2="1072" class="solid"></line>
    <path d="M 200,1072 A 16,16 0,0,0 200,1088" class="nofill"></path>
    <path d="M 224,1072 A 16,16 0,0,1 224,1088" class="nofill"></path>
    <line x1="200" y1="1088" x2="202" y2="1092" class="solid"></line>
    <path d="M 202,1092 A 8,8 0,0,0 208,1096" class="nofill"></path>
    <line x1="208" y1="1096" x2="216" y2="1096" class="solid"></line>
    <line x1="224" y1="1088" x2="222" y2="1092" class="solid"></line>
    <path d="M 222,1092 A 8,8 0,0,1 216,1096" class="nofill"></path>
  </g>
  <g>
    <line x1="100" y1="1176" x2="124" y2="1176" class="solid"></line>
    <line x1="100" y1="1176" x2="100" y2="1208" class="solid"></line>
    <line x1="116" y1="1176" x2="116" y2="1208" class="solid"></line>
    <line x1="124" y1="1176" x2="124" y2="1208" class="solid"></line>
    <line x1="100" y1="1192" x2="124" y2="1192" class="solid"></line>
    <line x1="100" y1="1208" x2="124" y2="1208" class="solid"></line>
  </g>
  <g>
    <path d="M 104,1224 A 4,4 0,0,0 100,1228" class="nofill"></path>
    <line x1="100" y1="1228" x2="100" y2="1252" class="solid"></line>
    <line x1="104" y1="1224" x2="120" y2="1224" class="solid"></line>
    <line x1="116" y1="1224" x2="116" y2="1256" class="solid"></line>
    <path d="M 120,1224 A 4,4 0,0,1 124,1228" class="nofill"></path>
    <line x1="124" y1="1228" x2="124" y2="1252" class="solid"></line>
    <line x1="100" y1="1240" x2="124" y2="1240" class="solid"></line>
    <path d="M 100,1252 A 4,4 0,0,0 104,1256" class="nofill"></path>
    <line x1="104" y1="1256" x2="120" y2="1256" class="solid"></line>
    <path d="M 124,1252 A 4,4 0,0,1 120,1256" class="nofill"></path>
  </g>
  <g>
    <line x1="194" y1="1176" x2="222" y2="1176" class="solid"></line>
    <line x1="194" y1="1176" x2="194" y2="1208" class="solid"></line>
    <line x1="198" y1="1176" x2="198" y2="1208" class="solid"></line>
    <line x1="210" y1="1176" x2="210" y2="1208" class="solid"></line>
    <line x1="214" y1="1176" x2="214" y2="1208" class="solid"></line>
    <line x1="218" y1="1176" x2="218" y2="1208" class="solid"></line>
    <line x1="222" y1="1176" x2="222" y2="1208" class="solid"></line>
    <line x1="198" y1="1192" x2="218" y2="1192" class="solid"></line>
    <line x1="194" y1="1208" x2="222" y2="1208" class="solid"></line>
  </g>
  <g>
    <line x1="244" y1="1176" x2="268" y2="1176" class="solid"></line>
    <line x1="244" y1="1176" x2="244" y2="1212" class="solid"></line>
    <line x1="244" y1="1180" x2="268" y2="1180" class="solid"></line>
    <line x1="260" y1="1180" x2="260" y2="1208" class="solid"></line>
    <line x1="268" y1="1176" x2="268" y2="1212" class="solid"></line>
    <line x1="244" y1="1192" x2="268" y2="1192" class="solid"></line>
    <line x1="244" y1="1196" x2="268" y2="1196" class="solid"></line>
    <line x1="244" y1="1208" x2="268" y2="1208" class="solid"></line>
    <line x1="244" y1="1212" x2="268" y2="1212" class="solid"></line>
  </g>
  <g>
    <path d="M 40,1624 A 8,8 0,0,0 34,1628" class="nofill"></path>
    <line x1="34" y1="1628" x2="20" y2="1656" class="solid"></line>
    <line x1="40" y1="1624" x2="72" y2="1624" class="solid"></line>
    <path d="M 72,1624 A 8,8 0,0,1 78,1628" class="nofill"></path>
    <line x1="78" y1="1628" x2="92" y2="1656" class="solid"></line>
    <line x1="20" y1="1656" x2="36" y2="1688" class="solid"></line>
    <path d="M 152,1624 A 8,8 0,0,0 146,1628" class="nofill"></path>
    <line x1="146" y1="1628" x2="132" y2="1656" class="solid"></line>
    <line x1="152" y1="1624" x2="184" y2="1624" class="solid"></line>
    <path d="M 184,1624 A 8,8 0,0,1 190,1628" class="nofill"></path>
    <line x1="190" y1="1628" x2="204" y2="1656" class="solid"></line>
    <line x1="92" y1="1656" x2="132" y2="1656" class="solid"></line>
    <line x1="92" y1="1656" x2="76" y2="1688" class="solid"></line>
    <line x1="132" y1="1656" x2="148" y2="1688" class="solid"></line>
    <line x1="204" y1="1656" x2="240" y2="1656" class="solid"></line>
    <line x1="204" y1="1656" x2="188" y2="1688" class="solid"></line>
    <path d="M 240,1656 A 8,8 0,0,1 246,1660" class="nofill"></path>
    <line x1="246" y1="1660" x2="260" y2="1688" class="solid"></line>
    <line x1="36" y1="1688" x2="76" y2="1688" class="solid"></line>
    <line x1="36" y1="1688" x2="20" y2="1720" class="solid"></line>
    <line x1="76" y1="1688" x2="92" y2="1720" class="solid"></line>
    <line x1="148" y1="1688" x2="188" y2="1688" class="solid"></line>
    <line x1="148" y1="1688" x2="132" y2="1720" class="solid"></line>
    <line x1="188" y1="1688" x2="204" y2="1720" class="solid"></line>
    <line x1="260" y1="1688" x2="244" y2="1720" class="solid"></line>
    <line x1="20" y1="1720" x2="34" y2="1748" class="solid"></line>
    <line x1="92" y1="1720" x2="132" y2="1720" class="solid"></line>
    <line x1="92" y1="1720" x2="76" y2="1752" class="solid"></line>
    <line x1="132" y1="1720" x2="148" y2="1752" class="solid"></line>
    <line x1="204" y1="1720" x2="244" y2="1720" class="solid"></line>
    <line x1="204" y1="1720" x2="188" y2="1752" class="solid"></line>
    <line x1="244" y1="1720" x2="260" y2="1752" class="solid"></line>
    <path d="M 34,1748 A 8,8 0,0,0 40,1752" class="nofill"></path>
    <line x1="40" y1="1752" x2="76" y2="1752" class="solid"></line>
    <line x1="76" y1="1752" x2="90" y2="1780" class="solid"></line>
    <line x1="148" y1="1752" x2="188" y2="1752" class="solid"></line>
    <line x1="148" y1="1752" x2="134" y2="1780" class="solid"></line>
    <line x1="188" y1="1752" x2="202" y2="1780" class="solid"></line>
    <line x1="260" y1="1752" x2="246" y2="1780" class="solid"></line>
    <path d="M 90,1780 A 8,8 0,0,0 96,1784" class="nofill"></path>
    <line x1="96" y1="1784" x2="128" y2="1784" class="solid"></line>
    <path d="M 134,1780 A 8,8 0,0,1 128,1784" class="nofill"></path>
    <path d="M 202,1780 A 8,8 0,0,0 208,1784" class="nofill"></path>
    <line x1="208" y1="1784" x2="240" y2="1784" class="solid"></line>
    <path d="M 246,1780 A 8,8 0,0,1 240,1784" class="nofill"></path>
  </g>
  <g>
    <path d="M 304,1640 A 4,4 0,0,0 300,1644" class="nofill"></path>
    <line x1="300" y1="1644" x2="300" y2="1780" class="solid"></line>
    <line x1="304" y1="1640" x2="440" y2="1640" class="solid"></line>
    <line x1="348" y1="1640" x2="348" y2="1784" class="solid"></line>
    <line x1="396" y1="1640" x2="396" y2="1784" class="solid"></line>
    <path d="M 440,1640 A 4,4 0,0,1 444,1644" class="nofill"></path>
    <line x1="444" y1="1644" x2="444" y2="1780" class="solid"></line>
    <line x1="300" y1="1688" x2="444" y2="1688" class="solid"></line>
    <line x1="300" y1="1736" x2="444" y2="1736" class="solid"></line>
    <path d="M 300,1780 A 4,4 0,0,0 304,1784" class="nofill"></path>
    <line x1="304" y1="1784" x2="440" y2="1784" class="solid"></line>
    <path d="M 444,1780 A 4,4 0,0,1 440,1784" class="nofill"></path>
  </g>
  <g>
    <path d="M 536,1656 A 8,8 0,0,0 530,1660" class="nofill"></path>
    <line x1="530" y1="1660" x2="470" y2="1780" class="solid"></line>
    <line x1="536" y1="1656" x2="724" y2="1656" class="solid"></line>
    <line x1="580" y1="1656" x2="516" y2="1784" class="solid"></line>
    <line x1="628" y1="1656" x2="564" y2="1784" class="solid"></line>
    <line x1="676" y1="1656" x2="612" y2="1784" class="solid"></line>
    <line x1="724" y1="1656" x2="660" y2="1784" class="solid"></line>
    <line x1="516" y1="1688" x2="708" y2="1688" class="solid"></line>
    <line x1="500" y1="1720" x2="692" y2="1720" class="solid"></line>
    <line x1="484" y1="1752" x2="676" y2="1752" class="solid"></line>
    <path d="M 470,1780 A 3,3 0,0,0 472,1784" class="nofill"></path>
    <line x1="472" y1="1784" x2="660" y2="1784" class="solid"></line>
  </g>
  <g>
    <line x1="56" y1="1888" x2="80" y2="1888" class="solid"></line>
    <line x1="80" y1="1888" x2="88" y2="1904" class="solid"></line>
    <line x1="88" y1="1904" x2="112" y2="1904" class="solid"></line>
    <line x1="120" y1="1888" x2="144" y2="1888" class="solid"></line>
    <line x1="120" y1="1888" x2="112" y2="1904" class="solid"></line>
    <line x1="144" y1="1888" x2="152" y2="1904" class="solid"></line>
    <line x1="112" y1="1904" x2="120" y2="1920" class="solid"></line>
    <line x1="120" y1="1920" x2="144" y2="1920" class="solid"></line>
    <line x1="152" y1="1904" x2="144" y2="1920" class="solid"></line>
    <line x1="144" y1="1920" x2="152" y2="1936" class="solid"></line>
    <line x1="24" y1="1904" x2="48" y2="1904" class="solid"></line>
    <line x1="56" y1="1888" x2="48" y2="1904" class="solid"></line>
    <line x1="24" y1="1904" x2="16" y2="1920" class="solid"></line>
    <line x1="48" y1="1904" x2="56" y2="1920" class="solid"></line>
    <line x1="56" y1="1920" x2="80" y2="1920" class="solid"></line>
    <line x1="88" y1="1904" x2="80" y2="1920" class="solid"></line>
    <line x1="16" y1="1920" x2="24" y2="1936" class="solid"></line>
    <line x1="24" y1="1936" x2="48" y2="1936" class="solid"></line>
    <line x1="56" y1="1920" x2="48" y2="1936" class="solid"></line>
    <line x1="80" y1="1920" x2="88" y2="1936" class="solid"></line>
    <line x1="88" y1="1936" x2="112" y2="1936" class="solid"></line>
    <line x1="120" y1="1920" x2="112" y2="1936" class="solid"></line>
    <line x1="24" y1="1936" x2="16" y2="1952" class="solid"></line>
    <line x1="48" y1="1936" x2="56" y2="1952" class="solid"></line>
    <line x1="56" y1="1952" x2="80" y2="1952" class="solid"></line>
    <line x1="88" y1="1936" x2="80" y2="1952" class="solid"></line>
    <line x1="112" y1="1936" x2="120" y2="1952" class="solid"></line>
    <line x1="120" y1="1952" x2="144" y2="1952" class="solid"></line>
    <line x1="152" y1="1936" x2="144" y2="1952" class="solid"></line>
    <line x1="16" y1="1952" x2="24" y2="1968" class="solid"></line>
    <line x1="24" y1="1968" x2="48" y2="1968" class="solid"></line>
    <line x1="56" y1="1952" x2="48" y2="1968" class="solid"></line>
    <line x1="80" y1="1952" x2="88" y2="1968" class="solid"></line>
    <line x1="88" y1="1968" x2="112" y2="1968" class="solid"></line>
    <line x1="120" y1="1952" x2="112" y2="1968" class="solid"></line>
    <line x1="144" y1="1952" x2="152" y2="1968" class="solid"></line>
    <line x1="48" y1="1968" x2="56" y2="1984" class="solid"></line>
    <line x1="56" y1="1984" x2="80" y2="1984" class="solid"></line>
    <line x1="88" y1="1968" x2="80" y2="1984" class="solid"></line>
    <line x1="112" y1="1968" x2="120" y2="1984" class="solid"></line>
    <line x1="120" y1="1984" x2="144" y2="1984" class="solid"></line>
    <line x1="152" y1="1968" x2="144" y2="1984" class="solid"></line>
  </g>
  <g>
    <path d="M 200,1880 A 4,4 0,0,0 196,1884" class="nofill"></path>
    <line x1="196" y1="1884" x2="196" y2="1972" class="solid"></line>
    <line x1="200" y1="1880" x2="352" y2="1880" class="solid"></line>
    <line x1="228" y1="1880" x2="228" y2="1976" class="solid"></line>
    <line x1="260" y1="1880" x2="260" y2="1976" class="solid"></line>
    <line x1="292" y1="1880" x2="292" y2="1976" class="solid"></line>
    <line x1="324" y1="1880" x2="324" y2="1976" class="solid"></line>
    <path d="M 352,1880 A 4,4 0,0,1 356,1884" class="nofill"></path>
    <line x1="356" y1="1884" x2="356" y2="1972" class="solid"></line>
    <line x1="196" y1="1912" x2="356" y2="1912" class="solid"></line>
    <line x1="196" y1="1944" x2="356" y2="1944" class="solid"></line>
    <path d="M 196,1972 A 4,4 0,0,0 200,1976" class="nofill"></path>
    <line x1="200" y1="1976" x2="352" y2="1976" class="solid"></line>
    <path d="M 356,1972 A 4,4 0,0,1 352,1976" class="nofill"></path>
  </g>
  <g>
    <line x1="404" y1="1880" x2="388" y2="1912" class="solid"></line>
    <line x1="404" y1="1880" x2="452" y2="1976" class="solid"></line>
    <path d="M 408,1880 A 8,8 0,0,0 402,1884" class="nofill"></path>
    <path d="M 408,1880 A 3,3 0,0,0 406,1884" class="nofill"></path>
    <line x1="408" y1="1880" x2="528" y2="1880" class="solid"></line>
    <line x1="436" y1="1880" x2="390" y2="1972" class="solid"></line>
    <line x1="436" y1="1880" x2="484" y2="1976" class="solid"></line>
    <line x1="468" y1="1880" x2="420" y2="1976" class="solid"></line>
    <line x1="468" y1="1880" x2="516" y2="1976" class="solid"></line>
    <line x1="500" y1="1880" x2="452" y2="1976" class="solid"></line>
    <line x1="500" y1="1880" x2="532" y2="1944" class="solid"></line>
    <path d="M 528,1880 A 3,3 0,0,1 530,1884" class="nofill"></path>
    <line x1="530" y1="1884" x2="484" y2="1976" class="solid"></line>
    <line x1="388" y1="1912" x2="516" y2="1912" class="solid"></line>
    <line x1="388" y1="1912" x2="420" y2="1976" class="solid"></line>
    <line x1="404" y1="1944" x2="532" y2="1944" class="solid"></line>
    <line x1="532" y1="1944" x2="516" y2="1976" class="solid"></line>
    <path d="M 390,1972 A 3,3 0,0,0 392,1976" class="nofill"></path>
    <line x1="392" y1="1976" x2="512" y2="1976" class="solid"></line>
    <path d="M 514,1972 A 3,3 0,0,1 512,1976" class="nofill"></path>
    <path d="M 518,1972 A 8,8 0,0,1 512,1976" class="nofill"></path>
  </g>
  <g>
    <path d="M 560,1880 A 4,4 0,0,0 556,1884" class="nofill"></path>
    <line x1="556" y1="1884" x2="556" y2="1972" class="solid"></line>
    <line x1="560" y1="1880" x2="584" y2="1880" class="solid"></line>
    <path d="M 584,1880 A 4,4 0,0,1 588,1884" class="nofill"></path>
    <line x1="588" y1="1884" x2="588" y2="1972" class="solid"></line>
    <line x1="556" y1="1912" x2="588" y2="1912" class="solid"></line>
    <line x1="556" y1="1944" x2="588" y2="1944" class="solid"></line>
    <path d="M 556,1972 A 4,4 0,0,0 560,1976" class="nofill"></path>
    <line x1="560" y1="1976" x2="584" y2="1976" class="solid"></line>
    <path d="M 588,1972 A 4,4 0,0,1 584,1976" class="nofill"></path>
    <path d="M 624,1880 A 4,4 0,0,0 620,1884" class="nofill"></path>
    <line x1="620" y1="1884" x2="620" y2="1972" class="solid"></line>
    <line x1="624" y1="1880" x2="648" y2="1880" class="solid"></line>
    <path d="M 648,1880 A 4,4 0,0,1 652,1884" class="nofill"></path>
    <line x1="652" y1="1884" x2="652" y2="1972" class="solid"></line>
    <line x1="588" y1="1896" x2="620" y2="1896" class="solid"></line>
    <line x1="620" y1="1912" x2="652" y2="1912" class="solid"></line>
    <line x1="588" y1="1928" x2="620" y2="1928" class="solid"></line>
    <line x1="620" y1="1944" x2="652" y2="1944" class="solid"></line>
    <line x1="588" y1="1960" x2="620" y2="1960" class="solid"></line>
    <path d="M 620,1972 A 4,4 0,0,0 624,1976" class="nofill"></path>
    <line x1="624" y1="1976" x2="648" y2="1976" class="solid"></line>
    <path d="M 652,1972 A 4,4 0,0,1 648,1976" class="nofill"></path>
  </g>
  <g>
    <line x1="488" y1="2064" x2="476" y2="2088" class="solid"></line>
    <line x1="476" y1="2088" x2="488" y2="2112" class="solid"></line>
  </g>
  <g>
    <line x1="172" y1="2108" x2="172" y2="2152" class="solid"></line>
    <line x1="172" y1="2152" x2="216" y2="2152" class="solid"></line>
    <line x1="172" y1="2152" x2="158" y2="2180" class="solid"></line>
  </g>
  <g>
    <path d="M 192,2136 A 4,4 0,0,1 196,2140" class="nofill"></path>
    <line x1="196" y1="2140" x2="196" y2="2144" class="solid"></line>
  </g>
  <g>
    <text x="114" y="2316">Êñá</text>
    <text x="130" y="2316">‰ª∂</text>
    <text x="146" y="2316">Á≥ª</text>
    <text x="162" y="2316">Áªü</text>
  </g>
  <g>
    <text x="258" y="2316">Ë∞É</text>
    <text x="274" y="2316">Â∫¶</text>
    <text x="290" y="2316">Âô®</text>
  </g>
  <g>
    <path d="M 288,2392 A 8,8 0,0,0 282,2396" class="nofill"></path>
    <line x1="282" y1="2396" x2="270" y2="2420" class="solid"></line>
    <line x1="288" y1="2392" x2="312" y2="2392" class="solid"></line>
  </g>
  <g>
    <line x1="270" y1="2428" x2="282" y2="2452" class="solid"></line>
    <path d="M 282,2452 A 8,8 0,0,0 288,2456" class="nofill"></path>
    <line x1="288" y1="2456" x2="312" y2="2456" class="solid"></line>
  </g>
  <g>
    <line x1="258" y1="2444" x2="246" y2="2468" class="solid"></line>
    <line x1="232" y1="2472" x2="240" y2="2472" class="solid"></line>
    <path d="M 246,2468 A 8,8 0,0,1 240,2472" class="nofill"></path>
  </g>
  <g>
    <line x1="220" y1="2544" x2="220" y2="2568" class="solid"></line>
    <line x1="220" y1="2568" x2="208" y2="2592" class="solid"></line>
    <line x1="220" y1="2568" x2="232" y2="2592" class="solid"></line>
  </g>
  <g>
    <path d="M 80,2568 A 4,4 0,0,0 76,2572" class="nofill"></path>
    <line x1="76" y1="2572" x2="76" y2="2596" class="solid"></line>
    <line x1="80" y1="2568" x2="104" y2="2568" class="solid"></line>
    <path d="M 104,2568 A 4,4 0,0,1 108,2572" class="nofill"></path>
    <line x1="108" y1="2572" x2="108" y2="2596" class="solid"></line>
    <path d="M 76,2596 A 4,4 0,0,0 80,2600" class="nofill"></path>
    <line x1="80" y1="2600" x2="104" y2="2600" class="solid"></line>
    <line x1="92" y1="2600" x2="92" y2="2696" class="solid"></line>
    <path d="M 108,2596 A 4,4 0,0,1 104,2600" class="nofill"></path>
    <line x1="92" y1="2632" x2="208" y2="2632" class="solid"></line>
    <path d="M 80,2696 A 4,4 0,0,0 76,2700" class="nofill"></path>
    <line x1="76" y1="2700" x2="76" y2="2724" class="solid"></line>
    <line x1="80" y1="2696" x2="104" y2="2696" class="solid"></line>
    <path d="M 104,2696 A 4,4 0,0,1 108,2700" class="nofill"></path>
    <line x1="108" y1="2700" x2="108" y2="2724" class="solid"></line>
    <path d="M 76,2724 A 4,4 0,0,0 80,2728" class="nofill"></path>
    <line x1="80" y1="2728" x2="104" y2="2728" class="solid"></line>
    <path d="M 108,2724 A 4,4 0,0,1 104,2728" class="nofill"></path>
  </g>
  <g>
    <line x1="220" y1="2736" x2="220" y2="2760" class="solid"></line>
    <line x1="220" y1="2760" x2="208" y2="2784" class="solid"></line>
    <line x1="220" y1="2760" x2="232" y2="2784" class="solid"></line>
  </g>
  <g>
    <path d="M 120,2824 A 8,8 0,0,0 114,2828" class="nofill"></path>
    <line x1="114" y1="2828" x2="112" y2="2832" class="solid"></line>
    <line x1="120" y1="2824" x2="128" y2="2824" class="solid"></line>
    <path d="M 128,2824 A 8,8 0,0,1 134,2828" class="nofill"></path>
    <line x1="134" y1="2828" x2="136" y2="2832" class="solid"></line>
    <path d="M 112,2832 A 16,16 0,0,0 112,2848" class="nofill"></path>
    <path d="M 136,2832 A 16,16 0,0,1 136,2848" class="nofill"></path>
    <line x1="112" y1="2848" x2="114" y2="2852" class="solid"></line>
    <path d="M 114,2852 A 8,8 0,0,0 120,2856" class="nofill"></path>
    <line x1="120" y1="2856" x2="128" y2="2856" class="solid"></line>
    <line x1="136" y1="2848" x2="134" y2="2852" class="solid"></line>
    <path d="M 134,2852 A 8,8 0,0,1 128,2856" class="nofill"></path>
  </g>
  <g>
    <path d="M 80,2920 A 8,8 0,0,0 74,2924" class="nofill"></path>
    <line x1="74" y1="2924" x2="72" y2="2928" class="solid"></line>
    <line x1="80" y1="2920" x2="88" y2="2920" class="solid"></line>
    <path d="M 88,2920 A 8,8 0,0,1 94,2924" class="nofill"></path>
    <line x1="94" y1="2924" x2="96" y2="2928" class="solid"></line>
    <path d="M 72,2928 A 16,16 0,0,0 72,2944" class="nofill"></path>
    <path d="M 96,2928 A 16,16 0,0,1 96,2944" class="nofill"></path>
    <line x1="72" y1="2944" x2="74" y2="2948" class="solid"></line>
    <path d="M 74,2948 A 8,8 0,0,0 80,2952" class="nofill"></path>
    <line x1="80" y1="2952" x2="88" y2="2952" class="solid"></line>
    <line x1="96" y1="2944" x2="94" y2="2948" class="solid"></line>
    <path d="M 94,2948 A 8,8 0,0,1 88,2952" class="nofill"></path>
  </g>
  <g>
    <path d="M 112,3016 A 8,8 0,0,0 106,3020" class="nofill"></path>
    <line x1="106" y1="3020" x2="104" y2="3024" class="solid"></line>
    <line x1="112" y1="3016" x2="120" y2="3016" class="solid"></line>
    <path d="M 120,3016 A 8,8 0,0,1 126,3020" class="nofill"></path>
    <line x1="126" y1="3020" x2="128" y2="3024" class="solid"></line>
    <path d="M 104,3024 A 16,16 0,0,0 104,3040" class="nofill"></path>
    <path d="M 128,3024 A 16,16 0,0,1 128,3040" class="nofill"></path>
    <line x1="104" y1="3040" x2="106" y2="3044" class="solid"></line>
    <path d="M 106,3044 A 8,8 0,0,0 112,3048" class="nofill"></path>
    <line x1="112" y1="3048" x2="120" y2="3048" class="solid"></line>
    <line x1="128" y1="3040" x2="126" y2="3044" class="solid"></line>
    <path d="M 126,3044 A 8,8 0,0,1 120,3048" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,2920 A 8,8 0,0,0 170,2924" class="nofill"></path>
    <line x1="170" y1="2924" x2="168" y2="2928" class="solid"></line>
    <line x1="176" y1="2920" x2="184" y2="2920" class="solid"></line>
    <path d="M 184,2920 A 8,8 0,0,1 190,2924" class="nofill"></path>
    <line x1="190" y1="2924" x2="192" y2="2928" class="solid"></line>
    <path d="M 168,2928 A 16,16 0,0,0 168,2944" class="nofill"></path>
    <path d="M 192,2928 A 16,16 0,0,1 192,2944" class="nofill"></path>
    <line x1="168" y1="2944" x2="170" y2="2948" class="solid"></line>
    <path d="M 170,2948 A 8,8 0,0,0 176,2952" class="nofill"></path>
    <line x1="176" y1="2952" x2="184" y2="2952" class="solid"></line>
    <line x1="192" y1="2944" x2="190" y2="2948" class="solid"></line>
    <path d="M 190,2948 A 8,8 0,0,1 184,2952" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,3032 A 8,8 0,0,0 170,3036" class="nofill"></path>
    <line x1="170" y1="3036" x2="168" y2="3040" class="solid"></line>
    <line x1="176" y1="3032" x2="184" y2="3032" class="solid"></line>
    <path d="M 184,3032 A 8,8 0,0,1 190,3036" class="nofill"></path>
    <line x1="190" y1="3036" x2="192" y2="3040" class="solid"></line>
    <path d="M 168,3040 A 16,16 0,0,0 168,3056" class="nofill"></path>
    <path d="M 192,3040 A 16,16 0,0,1 192,3056" class="nofill"></path>
    <line x1="168" y1="3056" x2="170" y2="3060" class="solid"></line>
    <path d="M 170,3060 A 8,8 0,0,0 176,3064" class="nofill"></path>
    <line x1="176" y1="3064" x2="184" y2="3064" class="solid"></line>
    <line x1="192" y1="3056" x2="190" y2="3060" class="solid"></line>
    <path d="M 190,3060 A 8,8 0,0,1 184,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 224,3032 A 8,8 0,0,0 218,3036" class="nofill"></path>
    <line x1="218" y1="3036" x2="216" y2="3040" class="solid"></line>
    <line x1="224" y1="3032" x2="232" y2="3032" class="solid"></line>
    <path d="M 232,3032 A 8,8 0,0,1 238,3036" class="nofill"></path>
    <line x1="238" y1="3036" x2="240" y2="3040" class="solid"></line>
    <path d="M 216,3040 A 16,16 0,0,0 216,3056" class="nofill"></path>
    <path d="M 240,3040 A 16,16 0,0,1 240,3056" class="nofill"></path>
    <line x1="216" y1="3056" x2="218" y2="3060" class="solid"></line>
    <path d="M 218,3060 A 8,8 0,0,0 224,3064" class="nofill"></path>
    <line x1="224" y1="3064" x2="232" y2="3064" class="solid"></line>
    <line x1="240" y1="3056" x2="238" y2="3060" class="solid"></line>
    <path d="M 238,3060 A 8,8 0,0,1 232,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 272,3032 A 8,8 0,0,0 266,3036" class="nofill"></path>
    <line x1="266" y1="3036" x2="264" y2="3040" class="solid"></line>
    <line x1="272" y1="3032" x2="280" y2="3032" class="solid"></line>
    <path d="M 280,3032 A 8,8 0,0,1 286,3036" class="nofill"></path>
    <line x1="286" y1="3036" x2="288" y2="3040" class="solid"></line>
    <path d="M 264,3040 A 16,16 0,0,0 264,3056" class="nofill"></path>
    <path d="M 288,3040 A 16,16 0,0,1 288,3056" class="nofill"></path>
    <line x1="264" y1="3056" x2="266" y2="3060" class="solid"></line>
    <path d="M 266,3060 A 8,8 0,0,0 272,3064" class="nofill"></path>
    <line x1="272" y1="3064" x2="280" y2="3064" class="solid"></line>
    <line x1="288" y1="3056" x2="286" y2="3060" class="solid"></line>
    <path d="M 286,3060 A 8,8 0,0,1 280,3064" class="nofill"></path>
  </g>
  <g>
    <path d="M 40,3016 A 8,8 0,0,0 34,3020" class="nofill"></path>
    <line x1="34" y1="3020" x2="32" y2="3024" class="solid"></line>
    <line x1="40" y1="3016" x2="48" y2="3016" class="solid"></line>
    <path d="M 48,3016 A 8,8 0,0,1 54,3020" class="nofill"></path>
    <line x1="54" y1="3020" x2="56" y2="3024" class="solid"></line>
    <path d="M 32,3024 A 16,16 0,0,0 32,3040" class="nofill"></path>
    <path d="M 56,3024 A 16,16 0,0,1 56,3040" class="nofill"></path>
    <line x1="32" y1="3040" x2="34" y2="3044" class="solid"></line>
    <path d="M 34,3044 A 8,8 0,0,0 40,3048" class="nofill"></path>
    <line x1="40" y1="3048" x2="48" y2="3048" class="solid"></line>
    <line x1="56" y1="3040" x2="54" y2="3044" class="solid"></line>
    <path d="M 54,3044 A 8,8 0,0,1 48,3048" class="nofill"></path>
  </g>
  <g>
    <path d="M 104,3176 A 4,4 0,0,0 100,3180" class="nofill"></path>
    <line x1="100" y1="3180" x2="100" y2="3220" class="solid"></line>
    <line x1="104" y1="3176" x2="296" y2="3176" class="solid"></line>
    <line x1="68" y1="3224" x2="96" y2="3224" class="solid"></line>
    <path d="M 100,3220 A 4,4 0,0,1 96,3224" class="nofill"></path>
    <path d="M 100,3220 A 4,4 0,0,0 104,3224" class="nofill"></path>
    <line x1="104" y1="3224" x2="296" y2="3224" class="broken"></line>
  </g>
  <g>
    <path d="M 128,3272 A 8,8 0,0,0 122,3276" class="nofill"></path>
    <line x1="122" y1="3276" x2="102" y2="3316" class="solid"></line>
    <line x1="128" y1="3272" x2="296" y2="3272" class="solid"></line>
    <line x1="68" y1="3320" x2="96" y2="3320" class="solid"></line>
    <path d="M 102,3316 A 8,8 0,0,1 96,3320" class="nofill"></path>
    <path d="M 102,3316 A 3,3 0,0,0 104,3320" class="nofill"></path>
    <line x1="104" y1="3320" x2="136" y2="3320" class="broken"></line>
  </g>
  <g>
    <line x1="72" y1="3384" x2="200" y2="3384" class="broken"></line>
    <path d="M 200,3384 A 4,4 0,0,1 204,3388" class="nofill"></path>
    <path d="M 208,3384 A 4,4 0,0,0 204,3388" class="nofill"></path>
    <line x1="204" y1="3388" x2="204" y2="3428" class="solid"></line>
    <line x1="208" y1="3384" x2="296" y2="3384" class="solid"></line>
    <line x1="68" y1="3432" x2="200" y2="3432" class="solid"></line>
    <path d="M 204,3428 A 4,4 0,0,1 200,3432" class="nofill"></path>
    <path d="M 204,3428 A 4,4 0,0,0 208,3432" class="nofill"></path>
    <line x1="208" y1="3432" x2="296" y2="3432" class="broken"></line>
  </g>
  <g>
    <line x1="124" y1="3496" x2="180" y2="3496" class="solid"></line>
    <line x1="124" y1="3496" x2="124" y2="3528" class="solid"></line>
    <line x1="180" y1="3496" x2="180" y2="3528" class="solid"></line>
    <line x1="96" y1="3512" x2="124" y2="3512" class="solid"></line>
    <line x1="180" y1="3512" x2="200" y2="3512" class="solid"></line>
    <line x1="124" y1="3528" x2="180" y2="3528" class="solid"></line>
  </g>
  <g>
    <path d="M 216,3496 A 8,8 0,0,0 210,3500" class="nofill"></path>
    <line x1="210" y1="3500" x2="208" y2="3504" class="solid"></line>
    <line x1="216" y1="3496" x2="224" y2="3496" class="solid"></line>
    <path d="M 224,3496 A 8,8 0,0,1 230,3500" class="nofill"></path>
    <line x1="230" y1="3500" x2="232" y2="3504" class="solid"></line>
    <path d="M 208,3504 A 16,16 0,0,0 208,3520" class="nofill"></path>
    <path d="M 232,3504 A 16,16 0,0,1 232,3520" class="nofill"></path>
    <line x1="208" y1="3520" x2="210" y2="3524" class="solid"></line>
    <path d="M 210,3524 A 8,8 0,0,0 216,3528" class="nofill"></path>
    <line x1="216" y1="3528" x2="224" y2="3528" class="solid"></line>
    <line x1="232" y1="3520" x2="230" y2="3524" class="solid"></line>
    <path d="M 230,3524 A 8,8 0,0,1 224,3528" class="nofill"></path>
  </g>
  <g>
    <line x1="252" y1="3496" x2="284" y2="3496" class="solid"></line>
    <line x1="252" y1="3496" x2="252" y2="3528" class="solid"></line>
    <line x1="284" y1="3496" x2="284" y2="3528" class="solid"></line>
    <line x1="240" y1="3512" x2="252" y2="3512" class="solid"></line>
    <line x1="284" y1="3512" x2="304" y2="3512" class="solid"></line>
    <line x1="252" y1="3528" x2="284" y2="3528" class="solid"></line>
  </g>
  <g>
    <line x1="80" y1="3512" x2="88" y2="3512" class="solid"></line>
    <path d="M 88,3512 A 4,4 0,0,1 92,3516" class="nofill"></path>
    <line x1="92" y1="3516" x2="92" y2="3572" class="solid"></line>
    <path d="M 92,3572 A 4,4 0,0,0 96,3576" class="nofill"></path>
    <line x1="96" y1="3576" x2="104" y2="3576" class="solid"></line>
    <path d="M 112,3544 A 4,4 0,0,0 108,3548" class="nofill"></path>
    <line x1="108" y1="3548" x2="108" y2="3572" class="solid"></line>
    <line x1="112" y1="3544" x2="160" y2="3544" class="solid"></line>
    <path d="M 108,3572 A 4,4 0,0,1 104,3576" class="nofill"></path>
  </g>
  <g>
    <path d="M 312,3512 A 4,4 0,0,0 308,3516" class="nofill"></path>
    <line x1="308" y1="3516" x2="308" y2="3572" class="solid"></line>
    <line x1="168" y1="3544" x2="216" y2="3544" class="solid"></line>
    <path d="M 216,3544 A 4,4 0,0,1 220,3548" class="nofill"></path>
    <line x1="220" y1="3548" x2="220" y2="3572" class="solid"></line>
    <path d="M 220,3572 A 4,4 0,0,0 224,3576" class="nofill"></path>
    <line x1="224" y1="3576" x2="304" y2="3576" class="solid"></line>
    <path d="M 308,3572 A 4,4 0,0,1 304,3576" class="nofill"></path>
  </g>
  <g>
    <line x1="148" y1="3560" x2="180" y2="3560" class="solid"></line>
    <line x1="148" y1="3560" x2="148" y2="3592" class="solid"></line>
    <line x1="180" y1="3560" x2="180" y2="3592" class="solid"></line>
    <line x1="180" y1="3576" x2="200" y2="3576" class="solid"></line>
    <path d="M 200,3576 A 4,4 0,0,1 204,3580" class="nofill"></path>
    <line x1="204" y1="3580" x2="204" y2="3620" class="solid"></line>
    <line x1="148" y1="3592" x2="180" y2="3592" class="solid"></line>
    <path d="M 128,3576 A 4,4 0,0,0 124,3580" class="nofill"></path>
    <line x1="124" y1="3580" x2="124" y2="3620" class="solid"></line>
    <line x1="128" y1="3576" x2="148" y2="3576" class="solid"></line>
    <path d="M 124,3620 A 4,4 0,0,0 128,3624" class="nofill"></path>
    <line x1="128" y1="3624" x2="144" y2="3624" class="solid"></line>
    <line x1="184" y1="3624" x2="200" y2="3624" class="solid"></line>
    <path d="M 204,3620 A 4,4 0,0,1 200,3624" class="nofill"></path>
  </g>
  <g>
    <line x1="92" y1="3584" x2="92" y2="3684" class="solid"></line>
    <path d="M 92,3684 A 4,4 0,0,0 96,3688" class="nofill"></path>
    <line x1="96" y1="3688" x2="112" y2="3688" class="solid"></line>
  </g>
  <g>
    <path d="M 160,3608 A 8,8 0,0,0 154,3612" class="nofill"></path>
    <line x1="154" y1="3612" x2="152" y2="3616" class="solid"></line>
    <line x1="160" y1="3608" x2="168" y2="3608" class="solid"></line>
    <path d="M 168,3608 A 8,8 0,0,1 174,3612" class="nofill"></path>
    <line x1="174" y1="3612" x2="176" y2="3616" class="solid"></line>
    <path d="M 152,3616 A 16,16 0,0,0 152,3632" class="nofill"></path>
    <path d="M 176,3616 A 16,16 0,0,1 176,3632" class="nofill"></path>
    <line x1="152" y1="3632" x2="154" y2="3636" class="solid"></line>
    <path d="M 154,3636 A 8,8 0,0,0 160,3640" class="nofill"></path>
    <line x1="160" y1="3640" x2="168" y2="3640" class="solid"></line>
    <line x1="176" y1="3632" x2="174" y2="3636" class="solid"></line>
    <path d="M 174,3636 A 8,8 0,0,1 168,3640" class="nofill"></path>
  </g>
  <g>
    <line x1="308" y1="3628" x2="308" y2="3684" class="solid"></line>
    <line x1="272" y1="3688" x2="304" y2="3688" class="solid"></line>
    <path d="M 308,3684 A 4,4 0,0,1 304,3688" class="nofill"></path>
  </g>
  <g>
    <path d="M 120,3656 A 4,4 0,0,0 116,3660" class="nofill"></path>
    <line x1="116" y1="3660" x2="116" y2="3684" class="solid"></line>
    <line x1="120" y1="3656" x2="184" y2="3656" class="solid"></line>
    <path d="M 116,3684 A 4,4 0,0,0 120,3688" class="nofill"></path>
    <line x1="120" y1="3688" x2="128" y2="3688" class="solid"></line>
  </g>
  <g>
    <line x1="192" y1="3656" x2="264" y2="3656" class="solid"></line>
    <path d="M 264,3656 A 4,4 0,0,1 268,3660" class="nofill"></path>
    <line x1="268" y1="3660" x2="268" y2="3684" class="solid"></line>
    <line x1="256" y1="3688" x2="264" y2="3688" class="solid"></line>
    <path d="M 268,3684 A 4,4 0,0,1 264,3688" class="nofill"></path>
  </g>
  <g>
    <line x1="148" y1="3672" x2="180" y2="3672" class="solid"></line>
    <line x1="148" y1="3672" x2="148" y2="3704" class="solid"></line>
    <line x1="180" y1="3672" x2="180" y2="3704" class="solid"></line>
    <line x1="180" y1="3688" x2="200" y2="3688" class="solid"></line>
    <line x1="148" y1="3704" x2="180" y2="3704" class="solid"></line>
    <path d="M 136,3688 A 4,4 0,0,0 132,3692" class="nofill"></path>
    <line x1="132" y1="3692" x2="132" y2="3716" class="solid"></line>
    <line x1="136" y1="3688" x2="148" y2="3688" class="solid"></line>
    <path d="M 132,3716 A 4,4 0,0,0 136,3720" class="nofill"></path>
    <line x1="136" y1="3720" x2="192" y2="3720" class="solid"></line>
  </g>
  <g>
    <path d="M 216,3672 A 8,8 0,0,0 210,3676" class="nofill"></path>
    <line x1="210" y1="3676" x2="208" y2="3680" class="solid"></line>
    <line x1="216" y1="3672" x2="224" y2="3672" class="solid"></line>
    <path d="M 224,3672 A 8,8 0,0,1 230,3676" class="nofill"></path>
    <line x1="230" y1="3676" x2="232" y2="3680" class="solid"></line>
    <path d="M 208,3680 A 16,16 0,0,0 208,3696" class="nofill"></path>
    <path d="M 232,3680 A 16,16 0,0,1 232,3696" class="nofill"></path>
    <line x1="208" y1="3696" x2="210" y2="3700" class="solid"></line>
    <path d="M 210,3700 A 8,8 0,0,0 216,3704" class="nofill"></path>
    <line x1="216" y1="3704" x2="224" y2="3704" class="solid"></line>
    <line x1="232" y1="3696" x2="230" y2="3700" class="solid"></line>
    <path d="M 230,3700 A 8,8 0,0,1 224,3704" class="nofill"></path>
  </g>
  <g>
    <line x1="240" y1="3688" x2="248" y2="3688" class="solid"></line>
    <path d="M 248,3688 A 4,4 0,0,1 252,3692" class="nofill"></path>
    <line x1="252" y1="3692" x2="252" y2="3716" class="solid"></line>
    <line x1="200" y1="3720" x2="248" y2="3720" class="solid"></line>
    <path d="M 252,3716 A 4,4 0,0,1 248,3720" class="nofill"></path>
  </g>
  <g>
    <path d="M 320,3736 A 4,4 0,0,0 316,3740" class="nofill"></path>
    <line x1="316" y1="3740" x2="316" y2="3768" class="solid"></line>
    <line x1="320" y1="3736" x2="416" y2="3736" class="solid"></line>
    <line x1="304" y1="3776" x2="312" y2="3776" class="solid"></line>
    <path d="M 316,3768 A 8,8 0,0,1 312,3776" class="nofill"></path>
  </g>
  <g>
    <line x1="424" y1="3736" x2="544" y2="3736" class="solid"></line>
    <path d="M 544,3736 A 4,4 0,0,1 548,3740" class="nofill"></path>
    <line x1="548" y1="3740" x2="548" y2="3768" class="solid"></line>
    <path d="M 548,3768 A 8,8 0,0,0 552,3776" class="nofill"></path>
    <line x1="552" y1="3776" x2="576" y2="3776" class="solid"></line>
  </g>
  <g>
    <line x1="92" y1="3752" x2="204" y2="3752" class="solid"></line>
    <line x1="92" y1="3752" x2="92" y2="3784" class="solid"></line>
    <line x1="204" y1="3752" x2="204" y2="3784" class="solid"></line>
    <line x1="56" y1="3776" x2="92" y2="3776" class="solid"></line>
    <line x1="204" y1="3776" x2="216" y2="3776" class="solid"></line>
    <line x1="92" y1="3784" x2="204" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 232,3752 A 8,8 0,0,0 226,3756" class="nofill"></path>
    <line x1="226" y1="3756" x2="224" y2="3760" class="solid"></line>
    <line x1="232" y1="3752" x2="240" y2="3752" class="solid"></line>
    <path d="M 240,3752 A 8,8 0,0,1 246,3756" class="nofill"></path>
    <line x1="246" y1="3756" x2="248" y2="3760" class="solid"></line>
    <path d="M 224,3760 A 16,16 0,0,0 224,3776" class="nofill"></path>
    <path d="M 248,3760 A 16,16 0,0,1 248,3776" class="nofill"></path>
    <line x1="224" y1="3776" x2="226" y2="3780" class="solid"></line>
    <path d="M 226,3780 A 8,8 0,0,0 232,3784" class="nofill"></path>
    <line x1="232" y1="3784" x2="240" y2="3784" class="solid"></line>
    <line x1="248" y1="3776" x2="246" y2="3780" class="solid"></line>
    <path d="M 246,3780 A 8,8 0,0,1 240,3784" class="nofill"></path>
  </g>
  <g>
    <path d="M 280,3752 A 8,8 0,0,0 274,3756" class="nofill"></path>
    <line x1="274" y1="3756" x2="272" y2="3760" class="solid"></line>
    <line x1="280" y1="3752" x2="288" y2="3752" class="solid"></line>
    <path d="M 288,3752 A 8,8 0,0,1 294,3756" class="nofill"></path>
    <line x1="294" y1="3756" x2="296" y2="3760" class="solid"></line>
    <path d="M 272,3760 A 16,16 0,0,0 272,3776" class="nofill"></path>
    <path d="M 296,3760 A 16,16 0,0,1 296,3776" class="nofill"></path>
    <line x1="272" y1="3776" x2="274" y2="3780" class="solid"></line>
    <path d="M 274,3780 A 8,8 0,0,0 280,3784" class="nofill"></path>
    <line x1="280" y1="3784" x2="288" y2="3784" class="solid"></line>
    <line x1="296" y1="3776" x2="294" y2="3780" class="solid"></line>
    <path d="M 294,3780 A 8,8 0,0,1 288,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="340" y1="3752" x2="396" y2="3752" class="solid"></line>
    <line x1="340" y1="3752" x2="340" y2="3784" class="solid"></line>
    <line x1="396" y1="3752" x2="396" y2="3784" class="solid"></line>
    <line x1="320" y1="3776" x2="340" y2="3776" class="solid"></line>
    <line x1="396" y1="3776" x2="408" y2="3776" class="solid"></line>
    <line x1="340" y1="3784" x2="396" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 424,3752 A 8,8 0,0,0 418,3756" class="nofill"></path>
    <line x1="418" y1="3756" x2="416" y2="3760" class="solid"></line>
    <line x1="424" y1="3752" x2="432" y2="3752" class="solid"></line>
    <path d="M 432,3752 A 8,8 0,0,1 438,3756" class="nofill"></path>
    <line x1="438" y1="3756" x2="440" y2="3760" class="solid"></line>
    <path d="M 416,3760 A 16,16 0,0,0 416,3776" class="nofill"></path>
    <path d="M 440,3760 A 16,16 0,0,1 440,3776" class="nofill"></path>
    <line x1="416" y1="3776" x2="418" y2="3780" class="solid"></line>
    <path d="M 418,3780 A 8,8 0,0,0 424,3784" class="nofill"></path>
    <line x1="424" y1="3784" x2="432" y2="3784" class="solid"></line>
    <line x1="440" y1="3776" x2="438" y2="3780" class="solid"></line>
    <path d="M 438,3780 A 8,8 0,0,1 432,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="468" y1="3752" x2="516" y2="3752" class="solid"></line>
    <line x1="468" y1="3752" x2="468" y2="3784" class="solid"></line>
    <line x1="516" y1="3752" x2="516" y2="3784" class="solid"></line>
    <line x1="448" y1="3776" x2="468" y2="3776" class="solid"></line>
    <line x1="516" y1="3776" x2="544" y2="3776" class="solid"></line>
    <line x1="468" y1="3784" x2="516" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 592,3752 A 8,8 0,0,0 586,3756" class="nofill"></path>
    <line x1="586" y1="3756" x2="584" y2="3760" class="solid"></line>
    <line x1="592" y1="3752" x2="600" y2="3752" class="solid"></line>
    <path d="M 600,3752 A 8,8 0,0,1 606,3756" class="nofill"></path>
    <line x1="606" y1="3756" x2="608" y2="3760" class="solid"></line>
    <path d="M 584,3760 A 16,16 0,0,0 584,3776" class="nofill"></path>
    <path d="M 608,3760 A 16,16 0,0,1 608,3776" class="nofill"></path>
    <line x1="584" y1="3776" x2="586" y2="3780" class="solid"></line>
    <path d="M 586,3780 A 8,8 0,0,0 592,3784" class="nofill"></path>
    <line x1="592" y1="3784" x2="600" y2="3784" class="solid"></line>
    <line x1="608" y1="3776" x2="606" y2="3780" class="solid"></line>
    <path d="M 606,3780 A 8,8 0,0,1 600,3784" class="nofill"></path>
  </g>
  <g>
    <line x1="636" y1="3752" x2="692" y2="3752" class="solid"></line>
    <line x1="636" y1="3752" x2="636" y2="3784" class="solid"></line>
    <line x1="692" y1="3752" x2="692" y2="3784" class="solid"></line>
    <line x1="616" y1="3776" x2="636" y2="3776" class="solid"></line>
    <line x1="692" y1="3776" x2="744" y2="3776" class="solid"></line>
    <line x1="636" y1="3784" x2="692" y2="3784" class="solid"></line>
  </g>
  <g>
    <path d="M 64,3776 A 8,8 0,0,1 68,3784" class="nofill"></path>
    <line x1="68" y1="3784" x2="68" y2="3844" class="solid"></line>
    <path d="M 68,3844 A 4,4 0,0,0 72,3848" class="nofill"></path>
    <line x1="72" y1="3848" x2="712" y2="3848" class="solid"></line>
    <path d="M 720,3776 A 8,8 0,0,0 716,3784" class="nofill"></path>
    <line x1="716" y1="3784" x2="716" y2="3844" class="solid"></line>
    <path d="M 716,3844 A 4,4 0,0,1 712,3848" class="nofill"></path>
  </g>
  <g>
    <path d="M 328,3776 A 8,8 0,0,0 324,3784" class="nofill"></path>
    <line x1="324" y1="3784" x2="324" y2="3812" class="solid"></line>
    <path d="M 324,3812 A 4,4 0,0,0 328,3816" class="nofill"></path>
    <line x1="328" y1="3816" x2="424" y2="3816" class="solid"></line>
  </g>
  <g>
    <path d="M 536,3776 A 8,8 0,0,1 540,3784" class="nofill"></path>
    <line x1="540" y1="3784" x2="540" y2="3812" class="solid"></line>
    <line x1="520" y1="3816" x2="536" y2="3816" class="solid"></line>
    <path d="M 540,3812 A 4,4 0,0,1 536,3816" class="nofill"></path>
  </g>
  <g>
    <path d="M 496,3800 A 8,8 0,0,0 490,3804" class="nofill"></path>
    <line x1="490" y1="3804" x2="488" y2="3808" class="solid"></line>
    <line x1="496" y1="3800" x2="504" y2="3800" class="solid"></line>
    <path d="M 504,3800 A 8,8 0,0,1 510,3804" class="nofill"></path>
    <line x1="510" y1="3804" x2="512" y2="3808" class="solid"></line>
    <path d="M 488,3808 A 16,16 0,0,0 488,3824" class="nofill"></path>
    <path d="M 512,3808 A 16,16 0,0,1 512,3824" class="nofill"></path>
    <line x1="488" y1="3824" x2="490" y2="3828" class="solid"></line>
    <path d="M 490,3828 A 8,8 0,0,0 496,3832" class="nofill"></path>
    <line x1="496" y1="3832" x2="504" y2="3832" class="solid"></line>
    <line x1="512" y1="3824" x2="510" y2="3828" class="solid"></line>
    <path d="M 510,3828 A 8,8 0,0,1 504,3832" class="nofill"></path>
  </g>
  <g>
    <line x1="256" y1="3928" x2="284" y2="3928" class="solid"></line>
    <line x1="284" y1="3928" x2="284" y2="3936" class="solid"></line>
  </g>
  <g>
    <line x1="260" y1="3932" x2="260" y2="3992" class="solid"></line>
    <line x1="212" y1="3948" x2="212" y2="3992" class="solid"></line>
    <line x1="236" y1="3948" x2="236" y2="3992" class="solid"></line>
    <line x1="284" y1="3948" x2="284" y2="3992" class="solid"></line>
    <line x1="164" y1="3964" x2="164" y2="3992" class="solid"></line>
    <line x1="188" y1="3964" x2="188" y2="3992" class="solid"></line>
    <line x1="88" y1="3992" x2="284" y2="3992" class="solid"></line>
    <line x1="116" y1="3984" x2="116" y2="3992" class="solid"></line>
    <line x1="140" y1="3984" x2="140" y2="3992" class="solid"></line>
  </g>
  <g>
    <line x1="580" y1="3952" x2="580" y2="4000" class="solid"></line>
    <line x1="392" y1="3992" x2="580" y2="3992" class="solid"></line>
  </g>
  <g>
    <line x1="68" y1="4064" x2="68" y2="4248" class="solid"></line>
    <line x1="64" y1="4072" x2="68" y2="4072" class="solid"></line>
    <line x1="64" y1="4088" x2="68" y2="4088" class="solid"></line>
    <line x1="64" y1="4104" x2="68" y2="4104" class="solid"></line>
    <line x1="64" y1="4120" x2="68" y2="4120" class="solid"></line>
    <line x1="64" y1="4136" x2="68" y2="4136" class="solid"></line>
    <line x1="64" y1="4152" x2="68" y2="4152" class="solid"></line>
    <line x1="64" y1="4168" x2="68" y2="4168" class="solid"></line>
    <line x1="64" y1="4184" x2="68" y2="4184" class="solid"></line>
    <line x1="64" y1="4200" x2="68" y2="4200" class="solid"></line>
    <line x1="64" y1="4232" x2="68" y2="4232" class="solid"></line>
    <line x1="68" y1="4248" x2="584" y2="4248" class="solid"></line>
    <line x1="164" y1="4240" x2="164" y2="4248" class="solid"></line>
    <line x1="260" y1="4240" x2="260" y2="4248" class="solid"></line>
    <line x1="356" y1="4240" x2="356" y2="4248" class="solid"></line>
    <line x1="452" y1="4240" x2="452" y2="4248" class="solid"></line>
    <line x1="548" y1="4240" x2="548" y2="4248" class="solid"></line>
  </g>
  <g>
    <path d="M 392,4072 A 4,4 0,0,0 388,4076" class="nofill"></path>
    <line x1="388" y1="4076" x2="388" y2="4132" class="solid"></line>
    <path d="M 392,4072 A 4,4 0,0,1 396,4076" class="nofill"></path>
    <line x1="396" y1="4076" x2="396" y2="4132" class="solid"></line>
    <path d="M 396,4132 A 4,4 0,0,0 400,4136" class="nofill"></path>
    <line x1="400" y1="4136" x2="408" y2="4136" class="solid"></line>
    <path d="M 360,4120 A 4,4 0,0,0 356,4124" class="nofill"></path>
    <line x1="356" y1="4124" x2="356" y2="4164" class="solid"></line>
    <line x1="360" y1="4120" x2="368" y2="4120" class="solid"></line>
    <path d="M 368,4120 A 4,4 0,0,1 372,4124" class="nofill"></path>
    <line x1="372" y1="4124" x2="372" y2="4132" class="solid"></line>
    <path d="M 372,4132 A 4,4 0,0,0 376,4136" class="nofill"></path>
    <line x1="376" y1="4136" x2="384" y2="4136" class="solid"></line>
    <path d="M 388,4132 A 4,4 0,0,1 384,4136" class="nofill"></path>
    <path d="M 424,4104 A 4,4 0,0,0 420,4108" class="nofill"></path>
    <line x1="420" y1="4108" x2="420" y2="4116" class="solid"></line>
    <path d="M 424,4104 A 4,4 0,0,1 428,4108" class="nofill"></path>
    <line x1="428" y1="4108" x2="428" y2="4116" class="solid"></line>
    <path d="M 428,4116 A 4,4 0,0,0 432,4120" class="nofill"></path>
    <path d="M 432,4120 A 4,4 0,0,1 436,4124" class="nofill"></path>
    <line x1="436" y1="4124" x2="436" y2="4148" class="solid"></line>
    <path d="M 436,4148 A 4,4 0,0,0 440,4152" class="nofill"></path>
    <path d="M 448,4104 A 4,4 0,0,0 444,4108" class="nofill"></path>
    <line x1="444" y1="4108" x2="444" y2="4148" class="solid"></line>
    <path d="M 448,4104 A 4,4 0,0,1 452,4108" class="nofill"></path>
    <line x1="452" y1="4108" x2="452" y2="4116" class="solid"></line>
    <path d="M 452,4116 A 4,4 0,0,0 456,4120" class="nofill"></path>
    <line x1="456" y1="4120" x2="464" y2="4120" class="solid"></line>
    <path d="M 444,4148 A 4,4 0,0,1 440,4152" class="nofill"></path>
    <path d="M 472,4104 A 4,4 0,0,0 468,4108" class="nofill"></path>
    <line x1="468" y1="4108" x2="468" y2="4116" class="solid"></line>
    <path d="M 472,4104 A 4,4 0,0,1 476,4108" class="nofill"></path>
    <line x1="476" y1="4108" x2="476" y2="4116" class="solid"></line>
    <path d="M 468,4116 A 4,4 0,0,1 464,4120" class="nofill"></path>
    <path d="M 476,4116 A 4,4 0,0,0 480,4120" class="nofill"></path>
    <path d="M 480,4120 A 4,4 0,0,1 484,4124" class="nofill"></path>
    <line x1="484" y1="4124" x2="484" y2="4148" class="solid"></line>
    <path d="M 484,4148 A 4,4 0,0,0 488,4152" class="nofill"></path>
    <path d="M 416,4120 A 4,4 0,0,0 412,4124" class="nofill"></path>
    <line x1="412" y1="4124" x2="412" y2="4132" class="solid"></line>
    <path d="M 420,4116 A 4,4 0,0,1 416,4120" class="nofill"></path>
    <path d="M 412,4132 A 4,4 0,0,1 408,4136" class="nofill"></path>
    <path d="M 272,4120 A 4,4 0,0,0 268,4124" class="nofill"></path>
    <line x1="268" y1="4124" x2="268" y2="4164" class="solid"></line>
    <path d="M 272,4120 A 4,4 0,0,1 276,4124" class="nofill"></path>
    <line x1="276" y1="4124" x2="276" y2="4164" class="solid"></line>
    <path d="M 276,4164 A 4,4 0,0,0 280,4168" class="nofill"></path>
    <path d="M 256,4136 A 4,4 0,0,0 252,4140" class="nofill"></path>
    <line x1="252" y1="4140" x2="252" y2="4164" class="solid"></line>
    <path d="M 256,4136 A 4,4 0,0,1 260,4140" class="nofill"></path>
    <line x1="260" y1="4140" x2="260" y2="4164" class="solid"></line>
    <path d="M 260,4164 A 4,4 0,0,0 264,4168" class="nofill"></path>
    <path d="M 268,4164 A 4,4 0,0,1 264,4168" class="nofill"></path>
    <path d="M 288,4136 A 4,4 0,0,0 284,4140" class="nofill"></path>
    <line x1="284" y1="4140" x2="284" y2="4164" class="solid"></line>
    <path d="M 288,4136 A 4,4 0,0,1 292,4140" class="nofill"></path>
    <line x1="292" y1="4140" x2="292" y2="4148" class="solid"></line>
    <path d="M 292,4148 A 4,4 0,0,0 296,4152" class="nofill"></path>
    <path d="M 296,4152 A 4,4 0,0,1 300,4156" class="nofill"></path>
    <line x1="300" y1="4156" x2="300" y2="4164" class="solid"></line>
    <path d="M 284,4164 A 4,4 0,0,1 280,4168" class="nofill"></path>
    <path d="M 300,4164 A 4,4 0,0,0 304,4168" class="nofill"></path>
    <path d="M 312,4136 A 4,4 0,0,0 308,4140" class="nofill"></path>
    <line x1="308" y1="4140" x2="308" y2="4164" class="solid"></line>
    <path d="M 312,4136 A 4,4 0,0,1 316,4140" class="nofill"></path>
    <line x1="316" y1="4140" x2="316" y2="4148" class="solid"></line>
    <path d="M 316,4148 A 4,4 0,0,0 320,4152" class="nofill"></path>
    <path d="M 308,4164 A 4,4 0,0,1 304,4168" class="nofill"></path>
    <path d="M 328,4136 A 4,4 0,0,0 324,4140" class="nofill"></path>
    <line x1="324" y1="4140" x2="324" y2="4148" class="solid"></line>
    <path d="M 328,4136 A 4,4 0,0,1 332,4140" class="nofill"></path>
    <line x1="332" y1="4140" x2="332" y2="4164" class="solid"></line>
    <path d="M 324,4148 A 4,4 0,0,1 320,4152" class="nofill"></path>
    <path d="M 332,4164 A 4,4 0,0,0 336,4168" class="nofill"></path>
    <line x1="336" y1="4168" x2="352" y2="4168" class="solid"></line>
    <path d="M 356,4164 A 4,4 0,0,1 352,4168" class="nofill"></path>
    <path d="M 552,4088 A 4,4 0,0,0 548,4092" class="nofill"></path>
    <line x1="548" y1="4092" x2="548" y2="4100" class="solid"></line>
    <path d="M 552,4088 A 4,4 0,0,1 556,4092" class="nofill"></path>
    <line x1="556" y1="4092" x2="556" y2="4100" class="solid"></line>
    <path d="M 556,4100 A 4,4 0,0,0 560,4104" class="nofill"></path>
    <line x1="560" y1="4104" x2="568" y2="4104" class="solid"></line>
    <path d="M 568,4104 A 4,4 0,0,1 572,4108" class="nofill"></path>
    <line x1="572" y1="4108" x2="572" y2="4132" class="solid"></line>
    <path d="M 572,4132 A 4,4 0,0,0 576,4136" class="nofill"></path>
    <path d="M 584,4120 A 4,4 0,0,0 580,4124" class="nofill"></path>
    <line x1="580" y1="4124" x2="580" y2="4132" class="solid"></line>
    <path d="M 580,4132 A 4,4 0,0,1 576,4136" class="nofill"></path>
    <path d="M 512,4104 A 4,4 0,0,0 508,4108" class="nofill"></path>
    <line x1="508" y1="4108" x2="508" y2="4148" class="solid"></line>
    <path d="M 512,4104 A 4,4 0,0,1 516,4108" class="nofill"></path>
    <line x1="516" y1="4108" x2="516" y2="4116" class="solid"></line>
    <path d="M 516,4116 A 4,4 0,0,0 520,4120" class="nofill"></path>
    <line x1="520" y1="4120" x2="536" y2="4120" class="solid"></line>
    <path d="M 544,4104 A 4,4 0,0,0 540,4108" class="nofill"></path>
    <line x1="540" y1="4108" x2="540" y2="4116" class="solid"></line>
    <path d="M 548,4100 A 4,4 0,0,1 544,4104" class="nofill"></path>
    <path d="M 540,4116 A 4,4 0,0,1 536,4120" class="nofill"></path>
    <path d="M 496,4120 A 4,4 0,0,0 492,4124" class="nofill"></path>
    <line x1="492" y1="4124" x2="492" y2="4148" class="solid"></line>
    <path d="M 496,4120 A 4,4 0,0,1 500,4124" class="nofill"></path>
    <line x1="500" y1="4124" x2="500" y2="4148" class="solid"></line>
    <path d="M 492,4148 A 4,4 0,0,1 488,4152" class="nofill"></path>
    <path d="M 500,4148 A 4,4 0,0,0 504,4152" class="nofill"></path>
    <path d="M 508,4148 A 4,4 0,0,1 504,4152" class="nofill"></path>
    <path d="M 104,4136 A 4,4 0,0,0 100,4140" class="nofill"></path>
    <line x1="100" y1="4140" x2="100" y2="4196" class="solid"></line>
    <path d="M 104,4136 A 4,4 0,0,1 108,4140" class="nofill"></path>
    <line x1="108" y1="4140" x2="108" y2="4148" class="solid"></line>
    <path d="M 108,4148 A 4,4 0,0,0 112,4152" class="nofill"></path>
    <path d="M 112,4152 A 4,4 0,0,1 116,4156" class="nofill"></path>
    <line x1="116" y1="4156" x2="116" y2="4164" class="solid"></line>
    <path d="M 116,4164 A 4,4 0,0,0 120,4168" class="nofill"></path>
    <path d="M 120,4168 A 4,4 0,0,1 124,4172" class="nofill"></path>
    <line x1="124" y1="4172" x2="124" y2="4180" class="solid"></line>
    <path d="M 124,4180 A 4,4 0,0,0 128,4184" class="nofill"></path>
    <path d="M 136,4168 A 4,4 0,0,0 132,4172" class="nofill"></path>
    <line x1="132" y1="4172" x2="132" y2="4180" class="solid"></line>
    <path d="M 136,4168 A 4,4 0,0,1 140,4172" class="nofill"></path>
    <line x1="140" y1="4172" x2="140" y2="4180" class="solid"></line>
    <path d="M 132,4180 A 4,4 0,0,1 128,4184" class="nofill"></path>
    <path d="M 140,4180 A 4,4 0,0,0 144,4184" class="nofill"></path>
    <path d="M 144,4184 A 4,4 0,0,1 148,4188" class="nofill"></path>
    <line x1="148" y1="4188" x2="148" y2="4196" class="solid"></line>
    <path d="M 148,4196 A 4,4 0,0,0 152,4200" class="nofill"></path>
    <path d="M 176,4152 A 4,4 0,0,0 172,4156" class="nofill"></path>
    <line x1="172" y1="4156" x2="172" y2="4164" class="solid"></line>
    <line x1="176" y1="4152" x2="192" y2="4152" class="solid"></line>
    <path d="M 192,4152 A 4,4 0,0,1 196,4156" class="nofill"></path>
    <line x1="196" y1="4156" x2="196" y2="4164" class="solid"></line>
    <path d="M 196,4164 A 4,4 0,0,0 200,4168" class="nofill"></path>
    <line x1="200" y1="4168" x2="208" y2="4168" class="solid"></line>
    <path d="M 208,4168 A 4,4 0,0,1 212,4172" class="nofill"></path>
    <line x1="212" y1="4172" x2="212" y2="4196" class="solid"></line>
    <path d="M 212,4196 A 4,4 0,0,0 216,4200" class="nofill"></path>
    <path d="M 168,4168 A 4,4 0,0,0 164,4172" class="nofill"></path>
    <line x1="164" y1="4172" x2="164" y2="4180" class="solid"></line>
    <path d="M 172,4164 A 4,4 0,0,1 168,4168" class="nofill"></path>
    <path d="M 224,4168 A 4,4 0,0,0 220,4172" class="nofill"></path>
    <line x1="220" y1="4172" x2="220" y2="4196" class="solid"></line>
    <path d="M 224,4168 A 4,4 0,0,1 228,4172" class="nofill"></path>
    <line x1="228" y1="4172" x2="228" y2="4180" class="solid"></line>
    <path d="M 228,4180 A 4,4 0,0,0 232,4184" class="nofill"></path>
    <path d="M 220,4196 A 4,4 0,0,1 216,4200" class="nofill"></path>
    <path d="M 240,4168 A 4,4 0,0,0 236,4172" class="nofill"></path>
    <line x1="236" y1="4172" x2="236" y2="4180" class="solid"></line>
    <line x1="240" y1="4168" x2="248" y2="4168" class="solid"></line>
    <path d="M 252,4164 A 4,4 0,0,1 248,4168" class="nofill"></path>
    <path d="M 236,4180 A 4,4 0,0,1 232,4184" class="nofill"></path>
    <path d="M 160,4184 A 4,4 0,0,0 156,4188" class="nofill"></path>
    <line x1="156" y1="4188" x2="156" y2="4196" class="solid"></line>
    <path d="M 164,4180 A 4,4 0,0,1 160,4184" class="nofill"></path>
    <path d="M 156,4196 A 4,4 0,0,1 152,4200" class="nofill"></path>
    <path d="M 80,4168 A 4,4 0,0,0 76,4172" class="nofill"></path>
    <line x1="76" y1="4172" x2="76" y2="4212" class="solid"></line>
    <path d="M 80,4168 A 4,4 0,0,1 84,4172" class="nofill"></path>
    <line x1="84" y1="4172" x2="84" y2="4228" class="solid"></line>
    <path d="M 84,4228 A 4,4 0,0,0 88,4232" class="nofill"></path>
    <path d="M 96,4200 A 4,4 0,0,0 92,4204" class="nofill"></path>
    <line x1="92" y1="4204" x2="92" y2="4228" class="solid"></line>
    <path d="M 100,4196 A 4,4 0,0,1 96,4200" class="nofill"></path>
    <path d="M 92,4228 A 4,4 0,0,1 88,4232" class="nofill"></path>
    <line x1="64" y1="4216" x2="72" y2="4216" class="solid"></line>
    <path d="M 76,4212 A 4,4 0,0,1 72,4216" class="nofill"></path>
  </g>
  <g>
    <path d="M 184,4408 A 4,4 0,0,0 180,4412" class="nofill"></path>
    <line x1="180" y1="4412" x2="180" y2="4436" class="solid"></line>
    <line x1="184" y1="4408" x2="200" y2="4408" class="solid"></line>
    <path d="M 200,4408 A 4,4 0,0,1 204,4412" class="nofill"></path>
    <line x1="204" y1="4412" x2="204" y2="4528" class="solid"></line>
    <path d="M 80,4472 A 4,4 0,0,0 76,4476" class="nofill"></path>
    <line x1="76" y1="4476" x2="76" y2="4528" class="solid"></line>
    <line x1="80" y1="4472" x2="96" y2="4472" class="solid"></line>
    <line x1="148" y1="4504" x2="136" y2="4528" class="solid"></line>
    <line x1="148" y1="4504" x2="160" y2="4528" class="solid"></line>
    <line x1="76" y1="4528" x2="136" y2="4528" class="solid"></line>
    <line x1="160" y1="4528" x2="204" y2="4528" class="solid"></line>
    <line x1="136" y1="4528" x2="148" y2="4552" class="solid"></line>
    <line x1="160" y1="4528" x2="148" y2="4552" class="solid"></line>
    <line x1="148" y1="4552" x2="148" y2="4564" class="solid"></line>
    <path d="M 148,4564 A 4,4 0,0,0 152,4568" class="nofill"></path>
    <line x1="152" y1="4568" x2="168" y2="4568" class="solid"></line>
  </g>
  <g>
    <line x1="148" y1="4480" x2="148" y2="4500" class="solid"></line>
    <path d="M 148,4500 A 16,16 0,0,1 146,4508" class="nofill"></path>
    <path d="M 148,4500 A 16,16 0,0,0 150,4508" class="nofill"></path>
  </g>
  <g>
    <line x1="428" y1="4432" x2="428" y2="4564" class="solid"></line>
    <line x1="392" y1="4568" x2="424" y2="4568" class="solid"></line>
    <path d="M 428,4564 A 4,4 0,0,1 424,4568" class="nofill"></path>
  </g>
  <g>
    <line x1="192" y1="4560" x2="224" y2="4560" class="solid"></line>
    <line x1="192" y1="4560" x2="184" y2="4576" class="solid"></line>
    <line x1="184" y1="4576" x2="216" y2="4576" class="solid"></line>
    <line x1="224" y1="4560" x2="216" y2="4576" class="solid"></line>
  </g>
  <g>
    <line x1="84" y1="4784" x2="100" y2="4784" class="solid"></line>
    <line x1="84" y1="4784" x2="84" y2="4792" class="solid"></line>
    <line x1="84" y1="4792" x2="72" y2="4816" class="solid"></line>
    <line x1="100" y1="4784" x2="100" y2="4816" class="solid"></line>
    <line x1="84" y1="4800" x2="84" y2="4816" class="solid"></line>
    <line x1="84" y1="4816" x2="100" y2="4816" class="solid"></line>
  </g>
  <g>
    <text x="50" y="4812">‚†∂</text>
    <text x="58" y="4812">‚†∂</text>
  </g>
  <g>
    <path d="M 200,4760 A 8,8 0,0,0 194,4764" class="nofill"></path>
    <line x1="194" y1="4764" x2="192" y2="4768" class="solid"></line>
    <line x1="200" y1="4760" x2="208" y2="4760" class="solid"></line>
    <path d="M 192,4768 A 16,16 0,0,0 192,4784" class="nofill"></path>
  </g>
  <g>
    <path d="M 176,4776 A 8,8 0,0,0 170,4780" class="nofill"></path>
    <line x1="170" y1="4780" x2="168" y2="4784" class="solid"></line>
    <line x1="176" y1="4776" x2="184" y2="4776" class="solid"></line>
    <path d="M 168,4784 A 16,16 0,0,0 168,4800" class="nofill"></path>
    <line x1="168" y1="4800" x2="170" y2="4804" class="solid"></line>
    <path d="M 170,4804 A 8,8 0,0,0 176,4808" class="nofill"></path>
    <line x1="176" y1="4808" x2="184" y2="4808" class="solid"></line>
  </g>
  <g>
    <line x1="256" y1="4760" x2="264" y2="4760" class="solid"></line>
    <path d="M 264,4760 A 8,8 0,0,1 270,4764" class="nofill"></path>
    <line x1="270" y1="4764" x2="272" y2="4768" class="solid"></line>
    <path d="M 272,4768 A 16,16 0,0,1 272,4784" class="nofill"></path>
  </g>
  <g>
    <line x1="280" y1="4776" x2="288" y2="4776" class="solid"></line>
    <path d="M 288,4776 A 8,8 0,0,1 294,4780" class="nofill"></path>
    <line x1="294" y1="4780" x2="296" y2="4784" class="solid"></line>
  </g>
  <g>
    <line x1="524" y1="4800" x2="564" y2="4800" class="solid"></line>
    <line x1="524" y1="4800" x2="524" y2="4832" class="solid"></line>
    <line x1="564" y1="4800" x2="564" y2="4832" class="solid"></line>
    <line x1="524" y1="4832" x2="564" y2="4832" class="solid"></line>
    <line x1="528" y1="4832" x2="520" y2="4848" class="solid"></line>
  </g>
  <g>
    <path d="M 272,4800 A 16,16 0,0,1 272,4816" class="nofill"></path>
    <line x1="272" y1="4816" x2="270" y2="4820" class="solid"></line>
    <line x1="256" y1="4824" x2="264" y2="4824" class="solid"></line>
    <path d="M 270,4820 A 8,8 0,0,1 264,4824" class="nofill"></path>
  </g>
  <g>
    <text x="426" y="4812">...¬∞</text>
    <text x="458" y="4812">]</text>
  </g>
  <g>
    <text x="530" y="4844">‚†∂</text>
    <text x="538" y="4844">‚†∂</text>
    <text x="546" y="4844">‚†∂</text>
  </g>
  <g>
    <line x1="320" y1="4888" x2="384" y2="4888" class="solid"></line>
    <path d="M 384,4888 A 3,3 0,0,1 386,4892" class="nofill"></path>
    <line x1="386" y1="4892" x2="374" y2="4916" class="solid"></line>
  </g>
  <g>
    <line x1="248" y1="4944" x2="320" y2="4944" class="solid"></line>
    <line x1="328" y1="4936" x2="320" y2="4944" class="solid"></line>
    <line x1="328" y1="4936" x2="476" y2="4936" class="solid"></line>
    <line x1="476" y1="4936" x2="464" y2="4960" class="solid"></line>
    <line x1="464" y1="4960" x2="476" y2="4984" class="solid"></line>
    <line x1="424" y1="4984" x2="476" y2="4984" class="solid"></line>
    <path d="M 168,4952 A 8,8 0,0,0 162,4956" class="nofill"></path>
    <line x1="162" y1="4956" x2="152" y2="4976" class="solid"></line>
    <line x1="168" y1="4952" x2="240" y2="4952" class="solid"></line>
    <line x1="248" y1="4944" x2="240" y2="4952" class="solid"></line>
    <path d="M 152,4976 A 16,16 0,0,0 152,4992" class="nofill"></path>
    <line x1="152" y1="4992" x2="162" y2="5012" class="solid"></line>
    <path d="M 162,5012 A 8,8 0,0,0 168,5016" class="nofill"></path>
    <line x1="168" y1="5016" x2="216" y2="5016" class="solid"></line>
    <line x1="216" y1="5016" x2="224" y2="5024" class="solid"></line>
    <line x1="224" y1="5024" x2="236" y2="5024" class="solid"></line>
    <line x1="236" y1="5024" x2="236" y2="5120" class="solid"></line>
    <line x1="200" y1="5120" x2="236" y2="5120" class="solid"></line>
    <line x1="200" y1="5120" x2="196" y2="5128" class="solid"></line>
    <line x1="196" y1="5128" x2="196" y2="5168" class="solid"></line>
    <path d="M 168,5160 A 4,4 0,0,0 164,5164" class="nofill"></path>
    <line x1="164" y1="5164" x2="164" y2="5184" class="solid"></line>
    <line x1="168" y1="5160" x2="196" y2="5160" class="solid"></line>
    <line x1="136" y1="5184" x2="164" y2="5184" class="solid"></line>
  </g>
  <g>
    <path d="M 184,4968 A 8,8 0,0,0 178,4972" class="nofill"></path>
    <line x1="178" y1="4972" x2="176" y2="4976" class="solid"></line>
    <line x1="184" y1="4968" x2="240" y2="4968" class="solid"></line>
    <line x1="240" y1="4968" x2="248" y2="4976" class="solid"></line>
    <line x1="248" y1="4976" x2="320" y2="4976" class="solid"></line>
    <path d="M 176,4976 A 16,16 0,0,0 176,4992" class="nofill"></path>
    <line x1="320" y1="4976" x2="328" y2="4984" class="solid"></line>
    <line x1="176" y1="4992" x2="178" y2="4996" class="solid"></line>
    <path d="M 178,4996 A 8,8 0,0,0 184,5000" class="nofill"></path>
    <line x1="184" y1="5000" x2="216" y2="5000" class="solid"></line>
    <line x1="224" y1="4992" x2="296" y2="4992" class="solid"></line>
    <line x1="224" y1="4992" x2="216" y2="5000" class="solid"></line>
    <line x1="296" y1="4992" x2="304" y2="5000" class="solid"></line>
    <line x1="304" y1="5000" x2="336" y2="5000" class="solid"></line>
  </g>
  <g>
    <line x1="244" y1="5024" x2="296" y2="5024" class="solid"></line>
    <line x1="304" y1="5016" x2="296" y2="5024" class="solid"></line>
    <line x1="304" y1="5016" x2="336" y2="5016" class="solid"></line>
    <line x1="244" y1="5024" x2="244" y2="5124" class="solid"></line>
    <path d="M 216,5128 A 4,4 0,0,0 212,5132" class="nofill"></path>
    <line x1="212" y1="5132" x2="212" y2="5168" class="solid"></line>
    <line x1="216" y1="5128" x2="240" y2="5128" class="solid"></line>
    <path d="M 244,5124 A 4,4 0,0,1 240,5128" class="nofill"></path>
    <line x1="212" y1="5160" x2="240" y2="5160" class="solid"></line>
    <path d="M 240,5160 A 4,4 0,0,1 244,5164" class="nofill"></path>
    <line x1="244" y1="5164" x2="244" y2="5220" class="solid"></line>
    <line x1="136" y1="5200" x2="164" y2="5200" class="solid"></line>
    <line x1="164" y1="5200" x2="164" y2="5220" class="solid"></line>
    <path d="M 164,5220 A 4,4 0,0,0 168,5224" class="nofill"></path>
    <line x1="180" y1="5184" x2="180" y2="5224" class="solid"></line>
    <line x1="196" y1="5184" x2="196" y2="5224" class="solid"></line>
    <line x1="212" y1="5184" x2="212" y2="5224" class="solid"></line>
    <line x1="228" y1="5184" x2="228" y2="5224" class="solid"></line>
    <line x1="168" y1="5224" x2="240" y2="5224" class="solid"></line>
    <path d="M 244,5220 A 4,4 0,0,1 240,5224" class="nofill"></path>
  </g>
  <g>
    <line x1="268" y1="5020" x2="268" y2="5108" class="solid"></line>
    <path d="M 268,5108 A 4,4 0,0,0 272,5112" class="nofill"></path>
    <line x1="272" y1="5112" x2="368" y2="5112" class="solid"></line>
    <path d="M 368,5112 A 4,4 0,0,1 372,5116" class="nofill"></path>
    <line x1="372" y1="5116" x2="372" y2="5172" class="solid"></line>
  </g>
  <g>
    <line x1="540" y1="5144" x2="620" y2="5144" class="solid"></line>
    <line x1="540" y1="5144" x2="540" y2="5172" class="solid"></line>
    <line x1="556" y1="5144" x2="556" y2="5224" class="solid"></line>
    <line x1="572" y1="5144" x2="572" y2="5224" class="solid"></line>
    <line x1="588" y1="5144" x2="588" y2="5224" class="solid"></line>
    <line x1="604" y1="5144" x2="604" y2="5224" class="solid"></line>
    <line x1="620" y1="5144" x2="620" y2="5224" class="solid"></line>
    <line x1="540" y1="5160" x2="620" y2="5160" class="solid"></line>
    <line x1="544" y1="5176" x2="620" y2="5176" class="solid"></line>
    <line x1="544" y1="5192" x2="620" y2="5192" class="solid"></line>
    <line x1="540" y1="5196" x2="540" y2="5224" class="solid"></line>
    <line x1="540" y1="5208" x2="620" y2="5208" class="solid"></line>
    <line x1="540" y1="5224" x2="620" y2="5224" class="solid"></line>
  </g>
  <g>
    <line x1="272" y1="5168" x2="288" y2="5168" class="solid"></line>
    <line x1="288" y1="5168" x2="296" y2="5176" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="5224" x2="348" y2="5272" class="solid"></line>
    <line x1="424" y1="5224" x2="444" y2="5224" class="solid"></line>
    <line x1="444" y1="5224" x2="444" y2="5272" class="solid"></line>
    <line x1="348" y1="5272" x2="444" y2="5272" class="solid"></line>
  </g>
  <g>
    <path d="M 64,5192 A 3,3 0,0,0 62,5196" class="nofill"></path>
    <line x1="62" y1="5196" x2="72" y2="5216" class="solid"></line>
    <line x1="64" y1="5192" x2="120" y2="5192" class="solid"></line>
  </g>
  <g>
    <path d="M 192,5432 A 8,8 0,0,0 186,5436" class="nofill"></path>
    <line x1="186" y1="5436" x2="184" y2="5440" class="solid"></line>
    <line x1="192" y1="5432" x2="224" y2="5432" class="solid"></line>
    <path d="M 224,5432 A 4,4 0,0,1 228,5436" class="nofill"></path>
    <line x1="228" y1="5436" x2="228" y2="5524" class="solid"></line>
    <path d="M 184,5440 A 16,16 0,0,0 184,5456" class="nofill"></path>
    <path d="M 192,5448 A 8,8 0,0,0 186,5452" class="nofill"></path>
    <line x1="186" y1="5452" x2="184" y2="5456" class="solid"></line>
    <line x1="192" y1="5448" x2="200" y2="5448" class="solid"></line>
    <path d="M 184,5456 A 16,16 0,0,0 184,5472" class="nofill"></path>
    <path d="M 208,5440 A 16,16 0,0,1 208,5456" class="nofill"></path>
    <line x1="208" y1="5456" x2="206" y2="5460" class="solid"></line>
    <path d="M 208,5456 A 16,16 0,0,1 208,5472" class="nofill"></path>
    <line x1="208" y1="5472" x2="206" y2="5476" class="solid"></line>
    <path d="M 208,5472 A 16,16 0,0,1 208,5488" class="nofill"></path>
    <line x1="208" y1="5488" x2="206" y2="5492" class="solid"></line>
    <path d="M 192,5464 A 8,8 0,0,0 186,5468" class="nofill"></path>
    <line x1="186" y1="5468" x2="184" y2="5472" class="solid"></line>
    <line x1="192" y1="5464" x2="200" y2="5464" class="solid"></line>
    <path d="M 206,5460 A 8,8 0,0,1 200,5464" class="nofill"></path>
    <path d="M 184,5472 A 16,16 0,0,0 184,5488" class="nofill"></path>
    <path d="M 192,5480 A 8,8 0,0,0 186,5484" class="nofill"></path>
    <line x1="186" y1="5484" x2="184" y2="5488" class="solid"></line>
    <line x1="192" y1="5480" x2="200" y2="5480" class="solid"></line>
    <path d="M 206,5476 A 8,8 0,0,1 200,5480" class="nofill"></path>
    <path d="M 180,5488 A 12,12 0,0,0 180,5504" class="nofill"></path>
    <path d="M 188,5496 A 8,8 0,0,0 180,5504" class="nofill"></path>
    <line x1="188" y1="5496" x2="200" y2="5496" class="solid"></line>
    <path d="M 206,5492 A 8,8 0,0,1 200,5496" class="nofill"></path>
    <line x1="180" y1="5504" x2="180" y2="5524" class="solid"></line>
    <line x1="260" y1="5504" x2="292" y2="5504" class="solid"></line>
    <line x1="260" y1="5504" x2="260" y2="5524" class="solid"></line>
    <line x1="260" y1="5520" x2="292" y2="5520" class="solid"></line>
    <line x1="292" y1="5504" x2="292" y2="5524" class="solid"></line>
    <path d="M 144,5528 A 4,4 0,0,0 140,5532" class="nofill"></path>
    <line x1="140" y1="5532" x2="140" y2="5540" class="solid"></line>
    <line x1="144" y1="5528" x2="176" y2="5528" class="solid"></line>
    <path d="M 180,5524 A 4,4 0,0,1 176,5528" class="nofill"></path>
    <path d="M 180,5524 A 4,4 0,0,0 184,5528" class="nofill"></path>
    <line x1="184" y1="5528" x2="224" y2="5528" class="solid"></line>
    <path d="M 228,5524 A 4,4 0,0,1 224,5528" class="nofill"></path>
    <path d="M 228,5524 A 4,4 0,0,0 232,5528" class="nofill"></path>
    <line x1="232" y1="5528" x2="256" y2="5528" class="solid"></line>
    <line x1="264" y1="5520" x2="256" y2="5528" class="solid"></line>
    <path d="M 260,5524 A 4,4 0,0,1 256,5528" class="nofill"></path>
    <path d="M 260,5524 A 4,4 0,0,0 264,5528" class="nofill"></path>
    <line x1="264" y1="5528" x2="288" y2="5528" class="solid"></line>
    <path d="M 292,5524 A 4,4 0,0,1 288,5528" class="nofill"></path>
    <path d="M 140,5540 A 4,4 0,0,0 144,5544" class="nofill"></path>
    <line x1="144" y1="5544" x2="296" y2="5544" class="solid"></line>
  </g>
  <g>
    <path d="M 360,5672 A 8,8 0,0,0 354,5676" class="nofill"></path>
    <line x1="360" y1="5672" x2="376" y2="5672" class="solid"></line>
  </g>
  <g>
    <path d="M 344,5704 A 8,8 0,0,0 338,5708" class="nofill"></path>
    <line x1="344" y1="5704" x2="376" y2="5704" class="solid"></line>
  </g>
  <g>
    <line x1="160" y1="5720" x2="216" y2="5720" class="solid"></line>
    <path d="M 216,5720 A 8,8 0,0,1 222,5724" class="nofill"></path>
  </g>
  <g>
    <path d="M 256,5832 A 8,8 0,0,0 250,5836" class="nofill"></path>
    <line x1="250" y1="5836" x2="248" y2="5840" class="solid"></line>
    <line x1="256" y1="5832" x2="280" y2="5832" class="solid"></line>
    <path d="M 280,5832 A 8,8 0,0,1 286,5836" class="nofill"></path>
    <line x1="286" y1="5836" x2="288" y2="5840" class="solid"></line>
    <path d="M 248,5840 A 16,16 0,0,0 248,5856" class="nofill"></path>
    <path d="M 288,5840 A 16,16 0,0,1 288,5856" class="nofill"></path>
    <line x1="248" y1="5856" x2="250" y2="5860" class="solid"></line>
    <path d="M 250,5860 A 8,8 0,0,0 256,5864" class="nofill"></path>
    <line x1="256" y1="5864" x2="280" y2="5864" class="solid"></line>
    <line x1="288" y1="5856" x2="286" y2="5860" class="solid"></line>
    <path d="M 286,5860 A 8,8 0,0,1 280,5864" class="nofill"></path>
  </g>
  <g>
    <line x1="304" y1="5832" x2="320" y2="5832" class="solid"></line>
    <line x1="320" y1="5832" x2="328" y2="5840" class="solid"></line>
    <line x1="328" y1="5840" x2="352" y2="5840" class="solid"></line>
    <line x1="352" y1="5840" x2="360" y2="5848" class="solid"></line>
  </g>
  <g>
    <line x1="304" y1="5872" x2="330" y2="5924" class="solid"></line>
    <path d="M 330,5924 A 8,8 0,0,0 336,5928" class="nofill"></path>
    <line x1="336" y1="5928" x2="384" y2="5928" class="solid"></line>
    <line x1="372" y1="5928" x2="386" y2="5956" class="solid"></line>
    <path d="M 386,5956 A 8,8 0,0,0 392,5960" class="nofill"></path>
    <line x1="392" y1="5960" x2="424" y2="5960" class="solid"></line>
  </g>
  <g>
    <line x1="248" y1="5888" x2="238" y2="5908" class="solid"></line>
    <path d="M 216,5912 A 8,8 0,0,0 210,5916" class="nofill"></path>
    <line x1="210" y1="5916" x2="196" y2="5944" class="solid"></line>
    <line x1="216" y1="5912" x2="232" y2="5912" class="solid"></line>
    <path d="M 238,5908 A 8,8 0,0,1 232,5912" class="nofill"></path>
    <line x1="196" y1="5944" x2="196" y2="5976" class="solid"></line>
    <line x1="196" y1="5976" x2="174" y2="6020" class="solid"></line>
  </g>
  <g>
    <line x1="280" y1="5888" x2="344" y2="6016" class="solid"></line>
    <line x1="344" y1="6016" x2="354" y2="6036" class="solid"></line>
    <path d="M 354,6036 A 8,8 0,0,0 360,6040" class="nofill"></path>
    <line x1="360" y1="6040" x2="376" y2="6040" class="solid"></line>
  </g>
  <g>
    <line x1="296" y1="5888" x2="346" y2="5988" class="solid"></line>
    <path d="M 346,5988 A 8,8 0,0,0 352,5992" class="nofill"></path>
    <line x1="352" y1="5992" x2="392" y2="5992" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="5984" x2="196" y2="6008" class="solid"></line>
    <line x1="196" y1="6008" x2="174" y2="6052" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="6016" x2="196" y2="6036" class="solid"></line>
    <path d="M 196,6036 A 16,16 0,0,1 194,6044" class="nofill"></path>
    <line x1="194" y1="6044" x2="174" y2="6084" class="solid"></line>
  </g>
  <g>
    <line x1="408" y1="5712" x2="418" y2="5732" class="solid"></line>
    <path d="M 418,5732 A 8,8 0,0,0 424,5736" class="nofill"></path>
    <line x1="424" y1="5736" x2="448" y2="5736" class="solid"></line>
  </g>
  <g>
    <line x1="424" y1="5744" x2="434" y2="5764" class="solid"></line>
    <path d="M 434,5764 A 8,8 0,0,0 440,5768" class="nofill"></path>
    <line x1="440" y1="5768" x2="456" y2="5768" class="solid"></line>
  </g>
  <g>
    <line x1="136" y1="5776" x2="170" y2="5844" class="solid"></line>
    <path d="M 170,5844 A 8,8 0,0,0 176,5848" class="nofill"></path>
    <line x1="176" y1="5848" x2="224" y2="5848" class="solid"></line>
  </g>
  <g>
    <line x1="464" y1="5824" x2="520" y2="5824" class="solid"></line>
    <line x1="464" y1="5824" x2="456" y2="5840" class="solid"></line>
    <line x1="520" y1="5824" x2="528" y2="5840" class="solid"></line>
  </g>
  <g>
    <line x1="456" y1="5856" x2="464" y2="5872" class="solid"></line>
    <line x1="464" y1="5872" x2="520" y2="5872" class="solid"></line>
    <line x1="528" y1="5856" x2="520" y2="5872" class="solid"></line>
  </g>
  <g>
    <line x1="196" y1="6208" x2="228" y2="6208" class="solid"></line>
    <line x1="184" y1="6216" x2="196" y2="6216" class="solid"></line>
    <line x1="196" y1="6208" x2="196" y2="6224" class="solid"></line>
    <line x1="196" y1="6224" x2="228" y2="6224" class="solid"></line>
    <line x1="228" y1="6208" x2="228" y2="6224" class="solid"></line>
  </g>
  <g>
    <line x1="132" y1="6220" x2="132" y2="6256" class="solid"></line>
    <line x1="120" y1="6256" x2="144" y2="6256" class="solid"></line>
  </g>
  <g>
    <line x1="180" y1="6220" x2="180" y2="6292" class="solid"></line>
    <path d="M 180,6292 A 4,4 0,0,0 184,6296" class="nofill"></path>
    <line x1="184" y1="6296" x2="200" y2="6296" class="solid"></line>
    <path d="M 200,6296 A 4,4 0,0,1 204,6300" class="nofill"></path>
    <line x1="204" y1="6300" x2="204" y2="6328" class="solid"></line>
    <line x1="244" y1="6220" x2="244" y2="6328" class="solid"></line>
    <line x1="268" y1="6220" x2="268" y2="6248" class="solid"></line>
    <path d="M 264,6248 A 4,4 0,0,0 260,6252" class="nofill"></path>
    <line x1="260" y1="6252" x2="260" y2="6292" class="solid"></line>
    <line x1="264" y1="6248" x2="272" y2="6248" class="solid"></line>
    <path d="M 272,6248 A 4,4 0,0,1 276,6252" class="nofill"></path>
    <line x1="276" y1="6252" x2="276" y2="6292" class="solid"></line>
    <path d="M 260,6292 A 4,4 0,0,0 264,6296" class="nofill"></path>
    <line x1="264" y1="6296" x2="272" y2="6296" class="solid"></line>
    <line x1="268" y1="6296" x2="268" y2="6328" class="solid"></line>
    <path d="M 276,6292 A 4,4 0,0,1 272,6296" class="nofill"></path>
    <path d="M 192,6328 A 4,4 0,0,0 188,6332" class="nofill"></path>
    <line x1="188" y1="6332" x2="188" y2="6580" class="solid"></line>
    <line x1="192" y1="6328" x2="288" y2="6328" class="solid"></line>
    <path d="M 288,6328 A 4,4 0,0,1 292,6332" class="nofill"></path>
    <line x1="292" y1="6332" x2="292" y2="6580" class="solid"></line>
    <line x1="292" y1="6568" x2="356" y2="6568" class="solid"></line>
    <line x1="356" y1="6560" x2="356" y2="6576" class="solid"></line>
    <path d="M 188,6580 A 4,4 0,0,0 192,6584" class="nofill"></path>
    <line x1="192" y1="6584" x2="288" y2="6584" class="solid"></line>
    <line x1="236" y1="6584" x2="236" y2="6644" class="solid"></line>
    <line x1="276" y1="6584" x2="276" y2="6612" class="solid"></line>
    <path d="M 292,6580 A 4,4 0,0,1 288,6584" class="nofill"></path>
    <path d="M 276,6612 A 4,4 0,0,0 280,6616" class="nofill"></path>
    <path d="M 128,6424 A 4,4 0,0,0 124,6428" class="nofill"></path>
    <line x1="124" y1="6428" x2="124" y2="6528" class="solid"></line>
    <line x1="128" y1="6424" x2="188" y2="6424" class="solid"></line>
    <line x1="96" y1="6528" x2="168" y2="6528" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="6220" x2="348" y2="6296" class="solid"></line>
    <path d="M 344,6296 A 4,4 0,0,0 340,6300" class="nofill"></path>
    <line x1="340" y1="6300" x2="340" y2="6340" class="solid"></line>
    <line x1="344" y1="6296" x2="352" y2="6296" class="solid"></line>
    <path d="M 352,6296 A 4,4 0,0,1 356,6300" class="nofill"></path>
    <line x1="356" y1="6300" x2="356" y2="6340" class="solid"></line>
    <path d="M 340,6340 A 4,4 0,0,0 344,6344" class="nofill"></path>
    <line x1="344" y1="6344" x2="352" y2="6344" class="solid"></line>
    <line x1="348" y1="6344" x2="348" y2="6372" class="solid"></line>
    <path d="M 356,6340 A 4,4 0,0,1 352,6344" class="nofill"></path>
  </g>
  <g>
    <line x1="388" y1="6220" x2="388" y2="6344" class="solid"></line>
    <line x1="388" y1="6344" x2="372" y2="6376" class="solid"></line>
    <line x1="372" y1="6352" x2="372" y2="6400" class="solid"></line>
    <line x1="352" y1="6376" x2="372" y2="6376" class="solid"></line>
  </g>
  <g>
    <line x1="392" y1="6216" x2="448" y2="6216" class="solid"></line>
    <path d="M 448,6216 A 4,4 0,0,1 452,6220" class="nofill"></path>
    <line x1="452" y1="6220" x2="452" y2="6288" class="solid"></line>
    <line x1="440" y1="6288" x2="464" y2="6288" class="solid"></line>
    <line x1="440" y1="6288" x2="452" y2="6312" class="solid"></line>
    <line x1="464" y1="6288" x2="452" y2="6312" class="solid"></line>
    <line x1="440" y1="6312" x2="464" y2="6312" class="solid"></line>
    <line x1="452" y1="6312" x2="452" y2="6424" class="solid"></line>
    <line x1="436" y1="6416" x2="436" y2="6464" class="solid"></line>
    <line x1="436" y1="6424" x2="452" y2="6424" class="solid"></line>
    <line x1="436" y1="6440" x2="448" y2="6440" class="solid"></line>
    <line x1="436" y1="6456" x2="452" y2="6456" class="solid"></line>
  </g>
  <g>
    <line x1="128" y1="6264" x2="140" y2="6264" class="solid"></line>
    <path d="M 140,6264 A 8,8 0,0,1 148,6272" class="nofill"></path>
  </g>
  <g>
    <line x1="132" y1="6316" x2="132" y2="6336" class="solid"></line>
    <line x1="104" y1="6336" x2="160" y2="6336" class="solid"></line>
  </g>
  <g>
    <line x1="348" y1="6380" x2="348" y2="6408" class="solid"></line>
    <path d="M 344,6408 A 4,4 0,0,0 340,6412" class="nofill"></path>
    <line x1="340" y1="6412" x2="340" y2="6452" class="solid"></line>
    <line x1="344" y1="6408" x2="352" y2="6408" class="solid"></line>
    <path d="M 352,6408 A 4,4 0,0,1 356,6412" class="nofill"></path>
    <line x1="356" y1="6412" x2="356" y2="6452" class="solid"></line>
    <path d="M 340,6452 A 4,4 0,0,0 344,6456" class="nofill"></path>
    <line x1="344" y1="6456" x2="352" y2="6456" class="solid"></line>
    <line x1="348" y1="6456" x2="348" y2="6484" class="solid"></line>
    <path d="M 356,6452 A 4,4 0,0,1 352,6456" class="nofill"></path>
    <path d="M 348,6484 A 4,4 0,0,0 352,6488" class="nofill"></path>
    <line x1="352" y1="6488" x2="384" y2="6488" class="solid"></line>
    <line x1="388" y1="6428" x2="388" y2="6484" class="solid"></line>
    <path d="M 388,6484 A 4,4 0,0,1 384,6488" class="nofill"></path>
  </g>
  <g>
    <line x1="392" y1="6424" x2="428" y2="6424" class="solid"></line>
    <line x1="428" y1="6416" x2="428" y2="6464" class="solid"></line>
  </g>
  <g>
    <line x1="456" y1="6488" x2="476" y2="6488" class="solid"></line>
    <line x1="476" y1="6480" x2="476" y2="6496" class="solid"></line>
  </g>
  <g>
    <line x1="124" y1="6544" x2="124" y2="6644" class="solid"></line>
    <path d="M 124,6644 A 4,4 0,0,0 128,6648" class="nofill"></path>
  </g>
  <g>
    <line x1="364" y1="6560" x2="364" y2="6576" class="solid"></line>
    <line x1="364" y1="6568" x2="384" y2="6568" class="solid"></line>
    <path d="M 384,6568 A 4,4 0,0,1 388,6572" class="nofill"></path>
    <line x1="388" y1="6572" x2="388" y2="6612" class="solid"></line>
  </g>
  <g>
    <line x1="500" y1="6620" x2="500" y2="6644" class="solid"></line>
    <line x1="452" y1="6640" x2="484" y2="6640" class="solid"></line>
    <line x1="432" y1="6648" x2="452" y2="6648" class="solid"></line>
    <line x1="452" y1="6640" x2="452" y2="6656" class="solid"></line>
    <line x1="452" y1="6656" x2="484" y2="6656" class="solid"></line>
    <line x1="484" y1="6640" x2="484" y2="6656" class="solid"></line>
    <line x1="484" y1="6648" x2="496" y2="6648" class="solid"></line>
    <path d="M 500,6644 A 4,4 0,0,1 496,6648" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="6648" x2="292" y2="6648" class="solid"></line>
    <line x1="296" y1="6640" x2="288" y2="6656" class="solid"></line>
    <line x1="296" y1="6640" x2="304" y2="6656" class="solid"></line>
    <line x1="312" y1="6640" x2="304" y2="6656" class="solid"></line>
    <line x1="312" y1="6640" x2="320" y2="6656" class="solid"></line>
    <line x1="328" y1="6640" x2="320" y2="6656" class="solid"></line>
  </g>
  <g>
    <line x1="428" y1="6652" x2="428" y2="6680" class="solid"></line>
    <path d="M 424,6680 A 4,4 0,0,0 420,6684" class="nofill"></path>
    <line x1="420" y1="6684" x2="420" y2="6724" class="solid"></line>
    <line x1="424" y1="6680" x2="432" y2="6680" class="solid"></line>
    <path d="M 432,6680 A 4,4 0,0,1 436,6684" class="nofill"></path>
    <line x1="436" y1="6684" x2="436" y2="6724" class="solid"></line>
    <path d="M 420,6724 A 4,4 0,0,0 424,6728" class="nofill"></path>
    <line x1="424" y1="6728" x2="432" y2="6728" class="solid"></line>
    <line x1="428" y1="6728" x2="428" y2="6752" class="solid"></line>
    <path d="M 436,6724 A 4,4 0,0,1 432,6728" class="nofill"></path>
  </g>
  <g>
    <line x1="80" y1="6944" x2="136" y2="6944" class="solid"></line>
    <line x1="80" y1="6944" x2="64" y2="6976" class="solid"></line>
    <line x1="136" y1="6944" x2="152" y2="6976" class="solid"></line>
    <line x1="64" y1="6976" x2="80" y2="7008" class="solid"></line>
    <line x1="152" y1="6976" x2="136" y2="7008" class="solid"></line>
    <line x1="80" y1="7008" x2="136" y2="7008" class="solid"></line>
  </g>
  <g>
    <path d="M 256,6888 A 8,8 0,0,0 250,6892" class="nofill"></path>
    <line x1="250" y1="6892" x2="248" y2="6896" class="solid"></line>
    <line x1="256" y1="6888" x2="304" y2="6888" class="solid"></line>
    <path d="M 304,6888 A 8,8 0,0,1 310,6892" class="nofill"></path>
    <line x1="310" y1="6892" x2="312" y2="6896" class="solid"></line>
    <path d="M 248,6896 A 16,16 0,0,0 248,6912" class="nofill"></path>
    <path d="M 312,6896 A 16,16 0,0,1 312,6912" class="nofill"></path>
    <line x1="248" y1="6912" x2="250" y2="6916" class="solid"></line>
    <path d="M 250,6916 A 8,8 0,0,0 256,6920" class="nofill"></path>
    <line x1="256" y1="6920" x2="304" y2="6920" class="solid"></line>
    <line x1="312" y1="6912" x2="310" y2="6916" class="solid"></line>
    <path d="M 310,6916 A 8,8 0,0,1 304,6920" class="nofill"></path>
  </g>
  <g>
    <line x1="232" y1="6944" x2="296" y2="6944" class="solid"></line>
    <line x1="232" y1="6944" x2="240" y2="6960" class="solid"></line>
    <line x1="296" y1="6944" x2="304" y2="6960" class="solid"></line>
    <path d="M 240,6960 A 16,16 0,0,1 240,6976" class="nofill"></path>
    <path d="M 304,6960 A 16,16 0,0,1 304,6976" class="nofill"></path>
    <line x1="240" y1="6976" x2="232" y2="6992" class="solid"></line>
    <line x1="232" y1="6992" x2="296" y2="6992" class="solid"></line>
    <line x1="304" y1="6976" x2="296" y2="6992" class="solid"></line>
  </g>
  <g>
    <line x1="200" y1="6944" x2="184" y2="6976" class="solid"></line>
    <line x1="200" y1="6944" x2="216" y2="6976" class="solid"></line>
    <line x1="184" y1="6976" x2="200" y2="7008" class="solid"></line>
    <line x1="216" y1="6976" x2="200" y2="7008" class="solid"></line>
  </g>
  <g>
    <path d="M 216,7208 A 3,3 0,0,0 214,7212" class="nofill"></path>
    <line x1="214" y1="7212" x2="236" y2="7256" class="solid"></line>
    <line x1="216" y1="7208" x2="256" y2="7208" class="solid"></line>
    <path d="M 256,7208 A 3,3 0,0,1 258,7212" class="nofill"></path>
    <line x1="258" y1="7212" x2="236" y2="7256" class="solid"></line>
  </g>
  <g>
    <path d="M 280,7208 A 3,3 0,0,0 278,7212" class="nofill"></path>
    <line x1="278" y1="7212" x2="298" y2="7252" class="solid"></line>
    <line x1="280" y1="7208" x2="312" y2="7208" class="solid"></line>
    <path d="M 312,7208 A 8,8 0,0,1 318,7212" class="nofill"></path>
    <line x1="318" y1="7212" x2="338" y2="7252" class="solid"></line>
    <path d="M 298,7252 A 8,8 0,0,0 304,7256" class="nofill"></path>
    <line x1="304" y1="7256" x2="336" y2="7256" class="solid"></line>
    <path d="M 338,7252 A 3,3 0,0,1 336,7256" class="nofill"></path>
  </g>
  <g>
    <path d="M 24,7368 A 8,8 0,0,0 18,7372" class="nofill"></path>
    <line x1="18" y1="7372" x2="6" y2="7396" class="solid"></line>
    <line x1="24" y1="7368" x2="128" y2="7368" class="solid"></line>
    <path d="M 128,7368 A 3,3 0,0,1 130,7372" class="nofill"></path>
    <line x1="130" y1="7372" x2="118" y2="7396" class="solid"></line>
    <path d="M 6,7396 A 3,3 0,0,0 8,7400" class="nofill"></path>
    <line x1="8" y1="7400" x2="112" y2="7400" class="solid"></line>
    <path d="M 118,7396 A 8,8 0,0,1 112,7400" class="nofill"></path>
  </g>
</svg>
</p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Svgbob},
  date = {2024-11-15},
  url = {https://samforeman.me/posts/svgbob},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúSvgbob.‚Äù</span> November 15, 2024. <a href="https://samforeman.me/posts/svgbob">https://samforeman.me/posts/svgbob</a>.
</div></div></section></div> ]]></description>
  <category>diagrams</category>
  <category>style</category>
  <guid>https://samforeman.me/posts/svgbob/</guid>
  <pubDate>Fri, 15 Nov 2024 06:00:00 GMT</pubDate>
</item>
<item>
  <title>üíæ Converting Checkpoints</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/checkpoints/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="mds-hf" class="level2">
<h2 class="anchored" data-anchor-id="mds-hf">MDS ‚Äì&gt; HF</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convert_mds_to_hf()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb1-2"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GLOBAL_STEP=$1</span></span>
<span id="cb1-3"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CKPT_ROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$2</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CKPT_ROOT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/Aurora_deployment/AuroraGPT-Testing/foremans/rollback-41k8/Megatron-DeepSpeed-41800/checkpoints/ws768_ds_stage1_nl32_hs4096_mb4_seq4096_gb3072_sp1_pp1_tp1_bf16_optadamw_lr0.00020_lwf0.05/"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-6"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SRC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CKPT_ROOT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/global_step</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-7"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb1-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Converting checkpoint @ global step </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\tsrc=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/flare/Aurora_deployment/AuroraGPT-Checkpoints/Megatron-DeepSpeed/checkpoints-to-convert/ws768_ds_stage1_nl32_hs4096_mb4_seq4096_gb3072_sp1_pp1_tp1_bf16_optadamw_lr0.00020_lwf0.05/global_step</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GLOBAL_STEP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_hf"</span></span>
<span id="cb1-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\tdst=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> mds_to_hf.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--mds_checkpoint</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/mp_rank_00_model_states.pt"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output_dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cache_dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./.cache"</span></span>
<span id="cb1-13"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unable to locate directory </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SRC}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">. Exiting"</span></span>
<span id="cb1-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb1-16"> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb1-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="hf-to-meg-ds" class="level1">
<h1>üöß HF to Meg-DS</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">2024-10-17</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ez</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> deepspeed</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoTokenizer, AutoConfig, AutoModelForCausalLM</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.integrations <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HfDeepSpeedConfig</span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># distributed setup</span></span>
<span id="cb2-9"></span>
<span id="cb2-10">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'WORLD_SIZE'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'12'</span></span>
<span id="cb2-11">rank <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.setup_torch(backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span>)</span>
<span id="cb2-12">deepspeed.init_distributed()</span>
<span id="cb2-13">model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meta-llama/Llama-3.2-1B"</span></span>
<span id="cb2-14">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoConfig.from_pretrained(model_name)</span>
<span id="cb2-15">ds_config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb2-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steps_per_print"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_micro_batch_size_per_gpu"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span>: {</span>
<span id="cb2-20">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb2-21">    },</span>
<span id="cb2-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"optimizer"</span>: {</span>
<span id="cb2-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adam"</span>,</span>
<span id="cb2-24">    },</span>
<span id="cb2-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero_optimization"</span>: {</span>
<span id="cb2-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stage"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-27">    },</span>
<span id="cb2-28">}</span>
<span id="cb2-29"></span>
<span id="cb2-30">dschf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> HfDeepSpeedConfig(ds_config)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep this object alive</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now a model can be loaded.</span></span>
<span id="cb2-32">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(model_name).to(ez.get_torch_device()).to(torch.bfloat16)</span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialise Deepspeed ZeRO and store only the engine object</span></span>
<span id="cb2-34">ds_engine <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deepspeed.initialize(model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model, config_params<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ds_config)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb2-35">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(model_name)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> tokenize_function(examples):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> tokenizer(examples[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>], truncation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yelp_review_full"</span>)</span>
<span id="cb3-5">tokenized_datasets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dataset.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(tokenize_function, batched<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-6">small_train_dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenized_datasets[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train"</span>].shuffle(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>).select(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span>
<span id="cb3-7">small_eval_dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenized_datasets[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>].shuffle(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>).select(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Trainer</span>
<span id="cb4-2">training_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TrainingArguments(output_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama-3.2-1B"</span>, deepspeed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ds_config)</span>
<span id="cb4-3">trainer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Trainer(model, training_args, train_dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>small_train_dataset, eval_dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>small_eval_dataset, tokenizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer)</span></code></pre></div>
</section>
<section id="older" class="level2">
<h2 class="anchored" data-anchor-id="older">Older</h2>
<p>Current status:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1][üëª aurora_nre_models_frameworks-2024.2.1_u1]</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][03:39:06 PM][foremans]@[x4407c6s7b0n0][/f/A/f/p/a/Megatron-DeepSpeed][üå±hzheng-data-fix][üìùü§∑üèéüí®]</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> _conversion_args=<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hf-ckpt-num-shards 1"</span></span>
<span id="cb5-4"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hf-ckpt-dir /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512"</span></span>
<span id="cb5-5"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--load-mode auto"</span></span>
<span id="cb5-6"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--save ckpt-mds-llama-3/"</span></span>
<span id="cb5-7"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tensor-model-parallel-size 1"</span></span>
<span id="cb5-8"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--pipeline-model-parallel-size 1"</span></span>
<span id="cb5-9"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-warmup-iters 2000"</span></span>
<span id="cb5-10"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--weight-decay 0.1"</span></span>
<span id="cb5-11"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--clip-grad 1"</span></span>
<span id="cb5-12"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-layers 32"</span></span>
<span id="cb5-13"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hidden-size 4096"</span></span>
<span id="cb5-14"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-attention-heads 32"</span></span>
<span id="cb5-15"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--ffn-hidden-size 14336"</span></span>
<span id="cb5-16"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--attention-dropout 0"</span></span>
<span id="cb5-17"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--hidden-dropout 0"</span></span>
<span id="cb5-18"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-query-key-layer-scaling"</span></span>
<span id="cb5-19"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--num-key-value-heads 8"</span></span>
<span id="cb5-20"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--disable-bias-linear"</span></span>
<span id="cb5-21"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--normalization rmsnorm"</span></span>
<span id="cb5-22"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--use-rotary-position-embeddings"</span></span>
<span id="cb5-23"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--untie-embeddings-and-output-weights"</span></span>
<span id="cb5-24"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--swiglu"</span></span>
<span id="cb5-25"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--seq-length 2048"</span></span>
<span id="cb5-26"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--max-position-embeddings 2048"</span></span>
<span id="cb5-27"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--micro-batch-size 1"</span></span>
<span id="cb5-28"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--global-batch-size 24"</span></span>
<span id="cb5-29"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--train-iters 3500"</span></span>
<span id="cb5-30"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr 2e-5"</span></span>
<span id="cb5-31"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tensorboard-dir tensorboard_output"</span></span>
<span id="cb5-32"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-decay-iters 320000"</span></span>
<span id="cb5-33"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--lr-decay-style cosine"</span></span>
<span id="cb5-34"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--log-interval 1"</span></span>
<span id="cb5-35"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--eval-iters 100"</span></span>
<span id="cb5-36"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--eval-interval 100"</span></span>
<span id="cb5-37"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--data-path /lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document"</span></span>
<span id="cb5-38"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--save-interval 1500"</span></span>
<span id="cb5-39"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--split 100,0,0"</span></span>
<span id="cb5-40"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--bf16"</span></span>
<span id="cb5-41"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tokenizer-type HFTokenizer"</span></span>
<span id="cb5-42"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--tokenizer-model ALCF/custom_tokenizer.model"</span></span>
<span id="cb5-43"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--deepspeed_config ./examples_deepspeed/finetune_hf_llama/ds_config.json"</span></span>
<span id="cb5-44"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--deepspeed"</span></span>
<span id="cb5-45"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--distributed-backend ccl"</span></span>
<span id="cb5-46"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-masked-softmax-fusion"</span></span>
<span id="cb5-47"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-bias-gelu-fusion"</span></span>
<span id="cb5-48"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-bias-dropout-fusion"</span></span>
<span id="cb5-49"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--no-gradient-accumulation-fusion"</span></span>
<span id="cb5-50"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--repeated-dataloader"</span></span>
<span id="cb5-51"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--data-cache-path ./.cache"</span></span>
<span id="cb5-52"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--make-vocab-size-divisible-by 128512"</span></span>
<span id="cb5-53"> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--vocab-size 128512"</span></span>
<span id="cb5-54"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-55"></span>
<span id="cb5-56"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">($(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s\n'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${_conversion_args</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb5-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--attention-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-cache-path</span> ./.cache <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> /lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span> ./examples_deepspeed/finetune_hf_llama/ds_config.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linear</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> ccl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> 100 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> 100 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> 14336 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hf-ckpt-dir</span> /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hf-ckpt-num-shards</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> 4096 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--load-mode</span> auto <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> 2e-5 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-iters</span> 320000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> cosine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> 2000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--make-vocab-size-divisible-by</span> 128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-bias-dropout-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-bias-gelu-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-gradient-accumulation-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-masked-softmax-fusion</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> rmsnorm <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--repeated-dataloader</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> ckpt-mds-llama-3/ <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> 1500 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> 100,0,0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglu</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> tensorboard_output <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> ALCF/custom_tokenizer.model <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> HFTokenizer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> 3500 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weights</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-size</span> 128512 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> 0.1</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2024.2.1_u1][üëª aurora_nre_models_frameworks-2024.2.1_u1]</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][03:39:18 PM][foremans]@[x4407c6s7b0n0][/f/A/f/p/a/Megatron-DeepSpeed][üå±hzheng-data-fix][üìùü§∑üèéüí®]</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 tools/hf2megads_weight_converter.py <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${conversion_flags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<details closed="">
<summary>
output:
</summary>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Disabling</span> local launch: multi-node application</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /flare/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/python3</span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application bdbd987f-b27b-4922-928b-5d1a166e800b</span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,424] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,456] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,457] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,568] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,571] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,575] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,578] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,584] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,608] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,614] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,615] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,630] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,686] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,698] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,711] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,716] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,723] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,724] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,726] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,731] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,737] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,755] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,766] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,780] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,798] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,840] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,870] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,870] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,872] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,873] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,877] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,896] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,902] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,932] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,934] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,957] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:30,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,028] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,029] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:31,150] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:219:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,079] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,481] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,982] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,983] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:33,984] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,165] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,207] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,210] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,216] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,218] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,218] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,219] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,271] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,772] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,784] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:34,795] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,038] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,048] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,062] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,070] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,073] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,078] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,078] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,103] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,104] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,104] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,106] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:667:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=13, local_rank=1, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=15, local_rank=3, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=16, local_rank=4, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=17, local_rank=5, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=12, local_rank=0, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=14, local_rank=2, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=0, local_rank=0, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:683:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb7-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=18, local_rank=6, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=19, local_rank=7, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=20, local_rank=8, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=21, local_rank=9, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=22, local_rank=10, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=23, local_rank=11, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=1, local_rank=1, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=2, local_rank=2, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=3, local_rank=3, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=4, local_rank=4, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=5, local_rank=5, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=6, local_rank=6, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=7, local_rank=7, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=8, local_rank=8, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=9, local_rank=9, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=10, local_rank=10, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35,107] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:718:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=11, local_rank=11, world_size=24, master_addr=10.115.45.184, master_port=29500</span>
<span id="cb7-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.116490]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=15/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.117455]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34466</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169066</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.120281]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=10/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.120280]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=11/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169075</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169076</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.124730]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=4/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.125260]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=6/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.125427]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169069</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169068</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169071</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.127167]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=8/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.127199]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=21/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169073</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34472</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129097]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=14/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129281]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=9/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129345]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=22/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.129461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=20/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34465</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.130518]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=13/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34473</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169074</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34471</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34464</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.131822]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=18/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.131816]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=19/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34469</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.133183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=7/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34470</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169072</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.192746]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.192682]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=5/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.193446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=17/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169067</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.193506]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=12/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169070</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.194435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=23/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.194529]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=16/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34468</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34463</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34467</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34474</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.198383]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:92</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb7-197"></span>
<span id="cb7-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb7-199">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=xpu</span>
<span id="cb7-200">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=xpu:0</span>
<span id="cb7-201">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=ccl</span>
<span id="cb7-202">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=12</span>
<span id="cb7-203">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4308c2s5b0n0.hostmgmt2308.cm.aurora.alcf.anl.gov'</span>]</span>
<span id="cb7-204">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/886439.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-205">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x4407c6s7b0n0.hostmgmt2407.cm.aurora.alcf.anl.gov</span>
<span id="cb7-206">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb7-207">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Aurora</span>
<span id="cb7-208">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=2</span>
<span id="cb7-209">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=24</span>
<span id="cb7-210">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=24</span>
<span id="cb7-211">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb7-212">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb7-213">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb7-214">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=24</span>
<span id="cb7-215">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=24</span>
<span id="cb7-216">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/886439.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb7-217"></span>
<span id="cb7-218"></span>
<span id="cb7-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DeepSpeed</span> C++/CUDA extension op report</span>
<span id="cb7-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NOTE:</span> Ops not installed will be just-in-time <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compiled</span> at</span>
<span id="cb7-223">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">runtime</span> if needed. Op compatibility means that your system</span>
<span id="cb7-224">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">meet</span> the required dependencies to JIT install the op.</span>
<span id="cb7-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span> compiled ops requires ninja</span>
<span id="cb7-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ninja</span> .................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">op</span> name ................ installed .. compatible</span>
<span id="cb7-230"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_not_implemented</span>  <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-232"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING]</span>  async_io requires the dev libaio .so object and headers but these were not found.</span>
<span id="cb7-233"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[WARNING]</span>  If libaio is already installed <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">perhaps</span> from source<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> try setting the CFLAGS and LDFLAGS environment variables to where it can be found.</span>
<span id="cb7-234"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">async_io</span> ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_adagrad</span> ............ <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_adam</span> ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">flash_attn</span> ............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fused_adam</span> ............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_inference</span> .. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pack_bits</span> .............. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">NO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> ....... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DeepSpeed</span> general environment info:</span>
<span id="cb7-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> install path ............... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> version .................... 2.3.1+cxx11.abi</span>
<span id="cb7-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> install path ........... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/deps/DeepSpeed/deepspeed'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> info ................... 0.15.3+unknown, unknown, unknown</span>
<span id="cb7-247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> wheel compiled w. ...... torch 2.3</span>
<span id="cb7-248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shared</span> memory <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/dev/shm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">size</span> .... 503.18 GB</span>
<span id="cb7-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.319255]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">configs.py:272</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">****</span> Git info for DeepSpeed: git_hash=7ef26bf git_branch=hzheng-data-fix <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">****</span></span>
<span id="cb7-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.319927]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using oneccl_bindings from: /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/oneccl_bindings_for_pytorch/__init__.py</span>
<span id="cb7-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.320347]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:727</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using ipex from: /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/intel_extension_for_pytorch/__init__.py</span>
<span id="cb7-252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.320734]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:728</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/24</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb7-253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.325748]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:35.326291]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_logger.py:68</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [24 / 24] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span> devices !!</span>
<span id="cb7-255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_KVS_MODE changed to be mpi <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:pmi</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_KVS_CONNECTION_TIMEOUT changed to be 3600 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:120</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_BCAST changed to be double_tree <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_ENABLE_SYCL_KERNELS changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_SYCL_ESIMD changed to be 1 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_PROCESS_LAUNCHER changed to be pmix <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:hydra</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">value</span> of CCL_ZE_CACHE_OPEN_IPC_HANDLES_THRESHOLD changed to be 32768 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">default:1000</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CCL_ALLGATHERV_MEDIUM_SIZE_THRESHOLD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.</span>
<span id="cb7-263"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CCL_SKIP_SCHEDULER</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">is</span> unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.</span>
<span id="cb7-264"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:10:16-15:39:35:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">169065</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MPI</span> was initialized externally, CCL-MPI specific environment is ignored</span>
<span id="cb7-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">using</span> world size: 24, data-parallel-size: 24, sequence-parallel size: 1, tensor-model-parallel size: 1, pipeline-model-parallel size: 1</span>
<span id="cb7-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">accumulate</span> and all-reduce gradients in fp32 for bfloat16 data type.</span>
<span id="cb7-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">using</span> torch.bfloat16 for parameters ...</span>
<span id="cb7-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">------------------------</span> arguments <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">------------------------</span></span>
<span id="cb7-269">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">accumulate_allreduce_grads_in_fp32</span> .............. True</span>
<span id="cb7-270">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_beta1</span> ...................................... 0.9</span>
<span id="cb7-271">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_beta2</span> ...................................... 0.999</span>
<span id="cb7-272">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adam_eps</span> ........................................ 1e-08</span>
<span id="cb7-273">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add_bias_linear</span> ................................. False</span>
<span id="cb7-274">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">add_position_embedding</span> .......................... False</span>
<span id="cb7-275">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adlr_autoresume</span> ................................. False</span>
<span id="cb7-276">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">adlr_autoresume_interval</span> ........................ 1000</span>
<span id="cb7-277">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aml_data_download_path</span> .......................... None</span>
<span id="cb7-278">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_layernorm_1p</span> .............................. False</span>
<span id="cb7-279">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_query_key_layer_scaling</span> ................... False</span>
<span id="cb7-280">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apply_residual_connection_post_layernorm</span> ........ False</span>
<span id="cb7-281">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">async_tensor_model_parallel_allreduce</span> ........... False</span>
<span id="cb7-282">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span> ............................... 0.0</span>
<span id="cb7-283">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_softmax_in_fp32</span> ....................... False</span>
<span id="cb7-284">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">barrier_with_L1_time</span> ............................ True</span>
<span id="cb7-285">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_binary_head</span> ................................ True</span>
<span id="cb7-286">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_embedder_type</span> .............................. megatron</span>
<span id="cb7-287">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bert_load</span> ....................................... None</span>
<span id="cb7-288">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bf16</span> ............................................ True</span>
<span id="cb7-289">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bias_dropout_fusion</span> ............................. False</span>
<span id="cb7-290">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bias_gelu_fusion</span> ................................ False</span>
<span id="cb7-291">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">biencoder_projection_dim</span> ........................ 0</span>
<span id="cb7-292">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">biencoder_shared_query_context_model</span> ............ False</span>
<span id="cb7-293">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">block_data_path</span> ................................. None</span>
<span id="cb7-294">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_activations</span> .......................... False</span>
<span id="cb7-295">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_in_cpu</span> ............................... False</span>
<span id="cb7-296">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">checkpoint_num_layers</span> ........................... 1</span>
<span id="cb7-297">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">classes_fraction</span> ................................ 1.0</span>
<span id="cb7-298">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clip_grad</span> ....................................... 1.0</span>
<span id="cb7-299">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compression_training</span> ............................ False</span>
<span id="cb7-300">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_train_samples</span> .......................... 0</span>
<span id="cb7-301">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_train_tokens</span> ........................... 0</span>
<span id="cb7-302">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">consumed_valid_samples</span> .......................... 0</span>
<span id="cb7-303">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">contigious_checkpointing</span> ........................ False</span>
<span id="cb7-304">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_optimizer</span> ................................... False</span>
<span id="cb7-305">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpu_torch_adam</span> .................................. False</span>
<span id="cb7-306">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">create_moe_param_group</span> .......................... False</span>
<span id="cb7-307">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curriculum_learning_legacy</span> ...................... False</span>
<span id="cb7-308">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_cache_path</span> ................................. ./.cache</span>
<span id="cb7-309">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_efficiency_curriculum_learning</span> ............. False</span>
<span id="cb7-310">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_file_list</span> .................................. None</span>
<span id="cb7-311">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_impl</span> ....................................... infer</span>
<span id="cb7-312">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_parallel_random_init</span> ....................... False</span>
<span id="cb7-313">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_parallel_size</span> .............................. 24</span>
<span id="cb7-314">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_path</span> ....................................... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/candle_aesp_CNDA/azton/data/v2/megatron/dataset_v2_wtextbooks_text_document'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-315">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_per_class_fraction</span> ......................... 1.0</span>
<span id="cb7-316">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data_sharding</span> ................................... True</span>
<span id="cb7-317">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataloader_type</span> ................................. single</span>
<span id="cb7-318">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DDP_impl</span> ........................................ local</span>
<span id="cb7-319">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">decoder_num_layers</span> .............................. None</span>
<span id="cb7-320">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">decoder_seq_length</span> .............................. None</span>
<span id="cb7-321">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepscale</span> ....................................... False</span>
<span id="cb7-322">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepscale_config</span> ................................ None</span>
<span id="cb7-323">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed</span> ....................................... True</span>
<span id="cb7-324">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_activation_checkpointing</span> .............. False</span>
<span id="cb7-325">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">deepspeed_config</span> ................................ ./examples_deepspeed/finetune_hf_llama/ds_config.json</span>
<span id="cb7-326">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_bottleneck_size</span> ............................ 256</span>
<span id="cb7-327">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_freeze_last_layer</span> .......................... 1</span>
<span id="cb7-328">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_head_hidden_size</span> ........................... 2048</span>
<span id="cb7-329">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_local_crops_number</span> ......................... 10</span>
<span id="cb7-330">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_local_img_size</span> ............................. 96</span>
<span id="cb7-331">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_norm_last_layer</span> ............................ False</span>
<span id="cb7-332">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_teacher_temp</span> ............................... 0.07</span>
<span id="cb7-333">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_warmup_teacher_temp</span> ........................ 0.04</span>
<span id="cb7-334">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dino_warmup_teacher_temp_epochs</span> ................. 30</span>
<span id="cb7-335">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distribute_checkpointed_activations</span> ............. False</span>
<span id="cb7-336">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distribute_saved_activations</span> .................... False</span>
<span id="cb7-337">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distributed_backend</span> ............................. ccl</span>
<span id="cb7-338">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">distributed_timeout_minutes</span> ..................... 10</span>
<span id="cb7-339">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_fused_adam</span> ................................... False</span>
<span id="cb7-340">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_inference</span> .................................... False</span>
<span id="cb7-341">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_pipeline_enabled</span> ............................. True</span>
<span id="cb7-342">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ds_sequence_parallel_size</span> ....................... 1</span>
<span id="cb7-343">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_path</span> .................................. None</span>
<span id="cb7-344">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_weights_in_fp32</span> ....................... False</span>
<span id="cb7-345">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">empty_unused_memory_level</span> ....................... 0</span>
<span id="cb7-346">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_expert_tensor_parallelism</span> ................ False</span>
<span id="cb7-347">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_zbh1_exact_semantics</span> ..................... False</span>
<span id="cb7-348">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enable_zbh1_pipeline</span> ............................ False</span>
<span id="cb7-349">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encoder_num_layers</span> .............................. 32</span>
<span id="cb7-350">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encoder_seq_length</span> .............................. 2048</span>
<span id="cb7-351">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">end_weight_decay</span> ................................ 0.1</span>
<span id="cb7-352">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eod_mask_loss</span> ................................... False</span>
<span id="cb7-353">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_interval</span> ................................... 100</span>
<span id="cb7-354">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">eval_iters</span> ...................................... 100</span>
<span id="cb7-355">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">evidence_data_path</span> .............................. None</span>
<span id="cb7-356">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_duration_in_mins</span> ........................... None</span>
<span id="cb7-357">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_interval</span> ................................... None</span>
<span id="cb7-358">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_on_missing_checkpoint</span> ...................... False</span>
<span id="cb7-359">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">exit_signal_handler</span> ............................. False</span>
<span id="cb7-360">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">expert_interval</span> ................................. 2</span>
<span id="cb7-361">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ffn_hidden_size</span> ................................. 14336</span>
<span id="cb7-362">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">finetune</span> ........................................ False</span>
<span id="cb7-363">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">force_ds_sequence_parallel</span> ...................... False</span>
<span id="cb7-364">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp16</span> ............................................ False</span>
<span id="cb7-365">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp16_lm_cross_entropy</span> ........................... False</span>
<span id="cb7-366">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp32_residual_connection</span> ........................ False</span>
<span id="cb7-367">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_amax_compute_algo</span> ........................... most_recent</span>
<span id="cb7-368">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_amax_history_len</span> ............................ 1</span>
<span id="cb7-369">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_e4m3</span> ........................................ False</span>
<span id="cb7-370">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_hybrid</span> ...................................... False</span>
<span id="cb7-371">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_interval</span> .................................... 1</span>
<span id="cb7-372">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_margin</span> ...................................... 0</span>
<span id="cb7-373">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fp8_wgrad</span> ....................................... True</span>
<span id="cb7-374">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global_batch_size</span> ............................... 24</span>
<span id="cb7-375">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gradient_accumulation_fusion</span> .................... False</span>
<span id="cb7-376">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">head_lr_mult</span> .................................... 1.0</span>
<span id="cb7-377">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hf_ckpt_dir</span> ..................................... /flare/Aurora_deployment/foremans/Meta-Llama-3.1-8B-128512</span>
<span id="cb7-378">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hf_ckpt_num_shards</span> .............................. 1</span>
<span id="cb7-379">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_dropout</span> .................................. 0.0</span>
<span id="cb7-380">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size</span> ..................................... 4096</span>
<span id="cb7-381">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size_teacher</span> ............................. None</span>
<span id="cb7-382">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hysteresis</span> ...................................... 2</span>
<span id="cb7-383">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ict_head_size</span> ................................... None</span>
<span id="cb7-384">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ict_load</span> ........................................ None</span>
<span id="cb7-385">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">img_h</span> ........................................... 224</span>
<span id="cb7-386">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">img_w</span> ........................................... 224</span>
<span id="cb7-387">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indexer_batch_size</span> .............................. 128</span>
<span id="cb7-388">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">indexer_log_interval</span> ............................ 1000</span>
<span id="cb7-389">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">inference</span> ....................................... False</span>
<span id="cb7-390">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">inference_batch_times_seqlen_threshold</span> .......... 512</span>
<span id="cb7-391">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">init_method_std</span> ................................. 0.02</span>
<span id="cb7-392">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">init_method_xavier_uniform</span> ...................... False</span>
<span id="cb7-393">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">initial_loss_scale</span> .............................. 4294967296</span>
<span id="cb7-394">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">iter_per_epoch</span> .................................. 1250</span>
<span id="cb7-395">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd</span> .............................................. False</span>
<span id="cb7-396">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_alpha_ce</span> ..................................... 1</span>
<span id="cb7-397">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_beta_ce</span> ...................................... 1</span>
<span id="cb7-398">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kd_temp</span> ......................................... 1.0</span>
<span id="cb7-399">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kill_switch_file</span> ................................ None</span>
<span id="cb7-400">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kv_channels</span> ..................................... 128</span>
<span id="cb7-401">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layernorm_epsilon</span> ............................... 1e-05</span>
<span id="cb7-402">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lazy_mpu_init</span> ................................... None</span>
<span id="cb7-403">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load</span> ............................................ None</span>
<span id="cb7-404">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_mode</span> ....................................... auto</span>
<span id="cb7-405">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_tag</span> ........................................ None</span>
<span id="cb7-406">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">load_teacher</span> .................................... None</span>
<span id="cb7-407">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">local_rank</span> ...................................... None</span>
<span id="cb7-408">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_batch_size_to_tensorboard</span> ................... False</span>
<span id="cb7-409">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_interval</span> .................................... 1</span>
<span id="cb7-410">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_learning_rate_to_tensorboard</span> ................ True</span>
<span id="cb7-411">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_loss_scale_to_tensorboard</span> ................... True</span>
<span id="cb7-412">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_memory_to_tensorboard</span> ....................... False</span>
<span id="cb7-413">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_num_zeros_in_grad</span> ........................... False</span>
<span id="cb7-414">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_optimizer_states_to_tensorboard</span> ............. False</span>
<span id="cb7-415">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_params_norm</span> ................................. False</span>
<span id="cb7-416">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_timers_to_tensorboard</span> ....................... False</span>
<span id="cb7-417">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_validation_ppl_to_tensorboard</span> ............... False</span>
<span id="cb7-418">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log_world_size_to_tensorboard</span> ................... False</span>
<span id="cb7-419">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss_scale</span> ...................................... None</span>
<span id="cb7-420">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss_scale_window</span> ............................... 1000</span>
<span id="cb7-421">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr</span> .............................................. 2e-05</span>
<span id="cb7-422">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_iters</span> .................................. 320000</span>
<span id="cb7-423">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_samples</span> ................................ None</span>
<span id="cb7-424">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_style</span> .................................. cosine</span>
<span id="cb7-425">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_decay_tokens</span> ................................. None</span>
<span id="cb7-426">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_fraction</span> .............................. None</span>
<span id="cb7-427">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_iters</span> ................................. 2000</span>
<span id="cb7-428">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_samples</span> ............................... 0</span>
<span id="cb7-429">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lr_warmup_tokens</span> ................................ None</span>
<span id="cb7-430">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make_vocab_size_divisible_by</span> .................... 128512</span>
<span id="cb7-431">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_factor</span> ..................................... 1.0</span>
<span id="cb7-432">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_prob</span> ....................................... 0.15</span>
<span id="cb7-433">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mask_type</span> ....................................... random</span>
<span id="cb7-434">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">masked_softmax_fusion</span> ........................... False</span>
<span id="cb7-435">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_position_embeddings</span> ......................... 2048</span>
<span id="cb7-436">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_tokens_to_oom</span> ............................... 12000</span>
<span id="cb7-437">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mem_efficient_ln</span> ................................ True</span>
<span id="cb7-438">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">memory_centric_tiled_linear</span> ..................... False</span>
<span id="cb7-439">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">merge_file</span> ...................................... None</span>
<span id="cb7-440">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">micro_batch_size</span> ................................ 1</span>
<span id="cb7-441">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min_loss_scale</span> .................................. 1.0</span>
<span id="cb7-442">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min_lr</span> .......................................... 0.0</span>
<span id="cb7-443">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp_type</span> ........................................ standard</span>
<span id="cb7-444">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mmap_warmup</span> ..................................... False</span>
<span id="cb7-445">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_eval_capacity_factor</span> ........................ 1.0</span>
<span id="cb7-446">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_expert_parallel_size</span> ........................ 1</span>
<span id="cb7-447">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_loss_coeff</span> .................................. 0.1</span>
<span id="cb7-448">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_min_capacity</span> ................................ 4</span>
<span id="cb7-449">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_token_dropping</span> .............................. True</span>
<span id="cb7-450">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_top2_2nd_expert_sampling</span> .................... True</span>
<span id="cb7-451">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">moe_train_capacity_factor</span> ....................... 1.0</span>
<span id="cb7-452">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mos</span> ............................................. False</span>
<span id="cb7-453">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiprocessing_context</span> ......................... fork</span>
<span id="cb7-454">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_lr_state</span> ................................ False</span>
<span id="cb7-455">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_optim</span> ................................... None</span>
<span id="cb7-456">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_load_rng</span> ..................................... None</span>
<span id="cb7-457">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_persist_layer_norm</span> ........................... False</span>
<span id="cb7-458">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_pipeline_parallel</span> ............................ False</span>
<span id="cb7-459">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_save_optim</span> ................................... None</span>
<span id="cb7-460">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no_save_rng</span> ..................................... None</span>
<span id="cb7-461">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">normalization</span> ................................... rmsnorm</span>
<span id="cb7-462">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads</span> ............................. 32</span>
<span id="cb7-463">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_teacher</span> ..................... None</span>
<span id="cb7-464">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_channels</span> .................................... 3</span>
<span id="cb7-465">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_classes</span> ..................................... 1000</span>
<span id="cb7-466">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts</span> ..................................... <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-467">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts_switch</span> .............................. None</span>
<span id="cb7-468">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_experts_teacher</span> ............................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-469">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_key_value_heads</span> ............................. 8</span>
<span id="cb7-470">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers</span> ...................................... 32</span>
<span id="cb7-471">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers_per_virtual_pipeline_stage</span> ........... None</span>
<span id="cb7-472">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_layers_teacher</span> .............................. None</span>
<span id="cb7-473">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_workers</span> ..................................... 2</span>
<span id="cb7-474">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">onnx_safe</span> ....................................... None</span>
<span id="cb7-475">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">openai_gelu</span> ..................................... False</span>
<span id="cb7-476">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ....................................... adam</span>
<span id="cb7-477">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output_bert_embeddings</span> .......................... False</span>
<span id="cb7-478">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">overlap_p2p_comm</span> ................................ False</span>
<span id="cb7-479">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">override_opt_param_scheduler</span> .................... False</span>
<span id="cb7-480">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params_dtype</span> .................................... torch.bfloat16</span>
<span id="cb7-481">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">partition_activations</span> ........................... False</span>
<span id="cb7-482">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">patch_dim</span> ....................................... 16</span>
<span id="cb7-483">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">perform_initialization</span> .......................... True</span>
<span id="cb7-484">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline_model_parallel_size</span> .................... 1</span>
<span id="cb7-485">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline_model_parallel_split_rank</span> .............. None</span>
<span id="cb7-486">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile</span> ......................................... None</span>
<span id="cb7-487">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_backward</span> ................................ False</span>
<span id="cb7-488">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_ranks</span> ................................... None</span>
<span id="cb7-489">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">profile_steps</span> ................................... 2,3</span>
<span id="cb7-490">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_in_block_prob</span> ............................. 0.1</span>
<span id="cb7-491">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rampup_batch_size</span> ............................... None</span>
<span id="cb7-492">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">random_ltd</span> ...................................... False</span>
<span id="cb7-493">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rank</span> ............................................ 0</span>
<span id="cb7-494">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_granularity</span> ........................... None</span>
<span id="cb7-495">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_method</span> ................................ None</span>
<span id="cb7-496">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">recompute_num_layers</span> ............................ 1</span>
<span id="cb7-497">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote_device</span> ................................... none</span>
<span id="cb7-498">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">repeated_dataloader</span> ............................. True</span>
<span id="cb7-499">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_attention_mask</span> ............................ False</span>
<span id="cb7-500">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_iteration</span> ................................. False</span>
<span id="cb7-501">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reset_position_ids</span> .............................. False</span>
<span id="cb7-502">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_report_topk_accuracies</span> ................ []</span>
<span id="cb7-503">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_score_scaling</span> ......................... False</span>
<span id="cb7-504">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retriever_seq_length</span> ............................ 256</span>
<span id="cb7-505">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_add_retriever</span> ............................. False</span>
<span id="cb7-506">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_cyclic_train_iters</span> ........................ None</span>
<span id="cb7-507">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_attention_dropout</span> ................. 0.1</span>
<span id="cb7-508">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_hidden_dropout</span> .................... 0.1</span>
<span id="cb7-509">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_encoder_layers</span> ............................ 2</span>
<span id="cb7-510">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_num_neighbors</span> ............................. 2</span>
<span id="cb7-511">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_num_retrieved_chunks</span> ...................... 2</span>
<span id="cb7-512">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_return_doc_ids</span> ............................ False</span>
<span id="cb7-513">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">retro_workdir</span> ................................... None</span>
<span id="cb7-514">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">return_data_index</span> ............................... False</span>
<span id="cb7-515">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rope_theta</span> ...................................... 10000</span>
<span id="cb7-516">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rotary_percent</span> .................................. 1.0</span>
<span id="cb7-517">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_rate</span> ..................................... 1.0</span>
<span id="cb7-518">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">save</span> ............................................ ckpt-mds-llama-3/</span>
<span id="cb7-519">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">save_interval</span> ................................... 1500</span>
<span id="cb7-520">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scatter_gather_tensors_in_pipeline</span> .............. True</span>
<span id="cb7-521">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scattered_embeddings</span> ............................ False</span>
<span id="cb7-522">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">schedulefree_for_each</span> ........................... False</span>
<span id="cb7-523">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seed</span> ............................................ 1234</span>
<span id="cb7-524">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seq_length</span> ...................................... 2048</span>
<span id="cb7-525">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sequence_parallel</span> ............................... False</span>
<span id="cb7-526">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sgd_momentum</span> .................................... 0.9</span>
<span id="cb7-527">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">short_seq_prob</span> .................................. 0.1</span>
<span id="cb7-528">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shuffle_sample</span> .................................. False</span>
<span id="cb7-529">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">skip_train</span> ...................................... False</span>
<span id="cb7-530">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_beta1</span> ................................... 0.9</span>
<span id="cb7-531">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_beta2</span> ................................... 0.95</span>
<span id="cb7-532">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sophiag_rho</span> ..................................... 0.01</span>
<span id="cb7-533">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">split</span> ........................................... 100,0,0</span>
<span id="cb7-534">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">split_transformers</span> .............................. False</span>
<span id="cb7-535">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">squared_relu</span> .................................... False</span>
<span id="cb7-536">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">standalone_embedding_stage</span> ...................... False</span>
<span id="cb7-537">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">start_weight_decay</span> .............................. 0.1</span>
<span id="cb7-538">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">swiglu</span> .......................................... True</span>
<span id="cb7-539">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">swin_backbone_type</span> .............................. tiny</span>
<span id="cb7-540">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">synchronize_each_layer</span> .......................... False</span>
<span id="cb7-541">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor_model_parallel_size</span> ...................... 1</span>
<span id="cb7-542">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_dir</span> ................................. tensorboard_output</span>
<span id="cb7-543">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_log_interval</span> ........................ 1</span>
<span id="cb7-544">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard_queue_size</span> .......................... 1000</span>
<span id="cb7-545">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">test_data_path</span> .................................. None</span>
<span id="cb7-546">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tile_factor</span> ..................................... 1</span>
<span id="cb7-547">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">timing_log_level</span> ................................ 0</span>
<span id="cb7-548">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">timing_log_option</span> ............................... minmax</span>
<span id="cb7-549">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">titles_data_path</span> ................................ None</span>
<span id="cb7-550">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to_hf_ckpt</span> ...................................... False</span>
<span id="cb7-551">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer_model</span> ................................. ALCF/custom_tokenizer.model</span>
<span id="cb7-552">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tokenizer_type</span> .................................. HFTokenizer</span>
<span id="cb7-553">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">topk</span> ............................................ 1</span>
<span id="cb7-554">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trace_dir</span> ....................................... ./trace/</span>
<span id="cb7-555">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_exact_num_epochs</span> ..................... None</span>
<span id="cb7-556">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_path</span> ................................. None</span>
<span id="cb7-557">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_desc_path</span> ................................. None</span>
<span id="cb7-558">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_doc_idx_path</span> .............................. None</span>
<span id="cb7-559">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_idx_path</span> .................................. None</span>
<span id="cb7-560">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iters</span> ..................................... 3500</span>
<span id="cb7-561">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iters_to_skip</span> ............................. None</span>
<span id="cb7-562">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_range_to_skip</span> ............................. None</span>
<span id="cb7-563">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_sample_idx_path</span> ........................... None</span>
<span id="cb7-564">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_samples</span> ................................... None</span>
<span id="cb7-565">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_shuffle_idx_path</span> .......................... None</span>
<span id="cb7-566">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_tokens</span> .................................... None</span>
<span id="cb7-567">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_impl</span> ................................ local</span>
<span id="cb7-568">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">transformer_pipeline_model_parallel_size</span> ........ 1</span>
<span id="cb7-569">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">trust_remote_code</span> ............................... False</span>
<span id="cb7-570">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">universal_checkpoint</span> ............................ False</span>
<span id="cb7-571">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">untie_embeddings_and_output_weights</span> ............. True</span>
<span id="cb7-572">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_checkpoint_args</span> ............................. False</span>
<span id="cb7-573">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_checkpoint_opt_param_scheduler</span> .............. False</span>
<span id="cb7-574">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_contiguous_buffers_in_local_ddp</span> ............. True</span>
<span id="cb7-575">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_cpu_initialization</span> .......................... None</span>
<span id="cb7-576">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_dataset_only</span> ................................ False</span>
<span id="cb7-577">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_distributed_optimizer</span> ....................... False</span>
<span id="cb7-578">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn</span> .................................. False</span>
<span id="cb7-579">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_builder</span> .......................... False</span>
<span id="cb7-580">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_triton</span> ........................... False</span>
<span id="cb7-581">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_v1</span> ............................... False</span>
<span id="cb7-582">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_flash_attn_v2</span> ............................... False</span>
<span id="cb7-583">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_mics</span> ........................................ False</span>
<span id="cb7-584">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_one_sent_docs</span> ............................... False</span>
<span id="cb7-585">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_pin_memory</span> .................................. False</span>
<span id="cb7-586">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_ring_exchange_p2p</span> ........................... False</span>
<span id="cb7-587">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_rotary_position_embeddings</span> .................. True</span>
<span id="cb7-588">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">use_tutel</span> ....................................... False</span>
<span id="cb7-589">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">valid_data_path</span> ................................. None</span>
<span id="cb7-590">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">variable_seq_lengths</span> ............................ False</span>
<span id="cb7-591">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">virtual_pipeline_model_parallel_size</span> ............ None</span>
<span id="cb7-592">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_backbone_type</span> ............................ vit</span>
<span id="cb7-593">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_pretraining</span> .............................. False</span>
<span id="cb7-594">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vision_pretraining_type</span> ......................... classify</span>
<span id="cb7-595">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_extra_ids</span> ................................. 0</span>
<span id="cb7-596">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_file</span> ...................................... None</span>
<span id="cb7-597">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab_size</span> ...................................... 128512</span>
<span id="cb7-598">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_exp_name</span> ..................................</span>
<span id="cb7-599">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_project</span> ...................................</span>
<span id="cb7-600">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb_save_dir</span> ..................................</span>
<span id="cb7-601">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay</span> .................................... 0.1</span>
<span id="cb7-602">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">weight_decay_incr_style</span> ......................... constant</span>
<span id="cb7-603">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">world_size</span> ...................................... 24</span>
<span id="cb7-604">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_allgather_bucket_size</span> ...................... 0.0</span>
<span id="cb7-605">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_contigious_gradients</span> ....................... False</span>
<span id="cb7-606">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_reduce_bucket_size</span> ......................... 0.0</span>
<span id="cb7-607">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_reduce_scatter</span> ............................. False</span>
<span id="cb7-608">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">zero_stage</span> ...................................... 1.0</span>
<span id="cb7-609"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------</span> end of arguments <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">---------------------</span></span>
<span id="cb7-610"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">setting</span> number of micro-batches to constant 1</span>
<span id="cb7-611"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HFTokenizer</span> tokenizer ...</span>
<span id="cb7-612"> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> padded <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">vocab</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">size:</span> 128000<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> 512 dummy tokens <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> size: 128512<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-613"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch</span> distributed is already initialized, skipping initialization ...</span>
<span id="cb7-614"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initialized <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor</span> model parallel with size 1</span>
<span id="cb7-615"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initialized <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pipeline</span> model parallel with size 1</span>
<span id="cb7-616"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> setting <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">random</span> seeds to 1234 ...</span>
<span id="cb7-617"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> initializing <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model</span> parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234</span>
<span id="cb7-618"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-619"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-620"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-621"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-622"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-623"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-624"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-625"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-626"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-627"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,879] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-628"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-629"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-630"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-631"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-632"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-633"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,882] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-634"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-635"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,882] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-636"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Entering directory <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/megatron/data'</span></span>
<span id="cb7-637"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-638"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,884] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-639"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-640"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,922] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-641"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-642"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,929] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-643"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-644"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,930] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-645"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-646"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,931] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-647"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-648"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,935] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-649"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-650"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,937] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-651"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-652"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,939] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-653"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-654"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,939] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-655"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-656"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,940] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-657"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-658"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,941] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-659"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-660"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,946] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-661"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-662"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36,949] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-663"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Nothing to be done for <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'default'</span>.</span>
<span id="cb7-664"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">make:</span> Leaving directory <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/megatron/data'</span></span>
<span id="cb7-665"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> compiling <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dataset</span> index builder ...</span>
<span id="cb7-666"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> done <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> dataset index builder. Compilation time: 0.080 seconds</span>
<span id="cb7-667"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-668"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:36.956560]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:479</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> building model ...</span>
<span id="cb7-669"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Before Building Model</span>
<span id="cb7-670"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB</span>
<span id="cb7-671"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 105.24 GB, percent = 9.3%</span>
<span id="cb7-672"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,133] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-673"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SEED_LAYERS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BASE_SEED</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1234 <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SEED_FN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None</span>
<span id="cb7-674"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> topology: {ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>4, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 4, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>5, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 6, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 7, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 8, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 9, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 10, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>11, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 11, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>12, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>13, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 13, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>14, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 14, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>15, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 15, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>16, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 16, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>17, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 17, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 18, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>19, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 19, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>20, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 20, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>21, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 21, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>22, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 22, ProcessCoord<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pipe</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>23, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 23}</span>
<span id="cb7-675"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:37,139] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">module.py:396:_partition_layers</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Partitioning pipeline stages with method type:transformer</span>
<span id="cb7-676"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.212904: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered</span>
<span id="cb7-677"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.212925: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered</span>
<span id="cb7-678"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.213970: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered</span>
<span id="cb7-679"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:37.704522: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT</span>
<span id="cb7-680"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]1 GPTModelPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-681">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tied_modules</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-682">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> EmbeddingPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-683">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">word_embeddings</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> VocabParallelEmbedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-684">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-685">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-686">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-687">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-688">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-689">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-690">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-691">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-692">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-693">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-694">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-695">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-696">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-697">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-698">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-699">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-700">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-701">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-702">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-703">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-704">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-705">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-706">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-707">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-708">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-709">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-710">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-711">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-712">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-713">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-714">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-715">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-716">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-717">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-718">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-719">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-720">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-721">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-722">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-723">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-724">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-725">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-726">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-727">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-728">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-729">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-730">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-731">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-732">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-733">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-734">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-735">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-736">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-737">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-738">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-739">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-740">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-741">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-742">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-743">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-744">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-745">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-746">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-747">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-748">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-749">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-750">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-751">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-752">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-753">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-754">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-755">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-756">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-757">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-758">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-759">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-760">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-761">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-762">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-763">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-764">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-765">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-766">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-767">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-768">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-769">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-770">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-771">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-772">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-773">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-774">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-775">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-776">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-777">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-778">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-779">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-780">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-781">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-782">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-783">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-784">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-785">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-786">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-787">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-788">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-789">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-790">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-791">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-792">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-793">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-794">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-795">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-796">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-797">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-798">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-799">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-800">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-801">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-802">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-803">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-804">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-805">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-806">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-807">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-808">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-809">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-810">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-811">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-812">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-813">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-814">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-815">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-816">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-817">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-818">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-819">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-820">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-821">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-822">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-823">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-824">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-825">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-826">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-827">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-828">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-829">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-830">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-831">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-832">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-833">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-834">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-835">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-836">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-837">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-838">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-839">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-840">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-841">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-842">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-843">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-844">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-845">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-846">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-847">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-848">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-849">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-850">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-851">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-852">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-853">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-854">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-855">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-856">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-857">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-858">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-859">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-860">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-861">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-862">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-863">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-864">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-865">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-866">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-867">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-868">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-869">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-870">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-871">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-872">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-873">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-874">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-875">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-876">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-877">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-878">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-879">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-880">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-881">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-882">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-883">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-884">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-885">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-886">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-887">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-888">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-889">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-890">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-891">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-892">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-893">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-894">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-895">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-896">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-897">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-898">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-899">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-900">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-901">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-902">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-903">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-904">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-905">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-906">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-907">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-908">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-909">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-910">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-911">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-912">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-913">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-914">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-915">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-916">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-917">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-918">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-919">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-920">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-921">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-922">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-923">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-924">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-925">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-926">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-927">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-928">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-929">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-930">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-931">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-932">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-933">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-934">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-935">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-936">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-937">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-938">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-939">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-940">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-941">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-942">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-943">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-944">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-945">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-946">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-947">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-948">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-949">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-950">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-951">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-952">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-953">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-954">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-955">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-956">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-957">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-958">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-959">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-960">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-961">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-962">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-963">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-964">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-965">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-966">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-967">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-968">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-969">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-970">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-971">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-972">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-973">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-974">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-975">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-976">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-977">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-978">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-979">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-980">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-981">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-982">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-983">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-984">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-985">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-986">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-987">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-988">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-989">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-990">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-991">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-992">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-993">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-994">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-995">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-996">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-997">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-998">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-999">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1000">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1001">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1002">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1003">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1004">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1005">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1006">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1007">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1008">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1009">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1010">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1011">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1012">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1013">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1014">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1015">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1016">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1017">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1018">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1019">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1020">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1021">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1022">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1023">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1024">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1025">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1026">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1027">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1028">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1029">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1030">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1031">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1032">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1033">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1034">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1035">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1036">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1037">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1038">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1039">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1040">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1041">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1042">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1043">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1044">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1045">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1046">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1047">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1048">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1049">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1050">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1051">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1052">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1053">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1054">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1055">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1056">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1057">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1058">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1059">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1060">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1061">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1062">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1063">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1064">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1065">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1066">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1067">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1068">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1069">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1070">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1071">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1072">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1073">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1074">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1075">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1076">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1077">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1078">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1079">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1080">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1081">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1082">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1083">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1084">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1085">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1086">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1087">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1088">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1089">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1090">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1091">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1092">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1093">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1094">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1095">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1096">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1097">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1098">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1099">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1100">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1101">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1102">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1103">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1104">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1105">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1106">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1107">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1108">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1109">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1110">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1111">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1112">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1113">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1114">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1115">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1116">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1117">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1118">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1119">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1120">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1121">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1122">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1123">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1124">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1125">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1126">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1127">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1128">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1129">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1130">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1131">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1132">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1133">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1134">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1135">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1136">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1137">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1138">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1139">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1140">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1141">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1142">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1143">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1144">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1145">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1146">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1147">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1148">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1149">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1150">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1151">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1152">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1153">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1154">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1155">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1156">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1157">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1158">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1159">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1160">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1161">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1162">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1163">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1164">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1165">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1166">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1167">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1168">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1169">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1170">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1171">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1172">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1173">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1174">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1175">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1176">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1177">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1178">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1179">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1180">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1181">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1182">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1183">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1184">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1185">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1186">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1187">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1188">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1189">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1190">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1191">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1192">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1193">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1194">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1195">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1196">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1197">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1198">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1199">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LMHeadPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1200">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1201">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]</span>
<span id="cb7-1203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]stage=0 layers=37</span>
<span id="cb7-1204">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0:</span> _to_float16</span>
<span id="cb7-1205">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1:</span> EmbeddingPipe</span>
<span id="cb7-1206">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1207">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1208">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1209">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1210">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1211">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1212">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1213">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1214">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1215">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1216">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1217">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1218">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1219">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1220">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1221">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1222">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1223">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1224">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1225">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1226">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1227">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1228">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1229">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1230">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1231">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1232">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1233">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1234">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1235">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1236">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1237">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33:</span> ParallelTransformerLayerPipe</span>
<span id="cb7-1238">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34:</span> RMSNorm</span>
<span id="cb7-1239">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35:</span> LMHeadPipe</span>
<span id="cb7-1240">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">36:</span> float16_to_fp32</span>
<span id="cb7-1241">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">loss:</span> loss_func</span>
<span id="cb7-1242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> After Building Model</span>
<span id="cb7-1243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-1244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:38,077] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 105.4 GB, percent = 9.3%</span>
<span id="cb7-1245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> GPTModelPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1246">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tied_modules</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ModuleDict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1247">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> EmbeddingPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1248">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">word_embeddings</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> VocabParallelEmbedding<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1249">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">embedding_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1250">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1251">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1252">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1253">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1254">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1255">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1256">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1257">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1258">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1259">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1260">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1261">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1262">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1263">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1264">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1265">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1266">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1267">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1268">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1269">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1270">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1271">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1272">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1273">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1274">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1275">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1276">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1277">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1278">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1279">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1280">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1281">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1282">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1283">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1284">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1285">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1286">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1287">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1288">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1289">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1290">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1291">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1292">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1293">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1294">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1295">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1296">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1297">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1298">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1299">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1300">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1301">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1302">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1303">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1304">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1305">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1306">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1307">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1308">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1309">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1310">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1311">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1312">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1313">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1314">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1315">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1316">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1317">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1318">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1319">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1320">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1321">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1322">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1323">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1324">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1325">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1326">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1327">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1328">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1329">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1330">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1331">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1332">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1333">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1334">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1335">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1336">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1337">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1338">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1339">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1340">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1341">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1342">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1343">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1344">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1345">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1346">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1347">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1348">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1349">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1350">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1351">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1352">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1353">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1354">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1355">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1356">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1357">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1358">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1359">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1360">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1361">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1362">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1363">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1364">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1365">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1366">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1367">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1368">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1369">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1370">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1371">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1372">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1373">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1374">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1375">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1376">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1377">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1378">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1379">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1380">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1381">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1382">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1383">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1384">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1385">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1386">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1387">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1388">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1389">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1390">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1391">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1392">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1393">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1394">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1395">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1396">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1397">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1398">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1399">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1400">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1401">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1402">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1403">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1404">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1405">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1406">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1407">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1408">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1409">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1410">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1411">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1412">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1413">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1414">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1415">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1416">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1417">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1418">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1419">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1420">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1421">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1422">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1423">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1424">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1425">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1426">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1427">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1428">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1429">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1430">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1431">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1432">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1433">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1434">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1435">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1436">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1437">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1438">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1439">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1440">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1441">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1442">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1443">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1444">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1445">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1446">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1447">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1448">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1449">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1450">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1451">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1452">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1453">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1454">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1455">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1456">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1457">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1458">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1459">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1460">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1461">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1462">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1463">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1464">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1465">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1466">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1467">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1468">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1469">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1470">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1471">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1472">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1473">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1474">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1475">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1476">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1477">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1478">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1479">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1480">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1481">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1482">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1483">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1484">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1485">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1486">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1487">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1488">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1489">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1490">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1491">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1492">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1493">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1494">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1495">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1496">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1497">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1498">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1499">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1500">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1501">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1502">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1503">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1504">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1505">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1506">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1507">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1508">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1509">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1510">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1511">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1512">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1513">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1514">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1515">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1516">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1517">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1518">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1519">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1520">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1521">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1522">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1523">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1524">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1525">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1526">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1527">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1528">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1529">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1530">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1531">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1532">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1533">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1534">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1535">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1536">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1537">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1538">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1539">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">20</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1540">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1541">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1542">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1543">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1544">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1545">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1546">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1547">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1548">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1549">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1550">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1551">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1552">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1553">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1554">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1555">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1556">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1557">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1558">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1559">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1560">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1561">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1562">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1563">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1564">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1565">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1566">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1567">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1568">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1569">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1570">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1571">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1572">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1573">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1574">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1575">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1576">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1577">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1578">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1579">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1580">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1581">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1582">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1583">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1584">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1585">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1586">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1587">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">23</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1588">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1589">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1590">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1591">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1592">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1593">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1594">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1595">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1596">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1597">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1598">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1599">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1600">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1601">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1602">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1603">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1604">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1605">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1606">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1607">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1608">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1609">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1610">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1611">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1612">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1613">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1614">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1615">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1616">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1617">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1618">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1619">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1620">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1621">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1622">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1623">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1624">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1625">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1626">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1627">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1628">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1629">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1630">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1631">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1632">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1633">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1634">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1635">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1636">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1637">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1638">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1639">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1640">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1641">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1642">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1643">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1644">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1645">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1646">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1647">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1648">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1649">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1650">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1651">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1652">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1653">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1654">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1655">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1656">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1657">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1658">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1659">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1660">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1661">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1662">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1663">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1664">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1665">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1666">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1667">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1668">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1669">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1670">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1671">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1672">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1673">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1674">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1675">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1676">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1677">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1678">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1679">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1680">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1681">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1682">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1683">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1684">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1685">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1686">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1687">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1688">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1689">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1690">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1691">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1692">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1693">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1694">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1695">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1696">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1697">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1698">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1699">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1700">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1701">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1702">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1703">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1704">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1705">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1706">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1707">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1708">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1709">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1710">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1711">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1712">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1713">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1714">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1715">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1716">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1717">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1718">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1719">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1720">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1721">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1722">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1723">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1724">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1725">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1726">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1727">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1728">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1729">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1730">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1731">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1732">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1733">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1734">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1735">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1736">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1737">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1738">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1739">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1740">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1741">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1742">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1743">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1744">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1745">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1746">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1747">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelTransformerLayerPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1748">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1749">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1750">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">query_key_value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1751">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">core_attention</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> CoreAttention<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1752">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scale_mask_softmax</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> FusedScaleMaskSoftmax<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1753">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">attention_dropout</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Dropout<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.0, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inplace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1754">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1755">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1756">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1757">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">post_attention_layernorm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1758">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlp</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ParallelMLP<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1759">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_h_to_4h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1760">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dense_4h_to_h</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RowParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1761">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1762">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1763">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> RMSNorm<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1764">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> LMHeadPipe<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-1765">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm_head</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> ColumnParallelLinear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1766">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1767"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-1768"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards:   0%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span>          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0/7</span> [00:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>, <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>it/s]2024-10-16 15:39:39.334375: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /tensorflow/core/bfc_allocator_delay. The old value will be erased inorder to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1769"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.334561: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /xla/service/gpu/compiled_programs_count. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1770"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.335711: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /jax/pjrt/pjrt_executable_executions. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1771"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.335722: W external/local_tsl/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /jax/pjrt/pjrt_executable_execution_time_usecs. The old value will be erased in order to register a new one. Please check if you linkthe metric more than once, or if the name is already used by other metrics.</span>
<span id="cb7-1772"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.587872: I itex/core/wrapper/itex_gpu_wrapper.cc:38] Intel Extension for Tensorflow<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> GPU backend is loaded.</span>
<span id="cb7-1773"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631109: I itex/core/devices/gpu/itex_gpu_runtime.cc:130] Selected platform: Intel<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">R</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Level-Zero</span></span>
<span id="cb7-1774"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631594: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1775"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631598: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1776"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631600: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1777"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631602: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1778"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631604: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1779"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631607: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1780"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631609: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1781"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631611: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1782"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631613: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1783"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631615: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1784"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631617: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1785"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024-10-16</span> 15:39:39.631619: I itex/core/devices/gpu/itex_gpu_runtime.cc:155] number of sub-devices is zero, expose root device.</span>
<span id="cb7-1786"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> setting <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensorboard</span> ...</span>
<span id="cb7-1787"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WARNING:</span> WANDB writing requested but no legit wandb project or experiment name provided, therefore no WANDB logs will be written according to random generated project or experiment name.</span>
<span id="cb7-1788"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-1789"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:39:39,835] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-1790"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:35<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 30.78s/it]</span>
<span id="cb7-1791"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.654241]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:108</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">----------------------------hf</span> weight list----------------------------</span>
<span id="cb7-1792"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.705041]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.embed_tokens.weight</span>
<span id="cb7-1793"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.708051]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.q_proj.weight</span>
<span id="cb7-1794"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.710201]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.k_proj.weight</span>
<span id="cb7-1795"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.711855]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.v_proj.weight</span>
<span id="cb7-1796"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.714676]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.self_attn.o_proj.weight</span>
<span id="cb7-1797"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.721608]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.gate_proj.weight</span>
<span id="cb7-1798"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.728527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.up_proj.weight</span>
<span id="cb7-1799"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.735447]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.mlp.down_proj.weight</span>
<span id="cb7-1800"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.736224]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.input_layernorm.weight</span>
<span id="cb7-1801"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.736764]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.0.post_attention_layernorm.weight</span>
<span id="cb7-1802"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.739392]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.q_proj.weight</span>
<span id="cb7-1803"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.741013]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.k_proj.weight</span>
<span id="cb7-1804"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.742600]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.v_proj.weight</span>
<span id="cb7-1805"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.745359]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.self_attn.o_proj.weight</span>
<span id="cb7-1806"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.752286]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.gate_proj.weight</span>
<span id="cb7-1807"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.759192]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.up_proj.weight</span>
<span id="cb7-1808"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.766054]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.mlp.down_proj.weight</span>
<span id="cb7-1809"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.766785]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.input_layernorm.weight</span>
<span id="cb7-1810"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.767321]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.1.post_attention_layernorm.weight</span>
<span id="cb7-1811"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.769938]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.q_proj.weight</span>
<span id="cb7-1812"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.771536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.k_proj.weight</span>
<span id="cb7-1813"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.773107]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.v_proj.weight</span>
<span id="cb7-1814"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.775861]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.self_attn.o_proj.weight</span>
<span id="cb7-1815"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.782733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.gate_proj.weight</span>
<span id="cb7-1816"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.789559]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.up_proj.weight</span>
<span id="cb7-1817"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.796385]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.mlp.down_proj.weight</span>
<span id="cb7-1818"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.797080]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.input_layernorm.weight</span>
<span id="cb7-1819"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.797626]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.2.post_attention_layernorm.weight</span>
<span id="cb7-1820"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.800331]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.q_proj.weight</span>
<span id="cb7-1821"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.801911]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.k_proj.weight</span>
<span id="cb7-1822"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.803453]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.v_proj.weight</span>
<span id="cb7-1823"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.806474]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.self_attn.o_proj.weight</span>
<span id="cb7-1824"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:35<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 30.84s/it]</span>
<span id="cb7-1825"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.813328]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.gate_proj.weight</span>
<span id="cb7-1826"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.820151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.up_proj.weight</span>
<span id="cb7-1827"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.826971]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.mlp.down_proj.weight</span>
<span id="cb7-1828"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.827640]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.input_layernorm.weight</span>
<span id="cb7-1829"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.828185]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.3.post_attention_layernorm.weight</span>
<span id="cb7-1830"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.831062]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.q_proj.weight</span>
<span id="cb7-1831"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.832590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.k_proj.weight</span>
<span id="cb7-1832"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.834171]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.v_proj.weight</span>
<span id="cb7-1833"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.837147]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.self_attn.o_proj.weight</span>
<span id="cb7-1834"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.843970]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.gate_proj.weight</span>
<span id="cb7-1835"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.850793]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.up_proj.weight</span>
<span id="cb7-1836"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.857596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.mlp.down_proj.weight</span>
<span id="cb7-1837"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.858284]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.input_layernorm.weight</span>
<span id="cb7-1838"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.858810]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.4.post_attention_layernorm.weight</span>
<span id="cb7-1839"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.861661]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.q_proj.weight</span>
<span id="cb7-1840"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.863209]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.k_proj.weight</span>
<span id="cb7-1841"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.864753]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.v_proj.weight</span>
<span id="cb7-1842"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.867739]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.self_attn.o_proj.weight</span>
<span id="cb7-1843"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.874537]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.gate_proj.weight</span>
<span id="cb7-1844"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.881318]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.up_proj.weight</span>
<span id="cb7-1845"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.888097]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.mlp.down_proj.weight</span>
<span id="cb7-1846"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.888767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.input_layernorm.weight</span>
<span id="cb7-1847"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.889295]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.5.post_attention_layernorm.weight</span>
<span id="cb7-1848"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.892151]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.q_proj.weight</span>
<span id="cb7-1849"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.893641]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.k_proj.weight</span>
<span id="cb7-1850"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.895211]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.v_proj.weight</span>
<span id="cb7-1851"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.898154]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.self_attn.o_proj.weight</span>
<span id="cb7-1852"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.904976]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.gate_proj.weight</span>
<span id="cb7-1853"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.911767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.up_proj.weight</span>
<span id="cb7-1854"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.918536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.mlp.down_proj.weight</span>
<span id="cb7-1855"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.919201]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.input_layernorm.weight</span>
<span id="cb7-1856"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.919795]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.6.post_attention_layernorm.weight</span>
<span id="cb7-1857"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.922646]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.q_proj.weight</span>
<span id="cb7-1858"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.924200]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.k_proj.weight</span>
<span id="cb7-1859"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.925687]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.v_proj.weight</span>
<span id="cb7-1860"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.928651]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.self_attn.o_proj.weight</span>
<span id="cb7-1861"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.935432]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.gate_proj.weight</span>
<span id="cb7-1862"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.942178]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.up_proj.weight</span>
<span id="cb7-1863"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.948916]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.mlp.down_proj.weight</span>
<span id="cb7-1864"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.949547]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.input_layernorm.weight</span>
<span id="cb7-1865"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.950059]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.7.post_attention_layernorm.weight</span>
<span id="cb7-1866"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.952902]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.q_proj.weight</span>
<span id="cb7-1867"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.954461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.k_proj.weight</span>
<span id="cb7-1868"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.955985]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.v_proj.weight</span>
<span id="cb7-1869"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.958931]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.self_attn.o_proj.weight</span>
<span id="cb7-1870"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.965709]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.gate_proj.weight</span>
<span id="cb7-1871"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.972481]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.up_proj.weight</span>
<span id="cb7-1872"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.979242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.mlp.down_proj.weight</span>
<span id="cb7-1873"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.979876]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.input_layernorm.weight</span>
<span id="cb7-1874"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.980381]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.8.post_attention_layernorm.weight</span>
<span id="cb7-1875"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.983353]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.q_proj.weight</span>
<span id="cb7-1876"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.984910]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.k_proj.weight</span>
<span id="cb7-1877"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.986401]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.v_proj.weight</span>
<span id="cb7-1878"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.989279]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.self_attn.o_proj.weight</span>
<span id="cb7-1879"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:13.996056]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.gate_proj.weight</span>
<span id="cb7-1880"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.002856]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.up_proj.weight</span>
<span id="cb7-1881"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.009601]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.mlp.down_proj.weight</span>
<span id="cb7-1882"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.010234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.input_layernorm.weight</span>
<span id="cb7-1883"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.010742]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.9.post_attention_layernorm.weight</span>
<span id="cb7-1884"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.013552]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.q_proj.weight</span>
<span id="cb7-1885"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.015117]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.k_proj.weight</span>
<span id="cb7-1886"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.016607]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.v_proj.weight</span>
<span id="cb7-1887"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.019542]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.self_attn.o_proj.weight</span>
<span id="cb7-1888"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.026297]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.gate_proj.weight</span>
<span id="cb7-1889"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.033038]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.up_proj.weight</span>
<span id="cb7-1890"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.039752]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.mlp.down_proj.weight</span>
<span id="cb7-1891"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.040455]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.input_layernorm.weight</span>
<span id="cb7-1892"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.040966]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.10.post_attention_layernorm.weight</span>
<span id="cb7-1893"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.043760]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.q_proj.weight</span>
<span id="cb7-1894"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.045346]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.k_proj.weight</span>
<span id="cb7-1895"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.046849]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.v_proj.weight</span>
<span id="cb7-1896"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.049725]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.self_attn.o_proj.weight</span>
<span id="cb7-1897"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.056435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.gate_proj.weight</span>
<span id="cb7-1898"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.063163]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.up_proj.weight</span>
<span id="cb7-1899"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.069898]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.mlp.down_proj.weight</span>
<span id="cb7-1900"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.070561]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.input_layernorm.weight</span>
<span id="cb7-1901"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.071084]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.11.post_attention_layernorm.weight</span>
<span id="cb7-1902"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.073869]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.q_proj.weight</span>
<span id="cb7-1903"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.075363]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.k_proj.weight</span>
<span id="cb7-1904"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.076918]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.v_proj.weight</span>
<span id="cb7-1905"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.079777]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.self_attn.o_proj.weight</span>
<span id="cb7-1906"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.086497]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.gate_proj.weight</span>
<span id="cb7-1907"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.093183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.up_proj.weight</span>
<span id="cb7-1908"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.099869]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.mlp.down_proj.weight</span>
<span id="cb7-1909"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.100523]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.input_layernorm.weight</span>
<span id="cb7-1910"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.101038]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.12.post_attention_layernorm.weight</span>
<span id="cb7-1911"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.103823]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.q_proj.weight</span>
<span id="cb7-1912"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.105335]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.k_proj.weight</span>
<span id="cb7-1913"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.106828]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.v_proj.weight</span>
<span id="cb7-1914"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.109698]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.self_attn.o_proj.weight</span>
<span id="cb7-1915"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.116395]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.gate_proj.weight</span>
<span id="cb7-1916"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.123086]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.up_proj.weight</span>
<span id="cb7-1917"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.129807]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.mlp.down_proj.weight</span>
<span id="cb7-1918"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.130474]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.input_layernorm.weight</span>
<span id="cb7-1919"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.130997]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.13.post_attention_layernorm.weight</span>
<span id="cb7-1920"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.133762]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.q_proj.weight</span>
<span id="cb7-1921"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.135290]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.k_proj.weight</span>
<span id="cb7-1922"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.136791]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.v_proj.weight</span>
<span id="cb7-1923"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.139860]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.self_attn.o_proj.weight</span>
<span id="cb7-1924"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.146560]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.gate_proj.weight</span>
<span id="cb7-1925"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.153229]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.up_proj.weight</span>
<span id="cb7-1926"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.160012]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.mlp.down_proj.weight</span>
<span id="cb7-1927"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.160681]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.input_layernorm.weight</span>
<span id="cb7-1928"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.161212]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.14.post_attention_layernorm.weight</span>
<span id="cb7-1929"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.164011]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.q_proj.weight</span>
<span id="cb7-1930"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.165550]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.k_proj.weight</span>
<span id="cb7-1931"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.167029]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.v_proj.weight</span>
<span id="cb7-1932"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.169860]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.self_attn.o_proj.weight</span>
<span id="cb7-1933"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.176522]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.gate_proj.weight</span>
<span id="cb7-1934"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.183206]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.up_proj.weight</span>
<span id="cb7-1935"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.189866]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.mlp.down_proj.weight</span>
<span id="cb7-1936"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.190530]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.input_layernorm.weight</span>
<span id="cb7-1937"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.191065]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.15.post_attention_layernorm.weight</span>
<span id="cb7-1938"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.193838]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.q_proj.weight</span>
<span id="cb7-1939"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.195331]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.k_proj.weight</span>
<span id="cb7-1940"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.196892]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.v_proj.weight</span>
<span id="cb7-1941"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.199748]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.self_attn.o_proj.weight</span>
<span id="cb7-1942"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.206446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.gate_proj.weight</span>
<span id="cb7-1943"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.213109]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.up_proj.weight</span>
<span id="cb7-1944"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.219783]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.mlp.down_proj.weight</span>
<span id="cb7-1945"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.220402]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.input_layernorm.weight</span>
<span id="cb7-1946"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.220932]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.16.post_attention_layernorm.weight</span>
<span id="cb7-1947"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.223676]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.q_proj.weight</span>
<span id="cb7-1948"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.225232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.k_proj.weight</span>
<span id="cb7-1949"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.226737]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.v_proj.weight</span>
<span id="cb7-1950"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.229543]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.self_attn.o_proj.weight</span>
<span id="cb7-1951"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.236240]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.gate_proj.weight</span>
<span id="cb7-1952"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.242898]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.up_proj.weight</span>
<span id="cb7-1953"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.249590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.mlp.down_proj.weight</span>
<span id="cb7-1954"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.250235]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.input_layernorm.weight</span>
<span id="cb7-1955"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.250747]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.17.post_attention_layernorm.weight</span>
<span id="cb7-1956"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.253465]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.q_proj.weight</span>
<span id="cb7-1957"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.255062]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.k_proj.weight</span>
<span id="cb7-1958"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.256546]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.v_proj.weight</span>
<span id="cb7-1959"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.259362]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.self_attn.o_proj.weight</span>
<span id="cb7-1960"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.266006]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.gate_proj.weight</span>
<span id="cb7-1961"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.272677]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.up_proj.weight</span>
<span id="cb7-1962"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.279406]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.mlp.down_proj.weight</span>
<span id="cb7-1963"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.280055]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.input_layernorm.weight</span>
<span id="cb7-1964"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.280566]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.18.post_attention_layernorm.weight</span>
<span id="cb7-1965"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.283295]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.q_proj.weight</span>
<span id="cb7-1966"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.284803]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.k_proj.weight</span>
<span id="cb7-1967"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.286350]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.v_proj.weight</span>
<span id="cb7-1968"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.289142]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.self_attn.o_proj.weight</span>
<span id="cb7-1969"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.295818]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.gate_proj.weight</span>
<span id="cb7-1970"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.302488]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.up_proj.weight</span>
<span id="cb7-1971"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.309098]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.mlp.down_proj.weight</span>
<span id="cb7-1972"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.309731]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.input_layernorm.weight</span>
<span id="cb7-1973"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.310234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.19.post_attention_layernorm.weight</span>
<span id="cb7-1974"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.312927]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.q_proj.weight</span>
<span id="cb7-1975"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.314505]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.k_proj.weight</span>
<span id="cb7-1976"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.315992]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.v_proj.weight</span>
<span id="cb7-1977"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.318788]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.self_attn.o_proj.weight</span>
<span id="cb7-1978"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.325390]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.gate_proj.weight</span>
<span id="cb7-1979"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.332020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.up_proj.weight</span>
<span id="cb7-1980"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.338682]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.mlp.down_proj.weight</span>
<span id="cb7-1981"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.339334]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.input_layernorm.weight</span>
<span id="cb7-1982"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.339845]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.20.post_attention_layernorm.weight</span>
<span id="cb7-1983"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.342562]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.q_proj.weight</span>
<span id="cb7-1984"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.344113]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.k_proj.weight</span>
<span id="cb7-1985"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.345593]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.v_proj.weight</span>
<span id="cb7-1986"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.348370]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.self_attn.o_proj.weight</span>
<span id="cb7-1987"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.355167]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.gate_proj.weight</span>
<span id="cb7-1988"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.361823]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.up_proj.weight</span>
<span id="cb7-1989"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.368428]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.mlp.down_proj.weight</span>
<span id="cb7-1990"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.369055]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.input_layernorm.weight</span>
<span id="cb7-1991"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.369558]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.21.post_attention_layernorm.weight</span>
<span id="cb7-1992"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.372269]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.q_proj.weight</span>
<span id="cb7-1993"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.373830]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.k_proj.weight</span>
<span id="cb7-1994"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.375316]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.v_proj.weight</span>
<span id="cb7-1995"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.378084]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.self_attn.o_proj.weight</span>
<span id="cb7-1996"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.384700]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.gate_proj.weight</span>
<span id="cb7-1997"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.391366]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.up_proj.weight</span>
<span id="cb7-1998"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.398053]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.mlp.down_proj.weight</span>
<span id="cb7-1999"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.398695]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.input_layernorm.weight</span>
<span id="cb7-2000"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.399206]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.22.post_attention_layernorm.weight</span>
<span id="cb7-2001"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.401929]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.q_proj.weight</span>
<span id="cb7-2002"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.403487]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.k_proj.weight</span>
<span id="cb7-2003"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.404961]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.v_proj.weight</span>
<span id="cb7-2004"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.407720]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.self_attn.o_proj.weight</span>
<span id="cb7-2005"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.414356]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.gate_proj.weight</span>
<span id="cb7-2006"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.421000]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.up_proj.weight</span>
<span id="cb7-2007"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.427610]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.mlp.down_proj.weight</span>
<span id="cb7-2008"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.428269]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.input_layernorm.weight</span>
<span id="cb7-2009"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.428783]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.23.post_attention_layernorm.weight</span>
<span id="cb7-2010"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.431461]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.q_proj.weight</span>
<span id="cb7-2011"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.432995]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.k_proj.weight</span>
<span id="cb7-2012"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.434507]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.v_proj.weight</span>
<span id="cb7-2013"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.437268]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.self_attn.o_proj.weight</span>
<span id="cb7-2014"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.443850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.gate_proj.weight</span>
<span id="cb7-2015"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.450632]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.up_proj.weight</span>
<span id="cb7-2016"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.457242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.mlp.down_proj.weight</span>
<span id="cb7-2017"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.457890]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.input_layernorm.weight</span>
<span id="cb7-2018"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.458409]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.24.post_attention_layernorm.weight</span>
<span id="cb7-2019"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.461063]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.q_proj.weight</span>
<span id="cb7-2020"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.462620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.k_proj.weight</span>
<span id="cb7-2021"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.464102]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.v_proj.weight</span>
<span id="cb7-2022"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.466871]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.self_attn.o_proj.weight</span>
<span id="cb7-2023"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.473435]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.gate_proj.weight</span>
<span id="cb7-2024"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.480017]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.up_proj.weight</span>
<span id="cb7-2025"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.486605]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.mlp.down_proj.weight</span>
<span id="cb7-2026"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.487227]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.input_layernorm.weight</span>
<span id="cb7-2027"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.487743]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.25.post_attention_layernorm.weight</span>
<span id="cb7-2028"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.490427]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.q_proj.weight</span>
<span id="cb7-2029"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.491946]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.k_proj.weight</span>
<span id="cb7-2030"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.493433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.v_proj.weight</span>
<span id="cb7-2031"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.496192]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.self_attn.o_proj.weight</span>
<span id="cb7-2032"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.502792]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.gate_proj.weight</span>
<span id="cb7-2033"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.509329]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.up_proj.weight</span>
<span id="cb7-2034"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.515980]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.mlp.down_proj.weight</span>
<span id="cb7-2035"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.516659]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.input_layernorm.weight</span>
<span id="cb7-2036"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.517200]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.26.post_attention_layernorm.weight</span>
<span id="cb7-2037"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.519874]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.q_proj.weight</span>
<span id="cb7-2038"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.521415]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.k_proj.weight</span>
<span id="cb7-2039"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.522879]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.v_proj.weight</span>
<span id="cb7-2040"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.525620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.self_attn.o_proj.weight</span>
<span id="cb7-2041"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.532202]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.gate_proj.weight</span>
<span id="cb7-2042"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.538768]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.up_proj.weight</span>
<span id="cb7-2043"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.545303]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.mlp.down_proj.weight</span>
<span id="cb7-2044"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.545921]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.input_layernorm.weight</span>
<span id="cb7-2045"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.546440]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.27.post_attention_layernorm.weight</span>
<span id="cb7-2046"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.549101]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.q_proj.weight</span>
<span id="cb7-2047"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.550596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.k_proj.weight</span>
<span id="cb7-2048"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.552114]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.v_proj.weight</span>
<span id="cb7-2049"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.554821]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.self_attn.o_proj.weight</span>
<span id="cb7-2050"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.561373]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.gate_proj.weight</span>
<span id="cb7-2051"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.567945]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.up_proj.weight</span>
<span id="cb7-2052"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.574713]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.mlp.down_proj.weight</span>
<span id="cb7-2053"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.575333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.input_layernorm.weight</span>
<span id="cb7-2054"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.575833]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.28.post_attention_layernorm.weight</span>
<span id="cb7-2055"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.578469]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.q_proj.weight</span>
<span id="cb7-2056"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.580020]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.k_proj.weight</span>
<span id="cb7-2057"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.581498]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.v_proj.weight</span>
<span id="cb7-2058"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.584217]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.self_attn.o_proj.weight</span>
<span id="cb7-2059"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.590850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.gate_proj.weight</span>
<span id="cb7-2060"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.597375]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.up_proj.weight</span>
<span id="cb7-2061"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.603899]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.mlp.down_proj.weight</span>
<span id="cb7-2062"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.604548]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.input_layernorm.weight</span>
<span id="cb7-2063"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.605067]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.29.post_attention_layernorm.weight</span>
<span id="cb7-2064"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.607694]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.q_proj.weight</span>
<span id="cb7-2065"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.609232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.k_proj.weight</span>
<span id="cb7-2066"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.610733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.v_proj.weight</span>
<span id="cb7-2067"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.613448]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.self_attn.o_proj.weight</span>
<span id="cb7-2068"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.619991]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.gate_proj.weight</span>
<span id="cb7-2069"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.626559]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.up_proj.weight</span>
<span id="cb7-2070"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.633070]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.mlp.down_proj.weight</span>
<span id="cb7-2071"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.633733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.input_layernorm.weight</span>
<span id="cb7-2072"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.634259]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.30.post_attention_layernorm.weight</span>
<span id="cb7-2073"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.636877]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.q_proj.weight</span>
<span id="cb7-2074"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.638487]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.k_proj.weight</span>
<span id="cb7-2075"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.639954]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.v_proj.weight</span>
<span id="cb7-2076"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.642672]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.self_attn.o_proj.weight</span>
<span id="cb7-2077"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.649190]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.gate_proj.weight</span>
<span id="cb7-2078"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.655715]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.up_proj.weight</span>
<span id="cb7-2079"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.662234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.mlp.down_proj.weight</span>
<span id="cb7-2080"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.662858]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.input_layernorm.weight</span>
<span id="cb7-2081"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.663389]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.layers.31.post_attention_layernorm.weight</span>
<span id="cb7-2082"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.663915]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model.norm.weight</span>
<span id="cb7-2083"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,693] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2084"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.713565]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:113</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> lm_head.weight</span>
<span id="cb7-2085"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14.714574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:504</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> before deepspeed init</span>
<span id="cb7-2086"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] DeepSpeed info: version=0.15.3+unknown, git-hash=unknown, git-branch=unknown</span>
<span id="cb7-2087"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:14,715] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2088"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:57<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 33.97s/it]</span>
<span id="cb7-2089"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:36,676] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2090"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.36s/it]</span>
<span id="cb7-2091"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.38s/it]</span>
<span id="cb7-2092"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.40s/it]</span>
<span id="cb7-2093"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.39s/it]</span>
<span id="cb7-2094"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2095"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.43s/it]</span>
<span id="cb7-2096"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.40s/it]</span>
<span id="cb7-2097"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2098"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:00<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.41s/it]</span>
<span id="cb7-2099"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.46s/it]</span>
<span id="cb7-2102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.43s/it]</span>
<span id="cb7-2104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.44s/it]</span>
<span id="cb7-2108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [03:58<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.12s/it]</span>
<span id="cb7-2109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.47s/it]</span>
<span id="cb7-2110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> checkpoint shards: 100%<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7/7</span> [04:01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>00:00, 34.51s/it]</span>
<span id="cb7-2111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,455] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,666] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,739] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,801] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,842] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,860] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,862] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,881] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:39,920] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,138] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,153] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,174] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,175] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,205] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,212] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,224] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,251] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,255] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,256] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,417] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:40,538] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:733:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Config mesh_device None world_size = 24</span>
<span id="cb7-2132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:56,920] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] DeepSpeed Flops Profiler Enabled: False</span>
<span id="cb7-2133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:56,921] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:129:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] Creating BF16 optimizer</span>
<span id="cb7-2134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> begin bf16_optimizer</span>
<span id="cb7-2135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-2136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,118] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 490.74 GB, percent = 43.3%</span>
<span id="cb7-2137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,290] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:781:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> end bf16_ optimizer</span>
<span id="cb7-2138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:782:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> MA 14.96 GB         Max_MA 14.96 GB         CA 14.96 GB         Max_CA 15 GB</span>
<span id="cb7-2139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils.py:789:see_memory_usage</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CPU Virtual Memory:  used = 490.74 GB, percent = 43.3%</span>
<span id="cb7-2140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,291] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:999:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> DeepSpeedEngine configuration:</span>
<span id="cb7-2141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   activation_checkpointing_config  {</span>
<span id="cb7-2142">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"partition_activations"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2143">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contiguous_memory_optimization"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2144">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpu_checkpointing"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2145">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number_checkpoints"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2146">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"synchronize_checkpoint_boundary"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2147">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"profile"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb7-2148"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   aio_config ................... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'block_size'</span>: 1048576, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'queue_depth'</span>: 8, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'thread_count'</span>: 1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single_submit'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'overlap_events'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'use_gds'</span>: False}</span>
<span id="cb7-2150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   amp_enabled .................. False</span>
<span id="cb7-2151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   amp_params ................... False</span>
<span id="cb7-2152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   autotuning_config ............ {</span>
<span id="cb7-2153">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2154">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2155">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2156">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2157">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"arg_mappings"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2158">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"throughput"</span>,</span>
<span id="cb7-2159">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_info"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2160">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"results_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"autotuning_results"</span>,</span>
<span id="cb7-2161">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exps_dir"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"autotuning_exps"</span>,</span>
<span id="cb7-2162">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2163">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fast"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2164">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start_profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3,</span>
<span id="cb7-2165">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end_profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5,</span>
<span id="cb7-2166">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_type"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gridsearch"</span>,</span>
<span id="cb7-2167">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_early_stopping"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 5,</span>
<span id="cb7-2168">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tuner_num_trials"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 50,</span>
<span id="cb7-2169">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_info_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2170">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mp_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2171">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2172">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2173">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max_train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1.024000e+03,</span>
<span id="cb7-2174">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min_train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2175">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_tuning_micro_batch_sizes"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 3</span>
<span id="cb7-2176"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   bfloat16_enabled ............. True</span>
<span id="cb7-2178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   bfloat16_immediate_grad_update  False</span>
<span id="cb7-2179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_parallel_write_pipeline  False</span>
<span id="cb7-2180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_tag_validation_enabled  True</span>
<span id="cb7-2181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   checkpoint_tag_validation_fail  False</span>
<span id="cb7-2182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   comms_config ................. <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>deepspeed.comm.config.DeepSpeedCommsConfig object at 0x145ea0815900<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb7-2183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   communication_data_type ...... None</span>
<span id="cb7-2184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   compression_config ........... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weight_quantization'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantizer_kernel'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_groups'</span>: 1, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_verbose'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantization_type'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'symmetric'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_weight_in_forward'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rounding'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nearest'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fp16_mixed_quantize'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantize_change_ratio'</span>: 0.001}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'activation_quantization'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'quantization_type'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'symmetric'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'range_calibration'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dynamic'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sparse_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'head_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'topk'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channel_pruning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shared_parameters'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'method'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'schedule_offset'</span>: 1000}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'different_groups'</span>: {}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'layer_reduction'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}</span>
<span id="cb7-2185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   curriculum_enabled_legacy .... False</span>
<span id="cb7-2186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   curriculum_params_legacy ..... False</span>
<span id="cb7-2187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   data_efficiency_config ....... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seed'</span>: 1234, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_sampling'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>: 1000, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_workers'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'curriculum_learning'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_routing'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'random_ltd'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'layer_token_lr_schedule'</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'enabled'</span>: False}}}}</span>
<span id="cb7-2188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   data_efficiency_enabled ...... False</span>
<span id="cb7-2189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dataloader_drop_last ......... False</span>
<span id="cb7-2190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   disable_allgather ............ False</span>
<span id="cb7-2191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dump_state ................... False</span>
<span id="cb7-2192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   dynamic_loss_scale_args ...... None</span>
<span id="cb7-2193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_enabled ........... False</span>
<span id="cb7-2194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_gas_boundary_resolution  1</span>
<span id="cb7-2195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_layer_name ........ bert.encoder.layer</span>
<span id="cb7-2196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_layer_num ......... 0</span>
<span id="cb7-2197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_max_iter .......... 100</span>
<span id="cb7-2198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_stability ......... 1e-06</span>
<span id="cb7-2199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,292] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_tol ............... 0.01</span>
<span id="cb7-2200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   eigenvalue_verbose ........... False</span>
<span id="cb7-2201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   elasticity_enabled ........... False</span>
<span id="cb7-2202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   flops_profiler_config ........ {</span>
<span id="cb7-2203">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2204">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recompute_fwd_factor"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0.0,</span>
<span id="cb7-2205">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"profile_step"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2206">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"module_depth"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1,</span></span>
<span id="cb7-2207">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top_modules"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2208">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"detailed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2209">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_file"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb7-2210"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_auto_cast ............... None</span>
<span id="cb7-2212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_enabled ................. False</span>
<span id="cb7-2213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   fp16_master_weights_and_gradients  False</span>
<span id="cb7-2214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   global_rank .................. 0</span>
<span id="cb7-2215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   grad_accum_dtype ............. None</span>
<span id="cb7-2216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_accumulation_steps .. 1</span>
<span id="cb7-2217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_clipping ............ 0.0</span>
<span id="cb7-2218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   gradient_predivide_factor .... 1.0</span>
<span id="cb7-2219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   graph_harvesting ............. False</span>
<span id="cb7-2220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8</span>
<span id="cb7-2221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   initial_dynamic_scale ........ 1</span>
<span id="cb7-2222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   load_universal_checkpoint .... False</span>
<span id="cb7-2223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   loss_scale ................... 1.0</span>
<span id="cb7-2224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   memory_breakdown ............. False</span>
<span id="cb7-2225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   mics_hierarchial_params_gather  False</span>
<span id="cb7-2226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   mics_shard_size .............. <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span></span>
<span id="cb7-2227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   monitor_config ............... tensorboard=TensorBoardConfig<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">job_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DeepSpeedJobName'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comet</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>CometConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_log_interval</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">project</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">workspace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">experiment_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">experiment_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">online</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mode</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wandb</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">group</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">team</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>None, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">project</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">csv_monitor</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>CSVConfig<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>False, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">job_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DeepSpeedJobName'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   nebula_config ................ {</span>
<span id="cb7-2229">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> false,</span>
<span id="cb7-2230">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"persistent_storage_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb7-2231">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"persistent_time_interval"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb7-2232">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_of_version_in_retention"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2,</span>
<span id="cb7-2233">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enable_nebula_load"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb7-2234">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"load_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb7-2235"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2236"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_legacy_fusion ...... False</span>
<span id="cb7-2237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_name ............... None</span>
<span id="cb7-2238"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   optimizer_params ............. None</span>
<span id="cb7-2239"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pipeline ..................... {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'stages'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'partition'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'seed_layers'</span>: False, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'activation_checkpoint_interval'</span>: 0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pipe_partitioned'</span>: True, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grad_partitioned'</span>: True}</span>
<span id="cb7-2240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pld_enabled .................. False</span>
<span id="cb7-2241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   pld_params ................... False</span>
<span id="cb7-2242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   prescale_gradients ........... False</span>
<span id="cb7-2243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   scheduler_name ............... None</span>
<span id="cb7-2244"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   scheduler_params ............. None</span>
<span id="cb7-2245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   seq_parallel_communication_data_type  torch.float32</span>
<span id="cb7-2246"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   sparse_attention ............. None</span>
<span id="cb7-2247"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   sparse_gradients_enabled ..... False</span>
<span id="cb7-2248"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   steps_per_print .............. 100</span>
<span id="cb7-2249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   timers_config ................ enabled=True synchronized=True</span>
<span id="cb7-2250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   train_batch_size ............. 24</span>
<span id="cb7-2251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   train_micro_batch_size_per_gpu  1</span>
<span id="cb7-2252"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   use_data_before_expert_parallel_  False</span>
<span id="cb7-2253"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   use_node_local_storage ....... False</span>
<span id="cb7-2254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   wall_clock_breakdown ......... False</span>
<span id="cb7-2255"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   weight_quantization_config ... None</span>
<span id="cb7-2256"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   world_size ................... 24</span>
<span id="cb7-2257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_allow_untested_optimizer  False</span>
<span id="cb7-2258"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True</span>
<span id="cb7-2259"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_enabled ................. False</span>
<span id="cb7-2260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_force_ds_cpu_optimizer .. True</span>
<span id="cb7-2261"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:1003:print</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   zero_optimization_stage ...... 0</span>
<span id="cb7-2262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">config.py:989:print_user_config</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>   json = {</span>
<span id="cb7-2263">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb7-2264">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_micro_batch_size_per_gpu"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb7-2265">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steps_per_print"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 100,</span>
<span id="cb7-2266">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero_optimization"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb7-2267">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stage"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0</span>
<span id="cb7-2268">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb7-2269">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bf16"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> {</span>
<span id="cb7-2270">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"enabled"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true</span>
<span id="cb7-2271">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2272"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-2273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,293] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:105:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> CONFIG: micro_batches=1 micro_batch_size=1</span>
<span id="cb7-2274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,294] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,298] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:165:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> RANK=0 STAGE=0 LAYERS=37 [0, 37<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STAGE_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TOTAL_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">UNIQUE_PARAMS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8032358400 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8032.358M</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.298751]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:511</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> after deepspeed init</span>
<span id="cb7-2277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.299527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:162</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> hf_w.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=128512</span>
<span id="cb7-2278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57.299951]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf2megads_weight_converter.py:163</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> self.token_vocab=128000</span>
<span id="cb7-2279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,373] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,410] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,525] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2282">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--hidden-size</span> HIDDEN_SIZE]</span>
<span id="cb7-2283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">!!!</span> ATTENTION !!!</span>
<span id="cb7-2284">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--num-attention-heads</span> NUM_ATTENTION_HEADS]</span>
<span id="cb7-2285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'up'</span> to get to the frame that called dist.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2286">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--kv-channels</span> KV_CHANNELS]</span>
<span id="cb7-2287"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /opt/aurora/24.180.0/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/torch/distributed/__init__.py<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">breakpoint()</span></span>
<span id="cb7-2288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2289"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,531] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,539] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,613] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,677] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,689] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,689] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,694] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,694] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,733] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,768] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,769] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,823] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,857] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,869] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:57,876] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,057] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,058] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,102] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2308"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-10-16</span> 15:43:58,102] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">engine.py:146:__init__</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> is_pipe_partitioned= False is_grad_partitioned= False</span>
<span id="cb7-2309">                                     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[--ffn-hidden-size</span> FFN_HIDDEN_SIZE]</span>
<span id="cb7-2310"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">l</span></span>
<span id="cb7-2311"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">84</span>                pdb.message<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2312"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">85</span>                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n!!! ATTENTION !!!\n\n"</span></span>
<span id="cb7-2313"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">86</span>                    f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type 'up' to get to the frame that called dist.breakpoint(rank={rank})\n"</span></span>
<span id="cb7-2314"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">87</span>                <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2315"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">88</span>                pdb.set_trace<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2316"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>        barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2317"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">90</span>     </span>
<span id="cb7-2318"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">91</span>        if sys.platform != <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"win32"</span>:</span>
<span id="cb7-2319"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">92</span>            from torch._C._distributed_c10d import <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2320"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">93</span>                HashStore,</span>
<span id="cb7-2321"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">94</span>                _round_robin_process_groups,</span>
<span id="cb7-2322"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ll</span></span>
<span id="cb7-2323"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">74</span>        def breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rank:</span> int = 0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2324"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">75</span>            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb7-2325"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 76            Set a breakpoint, but only on a single rank.  All other ranks will wait for you to be</span></span>
<span id="cb7-2326"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 77            done with the breakpoint before continuing.</span></span>
<span id="cb7-2327"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 78     </span></span>
<span id="cb7-2328"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 79            Args:</span></span>
<span id="cb7-2329"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 80                rank (int): Which rank to break on.  Default: </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">``</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">``</span></span>
<span id="cb7-2330"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> 81            """</span></span>
<span id="cb7-2331"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82</span>            if get_rank<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==</span> rank:</span>
<span id="cb7-2332"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">83</span>                pdb = _DistributedPdb<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2333"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">84</span>                pdb.message<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2334"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">85</span>                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n!!! ATTENTION !!!\n\n"</span></span>
<span id="cb7-2335"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">86</span>                    f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type 'up' to get to the frame that called dist.breakpoint(rank={rank})\n"</span></span>
<span id="cb7-2336"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">87</span>                <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2337"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">88</span>                pdb.set_trace<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2338"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">89</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>        barrier<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2339"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">up</span></span>
<span id="cb7-2340"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /lus/flare/projects/Aurora_deployment/foremans/projects/argonne-lcf/Megatron-DeepSpeed/tools/hf2megads_weight_converter.py<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">224</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">_qkv_refactor()</span></span>
<span id="cb7-2341"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> torch.distributed.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2342"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ll</span></span>
<span id="cb7-2343"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">194</span>        def _qkv_refactor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self,</span> pname, p, hf_layer<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2344"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">195</span>            hf_wq_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.q_proj.weight"</span></span>
<span id="cb7-2345"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">196</span>            hf_wk_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.k_proj.weight"</span></span>
<span id="cb7-2346"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">197</span>            hf_wv_name = f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model.layers.{hf_layer}.self_attn.v_proj.weight"</span></span>
<span id="cb7-2347"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">198</span>            wq = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wq_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2348"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">199</span>            wk = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wk_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">200</span>            wv = self.hf_model<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">hf_wv_name</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2350"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">201</span>     </span>
<span id="cb7-2351"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">202</span>            hidden_size = wq.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-2352"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">203</span>            per_partition_size, start_index, end_index = compute_partition_range<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2353"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">204</span>                hidden_size, self.tp_rank, self.tp_size<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2354"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">205</span>            hidden_size_per_attention_head = divide<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size,</span></span>
<span id="cb7-2355"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">206</span>                                                    self.config.num_attention_heads<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2356"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">207</span>            num_attention_heads_per_partition = divide<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">self.config.num_attention_heads,</span></span>
<span id="cb7-2357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">208</span>                                                       self.tp_size<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2358"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">209</span>     </span>
<span id="cb7-2359"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">210</span>            new_w = torch.zeros<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per_partition_size</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> 3, wq.shape<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> dtype=wq.dtype<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">211</span>     </span>
<span id="cb7-2361"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">212</span>            for i in range<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_per_partition</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-2362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">213</span>                try:</span>
<span id="cb7-2363"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">214</span>                    current_index = start_index + i <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head</span>
<span id="cb7-2364"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">215</span>                    next_index = current_index + hidden_size_per_attention_head</span>
<span id="cb7-2365"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">216</span>                    new_w_index = i <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2366"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">217</span>                    new_w[new_w_index: new_w_index + <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> hidden_size_per_attention_head<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> :] = <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2367">218                        torch.cat<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb7-2368">219                            wq[current_index: next_index, <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">:],</span></span>
<span id="cb7-2369"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">220</span>                            wk[current_index: next_index, :],</span>
<span id="cb7-2370"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">221</span>                            wv[current_index: next_index, :]</span>
<span id="cb7-2371"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">222</span>                        ], dim=0<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2372"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">223</span>                except Exception:</span>
<span id="cb7-2373"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">224</span>  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>                torch.distributed.breakpoint<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2374"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">225</span>            self.record_mapping_info<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-2375"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">226</span>                f<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mega-ds:{pname,p.data.shape}&lt;--hf{hf_wq_name,hf_wk_name,hf_wv_name,}  cat q,k,v [{current_index}:{next_index},:]  of q,k,v{wq.shape}"</span></span>
<span id="cb7-2376"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">227</span>            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2377"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">228</span>            return new_w</span>
<span id="cb7-2378"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">current_index</span></span>
<span id="cb7-2379"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb7-2380"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">next_index</span></span>
<span id="cb7-2381"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1152</span></span>
<span id="cb7-2382"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w_index</span></span>
<span id="cb7-2383"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3072</span></span>
<span id="cb7-2384"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2385"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2386"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wq</span></span>
<span id="cb7-2387"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tensor</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 0.0053, -0.0291, -0.0058,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0095,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0420,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0272],</span></span>
<span id="cb7-2388">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0142,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0679,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0049,</span>  ..., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0142,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0498,</span>  0.0192],</span>
<span id="cb7-2389">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0162,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0393,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0026,</span>  ...,  0.0115, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0126,</span>  0.0071],</span>
<span id="cb7-2390">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...,</span></span>
<span id="cb7-2391">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0039,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0393,</span>  0.0806,  ...,  0.0061, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0013,</span>  0.0023],</span>
<span id="cb7-2392">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0035,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0101,</span>  0.0459,  ...,  0.0049, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0011,</span>  0.0011],</span>
<span id="cb7-2393">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[-0.0018,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0.0153,</span>  0.0347,  ...,  0.0110,  0.0004,  0.0044]],</span>
<span id="cb7-2394">       <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dtype</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_fn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=&lt;</span>CloneBackward0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2395"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wq.shape</span></span>
<span id="cb7-2396"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4096,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2397"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wk.shape</span></span>
<span id="cb7-2398"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1024,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2399"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wv.shape</span></span>
<span id="cb7-2400"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1024,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2401"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hidden_size</span></span>
<span id="cb7-2402"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span></span>
<span id="cb7-2403"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">per_partition_size</span></span>
<span id="cb7-2404"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span></span>
<span id="cb7-2405"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">num_attention_heads_per_partition</span></span>
<span id="cb7-2406"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb7-2407"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2408"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2409"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new_w.shape</span></span>
<span id="cb7-2410"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12288,</span> 4096]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-2411"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Pdb</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div>
</details>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Converting {Checkpoints}},
  date = {2024-10-17},
  url = {https://samforeman.me/posts/AuroraGPT/checkpoints},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúConverting Checkpoints.‚Äù</span> October 17,
2024. <a href="https://samforeman.me/posts/AuroraGPT/checkpoints">https://samforeman.me/posts/AuroraGPT/checkpoints</a>.
</div></div></section></div> ]]></description>
  <category>ALCF</category>
  <category>AuroraGPT</category>
  <category>Aurora</category>
  <category>Megatron-DeepSpeed</category>
  <category>XPU</category>
  <guid>https://samforeman.me/posts/AuroraGPT/checkpoints/</guid>
  <pubDate>Thu, 17 Oct 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üèîÔ∏è Spike Skipper</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/spike-skipper/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="callout callout-style-simple callout-caution callout-titled" title="Details" style="width:100%">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Details
</div>
</div>
<div class="callout-body-container callout-body">
<p>We describe below our implementation for skipping individual steps during training.</p>
</div>
</div>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">üìù Example</h2>
<p>Suppose we observe a large spike in our loss curve, as shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/spike-skipper.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="spike-skipper"><img src="https://samforeman.me/posts/AuroraGPT/spike-skipper/assets/spike-skipper.png" class="img-fluid figure-img" alt="spike-skipper"></a></p>
<figcaption>spike-skipper</figcaption>
</figure>
</div>
<p>Seemingly, this spike is being caused by a batch of ‚Äúbad data‚Äù. In order to prevent this ‚Äúbad data‚Äù sample from corrupting our training, we would like to ‚Äúskip‚Äù that particular training step.</p>
<p>This can be accomplished by passing the keyword argument <code>--train-range-to-skip</code> and specifying the endpoints of the ranges to be skipped.</p>
<p>e.g., if you would like to skip all steps from <code>[10, 20]</code> and from <code>[25, 30]</code>, we would specify:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PBS_O_WORKDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> train_aGPT_7B.sh <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-range-to-skip</span> 10 20 25 30</span></code></pre></div>
</section>
<section id="implementation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="implementation">üß™ Implementation</h2>
<p>We discuss below the details of the implementation, and provide some simple results to confirm things are behaving how we expect.</p>
<ol type="1">
<li><p>Check if <code>args.train_range_to_skip is not None</code> [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1032">here</a>]</p>
<ul>
<li><p>Assert <code>len(args.train_range_to_skip) % 2 == 0</code> [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1033-L1037">here</a>]</p>
</li>
<li><p>Zip these up into pairs [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1038-L1043">here</a>]:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1">ranges_to_skip <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(</span>
<span id="cb2-3">        args.train_range_to_skip[::<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb2-4">        args.train_range_to_skip[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>::<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb2-5">    )</span>
<span id="cb2-6">)</span></code></pre></div></li>
</ul></li>
<li><p>If current iteration is in any of these pairs [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1066-L1085">here</a>]</p>
<ul>
<li><p>For each <code>micro_step</code> in <code>range(gradient_accumulation_steps)</code>, explicitly:</p>
<ul>
<li>draw a new batch of data [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1074-L1076">here</a>] from our <code>train_data_iterator</code></li>
<li>immediately discard it (instead of propagating it through the network)</li>
</ul></li>
<li><p>Increment [<a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1087-L1094">here</a>]:</p>
<ul>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1090"><code>DeepSpeedEngine.skipped_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1091"><code>DeepSpeedEngine.global_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1092"><code>DeepSpeedEngine.micro_steps</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1093"><code>DeepSpeedEngine.global_samples</code></a></li>
<li><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/295fcb3d57a40ec513a521aa8814d99a5c8827b8/megatron/training.py#L1094"><code>lr_scheduler</code></a></li>
</ul></li>
</ul></li>
</ol>
<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Must be even since we‚Äôre specifying the <em>endpoint<strong>s</strong></em> of intervals to skip</p>
</div></div></section>
<section id="sanity-check" class="level2">
<h2 class="anchored" data-anchor-id="sanity-check">‚úÖ Sanity Check</h2>
<p>In order to confirm things are behaving as expected, we can explicitly look at the tokens drawn for each step, and ensure that they are the same regardless of whether or not that iteration was skipped.</p>
<ul>
<li><p>In particular, we see that:</p>
<ul>
<li><p>test 1:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 23:09:09.059118][INFO][training:1083] - iteration=2 [0/8]: (torch.Size([4, 4097]))</span></span>
<span id="cb3-2">_tokens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb3-3">    [[ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1858</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3851</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29889</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>],</span>
<span id="cb3-4">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">349</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6156</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1650</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5806</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28557</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3519</span>],</span>
<span id="cb3-5">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16554</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1653</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">322</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6934</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14722</span>],</span>
<span id="cb3-6">     [ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4955</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10465</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1438</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3841</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>]]</span>
<span id="cb3-7">)</span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 23:09:09.061999][INFO][training:1083] - iteration=2 [1/8]: (torch.Size([4, 4097]))</span></span>
<span id="cb3-9">_tokens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb3-10">    [[  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">363</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1302</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16453</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7967</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29891</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">484</span>],</span>
<span id="cb3-11">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">367</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">766</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4752</span>,  ...,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29871</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30143</span>],</span>
<span id="cb3-12">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29899</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">855</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1503</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3786</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5100</span>],</span>
<span id="cb3-13">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">465</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1974</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">289</span>,  ..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21588</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">533</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>]]</span>
<span id="cb3-14">)</span></code></pre></div></li>
<li><p>test 2:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:27.752277][INFO][pretrain_gpt_alcf:198] - args.iteration=2:</span></span>
<span id="cb4-2">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb4-3">    [[ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1858</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3851</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29889</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>],</span>
<span id="cb4-4">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">349</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6156</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1650</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5806</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28557</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3519</span>],</span>
<span id="cb4-5">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16554</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1653</span>,  ...,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">322</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6934</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14722</span>],</span>
<span id="cb4-6">     [ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4955</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10465</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1438</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3841</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>]]</span>
<span id="cb4-7">)</span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:27,755] [INFO] [profiler.py:81:start_profile] Flops profiler started</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [2024-09-16 22:59:28.568805][INFO][pretrain_gpt_alcf:198] - args.iteration=2:</span></span>
<span id="cb4-10">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor(</span>
<span id="cb4-11">    [[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">363</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1302</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16453</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7967</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29891</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">484</span>],</span>
<span id="cb4-12">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">367</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">766</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4752</span>,  ...,     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29871</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30143</span>],</span>
<span id="cb4-13">     [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29899</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">855</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1503</span>,  ...,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3786</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29892</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5100</span>],</span>
<span id="cb4-14">     [  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">465</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1974</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">289</span>,  ..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21588</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">533</span>,   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">304</span>]]</span>
<span id="cb4-15">)</span></code></pre></div></li>
</ul>
<p>as expected.</p></li>
</ul>
<section id="details" class="level3">
<h3 class="anchored" data-anchor-id="details">üîç Details</h3>
<ul>
<li><p>First 4 steps:</p>
<details closed="">
<summary>
<p><code>tokens</code>:</p>
</summary>
<ul>
<li><p>Iteration 0:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:58:50.168667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,  7344,  5146,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9776,</span> 29914, 26419],</span>
<span id="cb5-2">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,  4706,  ...,  9280, 30004,    13],</span>
<span id="cb5-3">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29943,</span> 20774, 29908,  ...,   304, 27391,   322],</span>
<span id="cb5-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2645,   445, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16888,</span>  4656, 10070]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:58:58.866409]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2768,   596,  1788,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27274,</span>   393, 30010],</span>
<span id="cb5-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5613,  4192,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">362,</span>   310,  1950],</span>
<span id="cb5-7">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[28038,</span> 29892,  2022,  ...,  3160,   278,  2087],</span>
<span id="cb5-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4149,   907, 29888,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29896,</span> 29892, 29896]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:02.043059]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  424,   322, 16232,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">366,</span>   748,   467],</span>
<span id="cb5-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,   462,  1678,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2084,</span> 29892,  3497],</span>
<span id="cb5-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7562,   310, 19320,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8973,</span> 22684,   358],</span>
<span id="cb5-12">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2089,  3633,   292,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13774,</span>   269,  2375]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:03.456919]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[21411,</span>   322,  3896,  ...,  2610, 29889,   319],</span>
<span id="cb5-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8003, 29898, 29900,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12,</span>  6658,   529],</span>
<span id="cb5-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  4148,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span> 12212,   282],</span>
<span id="cb5-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5977, 29871, 29906,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15332,</span>   310,  1749]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:04.596630]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  278,  1473, 24987,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  2217,  3804],</span>
<span id="cb5-18">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2973,   263, 18778,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  4642,  6673],</span>
<span id="cb5-19">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  309,   323,   804,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1063,</span> 15296,   327],</span>
<span id="cb5-20">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5864,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9409,</span> 29889,  2178]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:05.486913]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29892,</span> 13731,  6617,  ..., 29871, 29896, 29946],</span>
<span id="cb5-22">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2892,  1012,  1266,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4036,</span>  7512,  2068],</span>
<span id="cb5-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1473,  1556,  3619,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3762,</span>   338,   263],</span>
<span id="cb5-24">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[23353,</span> 29918,  2177,  ...,   501,   567,   814]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:06.361333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5400, 14378,  4768,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2107,</span> 18677, 29889],</span>
<span id="cb5-26">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9200, 29887, 29914,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">293,</span> 24235,   322],</span>
<span id="cb5-27">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[30143,</span>  4746,  2184,  ..., 11891, 29974, 25760],</span>
<span id="cb5-28">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[19263,</span> 29914,   303,  ...,   358, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:07.230671]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  309,  1306,   681,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span> 23186, 21809],</span>
<span id="cb5-30">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29896,</span> 29929,    13,  ..., 29871, 29900,    13],</span>
<span id="cb5-31">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9558,   964,   263,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   282,   682],</span>
<span id="cb5-32">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 23904, 21767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">313,</span> 29929, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 1:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.287338]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       1/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3145728</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>29570.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9.4372e-09 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.167250 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>25.972 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>4432.597 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=20.30</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=26.18</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.289582]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:207</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> [Rank 0] <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">after</span> 1 iterations<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">memory</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MB</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">allocated:</span> 1894.57666015625 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max</span> allocated: 9752.35498046875 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reserved:</span> 11342.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max</span> reserved: 11342.0</span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">26094.39,</span> 26095.09<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3407.56,</span> 3409.92<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:19.297183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1472, 29892,   408,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1584,   363],</span>
<span id="cb6-7">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  967, 19475,  6593,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8093,</span> 29899, 11249],</span>
<span id="cb6-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1006,  2218, 13326,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2355,</span>  1304,   304],</span>
<span id="cb6-9">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 29916, 29947,  ...,   353,  1870, 29936]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.104352]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2354,   274,  1041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 13049,  9098],</span>
<span id="cb6-11">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8798,  9547, 10353,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">303,</span>  3143, 29889],</span>
<span id="cb6-12">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1373,  4056,  7236,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3186,</span>   297,  5837],</span>
<span id="cb6-13">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1738, 29920,  7355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29871,  3776]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977036]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> building dataset for /flare/Aurora_deployment/AuroraGPT/datasets/dolma/data_v1.7_Llama2Tokenizer/c4-0000_text_document</span>
<span id="cb6-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977877]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building dataset index ...</span>
<span id="cb6-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:20.977147]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2020,   306,  1016,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   920,   372],</span>
<span id="cb6-17">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5921,  1749,  7306,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19252,</span>   297,  5664],</span>
<span id="cb6-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  970,   770, 28547,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">970,</span>   894,  2577],</span>
<span id="cb6-19">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1907,   363, 14188,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">756,</span>  3646,   287]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:21.851620]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  715, 25392,  3104,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">289,</span>  5761,   616],</span>
<span id="cb6-21">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  426,    13,  9651,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9651,</span>  1815, 22603],</span>
<span id="cb6-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7714,  1213,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29876,   457],</span>
<span id="cb6-23">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span> 28663,  1230,  ...,  1546,   278,  6586]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:22.720945]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29929,</span>    13,    13,  ..., 10739,  4770, 11277],</span>
<span id="cb6-25">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4528,   304,  2367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2501,</span>   385,  4203],</span>
<span id="cb6-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  869,   319,   794,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3158,</span> 29889,  3115],</span>
<span id="cb6-27">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  592,   260,  4125,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">284,</span>  1135, 18655]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:23.590149]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[14338,</span> 25323,  3321,  ...,  5607,  1806,  1164],</span>
<span id="cb6-29">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  322,   278, 15352,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6462,</span>   313,  1552],</span>
<span id="cb6-30">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[25738,</span>   714, 29889,  ..., 29915, 29879, 24842],</span>
<span id="cb6-31">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5122,   399, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29947,</span>  7284,  2305]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:24.457646]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  367, 19310,  1891,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2408,</span>   292,   263],</span>
<span id="cb6-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  470,  3307,  5713,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">568,</span>  2594, 19385],</span>
<span id="cb6-34">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29953,</span> 29905,  1631,  ...,  1118,   343, 29897],</span>
<span id="cb6-35">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10261,</span>   373,  5490,  ...,   511,   297,  1760]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:25.326699]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=1: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1006,   326, 29901,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14834,</span>  6694,  9595],</span>
<span id="cb6-37">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12058,</span>  5446, 29892,  ..., 29889,  8246,  3310],</span>
<span id="cb6-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7483,   310,   278,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">402,</span>  9851,  4423],</span>
<span id="cb6-39">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8041,   813,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3303,</span>  3900,   393]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 2:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27.744603]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       2/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1536</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6291456</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8457.2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.88744e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.164009 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.271 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>90.810 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>15498.234 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=70.98</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=91.53</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8384.83,</span> 8385.57<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">55.03,</span> 55.61<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27.752277]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 1858,  3851, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">500,</span>    13,    13],</span>
<span id="cb7-6">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  349,  6156,  1650,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5806,</span> 28557,  3519],</span>
<span id="cb7-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16554,</span>   304,  1653,  ...,   322,  6934, 14722],</span>
<span id="cb7-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4955,   310, 10465,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1438,</span>  3841, 29892]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:27,755] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:28.568805]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  363,  1302, 16453,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7967,</span> 29891,   484],</span>
<span id="cb7-11">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  367,   766,  4752,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 29871, 30143],</span>
<span id="cb7-12">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>   855,  1503,  ...,  3786, 29892,  5100],</span>
<span id="cb7-13">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  465,  1974,   289,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21588,</span>   533,   304]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:28,571] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:29.440843]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span>    13,  4806,  ...,  3086, 26040,  9220],</span>
<span id="cb7-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  293,  7207,   355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18131,</span>   520,  1247],</span>
<span id="cb7-17">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8619, 29889, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">304,</span> 10029,   266],</span>
<span id="cb7-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  363, 15202, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">482,</span> 17162, 19104]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:29,443] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:30.313403]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[25561,</span>   411,   278,  ...,   297,  2898, 26163],</span>
<span id="cb7-21">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[22574,</span>  2607, 18134,  ...,    13,  4706,   500],</span>
<span id="cb7-22">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[20190,</span> 24820,  1623,  ...,   310,   901, 29892],</span>
<span id="cb7-23">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>  1951,  4486,  ...,   869,   887, 30010]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:30,316] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:31.185339]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5371, 22417, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span>  6716,   901],</span>
<span id="cb7-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  353,  1565, 29936,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29878,</span>  3567,  7196],</span>
<span id="cb7-27">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[17296,</span>   338,  1985,  ...,  3741,  9089,   422],</span>
<span id="cb7-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  694, 13331,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21180,</span> 29892,   607]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:31,188] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32.057207]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  292,  8818,   267,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 11275,  7407],</span>
<span id="cb7-31">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1870, 29897,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2697,</span> 29901,    13],</span>
<span id="cb7-32">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29913,</span>   338,   263,  ..., 29892,   591,  3394],</span>
<span id="cb7-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2253,   472,  1554,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">982,</span>   304,   376]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32,060] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32.930293]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  391,  2598, 29883,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22629,</span>   346,   440],</span>
<span id="cb7-36">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29896, 29906,  ...,   407,   583,  2833],</span>
<span id="cb7-37">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4262,  1836,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   263, 10608],</span>
<span id="cb7-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1199,   411, 24770,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">272,</span>  2153, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:32,932] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profiler.py:81:start_profile</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Flops profiler started</span>
<span id="cb7-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:33.803567]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=2: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  620, 20503,   428,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">297,</span>  1009,  9443],</span>
<span id="cb7-41">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  950, 25078,   892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span> 10636,   284],</span>
<span id="cb7-42">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1012,  2003,   364,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7313,</span> 29912, 19303],</span>
<span id="cb7-43">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29892, 29945,  ...,   967, 26414,   472]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 3:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:34.881265]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       3/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2304</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9437184</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7136.5 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2.83116e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.164038 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.279 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>107.615 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18366.372 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=84.12</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=108.46</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb8-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb8-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7078.48,</span> 7079.28<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">38.62,</span> 43.08<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:34.888870]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  496,   313, 29941,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1316,</span>   408,  4857],</span>
<span id="cb8-6">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>  3204, 29889,  ...,  1074,   330,  2547],</span>
<span id="cb8-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29916,</span> 29900, 29946,  ..., 18455, 29889,  4002],</span>
<span id="cb8-8">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[26406,</span>   338,  1641,  ...,   670,  1914,  6900]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:35.719630]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29945,</span> 29900,   867,  ...,  7601, 12091,   310],</span>
<span id="cb8-10">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  975, 29871, 29896,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3573,</span>   825,   306],</span>
<span id="cb8-11">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29900,  4638,  ..., 29227, 23145, 29892],</span>
<span id="cb8-12">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 14368,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14909,</span> 29936, 25913]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:36.591343]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  988,   306,  1033,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">437,</span>   408,  1532],</span>
<span id="cb8-14">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  450, 10317,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   752, 13036],</span>
<span id="cb8-15">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11405,</span>  8020, 29889,  ...,   471, 18096,   287],</span>
<span id="cb8-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  288,  3594, 19284,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">910,</span>   338,   385]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:37.463941]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  322, 15151, 29946,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11648,</span>  1497, 29889],</span>
<span id="cb8-18">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[24233,</span>   362,   467,  ...,  4513,  1353,   322],</span>
<span id="cb8-19">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 3311, 13605, 29912,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">945,</span> 29899,  4181],</span>
<span id="cb8-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1951,   366,   508,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6589,</span>   491,   777]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:38.343307]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span> 29900,    13,  ...,  6017,   424,  1711],</span>
<span id="cb8-22">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  5500,  1489,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>  3802,  7875],</span>
<span id="cb8-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8078,  5314,   515,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">373,</span>   278,  6991],</span>
<span id="cb8-24">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[13763,</span>  6204,  6359,  ...,  4706,  2024,  1347]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:39.214871]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>   13,  4806,  3512,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">278,</span>  7824,  6438],</span>
<span id="cb8-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2294,   938,   903,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4537,</span>  3047,   449],</span>
<span id="cb8-27">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1230,  4123,   767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   963, 21003],</span>
<span id="cb8-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1152,  2319, 10365,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">367,</span> 14040,   363]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.085368]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> building dataset for /flare/Aurora_deployment/AuroraGPT/datasets/dolma/data_v1.7_Llama2Tokenizer/tulu_flan-0000_text_document</span>
<span id="cb8-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.086224]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">utils:326</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> building dataset index ...</span>
<span id="cb8-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.085475]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[27297,</span> 29924,   801,  ..., 28947, 29892,   470],</span>
<span id="cb8-32">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12542,</span>  5568,   703,  ...,   426,    13,  4706],</span>
<span id="cb8-33">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 6907,   800,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1661, 30304],</span>
<span id="cb8-34">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 13630,   293,  ..., 26552,   363,   975]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:40.958071]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>   13, 29946, 29953,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29953,</span> 29945, 29871],</span>
<span id="cb8-36">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1283, 16578,  1156,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span>  2215,   408],</span>
<span id="cb8-37">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span>  4229,  7671,  ...,    13,  1576,  1014],</span>
<span id="cb8-38">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  526,  2898,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">471,</span>  4802, 29991]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 4:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.028460]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       4/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3072</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12582912</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7147.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3.77488e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.171233 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.272 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>107.458 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>18339.524 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=84.00</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=108.31</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb9-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">min,</span> max<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> across ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ms</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">forward-backward</span> ...............................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7091.77,</span> 7092.56<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">optimizer</span> ......................................: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">39.21,</span> 40.11<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.035716]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  443,   666, 10170,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">278,</span>   619,  7323],</span>
<span id="cb9-6">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13, 11008,   338,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2472,</span>   363, 22049],</span>
<span id="cb9-7">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span>    13, 29938,  ..., 29962,  8521, 29896],</span>
<span id="cb9-8">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1165,  2280,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">306,</span>   471,  2086]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:42.860756]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,   679,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1475,</span> 29889,  1570],</span>
<span id="cb9-10">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2184, 29936,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4706,</span>   970,  1780],</span>
<span id="cb9-11">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29872,</span>   352, 29901,  ..., 29905,  4915, 29912],</span>
<span id="cb9-12">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16809,</span>   304,  1438,  ..., 13457, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:43.731208]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[12015,</span> 29901, 20549,  ...,   322, 10752, 17906],</span>
<span id="cb9-14">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  372, 30010, 29879,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 14595,   653],</span>
<span id="cb9-15">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[18280,</span> 29958,    13,  ..., 18884,   736,  6251],</span>
<span id="cb9-16">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,    13,  ...,   599,   373, 17097]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:44.605047]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 3367,   567,   964,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3353,</span> 24870,  2181],</span>
<span id="cb9-18">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1262,  2609,   367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29974,</span> 29896,  7570],</span>
<span id="cb9-19">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29941, 29900,  ...,   341,   555,   265],</span>
<span id="cb9-20">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4225,   526,  6041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1925,</span>  1623,  2748]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:45.479433]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2283, 10162,  1496,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">30656,</span> 30317, 30605],</span>
<span id="cb9-22">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29879,</span>  9228,   292,  ...,  7968, 29899,  7052],</span>
<span id="cb9-23">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  884,   599,   367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>   278,  6054],</span>
<span id="cb9-24">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29879,</span>   411,   278,  ...,   367,  5019,  1183]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:46.351707]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 3867,   281,   761,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11949,</span>   338,  4922],</span>
<span id="cb9-26">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  1432,  2586,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5414,</span>   278, 29811],</span>
<span id="cb9-27">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>   278, 15562,  ..., 10296,   310,   394],</span>
<span id="cb9-28">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1451,  2960,  3505,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">657,</span> 14346,  8003]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:47.222016]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 6601,  2874,   414,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">302,</span>   317,  7390],</span>
<span id="cb9-30">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16415,</span>   297,  5146,  ...,   763,   372,   471],</span>
<span id="cb9-31">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29941,</span> 29906,  1118,  ..., 29900, 29889, 29953],</span>
<span id="cb9-32">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4893,   304,  4808,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2284,</span>  2164, 18690]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 22:59:48.094752]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=4: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  901,   310,  2994,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29873,</span>  1641,   766],</span>
<span id="cb9-34">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  304,  1716,  2562,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3489,</span>   304,   367],</span>
<span id="cb9-35">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1949,  6736, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29965,</span> 29909,   353],</span>
<span id="cb9-36">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,    13, 29930,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16497,</span>   316,   474]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
</ul>
</details></li>
<li><p>Skipping steps <code>[2, 3]</code>:</p>
<details closed="">
<summary>
<p><code>tokens</code>:</p>
</summary>
<ul>
<li><p>Iteration 0:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:47.749839]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  304,  7344,  5146,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9776,</span> 29914, 26419],</span>
<span id="cb10-2">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span>    13,  4706,  ...,  9280, 30004,    13],</span>
<span id="cb10-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29943,</span> 20774, 29908,  ...,   304, 27391,   322],</span>
<span id="cb10-4">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2645,   445, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">16888,</span>  4656, 10070]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:51.451183]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 2768,   596,  1788,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27274,</span>   393, 30010],</span>
<span id="cb10-6">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5613,  4192,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">362,</span>   310,  1950],</span>
<span id="cb10-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[28038,</span> 29892,  2022,  ...,  3160,   278,  2087],</span>
<span id="cb10-8">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4149,   907, 29888,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29896,</span> 29892, 29896]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:54.073597]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  424,   322, 16232,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">366,</span>   748,   467],</span>
<span id="cb10-10">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>   13,   462,  1678,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2084,</span> 29892,  3497],</span>
<span id="cb10-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7562,   310, 19320,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8973,</span> 22684,   358],</span>
<span id="cb10-12">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2089,  3633,   292,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13774,</span>   269,  2375]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:56.212476]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[21411,</span>   322,  3896,  ...,  2610, 29889,   319],</span>
<span id="cb10-14">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8003, 29898, 29900,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12,</span>  6658,   529],</span>
<span id="cb10-15">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  4148,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span> 12212,   282],</span>
<span id="cb10-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5977, 29871, 29906,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15332,</span>   310,  1749]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:57.207940]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  278,  1473, 24987,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  2217,  3804],</span>
<span id="cb10-18">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2973,   263, 18778,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">263,</span>  4642,  6673],</span>
<span id="cb10-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  309,   323,   804,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1063,</span> 15296,   327],</span>
<span id="cb10-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278,  5864,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9409,</span> 29889,  2178]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:58.083935]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29892,</span> 13731,  6617,  ..., 29871, 29896, 29946],</span>
<span id="cb10-22">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2892,  1012,  1266,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4036,</span>  7512,  2068],</span>
<span id="cb10-23">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1473,  1556,  3619,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3762,</span>   338,   263],</span>
<span id="cb10-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[23353,</span> 29918,  2177,  ...,   501,   567,   814]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:58.951793]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> 5400, 14378,  4768,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2107,</span> 18677, 29889],</span>
<span id="cb10-26">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9200, 29887, 29914,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">293,</span> 24235,   322],</span>
<span id="cb10-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[30143,</span>  4746,  2184,  ..., 11891, 29974, 25760],</span>
<span id="cb10-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[19263,</span> 29914,   303,  ...,   358, 29889,    13]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb10-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:08:59.820234]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=0: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span>  309,  1306,   681,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span> 23186, 21809],</span>
<span id="cb10-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29896,</span> 29929,    13,  ..., 29871, 29900,    13],</span>
<span id="cb10-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 9558,   964,   263,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   282,   682],</span>
<span id="cb10-32">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 23904, 21767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">313,</span> 29929, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 1:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.943867]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       1/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3145728</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>21224.4 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9.4372e-09 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>768 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lm</span> loss=11.167250 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>36.185 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6175.523 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=28.29</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=36.47</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.953432]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1472, 29892,   408,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1584,   363],</span>
<span id="cb11-4">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  967, 19475,  6593,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8093,</span> 29899, 11249],</span>
<span id="cb11-5">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1006,  2218, 13326,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2355,</span>  1304,   304],</span>
<span id="cb11-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 29916, 29947,  ...,   353,  1870, 29936]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.957524]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 2354,   274,  1041,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 13049,  9098],</span>
<span id="cb11-9">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8798,  9547, 10353,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">303,</span>  3143, 29889],</span>
<span id="cb11-10">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1373,  4056,  7236,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3186,</span>   297,  5837],</span>
<span id="cb11-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1738, 29920,  7355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29871,  3776]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.966648]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 2020,   306,  1016,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   920,   372],</span>
<span id="cb11-14">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5921,  1749,  7306,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">19252,</span>   297,  5664],</span>
<span id="cb11-15">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  970,   770, 28547,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">970,</span>   894,  2577],</span>
<span id="cb11-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1907,   363, 14188,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">756,</span>  3646,   287]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.969989]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  715, 25392,  3104,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">289,</span>  5761,   616],</span>
<span id="cb11-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  426,    13,  9651,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9651,</span>  1815, 22603],</span>
<span id="cb11-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7714,  1213,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span> 29876,   457],</span>
<span id="cb11-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29889,</span> 28663,  1230,  ...,  1546,   278,  6586]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.990736]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29929,</span>    13,    13,  ..., 10739,  4770, 11277],</span>
<span id="cb11-24">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4528,   304,  2367,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2501,</span>   385,  4203],</span>
<span id="cb11-25">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  869,   319,   794,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3158,</span> 29889,  3115],</span>
<span id="cb11-26">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  592,   260,  4125,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">284,</span>  1135, 18655]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:08.993101]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">5/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[14338,</span> 25323,  3321,  ...,  5607,  1806,  1164],</span>
<span id="cb11-29">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  322,   278, 15352,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6462,</span>   313,  1552],</span>
<span id="cb11-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[25738,</span>   714, 29889,  ..., 29915, 29879, 24842],</span>
<span id="cb11-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 5122,   399, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29947,</span>  7284,  2305]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.036896]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">6/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  367, 19310,  1891,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2408,</span>   292,   263],</span>
<span id="cb11-34">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  470,  3307,  5713,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">568,</span>  2594, 19385],</span>
<span id="cb11-35">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29953,</span> 29905,  1631,  ...,  1118,   343, 29897],</span>
<span id="cb11-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[10261,</span>   373,  5490,  ...,   511,   297,  1760]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.039401]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=1 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">7/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb11-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1006,   326, 29901,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14834,</span>  6694,  9595],</span>
<span id="cb11-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12058,</span>  5446, 29892,  ..., 29889,  8246,  3310],</span>
<span id="cb11-40">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 7483,   310,   278,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">402,</span>  9851,  4423],</span>
<span id="cb11-41">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8041,   813,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3303,</span>  3900,   393]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 2:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.050766]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>  iteration=       2/  635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1536</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6291456</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>106.8 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.88744e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>7190.781 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1227226.651 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=5620.92</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=7247.49</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb12-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.055864]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1069</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Caught 3 in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ranges_to_skip'</span>, skipping!</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.057929]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1082</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> torch.Size<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> len<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_data_iterator</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=490723200</span></span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.059118]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 1858,  3851, 29889,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">500,</span>    13,    13],</span>
<span id="cb12-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  349,  6156,  1650,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5806,</span> 28557,  3519],</span>
<span id="cb12-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[16554,</span>   304,  1653,  ...,   322,  6934, 14722],</span>
<span id="cb12-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4955,   310, 10465,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1438,</span>  3841, 29892]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.061999]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  363,  1302, 16453,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7967,</span> 29891,   484],</span>
<span id="cb12-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  367,   766,  4752,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 29871, 30143],</span>
<span id="cb12-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>   855,  1503,  ...,  3786, 29892,  5100],</span>
<span id="cb12-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  465,  1974,   289,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21588,</span>   533,   304]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.065494]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span>    13,  4806,  ...,  3086, 26040,  9220],</span>
<span id="cb12-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  293,  7207,   355,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18131,</span>   520,  1247],</span>
<span id="cb12-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8619, 29889, 29871,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">304,</span> 10029,   266],</span>
<span id="cb12-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  363, 15202, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">482,</span> 17162, 19104]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.069035]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[25561,</span>   411,   278,  ...,   297,  2898, 26163],</span>
<span id="cb12-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[22574,</span>  2607, 18134,  ...,    13,  4706,   500],</span>
<span id="cb12-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[20190,</span> 24820,  1623,  ...,   310,   901, 29892],</span>
<span id="cb12-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29892,</span>  1951,  4486,  ...,   869,   887, 30010]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.072577]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span> 5371, 22417, 29892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13,</span>  6716,   901],</span>
<span id="cb12-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  353,  1565, 29936,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29878,</span>  3567,  7196],</span>
<span id="cb12-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[17296,</span>   338,  1985,  ...,  3741,  9089,   422],</span>
<span id="cb12-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  694, 13331,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21180,</span> 29892,   607]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.075789]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">5/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  292,  8818,   267,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span> 11275,  7407],</span>
<span id="cb12-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1870, 29897,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2697,</span> 29901,    13],</span>
<span id="cb12-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29913,</span>   338,   263,  ..., 29892,   591,  3394],</span>
<span id="cb12-33"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2253,   472,  1554,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">982,</span>   304,   376]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.079052]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">6/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  391,  2598, 29883,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22629,</span>   346,   440],</span>
<span id="cb12-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29871,</span> 29896, 29906,  ...,   407,   583,  2833],</span>
<span id="cb12-37"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 4262,  1836,    13,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   263, 10608],</span>
<span id="cb12-38"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1199,   411, 24770,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">272,</span>  2153, 29889]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb12-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.082739]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training:1083</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration=2 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">7/8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>: <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.Size</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[4,</span> 4097]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>:10<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tensor<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">([[</span>  620, 20503,   428,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">297,</span>  1009,  9443],</span>
<span id="cb12-41"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  950, 25078,   892,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span> 10636,   284],</span>
<span id="cb12-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1012,  2003,   364,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">7313,</span> 29912, 19303],</span>
<span id="cb12-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29892, 29945,  ...,   967, 26414,   472]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
<li><p>Iteration 3:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.135651]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">training_log:661</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iteration= 3/ 635782 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_samples</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2304</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">consumed_tokens</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9437184</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">elapsed_time_per_iteration_ms</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>84.7 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">learning_rate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>2.83116e-08 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_batch_size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">768</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loss_scale</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grad_norm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>6.363 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">actual_seqlen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4096</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_skipped_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">number_of_nan_iterations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samples_per_second</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>9070.783 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tokens_per_gpu_per_second_tgs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1548080.271 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LM]TFLOPs=7090.49</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DS]TFLOPs=9142.31</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span></span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.143511]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[496,</span>   313, 29941,  ...,  1316,   408,  4857],</span>
<span id="cb13-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29899,</span>  3204, 29889,  ...,  1074,   330,  2547],</span>
<span id="cb13-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29916,</span> 29900, 29946,  ..., 18455, 29889,  4002],</span>
<span id="cb13-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[26406,</span>   338,  1641,  ...,   670,  1914,  6900]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:09.971988]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29945,</span> 29900,   867,  ...,  7601, 12091,   310],</span>
<span id="cb13-7">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  975, 29871, 29896,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3573,</span>   825,   306],</span>
<span id="cb13-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span> 29900,  4638,  ..., 29227, 23145, 29892],</span>
<span id="cb13-9">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  278, 14368,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">14909,</span> 29936, 25913]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:10.843966]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[988,</span>   306,  1033,  ...,   437,   408,  1532],</span>
<span id="cb13-11">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  450, 10317,   310,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">322,</span>   752, 13036],</span>
<span id="cb13-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[11405,</span>  8020, 29889,  ...,   471, 18096,   287],</span>
<span id="cb13-13">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  288,  3594, 19284,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">910,</span>   338,   385]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:11.715513]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[322,</span> 15151, 29946,  ..., 11648,  1497, 29889],</span>
<span id="cb13-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[24233,</span>   362,   467,  ...,  4513,  1353,   322],</span>
<span id="cb13-16">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 3311, 13605, 29912,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">945,</span> 29899,  4181],</span>
<span id="cb13-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1951,   366,   508,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6589,</span>   491,   777]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:12.584136]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[29889,</span> 29900,    13,  ...,  6017,   424,  1711],</span>
<span id="cb13-19">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  297,  5500,  1489,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>  3802,  7875],</span>
<span id="cb13-20">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 8078,  5314,   515,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">373,</span>   278,  6991],</span>
<span id="cb13-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[13763,</span>  6204,  6359,  ...,  4706,  2024,  1347]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:13.450767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[13,</span>  4806,  3512,  ...,   278,  7824,  6438],</span>
<span id="cb13-23">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 2294,   938,   903,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4537,</span>  3047,   449],</span>
<span id="cb13-24">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1230,  4123,   767,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">310,</span>   963, 21003],</span>
<span id="cb13-25">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1152,  2319, 10365,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">367,</span> 14040,   363]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:14.317517]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[27297,</span> 29924,   801,  ..., 28947, 29892,   470],</span>
<span id="cb13-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[12542,</span>  5568,   703,  ...,   426,    13,  4706],</span>
<span id="cb13-28">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 6907,   800,   322,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">29892,</span>  1661, 30304],</span>
<span id="cb13-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29900,</span> 13630,   293,  ..., 26552,   363,   975]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb13-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-09-16</span> 23:09:15.187191]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">pretrain_gpt_alcf:198</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> args.iteration=3: data<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:10</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>=tensor<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[[13,</span> 29946, 29953,  ..., 29953, 29945, 29871],</span>
<span id="cb13-31">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> 1283, 16578,  1156,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">408,</span>  2215,   408],</span>
<span id="cb13-32">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[29906,</span>  4229,  7671,  ...,    13,  1576,  1014],</span>
<span id="cb13-33">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span>  526,  2898,   304,  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...,</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">471,</span>  4802, 29991]]<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></li>
</ul>
</details></li>
</ul>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Spike {Skipper}},
  date = {2024-09-17},
  url = {https://samforeman.me/posts/AuroraGPT/spike-skipper},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúSpike Skipper.‚Äù</span> September 17, 2024. <a href="https://samforeman.me/posts/AuroraGPT/spike-skipper">https://samforeman.me/posts/AuroraGPT/spike-skipper</a>.
</div></div></section></div> ]]></description>
  <category>AuroraGPT</category>
  <guid>https://samforeman.me/posts/AuroraGPT/spike-skipper/</guid>
  <pubDate>Tue, 17 Sep 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üçã ezpz @ ALCF</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/ezpz-at-alcf/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<blockquote class="blockquote">
<p><em>Work smarter, not harder</em>.</p>
</blockquote>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">üê£ Getting Started</h2>
<p>There are two main, distinct components of <code>ezpz</code>:</p>
<ol type="1">
<li>üêç <strong>Python Library</strong></li>
<li>üêö <strong>Shell Utilities</strong></li>
</ol>
</section>
<section id="shell-utilities" class="level2">
<h2 class="anchored" data-anchor-id="shell-utilities">üêö Shell Utilities</h2>
<p>The Shell Utilities can be roughly broken up further into two main components</p>
<ol type="1">
<li>Setup Environment:
<ol type="1">
<li>Setup Python:
<ol type="1">
<li>Setup Conda</li>
<li>Setup Virtual Environment</li>
</ol></li>
<li>Setup Job:</li>
</ol></li>
</ol>
<p>We provide a variety of helper functions designed to make your life easier when working with job schedulers (e.g.&nbsp;<code>PBS Pro</code> @ ALCF or <code>slurm</code> elsewhere).</p>
<p><strong>All</strong> of these functions are:</p>
<ul>
<li>located in <a href="../../src/ezpz/bin/utils.sh"><code>utils.sh</code></a></li>
<li>prefixed with <code>ezpz_*</code> (e.g.&nbsp;<code>ezpz_setup_python</code>)<sup>1</sup></li>
</ul>
<p>To use these, we can <code>source</code> the file directly via:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PBS_O_WORKDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if on ALCF</span></span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> /dev/stdin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/saforem2/ezpz/refs/heads/main/src/ezpz/bin/utils.sh'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<section id="setup-environment" class="level3">
<h3 class="anchored" data-anchor-id="setup-environment">‚öôÔ∏è Setup Environment</h3>
<p>We would like to write our application in such a way that it is able to take full advantage of the resources allocated by the job scheduler.</p>
<p>That is to say, we want to have a single script with the ability to dynamically <code>launch</code> python applications across any number of accelerators on any of the systems under consideration.</p>
<p>In order to do this, there is some basic setup and information gathering that needs to occur.</p>
<p>In particular, we need mechanisms for:</p>
<ol type="1">
<li>Setting up a python environment</li>
<li>Determining what system / machine we‚Äôre on
<ul>
<li>+ what job scheduler we‚Äôre using (e.g.&nbsp;<code>PBS Pro</code> @ ALCF or <code>slurm</code> elsewhere)</li>
</ul></li>
<li>Determining how many nodes have been allocated in the current job (<code>NHOSTS</code>)
<ul>
<li>+ Determining how many accelerators exist on each of these nodes (<code>NGPU_PER_HOST</code>)</li>
</ul></li>
</ol>
<p>This allows us to calculate the total number of accelerators (GPUs) as: <img src="https://latex.codecogs.com/png.latex?N_%7B%5Cmathrm%7BGPU%7D%7D%20=%20N_%7B%5Cmathrm%7BHOST%7D%7D%20%5Ctimes%20n_%7B%5Cmathrm%7BGPU%7D%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?n_%7B%5Cmathrm%7BGPU%7D%7D%20=%20N_%7B%5Cmathrm%7BGPU%7D%7D%20/%20N_%7B%5Cmathrm%7BHOST%7D%7D"> is the number of GPUs per host.</p>
<p>With this we have everything we need to build the appropriate {<code>mpi</code>{<code>run</code>, <code>exec</code>}, <code>slurm</code>} command for launching our python application across them.</p>
<p>Now, there are a few functions in particular worth elaborating on.</p>
<div id="tbl-shell-fns" class="responsive striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-shell-fns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table-striped table-hover table">
<caption>Shell Functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">&nbsp;</th>
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Setup Environment</td>
<td style="text-align: left;"><code>ezpz_setup_env</code></td>
<td style="text-align: left;">Wrapper around <code>ezpz_setup_python</code> <code>&amp;&amp;</code> <code>ezpz_setup_job</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Setup Job</td>
<td style="text-align: left;"><code>ezpz_setup_job</code></td>
<td style="text-align: left;">Determine {<code>NGPUS</code>, <code>NGPU_PER_HOST</code>, <code>NHOSTS</code>}, build <code>launch</code> command alias</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Setup Python</td>
<td style="text-align: left;"><code>ezpz_setup_python</code></td>
<td style="text-align: left;">Wrapper around <code>ezpz_setup_conda</code> <code>&amp;&amp;</code> <code>ezpz_setup_venv_from_conda</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Setup Conda</td>
<td style="text-align: left;"><code>ezpz_setup_conda</code></td>
<td style="text-align: left;">Find and activate appropriate <code>conda</code> module to load<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Setup Virtual Environment</td>
<td style="text-align: left;"><code>ezpz_setup_venv_from_conda</code></td>
<td style="text-align: left;">From <code>${CONDA_NAME}</code>, build or activate the virtual env located in <code>venvs/${CONDA_NAME}/</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-shell-fns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Shell Functions
</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-warning callout-titled" title="Where am I?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Where am I?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><em>Some</em> of the <code>ezpz_*</code> functions (e.g.&nbsp;<code>ezpz_setup_python</code>), will try to create / look for certain directories.</p>
<p>In an effort to be explicit, these directories will be defined <strong>relative to</strong> a <code>WORKING_DIR</code> (e.g.&nbsp;<code>"${WORKING_DIR}/venvs/"</code>)</p>
<p>This <code>WORKING_DIR</code> will be assigned to the first non-zero match found below:</p>
<ol type="1">
<li><code>PBS_O_WORKDIR</code>: If found in environment, paths will be relative to this</li>
<li><code>SLURM_SUBMIT_DIR</code>: Next in line. If not @ ALCF, maybe using <code>slurm</code>‚Ä¶</li>
<li><code>$(pwd)</code>: Otherwise, no worries. Use your <em>actual</em> working directory.</li>
</ol>
</div>
</div>
</div>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">üìù Example</h3>
<ol type="1">
<li><p>Clone repo:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/ezpz</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ezpz</span></code></pre></div></li>
<li><p>Setup environment:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PBS_O_WORKDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> src/ezpz/bin/utils.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span></code></pre></div>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> src/ezpz/bin/utils.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_env</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /gila/Aurora_deployment/foremans/projects/saforem2/ezpz</span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> conda_prefix OR virtual_env found in environment...</span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Setting</span> up conda...</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb5-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich/icc-all-pmix-gpu/20240717</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">The</span> following have been reloaded with a version change:</span>
<span id="cb5-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneapi/eng-compiler/2024.07.30.002</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> oneapi/release/2024.2.1</span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> conda at: /opt/aurora/24.180.1/frameworks/aurora_nre_models_frameworks-2024.2.1_u1</span>
<span id="cb5-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> VIRTUAL_ENV found in environment!</span>
<span id="cb5-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Trying to setup from /opt/aurora/24.180.1/frameworks/aurora_nre_models_frameworks-2024.2.1_u1</span>
<span id="cb5-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Using VENV_DIR=/gila/Aurora_deployment/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2024.2.1_u1</span>
<span id="cb5-16"></span>
<span id="cb5-17">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Creating a new virtual env on top of aurora_nre_models_frameworks-2024.2.1_u1 in /gila/Aurora_deployment/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2024.2.1_u1</span>
<span id="cb5-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[python]</span> Using /gila/Aurora_deployment/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/python3</span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[üçã</span> ezpz/bin/utils.sh]</span>
<span id="cb5-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> USER=foremans</span>
<span id="cb5-22">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=sunspot</span>
<span id="cb5-23">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOST=x1922c5s0b0n0</span>
<span id="cb5-24">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> TSTAMP=2024-11-28-133756</span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_setup_host_pbs]</span></span>
<span id="cb5-27">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Using hostfile: /var/spool/pbs/aux/10283088.amn-0001</span>
<span id="cb5-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Found in environment:</span>
<span id="cb5-29">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/10283088.amn-0001</span>
<span id="cb5-30">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Writing PBS vars to: /home/foremans/.pbsenv</span>
<span id="cb5-31"></span>
<span id="cb5-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_save_pbs_env]</span></span>
<span id="cb5-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Setting:</span>
<span id="cb5-34">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/10283088.amn-0001</span>
<span id="cb5-35">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> JOBENV_FILE: /home/foremans/.pbsenv</span>
<span id="cb5-36"></span>
<span id="cb5-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[HOSTS]</span></span>
<span id="cb5-38">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x1922c5s0b0n0.hostmgmt2001.cm.americas.sgi.com</span>
<span id="cb5-39">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:1</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x1922c5s2b0n0.hostmgmt2001.cm.americas.sgi.com</span>
<span id="cb5-40">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:2</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x1922c5s4b0n0.hostmgmt2001.cm.americas.sgi.com</span>
<span id="cb5-41">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x1922c6s1b0n0.hostmgmt2001.cm.americas.sgi.com</span>
<span id="cb5-42"></span>
<span id="cb5-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DIST</span> INFO]</span>
<span id="cb5-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=48</span>
<span id="cb5-45">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NHOSTS=4</span>
<span id="cb5-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPU_PER_HOST=12</span>
<span id="cb5-47">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/10283088.amn-0001</span>
<span id="cb5-48">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DIST_LAUNCH=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/10283088.amn-0001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8</span>
<span id="cb5-49"></span>
<span id="cb5-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LAUNCH]:</span></span>
<span id="cb5-51">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> To launch across all available GPUs, use: launch</span>
<span id="cb5-52"></span>
<span id="cb5-53">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/10283088.amn-0001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8</span>
<span id="cb5-54"></span>
<span id="cb5-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">took:</span> 0h:00m:12s</span></code></pre></div>
</details></li>
<li><p>Install <code>ezpz</code>:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div></li>
<li><p>Check <code>launch</code>:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> which launch</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch:</span> aliased to mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/10283088.amn-0001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 8</span></code></pre></div></li>
<li><p>Run <code>ezpz.test_dist</code>:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> python3 src/ezpz/test_dist.py</span></code></pre></div>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üêç aurora_nre_models_frameworks-2023.2.1_u1](üëª aurora_nre_models_frameworks-2024.2.1_u1)</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåª][01:42:37 PM][foremans@x1922c5s0b0n0][‚Ä¶/ezpz][üå± saforem2-patch-1]via ‚®Å v1.4.552</span></span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.test_dist</span>
<span id="cb9-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Disabling</span> local launch: multi-node application</span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x1922c5s0b0n0.hostmgmt2001.cm.americas.sgi.com:7919</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /gila/Aurora_deployment/foremans/projects/saforem2/ezpz/venvs/aurora_nre_models_frameworks-2024.2.1_u1/bin/python3</span>
<span id="cb9-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application ecd9868b-2b3b-4a0e-b2e6-79769ecc7eff</span>
<span id="cb9-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.385960]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.386603]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.386605]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.386834]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=6/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387707]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=8/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387290]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=4/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387235]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=10/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387362]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=11/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387761]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=5/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:41.387958]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=9/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:43:46.384505]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=7/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.816252]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=15/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.821175]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=17/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.824021]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=22/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.825905]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=41/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.826590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=38/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838048]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=23/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838526]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=21/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838825]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=19/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838817]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=36/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838665]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=35/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.839033]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=25/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.838855]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=26/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.839144]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=33/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.840785]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=37/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.840740]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=47/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=11/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.844721]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=46/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.845202]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=30/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.845888]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=18/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.849905]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=20/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.849947]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=32/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.850232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=39/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.850301]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=44/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=8/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.850795]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=14/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.851872]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=28/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.852078]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=12/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.853836]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=16/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.853997]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=24/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.855526]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=13/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.856609]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=40/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=4/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.857991]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=42/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=6/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.863239]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=29/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=5/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.864956]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=45/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=9/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.867388]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=27/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.867764]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=43/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.873106]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=34/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=10/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.877043]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=31/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=7/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.887609]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:92</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb9-56"></span>
<span id="cb9-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb9-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=xpu</span>
<span id="cb9-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=xpu:0</span>
<span id="cb9-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=ccl</span>
<span id="cb9-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=12</span>
<span id="cb9-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1922c5s0b0n0.hostmgmt2001.cm.americas.sgi.com'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1922c5s2b0n0.hostmgmt2001.cm.americas.sgi.com'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1922c5s4b0n0.hostmgmt2001.cm.americas.sgi.com'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1922c6s1b0n0.hostmgmt2001.cm.americas.sgi.com'</span>]</span>
<span id="cb9-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/10283088.amn-0001</span>
<span id="cb9-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x1922c5s0b0n0.hostmgmt2001.cm.americas.sgi.com</span>
<span id="cb9-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb9-66">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=SunSpot</span>
<span id="cb9-67">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=4</span>
<span id="cb9-68">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=48</span>
<span id="cb9-69">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=48</span>
<span id="cb9-70">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb9-71">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb9-72">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb9-73">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=48</span>
<span id="cb9-74">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=48</span>
<span id="cb9-75">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/10283088.amn-0001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb9-76"></span>
<span id="cb9-77"></span>
<span id="cb9-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.933415]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using oneccl_bindings from: /opt/aurora/24.180.1/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/oneccl_bindings_for_pytorch/__init__.py</span>
<span id="cb9-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.933861]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:727</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using ipex from: /opt/aurora/24.180.1/frameworks/aurora_nre_models_frameworks-2024.2.1_u1/lib/python3.10/site-packages/intel_extension_for_pytorch/__init__.py</span>
<span id="cb9-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.934238]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:728</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/48</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> for distributed training.</span>
<span id="cb9-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.940188]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:348</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/47</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:32.940746]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_logger.py:68</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [48 / 48] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span> devices !!</span>
<span id="cb9-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:34.193788]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:882</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb9-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:34.194312]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:883</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: ezpz.test_dist</span>
<span id="cb9-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.</span>
<span id="cb9-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Currently logged in as: foremans <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">aurora_gpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> Use <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> login <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--relogin</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to force relogin</span>
<span id="cb9-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Tracking run with wandb version 0.18.7</span>
<span id="cb9-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run data is saved locally in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/wandb/run-20241128_134434-4mwyy84l</span>
<span id="cb9-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Run <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb</span> offline<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> to turn off syncing.</span>
<span id="cb9-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> Syncing run driven-wind-683</span>
<span id="cb9-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ‚≠êÔ∏è View project at https://wandb.ai/aurora_gpt/ezpz.test_dist</span>
<span id="cb9-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> üöÄ View run at https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/4mwyy84l</span>
<span id="cb9-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:35.481364]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:908</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">driven</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">wind</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">683</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/4mwyy84l</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:35.495959]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:304</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Updating wandb.run: driven-wind-683 config with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DIST_INFO"</span></span>
<span id="cb9-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:35.500222]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:936</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on machine=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SunSpot'</span></span>
<span id="cb9-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:35.501304]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:92</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb9-97"></span>
<span id="cb9-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[CONFIG]:</span></span>
<span id="cb9-99">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> warmup=0</span>
<span id="cb9-100">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> log_freq=1</span>
<span id="cb9-101">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> batch_size=64</span>
<span id="cb9-102">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> input_size=128</span>
<span id="cb9-103">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> output_size=128</span>
<span id="cb9-104">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> dtype=torch.float32</span>
<span id="cb9-105">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> device=xpu</span>
<span id="cb9-106">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> world_size=48</span>
<span id="cb9-107">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> train_iters=100</span>
<span id="cb9-108"></span>
<span id="cb9-109"></span>
<span id="cb9-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:35.575161]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:147</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model=Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb9-111">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb9-112">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-113">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-114">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-115">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-116">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-117">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-118"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.340596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=1 dt=0.019713 dtf=0.002959 dtb=0.016754 loss=1821.131958 sps=3246.551823</span>
<span id="cb9-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.346527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=2 dt=0.004083 dtf=0.000822 dtb=0.003261 loss=1348.032227 sps=15673.877930</span>
<span id="cb9-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.351387]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=3 dt=0.003260 dtf=0.000735 dtb=0.002525 loss=1072.068359 sps=19634.479814</span>
<span id="cb9-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.356043]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=4 dt=0.003117 dtf=0.000716 dtb=0.002401 loss=928.493774 sps=20534.414826</span>
<span id="cb9-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.360830]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=5 dt=0.003181 dtf=0.000798 dtb=0.002384 loss=867.221558 sps=20116.568892</span>
<span id="cb9-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.365608]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=6 dt=0.003146 dtf=0.000738 dtb=0.002408 loss=794.671204 sps=20341.929281</span>
<span id="cb9-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.370473]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=7 dt=0.003149 dtf=0.000751 dtb=0.002398 loss=748.687500 sps=20324.551047</span>
<span id="cb9-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.375126]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=8 dt=0.003105 dtf=0.000719 dtb=0.002385 loss=720.116943 sps=20614.492256</span>
<span id="cb9-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.379744]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=9 dt=0.003057 dtf=0.000698 dtb=0.002359 loss=714.217957 sps=20937.174740</span>
<span id="cb9-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.384429]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=10 dt=0.003083 dtf=0.000703 dtb=0.002380 loss=718.780884 sps=20760.967373</span>
<span id="cb9-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.390098]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=11 dt=0.003931 dtf=0.000802 dtb=0.003129 loss=699.931152 sps=16281.262548</span>
<span id="cb9-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.395638]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=12 dt=0.003698 dtf=0.000865 dtb=0.002832 loss=687.315857 sps=17308.773026</span>
<span id="cb9-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.400852]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=13 dt=0.003502 dtf=0.000792 dtb=0.002709 loss=685.231995 sps=18276.152786</span>
<span id="cb9-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.406145]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=14 dt=0.003501 dtf=0.000788 dtb=0.002714 loss=678.643860 sps=18278.977230</span>
<span id="cb9-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.411186]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=15 dt=0.003366 dtf=0.000760 dtb=0.002606 loss=675.734375 sps=19012.740109</span>
<span id="cb9-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.416092]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=16 dt=0.003308 dtf=0.000764 dtb=0.002545 loss=656.803894 sps=19345.774997</span>
<span id="cb9-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.421088]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=17 dt=0.003326 dtf=0.000800 dtb=0.002526 loss=663.846558 sps=19240.551489</span>
<span id="cb9-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.426305]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=18 dt=0.003439 dtf=0.000805 dtb=0.002634 loss=646.870605 sps=18607.582468</span>
<span id="cb9-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.431107]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=19 dt=0.003217 dtf=0.000730 dtb=0.002488 loss=631.541504 sps=19893.098888</span>
<span id="cb9-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.436171]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=20 dt=0.003447 dtf=0.000707 dtb=0.002741 loss=645.819580 sps=18564.526433</span>
<span id="cb9-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.441333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=21 dt=0.003465 dtf=0.000921 dtb=0.002543 loss=642.620361 sps=18470.919500</span>
<span id="cb9-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.446923]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=22 dt=0.003732 dtf=0.000822 dtb=0.002910 loss=639.229980 sps=17149.966074</span>
<span id="cb9-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.451965]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=23 dt=0.003386 dtf=0.000778 dtb=0.002608 loss=627.894897 sps=18902.966756</span>
<span id="cb9-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.457006]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=24 dt=0.003367 dtf=0.000807 dtb=0.002560 loss=604.797424 sps=19007.381386</span>
<span id="cb9-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.461850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=25 dt=0.003164 dtf=0.000721 dtb=0.002443 loss=614.561523 sps=20229.778931</span>
<span id="cb9-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.466983]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=26 dt=0.003473 dtf=0.000759 dtb=0.002714 loss=617.550781 sps=18428.700435</span>
<span id="cb9-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.471925]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=27 dt=0.003289 dtf=0.000758 dtb=0.002531 loss=618.434082 sps=19457.441792</span>
<span id="cb9-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.477516]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=28 dt=0.003872 dtf=0.000930 dtb=0.002942 loss=607.261475 sps=16528.336617</span>
<span id="cb9-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.482581]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=29 dt=0.003365 dtf=0.000773 dtb=0.002591 loss=601.454590 sps=19021.673645</span>
<span id="cb9-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.487622]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=30 dt=0.003288 dtf=0.000825 dtb=0.002463 loss=594.649170 sps=19463.454229</span>
<span id="cb9-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.492493]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=31 dt=0.003211 dtf=0.000734 dtb=0.002477 loss=582.087036 sps=19933.062380</span>
<span id="cb9-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.497510]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=32 dt=0.003360 dtf=0.000851 dtb=0.002509 loss=582.850586 sps=19050.324061</span>
<span id="cb9-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.502534]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=33 dt=0.003299 dtf=0.000751 dtb=0.002547 loss=574.619019 sps=19402.524122</span>
<span id="cb9-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.507516]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=34 dt=0.003318 dtf=0.000843 dtb=0.002475 loss=571.530273 sps=19291.396984</span>
<span id="cb9-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.512324]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=35 dt=0.003162 dtf=0.000718 dtb=0.002444 loss=569.056335 sps=20239.766403</span>
<span id="cb9-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.517314]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=36 dt=0.003338 dtf=0.000803 dtb=0.002535 loss=570.773315 sps=19171.898987</span>
<span id="cb9-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.522111]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=37 dt=0.003111 dtf=0.000712 dtb=0.002399 loss=564.691101 sps=20571.738756</span>
<span id="cb9-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.527333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=38 dt=0.003581 dtf=0.000698 dtb=0.002883 loss=555.157349 sps=17870.995302</span>
<span id="cb9-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.532827]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=39 dt=0.003596 dtf=0.000841 dtb=0.002755 loss=542.374756 sps=17796.934508</span>
<span id="cb9-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.538391]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=40 dt=0.003673 dtf=0.000872 dtb=0.002801 loss=538.616821 sps=17424.614226</span>
<span id="cb9-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.543835]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=41 dt=0.003606 dtf=0.000837 dtb=0.002769 loss=546.055054 sps=17746.977167</span>
<span id="cb9-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.548728]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=42 dt=0.003171 dtf=0.000786 dtb=0.002385 loss=541.741455 sps=20183.008810</span>
<span id="cb9-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.553392]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=43 dt=0.003091 dtf=0.000675 dtb=0.002415 loss=541.895630 sps=20707.731509</span>
<span id="cb9-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.558674]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=44 dt=0.003598 dtf=0.000797 dtb=0.002801 loss=532.636841 sps=17789.399613</span>
<span id="cb9-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.563691]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=45 dt=0.003305 dtf=0.000726 dtb=0.002579 loss=527.679077 sps=19363.041186</span>
<span id="cb9-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.568927]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=46 dt=0.003472 dtf=0.000776 dtb=0.002696 loss=519.220581 sps=18435.547756</span>
<span id="cb9-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.573801]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=47 dt=0.003203 dtf=0.000723 dtb=0.002480 loss=527.749268 sps=19982.521481</span>
<span id="cb9-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.578761]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=48 dt=0.003253 dtf=0.000782 dtb=0.002471 loss=524.344238 sps=19672.846752</span>
<span id="cb9-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.583369]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=49 dt=0.003042 dtf=0.000652 dtb=0.002390 loss=514.100464 sps=21038.853899</span>
<span id="cb9-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.588292]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=50 dt=0.003210 dtf=0.000763 dtb=0.002447 loss=513.998962 sps=19936.401969</span>
<span id="cb9-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.593155]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=51 dt=0.003210 dtf=0.000763 dtb=0.002447 loss=506.444519 sps=19937.409848</span>
<span id="cb9-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.598482]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=52 dt=0.003648 dtf=0.000781 dtb=0.002868 loss=505.063721 sps=17542.989327</span>
<span id="cb9-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.603395]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=53 dt=0.003258 dtf=0.000742 dtb=0.002516 loss=500.011047 sps=19642.561466</span>
<span id="cb9-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.608385]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=54 dt=0.003292 dtf=0.000797 dtb=0.002495 loss=508.445740 sps=19439.362133</span>
<span id="cb9-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.613115]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=55 dt=0.003151 dtf=0.000699 dtb=0.002452 loss=492.626648 sps=20310.433009</span>
<span id="cb9-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.618036]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=56 dt=0.003251 dtf=0.000727 dtb=0.002524 loss=487.402435 sps=19684.735824</span>
<span id="cb9-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.623122]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=57 dt=0.003449 dtf=0.000979 dtb=0.002469 loss=474.962097 sps=18556.851343</span>
<span id="cb9-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.628167]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=58 dt=0.003343 dtf=0.000811 dtb=0.002532 loss=479.064941 sps=19143.536594</span>
<span id="cb9-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.633070]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=59 dt=0.003256 dtf=0.000787 dtb=0.002468 loss=471.197083 sps=19658.706785</span>
<span id="cb9-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.638373]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=60 dt=0.003548 dtf=0.000853 dtb=0.002696 loss=469.964081 sps=18037.965649</span>
<span id="cb9-179"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.643270]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=61 dt=0.003225 dtf=0.000736 dtb=0.002489 loss=476.972076 sps=19844.166872</span>
<span id="cb9-180"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.648256]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=62 dt=0.003214 dtf=0.000745 dtb=0.002469 loss=463.572174 sps=19912.478524</span>
<span id="cb9-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.652939]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=63 dt=0.003095 dtf=0.000683 dtb=0.002411 loss=462.910156 sps=20679.849741</span>
<span id="cb9-182"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.657892]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=64 dt=0.003239 dtf=0.000746 dtb=0.002492 loss=457.325439 sps=19762.175344</span>
<span id="cb9-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.662903]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=65 dt=0.003293 dtf=0.000729 dtb=0.002563 loss=453.347168 sps=19438.021843</span>
<span id="cb9-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.667970]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=66 dt=0.003276 dtf=0.000788 dtb=0.002488 loss=450.351135 sps=19534.356115</span>
<span id="cb9-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.672824]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=67 dt=0.003192 dtf=0.000735 dtb=0.002457 loss=450.714233 sps=20047.789409</span>
<span id="cb9-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.677882]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=68 dt=0.003330 dtf=0.000799 dtb=0.002530 loss=440.284546 sps=19220.840096</span>
<span id="cb9-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.682532]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=69 dt=0.003081 dtf=0.000663 dtb=0.002418 loss=444.536011 sps=20770.230742</span>
<span id="cb9-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.687492]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=70 dt=0.003307 dtf=0.000766 dtb=0.002541 loss=446.201233 sps=19354.965715</span>
<span id="cb9-189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.692350]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=71 dt=0.003225 dtf=0.000737 dtb=0.002488 loss=427.167328 sps=19845.047963</span>
<span id="cb9-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.697422]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=72 dt=0.003415 dtf=0.000881 dtb=0.002534 loss=434.620087 sps=18740.536560</span>
<span id="cb9-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.702393]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=73 dt=0.003299 dtf=0.000740 dtb=0.002559 loss=425.558777 sps=19402.652860</span>
<span id="cb9-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.707240]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=74 dt=0.003180 dtf=0.000789 dtb=0.002391 loss=428.168945 sps=20126.919392</span>
<span id="cb9-193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.712103]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=75 dt=0.003322 dtf=0.000680 dtb=0.002642 loss=417.153503 sps=19263.558998</span>
<span id="cb9-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.717120]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=76 dt=0.003405 dtf=0.000787 dtb=0.002618 loss=412.435059 sps=18794.204421</span>
<span id="cb9-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.722012]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=77 dt=0.003208 dtf=0.000722 dtb=0.002487 loss=426.690186 sps=19947.873515</span>
<span id="cb9-196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.727040]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=78 dt=0.003330 dtf=0.000775 dtb=0.002554 loss=404.138733 sps=19220.615648</span>
<span id="cb9-197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.731946]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=79 dt=0.003218 dtf=0.000757 dtb=0.002461 loss=396.998413 sps=19886.330391</span>
<span id="cb9-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.736956]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=80 dt=0.003362 dtf=0.000818 dtb=0.002544 loss=405.073059 sps=19036.951133</span>
<span id="cb9-199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.742154]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=81 dt=0.003309 dtf=0.000840 dtb=0.002468 loss=408.205780 sps=19341.447610</span>
<span id="cb9-200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.747100]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=82 dt=0.003301 dtf=0.000801 dtb=0.002500 loss=391.203918 sps=19389.697222</span>
<span id="cb9-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.752235]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=83 dt=0.003488 dtf=0.000732 dtb=0.002756 loss=401.911407 sps=18347.650097</span>
<span id="cb9-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.757468]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=84 dt=0.003567 dtf=0.000886 dtb=0.002681 loss=390.872192 sps=17942.862497</span>
<span id="cb9-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.762431]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=85 dt=0.003272 dtf=0.000769 dtb=0.002502 loss=390.741089 sps=19562.065370</span>
<span id="cb9-204"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.767527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=86 dt=0.003390 dtf=0.000795 dtb=0.002596 loss=393.982513 sps=18877.408330</span>
<span id="cb9-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.772363]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=87 dt=0.003198 dtf=0.000727 dtb=0.002471 loss=378.682495 sps=20014.348794</span>
<span id="cb9-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.777779]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=88 dt=0.003666 dtf=0.000914 dtb=0.002752 loss=378.739502 sps=17459.234394</span>
<span id="cb9-207"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.783160]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=89 dt=0.003529 dtf=0.000832 dtb=0.002697 loss=382.028931 sps=18136.158201</span>
<span id="cb9-208"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.788498]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=90 dt=0.003442 dtf=0.000809 dtb=0.002633 loss=371.271118 sps=18594.284077</span>
<span id="cb9-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.793524]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=91 dt=0.003358 dtf=0.000754 dtb=0.002603 loss=371.135925 sps=19060.348912</span>
<span id="cb9-210"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.798593]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=92 dt=0.003336 dtf=0.000791 dtb=0.002545 loss=368.860168 sps=19183.369504</span>
<span id="cb9-211"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.803491]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=93 dt=0.003227 dtf=0.000725 dtb=0.002502 loss=371.283356 sps=19831.370522</span>
<span id="cb9-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.808397]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=94 dt=0.003250 dtf=0.000769 dtb=0.002481 loss=362.983154 sps=19693.397864</span>
<span id="cb9-213"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.813075]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=95 dt=0.003098 dtf=0.000703 dtb=0.002396 loss=365.535828 sps=20656.015873</span>
<span id="cb9-214"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.818465]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=96 dt=0.003581 dtf=0.000872 dtb=0.002709 loss=344.663239 sps=17873.310048</span>
<span id="cb9-215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.823831]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=97 dt=0.003509 dtf=0.000834 dtb=0.002675 loss=361.620361 sps=18238.825661</span>
<span id="cb9-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.828930]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=98 dt=0.003326 dtf=0.000804 dtb=0.002522 loss=347.258301 sps=19245.190902</span>
<span id="cb9-217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:48.834103]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:228</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=99 dt=0.003474 dtf=0.000740 dtb=0.002733 loss=346.517212 sps=18424.412945</span>
<span id="cb9-218"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Failed</span> to download font: IBM Plex Sans, skipping!</span>
<span id="cb9-219"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Failed</span> to download font: IBM Plex Sans Condensed, skipping!</span>
<span id="cb9-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Failed</span> to download font: IBM Plex Serif, skipping!</span>
<span id="cb9-221"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:50.885911]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_iter plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-222"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:51.498182]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_dt plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:51.758706]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_dtf plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-224"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.022463]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_dtb plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-225"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.309521]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_loss plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.562425]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">history.py:696</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving train_sps plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/mplot</span>
<span id="cb9-227">                        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iter</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-228">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">99.0‚î§</span>                                                                 ‚ñó‚ñÑ‚ñÑ‚ñÄ‚îÇ</span>
<span id="cb9-230">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                              ‚ñÑ‚ñû‚ñÄ‚ñò   ‚îÇ</span>
<span id="cb9-231">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                          ‚ñÑ‚ñÑ‚ñÄ‚ñÄ       ‚îÇ</span>
<span id="cb9-232"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82.7‚î§</span>                                                      ‚ñÑ‚ñÑ‚ñÄ‚ñÄ           ‚îÇ</span>
<span id="cb9-233">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                  ‚ñó‚ñÑ‚ñû‚ñÄ               ‚îÇ</span>
<span id="cb9-234">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                              ‚ñÑ‚ñÑ‚ñÄ‚ñÄ‚ñò                  ‚îÇ</span>
<span id="cb9-235"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">66.3‚î§</span>                                          ‚ñó‚ñÑ‚ñÄ‚ñÄ                       ‚îÇ</span>
<span id="cb9-236">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                      ‚ñó‚ñÑ‚ñû‚ñÄ‚ñò                          ‚îÇ</span>
<span id="cb9-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">50.0‚î§</span>                                  ‚ñó‚ñÑ‚ñû‚ñÄ‚ñò                              ‚îÇ</span>
<span id="cb9-238">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                               ‚ñÑ‚ñÑ‚ñÄ‚ñò                                  ‚îÇ</span>
<span id="cb9-239">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                          ‚ñó‚ñÑ‚ñû‚ñÄ‚ñÄ                                      ‚îÇ</span>
<span id="cb9-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33.7‚î§</span>                       ‚ñÑ‚ñû‚ñÄ‚ñò                                          ‚îÇ</span>
<span id="cb9-241">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                   ‚ñÑ‚ñÑ‚ñÄ‚ñÄ                                              ‚îÇ</span>
<span id="cb9-242">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>              ‚ñó‚ñÑ‚ñÑ‚ñÄ‚ñÄ                                                  ‚îÇ</span>
<span id="cb9-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17.3‚î§</span>           ‚ñÑ‚ñÑ‚ñû‚ñò                                                      ‚îÇ</span>
<span id="cb9-244">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ñÑ‚ñÑ‚ñÄ‚ñÄ                                                          ‚îÇ</span>
<span id="cb9-245">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñó‚ñÑ‚ñÄ‚ñÄ                                                              ‚îÇ</span>
<span id="cb9-246"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0‚î§‚ñÑ‚ñû‚ñÄ‚ñò</span>                                                                 ‚îÇ</span>
<span id="cb9-247">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-248">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20   27 31 36   43  48 53 57 61  68 71  78 81 86 91   98</span>
<span id="cb9-249"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iter</span>                        train/iter</span>
<span id="cb9-250"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.868990]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_iter.txt</span>
<span id="cb9-251"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_iter.txt</span>
<span id="cb9-252">                          <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-253">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-254"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0197‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-255">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-256">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0169‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-258">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-259">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-260"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0142‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-261">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-262"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0114‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-263">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-264">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0086‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-266">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-267">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0058‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-269">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-270">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñö</span>      ‚ññ          ‚ñó                                                ‚îÇ</span>
<span id="cb9-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0030‚î§</span> ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñû‚ñù‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÑ‚ñÄ‚ñÄ‚ñÄ‚ñÑ‚ñÄ‚ñò‚ñÄ‚ñÑ‚ñÄ‚ñÄ‚ñÑ‚ñö‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñÄ‚ñÄ‚ñÑ‚ñÑ‚ñÑ‚ñû‚ñÑ‚ñö‚ñÑ‚ñÄ‚ñÑ‚ñö‚ñÑ‚ñÑ‚ñû‚ñÑ‚ñû‚ñÑ‚ñö‚ñÄ‚ñö‚ñÄ‚ñö‚ñû‚ñû‚ñÄ‚ñÄ‚ñÄ‚ñû‚ñÑ‚ñÄ‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñû‚ñÄ‚ñÄ‚îÇ</span>
<span id="cb9-272">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-273">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20   27 32 36  43  48 53   61   68  74   81 86  91  98</span>
<span id="cb9-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dt</span>                           train/iter</span>
<span id="cb9-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.888254]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dt.txt</span>
<span id="cb9-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dt.txt</span>
<span id="cb9-277">                           <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-278">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00296‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-280">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-281">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00257‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-283">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-284">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00219‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-286">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00181‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-288">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-289">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00142‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-291">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-292">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00104‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-294">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>            ‚ñó    ‚ññ                  ‚ñü                 ‚ñó  ‚ññ       ‚îÇ</span>
<span id="cb9-295">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù‚ññ‚ñó</span>   ‚ñó‚ñû‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñó‚ñò‚ñö‚ñÑ‚ñó‚ñü‚ñö‚ñü‚ñû‚ñÑ‚ñå‚ñó ‚ñû‚ñÄ‚ñÑ‚ñó ‚ññ‚ñó ‚ñÑ‚ññ‚ñó ‚ñõ‚ñÑ‚ñü   ‚ñó ‚ññ‚ññ‚ñü ‚ññ‚ññ‚ñó‚ñÑ‚ñÄ‚ññ‚ñõ‚ñÑ‚ñü‚ñù‚ñö‚ñÑ‚ññ‚ññ‚ñû‚ñö‚ññ‚îÇ</span>
<span id="cb9-296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00065‚î§</span> ‚ñù‚ñò‚ñÄ‚ñÄ‚ñÄ‚ñò     ‚ñÄ   ‚ñò   ‚ñò ‚ñù‚ñò‚ñÄ  ‚ñù‚ñå‚ñÄ‚ñù‚ñÄ‚ñû ‚ñù‚ñò‚ñÄ‚ñò  ‚ñÄ‚ñö‚ñÄ‚ñò‚ñÄ‚ñú‚ñù‚ñò‚ñÄ‚ñú‚ñù‚ñò  ‚ñù‚ñò ‚ñù   ‚ñù‚ñù‚ñò ‚ñù‚îÇ</span>
<span id="cb9-297">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-298">         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20  27 31 36   43 48 53 57 61  68  74   81 86  91  98</span>
<span id="cb9-299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtf</span>                           train/iter</span>
<span id="cb9-300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.904574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dtf.txt</span>
<span id="cb9-301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dtf.txt</span>
<span id="cb9-302">                          <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-303">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0168‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-305">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-306">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0144‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-308">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-309">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-310"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0120‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-311">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0096‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-313">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-314">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0072‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-316">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-317">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-318"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0048‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-319">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-320">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñö</span>      ‚ññ                                                           ‚îÇ</span>
<span id="cb9-321"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0024‚î§</span> ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñû‚ñù‚ñÄ‚ñÄ‚ñÑ‚ñû‚ñÑ‚ñö‚ñû‚ñö‚ñÑ‚ñö‚ñû‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñÄ‚ñÄ‚ñÑ‚ñÑ‚ñÑ‚ñû‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÄ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñû‚ñÄ‚ñû‚ñÑ‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñÑ‚ñû‚ñö‚ñû‚îÇ</span>
<span id="cb9-322">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-323">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20   27 32 36  43  48 53   61   68  74   81 86  91  98</span>
<span id="cb9-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtb</span>                          train/iter</span>
<span id="cb9-325"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.920733]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dtb.txt</span>
<span id="cb9-326"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_dtb.txt</span>
<span id="cb9-327">                         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_loss</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-328">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-329"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1821.1‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-330">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-331">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-332"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1575.1‚î§‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-333">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                  ‚îÇ</span>
<span id="cb9-334">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñö</span>                                                                  ‚îÇ</span>
<span id="cb9-335"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1329.0‚î§‚ñê</span>                                                                  ‚îÇ</span>
<span id="cb9-336">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù‚ññ</span>                                                                 ‚îÇ</span>
<span id="cb9-337"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1082.9‚î§</span> ‚ñå                                                                 ‚îÇ</span>
<span id="cb9-338">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñê                                                                 ‚îÇ</span>
<span id="cb9-339">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù‚ññ                                                                ‚îÇ</span>
<span id="cb9-340"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">836.8‚î§</span>  ‚ñö                                                                ‚îÇ</span>
<span id="cb9-341">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñÄ‚ññ                                                              ‚îÇ</span>
<span id="cb9-342">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñù‚ñÄ‚ñö‚ñÑ‚ñÑ‚ñÑ ‚ññ                                                       ‚îÇ</span>
<span id="cb9-343"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">590.7‚î§</span>          ‚ñÄ‚ñù‚ñÄ‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ññ                                             ‚îÇ</span>
<span id="cb9-344">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                     ‚ñù‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ                              ‚îÇ</span>
<span id="cb9-345">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                     ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñö‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ  ‚ñó            ‚îÇ</span>
<span id="cb9-346"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">344.7‚î§</span>                                                    ‚ñÄ‚ñÄ‚ñò‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚îÇ</span>
<span id="cb9-347">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-348">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20   27 32 36  43  48 53   61   68  74   81 86  91  98</span>
<span id="cb9-349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_loss</span>                         train/iter</span>
<span id="cb9-350"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.939625]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_loss.txt</span>
<span id="cb9-351"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_loss.txt</span>
<span id="cb9-352">                           <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_sps</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">11</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">28</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">134452</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb9-353">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb9-354"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21038.9‚î§</span>  ‚ññ‚ñó‚ñÑ‚ñû‚ññ                 ‚ññ   ‚ññ  ‚ñó‚ñö   ‚ññ    ‚ñó   ‚ñó                 ‚ññ  ‚îÇ</span>
<span id="cb9-355">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñê‚ñù‚ñò  ‚ñå   ‚ññ‚ñó‚ñå  ‚ñó‚ñå‚ñó ‚ñó‚ñå‚ñó‚ñû‚ñü‚ñå  ‚ñû‚ñå‚ñó‚ñû‚ñü ‚ñú ‚ñü‚ñù‚ññ ‚ñÑ‚ñÄ‚ñÄ‚ñÑ‚ñÑ‚ñö‚ñõ‚ñÑ‚ñå‚ñÑ‚ñö‚ñó‚ñô‚ñö‚ñó‚ññ ‚ññ‚ñü   ‚ñû‚ñû‚ñå  ‚îÇ</span>
<span id="cb9-356">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñå    ‚ñå ‚ñÑ‚ñû‚ñù‚ñü‚ñö‚ñÑ‚ñû‚ñÄ‚ñö‚ñú‚ñû‚ñò‚ñù‚ñò ‚ñù‚ñå ‚ñó‚ñò‚ñô‚ñÄ‚ñå  ‚ñê‚ñê  ‚ñö‚ñÄ‚ñà     ‚ñò ‚ñú  ‚ñò‚ñù ‚ñò‚ñù‚ñü‚ñù‚ñú ‚ñó‚ñÄ‚ñò ‚ñå‚ñó‚ñö‚îÇ</span>
<span id="cb9-357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18073.5‚î§</span> ‚ñå    ‚ñå‚ñê     ‚ñê‚ñå  ‚ñê‚ñå     ‚ñù‚ñÄ‚ñû ‚ñù    ‚ñù‚ñå    ‚ñù               ‚ñù ‚ñù‚ñÑ‚ñò   ‚ñù‚ñò ‚îÇ</span>
<span id="cb9-358">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>     ‚ñö‚ñò      ‚ñò  ‚ñù‚ñå                                               ‚îÇ</span>
<span id="cb9-359">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñê</span>                                                                 ‚îÇ</span>
<span id="cb9-360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15108.1‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-361">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">12142.7‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-363">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-364">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-365"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9177.3‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-366">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-367">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-368"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6211.9‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-369">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-370">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-371"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3246.6‚î§‚ñå</span>                                                                 ‚îÇ</span>
<span id="cb9-372">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚î¨‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îò</span></span>
<span id="cb9-373">         <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 5  11 16 20  27 31 36   43 48 53 57 61  68  74   81 86  91  98</span>
<span id="cb9-374"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_sps</span>                           train/iter</span>
<span id="cb9-375"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:52.955997]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot.py:220</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_sps.txt</span>
<span id="cb9-376"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/test-dist-plots/tplot/train_sps.txt</span>
<span id="cb9-377"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-11-28</span> 13:44:53.002178]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist.py:246</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> dataset=<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>xarray.Dataset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Size: 5kB</span>
<span id="cb9-378"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Dimensions:</span>     <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw:</span> 99<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb9-379"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Coordinates:</span></span>
<span id="cb9-380">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> draw        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">int64</span> 792B 0 1 2 3 4 5 6 7 8 ... 91 92 93 94 95 96 97 98</span>
<span id="cb9-381"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Data</span> variables:</span>
<span id="cb9-382">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_iter</span>  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">int64</span> 792B 1 2 3 4 5 6 7 8 9 ... 92 93 94 95 96 97 98 99</span>
<span id="cb9-383">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dt</span>    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">float64</span> 792B 0.01971 0.004083 ... 0.003326 0.003474</span>
<span id="cb9-384">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtf</span>   <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">float64</span> 792B 0.002959 0.0008221 ... 0.0008038 0.0007404</span>
<span id="cb9-385">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_dtb</span>   <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">float64</span> 792B 0.01675 0.003261 ... 0.002522 0.002733</span>
<span id="cb9-386">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_loss</span>  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">float32</span> 396B 1.821e+03 1.348e+03 ... 347.3 346.5</span>
<span id="cb9-387">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_sps</span>   <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">draw</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">float64</span> 792B 3.247e+03 1.567e+04 ... 1.925e+04 1.842e+04</span>
<span id="cb9-388"></span>
<span id="cb9-389">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_</span>     ._   __/__   _ _  _  _ _/_   Recorded: 13:44:35  Samples:  2127</span>
<span id="cb9-390"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/_//_///</span> /_\ / //_// / //_<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/ //     Duration: 17.440    CPU time: 29.088</span></span>
<span id="cb9-391"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/   _/                      v5.0.0</span></span>
<span id="cb9-392"></span>
<span id="cb9-393"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Profile at /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/profile.py:101</span></span>
<span id="cb9-394"></span>
<span id="cb9-395"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">17.440 &lt;module&gt;  ezpz/test_dist.py:1</span></span>
<span id="cb9-396"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚îî‚îÄ 17.440 main  ezpz/test_dist.py:177</span></span>
<span id="cb9-397"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 10.558 build_model_and_optimizer  ezpz/test_dist.py:136</span></span>
<span id="cb9-398"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 10.547 DistributedDataParallel.__init__  torch/nn/parallel/distributed.py:622</span></span>
<span id="cb9-399"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ     ‚îî‚îÄ 10.502 _verify_param_shape_across_processes  torch/distributed/utils.py:266</span></span>
<span id="cb9-400"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ        ‚îî‚îÄ 10.502 PyCapsule._verify_params_across_processes  &lt;built-in&gt;</span></span>
<span id="cb9-401"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 3.256 History.plot_all  ezpz/history.py:636</span></span>
<span id="cb9-402"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 1.809 savefig  matplotlib/pyplot.py:974</span></span>
<span id="cb9-403"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     [38 frames hidden]  matplotlib, PIL, &lt;built-in&gt;, numpy</span></span>
<span id="cb9-404"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 0.895 &lt;module&gt;  seaborn/__init__.py:1</span></span>
<span id="cb9-405"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     [8 frames hidden]  seaborn, scipy</span></span>
<span id="cb9-406"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 0.227 History.get_dataset  ezpz/history.py:752</span></span>
<span id="cb9-407"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ  ‚îî‚îÄ 0.183 History.to_DataArray  ezpz/history.py:712</span></span>
<span id="cb9-408"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     ‚îî‚îÄ 0.183 DataArray.__init__  xarray/core/dataarray.py:437</span></span>
<span id="cb9-409"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ           [5 frames hidden]  xarray</span></span>
<span id="cb9-410"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 0.179 make_ridgeplots  ezpz/plot.py:900</span></span>
<span id="cb9-411"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 2.016 _forward_step  ezpz/test_dist.py:193</span></span>
<span id="cb9-412"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 1.963 DistributedDataParallel._wrapped_call_impl  torch/nn/modules/module.py:1528</span></span>
<span id="cb9-413"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ        [4 frames hidden]  torch</span></span>
<span id="cb9-414"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ           1.945 Network._call_impl  torch/nn/modules/module.py:1534</span></span>
<span id="cb9-415"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ           ‚îî‚îÄ 1.943 Network.forward  ezpz/test_dist.py:128</span></span>
<span id="cb9-416"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ              ‚îî‚îÄ 1.943 Sequential._wrapped_call_impl  torch/nn/modules/module.py:1528</span></span>
<span id="cb9-417"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ                    [6 frames hidden]  torch, &lt;built-in&gt;</span></span>
<span id="cb9-418"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 0.716 &lt;module&gt;  ambivalent/__init__.py:1</span></span>
<span id="cb9-419"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ     [20 frames hidden]  ambivalent, requests, urllib3, http, ...</span></span>
<span id="cb9-420"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îî‚îÄ 0.495 _backward_step  ezpz/test_dist.py:198</span></span>
<span id="cb9-421"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      ‚îî‚îÄ 0.457 Tensor.backward  torch/_tensor.py:466</span></span>
<span id="cb9-422"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            [3 frames hidden]  torch, &lt;built-in&gt;</span></span>
<span id="cb9-423"></span>
<span id="cb9-424"></span>
<span id="cb9-425"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-11-28 13:44:54.356012][INFO][profile.py:115] - Saving pyinstrument profile output to: /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/ezpz_pyinstrument_profiles</span></span>
<span id="cb9-426"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-11-28 13:44:54.356642][INFO][profile.py:123] - PyInstrument profile saved (as html) to:  /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-11-28-134454.html</span></span>
<span id="cb9-427"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-11-28 13:44:54.357100][INFO][profile.py:131] - PyInstrument profile saved (as text) to:  /lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-11-28-134454.txt</span></span>
<span id="cb9-428"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-11-28 13:44:54.716119][INFO][profile.py:143] - Finished with pyinstrument profiler. Took: 17.44008s</span></span>
<span id="cb9-429"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-11-28 13:44:54.717891][INFO][test_dist.py:269] - [0] runtime=73.419312s</span></span>
<span id="cb9-430"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">wandb: üöÄ View run driven-wind-683 at: https://wandb.ai/aurora_gpt/ezpz.test_dist/runs/4mwyy84l</span></span>
<span id="cb9-431"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">wandb: Find logs at: ../../../../../../lus/gila/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/wandb/run-20241128_134434-4mwyy84l/logs</span></span>
<span id="cb9-432"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Application ecd9868b resources: utime=2078s stime=374s maxrss=2509188KB inblock=786752 oublock=12104 minflt=13378945 majflt=181980 nvcsw=1704995 nivcsw=216931</span></span>
<span id="cb9-433"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">took: 0h:01m:32s</span></span></code></pre></div>
</details></li>
</ol>
<p> </p>
<section id="setup-python" class="level4">
<h4 class="anchored" data-anchor-id="setup-python">üõ†Ô∏è Setup Python</h4>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_python</span></span></code></pre></div>
<p>This will:</p>
<ol type="1">
<li><p>Automatically load and activate <code>conda</code> using the <code>ezpz_setup_conda</code> function.</p>
<p>How this is done, in practice, varies from machine to machine:</p>
<ul>
<li><p><strong>ALCF</strong><sup>3</sup>: Automatically load the most recent <code>conda</code> module and activate the base environment.</p></li>
<li><p><strong>Frontier</strong>: Load the appropriate AMD modules (e.g.&nbsp;<code>rocm</code>, <code>RCCL</code>, etc.), and activate base <code>conda</code></p></li>
<li><p><strong>Perlmutter</strong>: Load the appropriate <code>pytorch</code> module and activate environment</p></li>
<li><p><strong>Unknown</strong>: In this case, we will look for a <code>conda</code>, <code>mamba</code>, or <code>micromamba</code> executable, and if found, use that to activate the base environment.</p></li>
</ul>
<div class="callout callout-style-simple callout-tip callout-titled" title="Using your own `conda`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Using your own <code>conda</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>If you are already in a conda environment when calling <code>ezpz_setup_python</code> then it will try and use this instead.</p>
<p>For example, if you have a custom <code>conda</code> env at <code>~/conda/envs/custom</code>, then this would bootstrap the <code>custom</code> conda environment and create the virtual env in <code>venvs/custom/</code></p>
</div>
</div>
</div></li>
</ol>
<ol start="2" type="1">
<li><p>Build (or activate, if found) a virtual environment on top of (the active) base <code>conda</code> environment.</p>
<p>By default, it will try looking in:</p>
<ul>
<li><code>$PBS_O_WORKDIR</code>, otherwise</li>
<li><code>${SLURM_SUBMIT_DIR}</code>, otherwise</li>
<li><code>$(pwd)</code></li>
</ul>
<p>for a nested folder named <code>"venvs/${CONDA_NAME}"</code>.</p>
<p>If this doesn‚Äôt exist, it will attempt to create a new virtual environment at this location using:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv venvs/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CONDA_NAME}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span></span></code></pre></div>
<p>(where we‚Äôve pulled in the <code>--system-site-packages</code> from conda).</p></li>
</ol>
</section>
<section id="setup-job" class="level4">
<h4 class="anchored" data-anchor-id="setup-job">üß∞ Setup Job</h4>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_job</span></span></code></pre></div>
<p>Now that we are in a suitable python environment, we need to construct the command that we will use to run python on each of our acceleratorss.</p>
<p>To do this, we need a few things:</p>
<ol type="1">
<li>What machine we‚Äôre on (and what scheduler is it using i.e.&nbsp;{PBS, SLURM})</li>
<li>How many nodes are available in our active job</li>
<li>How many GPUs are on each of those nodes</li>
<li>What type of GPUs are they</li>
</ol>
<p>With this information, we can then use <code>mpi{exec,run}</code> or <code>srun</code> to launch python across all of our accelerators.</p>
<p>Again, how this is done will vary from machine to machine and will depend on the job scheduler in use.</p>
<p>To identify where we are, we look at our <code>$(hostname)</code> and see if we‚Äôre running on one of the known machines:</p>
<ul>
<li><strong>ALCF</strong><sup>4</sup>: Using PBS Pro via <code>qsub</code> and <code>mpiexec</code> / <code>mpirun</code>.
<ul>
<li><code>x4*</code>: <strong>Aurora</strong></li>
<li><strong>Aurora</strong>: <code>x4*</code> (or <code>aurora*</code> on login nodes)</li>
<li><strong>Sunspot</strong>: <code>x1*</code> (or <code>uan*</code>)</li>
<li><strong>Sophia</strong>: <code>sophia-*</code></li>
<li><strong>Polaris</strong> / <strong>Sirius</strong>: <code>x3*</code>
<ul>
<li>to determine between the two, we look at <code>"${PBS_O_HOST}"</code></li>
</ul></li>
</ul></li>
</ul>
<ul>
<li><p><strong>OLCF</strong>: Using Slurm via <code>sbatch</code> / <code>srun</code>.</p>
<ul>
<li><code>frontier*</code>: <strong>Frontier</strong>, using Slurm</li>
<li><code>nid*</code>: Perlmutter, using Slurm</li>
</ul></li>
<li><p>Unknown machine: If <code>$(hostname)</code> does not match one of these patterns we assume that we are running on an unknown machine and will try to use <code>mpirun</code> as our generic launch command</p>
<p>Once we have this, we can:</p>
<ol type="1">
<li><p>Get <code>PBS_NODEFILE</code> from <code>$(hostname)</code>:</p>
<ul>
<li><p><code>ezpz_qsme_running</code>: For each (running) job owned by <code>${USER}</code>, print out both the jobid as well as a list of hosts the job is running on, e.g.:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>jobid0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> host00 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">host01</span> host02 host03 ...</span>
<span id="cb13-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>jobid1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> host10 <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">host11</span> host12 host13 ...</span>
<span id="cb13-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span></span></code></pre></div></li>
<li><p><code>ezpz_get_pbs_nodefile_from_hostname</code>: Look for <code>$(hostname)</code> in the output from the above command to determine our <code>${PBS_JOBID}</code>.</p>
<p>Once we‚Äôve identified our <code>${PBS_JOBID}</code> we then know the location of our <code>${PBS_NODEFILE}</code> since they are named according to:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jobid</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_qsme_running</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print $1}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb14-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/var/spool/pbs/aux</span>
<span id="cb14-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">match</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bin/ls</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${jobid}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb14-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hostfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${prefix}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${match}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div></li>
</ul></li>
<li><p>Identify number of available accelerators:</p></li>
</ol></li>
</ul>
</section>
</section>
</section>
<section id="python-library" class="level2">
<h2 class="anchored" data-anchor-id="python-library">üêç Python Library</h2>
<p>To install<sup>5</sup>:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz#egg=ezpz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div>
<ul>
<li>üìÇ <code>ezpz</code> / <code>src</code> / <a href="https://github.com/saforem2/ezpz"><code>ezpz/</code></a>
<ul>
<li>üìÇ <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/bin/"><code>bin/</code></a>:
<ul>
<li><a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/bin/utils.sh"><code>utils.sh</code></a>: Shell utilities for <code>ezpz</code></li>
</ul></li>
<li>üìÇ <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/conf/"><code>conf/</code></a>:
<ul>
<li>‚öôÔ∏è <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/conf/config.yaml"><code>config.yaml</code></a>: Default <code>TrainConfig</code> object</li>
<li>‚öôÔ∏è <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/conf/ds_config.json"><code>ds_config.json</code></a>: DeepSpeed configuration</li>
</ul></li>
<li>üìÇ <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/log/"><code>log/</code></a>: Logging configuration.</li>
<li>üêç <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/__about__.py"><code>__about__.py</code></a>: Version information</li>
<li>üêç <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/__init__.py"><code>__init__.py</code></a>: Main module</li>
<li>üêç <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/__main__.py"><code>__main__.py</code></a>: Entry point</li>
<li>üêç <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/configs.py"><code>configs.py</code></a>: Configuration module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/create.py"><code>cria.py</code></a>: Baby Llama</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py"><strong><code>dist.py</code></strong></a>: Distributed training module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/history.py"><code>history.py</code></a>: History module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/jobs.py"><code>jobs.py</code></a>: Jobs module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/model.py"><code>model.py</code></a>: Model module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/plot.py"><code>plot.py</code></a>: Plot modul</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/profile.py"><code>profile.py</code></a>: Profile module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/runtime.py"><code>runtime.py</code></a>: Runtime module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test.py"><code>test.py</code></a>: Test module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py"><strong><code>test_dist.py</code></strong></a>: Distributed training test module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/train.py"><code>train.py</code></a>: train module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/trainer.py"><code>trainer.py</code></a>: trainer module</li>
<li>üêç<a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/utils.py"><code>utils.py</code></a>: utility module</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">üìÇ</span> /ezpz/src/ezpz/</span>
<span id="cb16-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üìÇ bin/</span>
<span id="cb16-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ affinity.sh</span>
<span id="cb16-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ getjobenv</span>
<span id="cb16-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ savejobenv</span>
<span id="cb16-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ saveslurmenv</span>
<span id="cb16-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ setup.sh</span>
<span id="cb16-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ train.sh</span>
<span id="cb16-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îó‚îÅ‚îÅ üìÑ utils.sh</span>
<span id="cb16-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üìÇ conf/</span>
<span id="cb16-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÇ hydra/</span>
<span id="cb16-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ   ‚îó‚îÅ‚îÅ üìÇ job_logging/</span>
<span id="cb16-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ       ‚î£‚îÅ‚îÅ ‚öôÔ∏è colorlog1.yaml</span>
<span id="cb16-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ       ‚î£‚îÅ‚îÅ ‚öôÔ∏è custom.yaml</span>
<span id="cb16-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ       ‚îó‚îÅ‚îÅ ‚öôÔ∏è enrich.yaml</span>
<span id="cb16-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÇ logdir/</span>
<span id="cb16-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ   ‚îó‚îÅ‚îÅ ‚öôÔ∏è default.yaml</span>
<span id="cb16-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ ‚öôÔ∏è config.yaml</span>
<span id="cb16-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÑ ds_config.json</span>
<span id="cb16-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îó‚îÅ‚îÅ ‚öôÔ∏è ds_config.yaml</span>
<span id="cb16-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üìÇ log/</span>
<span id="cb16-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üìÇ conf/</span>
<span id="cb16-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ   ‚îó‚îÅ‚îÅ üìÇ hydra/</span>
<span id="cb16-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ       ‚îó‚îÅ‚îÅ üìÇ job_logging/</span>
<span id="cb16-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îÉ           ‚îó‚îÅ‚îÅ ‚öôÔ∏è enrich.yaml</span>
<span id="cb16-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç __init__.py</span>
<span id="cb16-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç __main__.py</span>
<span id="cb16-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç config.py</span>
<span id="cb16-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç console.py</span>
<span id="cb16-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç handler.py</span>
<span id="cb16-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç style.py</span>
<span id="cb16-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚î£‚îÅ‚îÅ üêç test.py</span>
<span id="cb16-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÉ</span>   ‚îó‚îÅ‚îÅ üêç test_log.py</span>
<span id="cb16-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç __about__.py</span>
<span id="cb16-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç __init__.py</span>
<span id="cb16-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç __main__.py</span>
<span id="cb16-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç configs.py</span>
<span id="cb16-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç cria.py</span>
<span id="cb16-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç dist.py</span>
<span id="cb16-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç history.py</span>
<span id="cb16-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç jobs.py</span>
<span id="cb16-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç loadjobenv.py</span>
<span id="cb16-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç model.py</span>
<span id="cb16-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç plot.py</span>
<span id="cb16-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç profile.py</span>
<span id="cb16-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç runtime.py</span>
<span id="cb16-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç savejobenv.py</span>
<span id="cb16-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç test.py</span>
<span id="cb16-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç test_dist.py</span>
<span id="cb16-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç train.py</span>
<span id="cb16-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚î£‚îÅ‚îÅ</span> üêç trainer.py</span>
<span id="cb16-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îó‚îÅ‚îÅ</span> üêç utils.py</span></code></pre></div>
<p> </p>
<p> </p>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Plus this is useful for tab-completions in your shell, e.g.:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ezpz_<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>TAB<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_check_and_kill_if_running</span></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_get_dist_launch_cmd</span></span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_get_job_env</span></span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--More--</span></span></code></pre></div>
‚Ü©Ô∏é</li>
<li id="fn2"><p>This is system dependent. See <a href="../../src/ezpz/bin/utils.sh"><code>ezpz_setup_conda</code></a>‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Any of {Aurora, Polaris, Sophia, Sunspot, Sirius}‚Ü©Ô∏é</p></li>
<li id="fn4"><p>At ALCF, if our <code>$(hostname)</code> starts with <code>x*</code>, we‚Äôre on a compute node.‚Ü©Ô∏é</p></li>
<li id="fn5"><p>Note the <code>--require-virtualenv</code> isn‚Äôt <em>strictly</em> required, but I highly recommend to always try and work within a virtual environment, when possible.‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{foreman2024,
  author = {Foreman, Sam},
  title = {üçã Ezpz at {ALCF}},
  date = {2024-08-23},
  url = {https://samforeman.me/posts/ezpz-at-alcf},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüçã Ezpz at ALCF,‚Äù</span> August. <a href="https://samforeman.me/posts/ezpz-at-alcf">https://samforeman.me/posts/ezpz-at-alcf</a>.
</div></div></section></div> ]]></description>
  <category>ezpz</category>
  <category>ML</category>
  <category>ai4science</category>
  <guid>https://samforeman.me/posts/ezpz-at-alcf/</guid>
  <pubDate>Fri, 23 Aug 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üìù ezpz-v1</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/ezpz-v1/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>See <a href="https://saforem2.github.io/ezpz/">üçã ezpz docs</a> for more details.</p>
</div>
</div>
</div>
<details closed="">
<summary>
üçã <code>ezpz</code> v1
</summary>
<section id="ezpz-v1" class="level2">
<h2 class="anchored" data-anchor-id="ezpz-v1">üçã <code>ezpz</code> v1</h2>
<p><a href="https://samforeman.me">Sam Foreman</a><br>
<em>2024-05-14</em></p>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">üëÄ Overview</h3>
<p><strong><code>ezpz</code> üçã</strong></p>
<p>Launch, train and communicate across all your accelerators, <code>ezpz</code>.</p>
<p><em>Full support for your favorite framework + backend combo ‚ù§Ô∏è</em>.</p>
<p><code>ezpz</code> simplifies the process of:</p>
<ul>
<li><p>Setting up + launching distributed training:</p>
<ul>
<li><code>import ezpz as ez</code>
<ul>
<li><p><code>RANK =</code> <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py#L551"><code>ez.setup_torch(backend=backend)</code></a> <span class="dim-text">for <code>backend</code> <img src="https://latex.codecogs.com/png.latex?%5Cin"> {<code>DDP</code>, <code>deepspeed</code>, <code>horovod</code>}</span></p></li>
<li><p><code>RANK =</code> <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py#396"><code>ez.get_rank()</code></a></p></li>
<li><p><code>LOCAL_RANK =</code> <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py#448"><code>ez.get_local_rank()</code></a></p></li>
<li><p><code>WORLD_SIZE =</code> <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py#L417"><code>ez.get_world_size()</code></a></p></li>
</ul>
<span class="dim-text"> (see <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/dist.py"><code>ezpz/dist.py</code></a> for more details). </span></li>
</ul></li>
<li><p>Writing device agnostic code:</p>
<ul>
<li><a href="https://github.com/saforem3/ezpz/blob/main/src/ezpz/dist.py#L332"><code>ezpz.get_torch_device()</code></a> &gt; &gt; - <strong>Full support</strong> for any {<code>device</code> + <code>framework</code> + <code>backend</code>}: &gt; - device: {<code>GPU</code>, <code>XPU</code>, <code>MPS</code>, <code>CPU</code>} &gt; - framework: {<code>torch</code>, <code>deepspeed</code>, <code>horovod</code>, <code>tensorflow</code>} &gt; - backend: {<code>DDP</code>, <code>deepspeed</code>, <code>horovod</code>}</li>
</ul></li>
</ul>
</section>
</section>
<section id="test_dist.py" class="level2">
<h2 class="anchored" data-anchor-id="test_dist.py"><a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/test_dist.py"><code>test_dist.py</code></a></h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ezpz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ez</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># backend can be any of DDP, deespepeed, horovod</span></span>
<span id="cb1-9">RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.setup_torch(</span>
<span id="cb1-10">  backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(</span>
<span id="cb1-11">      backend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:=</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BACKEND'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span>)</span>
<span id="cb1-12">  ),</span>
<span id="cb1-13">  port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(</span>
<span id="cb1-14">      port <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:=</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MASTER_PORT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"29500"</span>)</span>
<span id="cb1-15">  )</span>
<span id="cb1-16">)</span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RANK = DIST_INIT['rank']</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># WORLD_SIZE = DIST_INIT['world_size']</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LOCAL_RANK = DIST_INIT['local_rank']</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if DEVICE == "cuda" and torch.cuda.is_available():</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     torch.cuda.set_device(LOCAL_RANK)</span></span>
<span id="cb1-22">DEVICE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.get_torch_device()</span>
<span id="cb1-23">WORLD_SIZE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.get_world_size()</span>
<span id="cb1-24">LOCAL_RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ez.get_local_rank()</span>
<span id="cb1-25">DEVICE_ID <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>DEVICE<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>LOCAL_RANK<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># log only from RANK == 0</span></span>
<span id="cb1-29">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.getLogger(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span>
<span id="cb1-30">logger.setLevel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"INFO"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> logger.setLevel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRITICAL"</span>)</span>
<span id="cb1-31"></span>
<span id="cb1-32">BATCH_SIZE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BATCH_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 64</span></span>
<span id="cb1-33">INPUT_SIZE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"INPUT_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 128</span></span>
<span id="cb1-34">OUTPUT_SIZE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OUTPUT_SIZE"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 128</span></span>
<span id="cb1-35">DTYPE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DTYPE"</span>, torch.get_default_dtype())</span>
<span id="cb1-36">TRAIN_ITERS <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRAIN_ITERS"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>))</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># logger.info(f"{DIST_INIT=}")</span></span>
<span id="cb1-39"></span>
<span id="cb1-40"></span>
<span id="cb1-41"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Network(torch.nn.Module):</span>
<span id="cb1-42">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb1-43">          <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb1-44">          input_dim: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>,</span>
<span id="cb1-45">          output_dim: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>,</span>
<span id="cb1-46">          sizes: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb1-47">  ):</span>
<span id="cb1-48">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>(Network, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>).<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb1-49">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sizes <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-50">          <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.Linear(input_dim, output_dim)</span>
<span id="cb1-51">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sizes) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb1-52">          layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [torch.nn.Linear(input_dim, sizes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])]</span>
<span id="cb1-53">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, size <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sizes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]):</span>
<span id="cb1-54">              layers.append(</span>
<span id="cb1-55">                  torch.nn.Linear(sizes[idx], size)</span>
<span id="cb1-56">              )</span>
<span id="cb1-57">          layers.append(torch.nn.Linear(sizes[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], output_dim))</span>
<span id="cb1-58">          <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.Sequential(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>layers)</span>
<span id="cb1-59"></span>
<span id="cb1-60">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x: torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb1-61">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layers(x)</span>
<span id="cb1-62"></span>
<span id="cb1-63"></span>
<span id="cb1-64"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> calc_loss(x: torch.Tensor, y: torch.Tensor) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> torch.Tensor:</span>
<span id="cb1-65">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pow</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb1-66"></span>
<span id="cb1-67"></span>
<span id="cb1-68"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_losses(losses: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-69">  <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotext <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pltx</span>
<span id="cb1-70">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y = list(losses.values())</span></span>
<span id="cb1-71">  pltx.theme(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'clear'</span>)</span>
<span id="cb1-72">  pltx.scatter(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(losses.values()))</span>
<span id="cb1-73">  pltx.show()</span>
<span id="cb1-74">  pltx.save_fig(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test_dist_losses.txt"</span>)</span>
<span id="cb1-75">  pltx.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loss"</span>)</span>
<span id="cb1-76">  pltx.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iteration"</span>)</span>
<span id="cb1-77"></span>
<span id="cb1-78"></span>
<span id="cb1-79"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main():</span>
<span id="cb1-80">  model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Network(</span>
<span id="cb1-81">      input_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>INPUT_SIZE,</span>
<span id="cb1-82">      output_dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>OUTPUT_SIZE,</span>
<span id="cb1-83">      sizes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>]</span>
<span id="cb1-84">  )</span>
<span id="cb1-85">  model.to(DEVICE)</span>
<span id="cb1-86">  model.to(DEVICE_ID)</span>
<span id="cb1-87">  logger.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-88">  optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.Adam(model.parameters())</span>
<span id="cb1-89">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> backend.lower() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ddp'</span>:</span>
<span id="cb1-90">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> WORLD_SIZE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb1-91">          <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.nn.parallel <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DistributedDataParallel <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> DDP</span>
<span id="cb1-92">          model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DDP(</span>
<span id="cb1-93">              model,</span>
<span id="cb1-94">              device_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[]</span>
<span id="cb1-95">          )</span>
<span id="cb1-96">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> backend.lower() <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ds'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span>):</span>
<span id="cb1-97">      <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> deepspeed</span>
<span id="cb1-98">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># config = ez.load_ds_config().update(</span></span>
<span id="cb1-99">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     {"train_micro_batch_size_per_gpu": BATCH_SIZE}</span></span>
<span id="cb1-100">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb1-101">      <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> argparse</span>
<span id="cb1-102">      parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> argparse.ArgumentParser(</span>
<span id="cb1-103">          description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'My training script.'</span></span>
<span id="cb1-104">      )</span>
<span id="cb1-105">      parser.add_argument(</span>
<span id="cb1-106">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--local_rank'</span>,</span>
<span id="cb1-107">          required<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb1-108">          <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb1-109">          default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-110">          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># default=ez.get_local_rank()),</span></span>
<span id="cb1-111">          <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'local rank passed from distributed launcher'</span>,</span>
<span id="cb1-112">      )</span>
<span id="cb1-113">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Include DeepSpeed configuration arguments</span></span>
<span id="cb1-114">      parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deepspeed.add_config_arguments(parser)</span>
<span id="cb1-115">      cmd_args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parser.parse_args()</span>
<span id="cb1-116">      logger.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cmd_args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-117">      model, optimizer, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deepspeed.initialize(</span>
<span id="cb1-118">          args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cmd_args,</span>
<span id="cb1-119">          model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>model,</span>
<span id="cb1-120">          optimizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>optimizer,</span>
<span id="cb1-121">      )</span>
<span id="cb1-122"></span>
<span id="cb1-123">  losses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb1-124">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(TRAIN_ITERS):</span>
<span id="cb1-125">      t0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb1-126">      x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand((BATCH_SIZE, INPUT_SIZE), dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>DTYPE).to(DEVICE)</span>
<span id="cb1-127">      y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x)</span>
<span id="cb1-128">      loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> calc_loss(x, y)</span>
<span id="cb1-129">      losses[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss</span>
<span id="cb1-130">      dtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:=</span> time.perf_counter()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0)</span>
<span id="cb1-131">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> backend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span>:</span>
<span id="cb1-132">          model.backward(loss)</span>
<span id="cb1-133">          model.step(loss)</span>
<span id="cb1-134">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-135">          loss.backward()</span>
<span id="cb1-136">          optimizer.step()</span>
<span id="cb1-137">      optimizer.zero_grad()</span>
<span id="cb1-138">      dtb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t1</span>
<span id="cb1-139">      logger.info(</span>
<span id="cb1-140">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', '</span>.join([</span>
<span id="cb1-141">              <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb1-142">              <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'loss=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.5f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb1-143">              <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'dt=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dtf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>dtb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb1-144">              <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dtf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb1-145">              <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dtb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-146">          ])</span>
<span id="cb1-147">      )</span>
<span id="cb1-148">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb1-149">      plot_losses(losses)</span>
<span id="cb1-150"></span>
<span id="cb1-151"></span>
<span id="cb1-152"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'__main__'</span>:</span>
<span id="cb1-153">  main()</span></code></pre></div>
</section></details>
<details closed="">
<summary>
<code>README</code> (grandparent)
</summary>

<section id="ezpz" class="level2">
<h2 class="anchored" data-anchor-id="ezpz">ezpz</h2>
<p><img alt="pyTorch" src="https://img.shields.io/badge/PyTorch-ee4c2c?logo=pytorch&amp;logoColor=white"> <a href="https://www.tensorflow.org"><img alt="tensorflow" src="https://img.shields.io/badge/TensorFlow-%23FF6F00.svg?&amp;logo=TensorFlow&amp;logoColor=white"></a></p>
<p>Simplifies the process of setting up distributed training for:</p>
<ul>
<li><p><code>pytorch</code> + <code>{DDP, deepspeed, horovod}</code></p></li>
<li><p><code>tensorflow</code> + <code>horovod</code></p></li>
</ul>
<section id="setup" class="level3">
<h3 class="anchored" data-anchor-id="setup">Setup</h3>
<ul>
<li><p>Install:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/saforem2/ezpz</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ezpz</span></code></pre></div></li>
<li><p>Determine available resources:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">==theta*"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HOSTFILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${COBALT_NODEFILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ThetaGPU @ ALCF</span></span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">==x3*"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HOSTFILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PBS_NODEFILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Polaris @ ALCF</span></span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hostname</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">==nid*"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HOSTFILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_NODELIST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perlmutter @ NERSC</span></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">NHOSTS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HOSTFILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">NGPU_PER_HOST</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nvidia-smi</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">NGPUS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((${NHOSTS}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}))</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$NHOSTS</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$NGPU_PER_HOST</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$NGPUS</span></span>
<span id="cb3-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span> 4 8</span></code></pre></div></li>
<li><p>Example <code>python</code> script:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">ezpz/test.py</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ezpz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> setup_torch, setup_tensorflow</span>
<span id="cb4-5"></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> test(</span>
<span id="cb4-8">        framework: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pytorch'</span>,</span>
<span id="cb4-9">        backend: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span>,</span>
<span id="cb4-10">        port: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'5432'</span></span>
<span id="cb4-11">):</span>
<span id="cb4-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> framework <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pytorch'</span>:</span>
<span id="cb4-13">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_torch(</span>
<span id="cb4-14">            backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>backend,</span>
<span id="cb4-15">            port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>port,</span>
<span id="cb4-16">        )</span>
<span id="cb4-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> framework <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensorflow'</span>:</span>
<span id="cb4-18">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_tensorflow()</span>
<span id="cb4-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb4-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>  </span>
<span id="cb4-21"></span>
<span id="cb4-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'__main__'</span>:</span>
<span id="cb4-23">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb4-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb4-25">        framework <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sys.argv[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb4-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">IndexError</span>:</span>
<span id="cb4-27">        framework <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pytorch'</span></span>
<span id="cb4-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb4-29">        backend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sys.argv[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb4-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">IndexError</span>:</span>
<span id="cb4-31">        backend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed'</span></span>
<span id="cb4-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb4-33">        port <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sys.argv[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb4-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">IndexError</span>:</span>
<span id="cb4-35">        port <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'5432'</span></span>
<span id="cb4-36">    test(framework<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>framework, backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>backend, port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>port)</span></code></pre></div></li>
</ul>
</section>
<section id="tests" class="level3">
<h3 class="anchored" data-anchor-id="tests">Tests</h3>
<p>You can test a <code>{framework, backend}</code> combination by:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 test.py framework backend</span></code></pre></div>
<p>for <code>framework</code> <img src="https://latex.codecogs.com/png.latex?%5Cin"> <code>{pytorch, tensorflow}</code> and <code>backend</code> <img src="https://latex.codecogs.com/png.latex?%5Cin"> <code>{horovod, deepspeed, DDP}</code><sup>1</sup></p>
<ul>
<li><p>‚úÖ PyTorch + DDP:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 test.py pytorch DDP</span></code></pre></div></li>
<li><p>‚úÖ PyTorch + DeepSpeed:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 test.py pytorch deepspeed</span></code></pre></div></li>
<li><p>‚úÖ PyTorch + Horovod:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 test.py pytorch horovod</span></code></pre></div></li>
<li><p>‚úÖ TensorFlow + Horovod:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPUS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ppn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${NGPU_PER_HOST}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> python3 test.py tensorflow</span></code></pre></div></li>
</ul>
</section>
<section id="helper-utilities" class="level3">
<h3 class="anchored" data-anchor-id="helper-utilities">Helper Utilities</h3>
<ul>
<li><p><a href="./src/ezpz/bin/savejobenv"><code>src/ezpz/bin/savejobenv</code></a>: Shell script to save relevant job related environment variables to a file which can be sourced from new login instances.</p></li>
<li><p><a href="./src/ezpz/bin/getjobenv"><code>src/ezpz/bin/getjobenv</code></a>: Shell script that, when sourced, will populate the current environment with the necessary job-related variables.</p></li>
</ul>
<ol type="1">
<li><p>Launch a job, clone (or navigate into) <code>ezpz</code>, and run <a href="./src/ezpz/bin/savejobenv"><code>src/ezpz/bin/savejobenv</code></a>:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetalogin5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> qsub-gpu <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> datascience <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> full-node <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--attrs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"filesystems=home,grand,eagle,theta-fs0:ssds=required"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> 12:00 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span></span>
<span id="cb10-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/saforem2/ezpz</span>
<span id="cb10-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ezpz/src/ezpz</span>
<span id="cb10-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ./bin/savejobenv</span>
<span id="cb10-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb10-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> [DIST INFO]:</span>
<span id="cb10-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚Ä¢ Writing Job info to /home/foremans/.cobaltenv</span>
<span id="cb10-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚Ä¢ NHOSTS: 4</span>
<span id="cb10-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚Ä¢ NGPU_PER_HOST: 8</span>
<span id="cb10-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚Ä¢ NGPUS = <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> NGPU_PER_HOST<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=</span> 32</span>
<span id="cb10-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span>
<span id="cb10-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb10-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Saving COBALT env to /home/foremans/.cobaltenv from thetagpu13</span>
<span id="cb10-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Writing COBALT vars to /home/foremans/.cobaltenv                 ‚îÇ</span>
<span id="cb10-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span>
<span id="cb10-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb10-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Copying COBALT_NODEFILE to clipboard...</span>
<span id="cb10-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> COBALT_NODEFILE: /var/tmp/cobalt.10154591</span>
<span id="cb10-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Hosts</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb10-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   thetagpu13 thetagpu12 thetagpu19 thetagpu18</span>
<span id="cb10-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span>
<span id="cb10-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb10-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Run <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'source getjobenv'</span> in a NEW SHELL to automatically set env vars   ‚îÇ</span>
<span id="cb10-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span></span></code></pre></div></li>
<li><p>now, in a <strong>NEW SHELL</strong></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">localhost</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ssh foremans@theta</span>
<span id="cb11-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetalogin5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ssh thetagpu18</span>
<span id="cb11-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module load conda/2023-01-11<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cond</span> activate base</span>
<span id="cb11-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ezpz</span>
<span id="cb11-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> mkdir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> venvs/thetaGPU/2023-01-11</span>
<span id="cb11-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv venvs/thetaGPU/2023-01-11 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span></span>
<span id="cb11-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source venvs/thetaGPU/2023-01-11/bin/activate</span>
<span id="cb11-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> .</span>
<span id="cb11-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ezpz/src/ezpz</span>
<span id="cb11-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source bin/getjobenv</span>
<span id="cb11-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RUNNING_JOB_FILE:</span> /var/tmp/cobalt-running-job</span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JOBID:</span> 10154591</span>
<span id="cb11-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Loading</span> job env from: /home/foremans/.cobaltenv</span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Defining</span> alias mpilaunch: mpilaunch: aliased to mpirun <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-N</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/tmp/cobalt.10154591 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> PATH <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> LD_LIBRARY_PATH</span>
<span id="cb11-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HOSTFILE:</span> /var/tmp/cobalt.10154591</span>
<span id="cb11-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS:</span> 4</span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NGPU_PER_HOST:</span> 8</span>
<span id="cb11-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NGPUS</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS</span> x NGPU_PER_HOST<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 32</span>
<span id="cb11-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HOSTS:</span> thetagpu13 thetagpu12 thetagpu19 thetagpu18</span>
<span id="cb11-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">thetagpu18</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> mpilaunch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz pytorch DDP</span>
<span id="cb11-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> DDP for distributed training</span>
<span id="cb11-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 0 / 31</span>
<span id="cb11-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 25 / 31</span>
<span id="cb11-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 24 / 31</span>
<span id="cb11-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 15 / 31</span>
<span id="cb11-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 26 / 31</span>
<span id="cb11-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 31 / 31</span>
<span id="cb11-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 2 / 31</span>
<span id="cb11-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 12 / 31</span>
<span id="cb11-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 1 / 31</span>
<span id="cb11-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 28 / 31</span>
<span id="cb11-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 3 / 31</span>
<span id="cb11-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 14 / 31</span>
<span id="cb11-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 4 / 31</span>
<span id="cb11-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 10 / 31</span>
<span id="cb11-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 27 / 31</span>
<span id="cb11-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 5 / 31</span>
<span id="cb11-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 30 / 31</span>
<span id="cb11-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 29 / 31</span>
<span id="cb11-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 9 / 31</span>
<span id="cb11-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 7 / 31</span>
<span id="cb11-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 6 / 31</span>
<span id="cb11-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 13 / 31</span>
<span id="cb11-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 8 / 31</span>
<span id="cb11-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 11 / 31</span>
<span id="cb11-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 18 / 31</span>
<span id="cb11-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 16 / 31</span>
<span id="cb11-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 21 / 31</span>
<span id="cb11-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 20 / 31</span>
<span id="cb11-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 22 / 31</span>
<span id="cb11-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 19 / 31</span>
<span id="cb11-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 17 / 31</span>
<span id="cb11-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RANK:</span> 23 / 31</span></code></pre></div>
<p>while this example looked at ThetaGPU, the exact same process will work on any of <code>{ThetaGPU, Polaris, Perlmutter}</code>.</p>
<p>2ez</p></li>
</ol>
</section></section></details>

<details closed="">
<summary>
Deprecated:
</summary>


<section id="complete-example" class="level2">
<h2 class="anchored" data-anchor-id="complete-example">Complete Example</h2>
<section id="gist" class="level3">
<h3 class="anchored" data-anchor-id="gist">Gist</h3>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[{{< fa brands github >}} <code>saforem2/ezpz.md</code>]{.dim-text style=&quot;font-weight: normal;&quot;}" style="width:100%; background-color: rgba(0,0,0,0.0)!important; border:1px solid rgba(131,131,131,0.2)!important;">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span class="dim-text" style="font-weight: normal;"><i class="fa-brands fa-github" aria-label="github"></i> <code>saforem2/ezpz.md</code></span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<script src="https://gist.github.com/saforem2/2f2549894d9c65ed2edcfe6b1dbe6a70.js"></script>
</div>
</div>
</div>
</section>
<section id="clone-repos" class="level3">
<h3 class="anchored" data-anchor-id="clone-repos">üì¶ Clone Repo(s)</h3>
<ul>
<li><p><a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a>:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/argonne-lcf/Megatron-DeepSpeed</span>
<span id="cb12-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cloning</span> into <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Megatron-DeepSpeed'</span>...</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Enumerating objects: 15538, done.</span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Counting objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21/21</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span>
<span id="cb12-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Compressing objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11/11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span>
<span id="cb12-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Total 15538 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">delta</span> 10<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> reused 18 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">delta</span> 10<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> pack-reused 15517</span>
<span id="cb12-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Receiving</span> objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15538/15538</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> 6.25 MiB <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">32.32</span> MiB/s, done.</span>
<span id="cb12-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Resolving</span> deltas: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">11482/11482</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span>
<span id="cb12-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Updating</span> files: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">596/596</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span></code></pre></div></li>
<li><p><a href="https://github.com/saforem2/ezpz"><code>saforem2/ezpz</code></a>:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd Megatron-DeepSpeed</span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/saforem2/ezpz deps/ezpz</span>
<span id="cb13-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cloning</span> into <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deps/ezpz'</span>...</span>
<span id="cb13-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Enumerating objects: 2161, done.</span>
<span id="cb13-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Counting objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">390/390</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span>
<span id="cb13-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Compressing objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">181/181</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span>
<span id="cb13-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Total 2161 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">delta</span> 214<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> reused 285 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">delta</span> 151<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> pack-reused 1771</span>
<span id="cb13-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Receiving</span> objects: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2161/2161</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> 4.28 MiB <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25.35</span> MiB/s, done.</span>
<span id="cb13-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Resolving</span> deltas: 100% <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1134/1134</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> done.</span></code></pre></div></li>
</ul>
</section>
<section id="setup-job" class="level3">
<h3 class="anchored" data-anchor-id="setup-job">üõú Setup Job</h3>
<ol type="1">
<li><p>Source <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/bin/utils.sh"><code>ezpz/bin/utils.sh</code></a>:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> source deps/ezpz/src/ezpz/bin/utils.sh</span>
<span id="cb14-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /eagle/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed</span></code></pre></div></li>
<li><p><code>ezpz_setup_alcf</code>:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ezpz_setup_alcf</span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz/bin/utils.sh]</span></span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23-221417]</span></span>
<span id="cb15-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> USER=foremans</span>
<span id="cb15-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=polaris</span>
<span id="cb15-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOST=x3006c0s25b1n0</span>
<span id="cb15-8"></span>
<span id="cb15-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_get_pbs_env]:</span> Caught 0 arguments</span>
<span id="cb15-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> hostfile: /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> jobenv_file: /home/foremans/.pbsenv</span>
<span id="cb15-12"></span>
<span id="cb15-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_setup_host]</span></span>
<span id="cb15-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Using hostfile: /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Found in environment:</span>
<span id="cb15-16">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-17">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Writing PBS vars to: /home/foremans/.pbsenv</span>
<span id="cb15-18"></span>
<span id="cb15-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_save_pbs_env]</span></span>
<span id="cb15-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Setting:</span>
<span id="cb15-21">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-22">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> JOBENV_FILE: /home/foremans/.pbsenv</span>
<span id="cb15-23"></span>
<span id="cb15-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[HOSTS]</span></span>
<span id="cb15-25">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x3006c0s25b1n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-26"></span>
<span id="cb15-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DIST</span> INFO]</span>
<span id="cb15-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb15-29">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NHOSTS=1</span>
<span id="cb15-30">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPU_PER_HOST=4</span>
<span id="cb15-31">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb15-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DIST_LAUNCH=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb15-33"></span>
<span id="cb15-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LAUNCH]:</span></span>
<span id="cb15-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> To launch across all available GPUs, use: launch</span>
<span id="cb15-36">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span></code></pre></div></li>
</ol>
</section>
<section id="setup-python" class="level3">
<h3 class="anchored" data-anchor-id="setup-python">üêç Setup Python</h3>
<ul>
<li><p><code>ezpz_setup_python</code>:</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ezpz_setup_python</span>
<span id="cb16-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> conda_prefix OR virtual_env found in environment...</span>
<span id="cb16-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Setting</span> up conda...</span>
<span id="cb16-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nvhpc/23.9"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gcc-native/12.3"</span>.</span>
<span id="cb16-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-nvhpc/8.5.0"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-gnu/8.5.0"</span>.</span>
<span id="cb16-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb16-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-mpich/8.1.28</span></span>
<span id="cb16-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> conda at: /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb16-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> VIRTUAL_ENV found in environment!</span>
<span id="cb16-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Trying to setup from /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb16-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Using VENV_DIR=/eagle/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/venvs/2024-04-29</span>
<span id="cb16-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Creating a new virtual env on top of 2024-04-29 in /eagle/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/venvs/2024-04-29</span>
<span id="cb16-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[python]</span> Using /eagle/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/venvs/2024-04-29/bin/python3</span>
<span id="cb16-14"></span>
<span id="cb16-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> which python3</span>
<span id="cb16-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/eagle/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/venvs/2024-04-29/bin/python3</span></span>
<span id="cb16-17"></span>
<span id="cb16-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> deps/ezpz <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span>
<span id="cb16-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Looking</span> in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com</span>
<span id="cb16-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Obtaining</span> file:///lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/deps/ezpz</span>
<span id="cb16-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> build dependencies ... done</span>
<span id="cb16-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Checking</span> if build backend supports build_editable ... done</span>
<span id="cb16-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Getting</span> requirements to build editable ... done</span>
<span id="cb16-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> backend dependencies ... done</span>
<span id="cb16-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Preparing</span> editable metadata <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span> done</span></code></pre></div></li>
</ul>
</section>
<section id="test-setup" class="level3">
<h3 class="anchored" data-anchor-id="test-setup">üìù Test Setup</h3>
<ul>
<li><p><a href="https://github.com/saforem2/ezpz/blob/main/ezpz/test_dist.py"><code>ezpz/test_dist.py</code></a></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.test_dist</span></code></pre></div>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:37.972869]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:37.975224]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb18-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:37.975718]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:160</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To disable this behavior, and log from ALL ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">not</span> recommended<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> set: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export LOG_FROM_ALL_RANKS=1'</span>  in your environment, and re-run.</span>
<span id="cb18-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.790899]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.790850]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.791749]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.797666]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb18-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=cuda</span>
<span id="cb18-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=cuda:0</span>
<span id="cb18-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=nccl</span>
<span id="cb18-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=4</span>
<span id="cb18-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x3006c0s25b1n0.hsn.cm.polaris.alcf.anl.gov'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb18-16">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x3006c0s25b1n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb18-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb18-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Polaris</span>
<span id="cb18-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=1</span>
<span id="cb18-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb18-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=4</span>
<span id="cb18-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb18-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb18-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb18-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=4</span>
<span id="cb18-26">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=4</span>
<span id="cb18-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2036165.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb18-28"></span>
<span id="cb18-29"></span>
<span id="cb18-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.800519]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/4</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nccl'</span> for distributed training.</span>
<span id="cb18-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.805001]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.805513]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:364</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [4 / 4] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> devices !!</span>
<span id="cb18-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.806121]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb18-34"></span>
<span id="cb18-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[timers_import]:</span></span>
<span id="cb18-36">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> os=1.062639057636261e-06</span>
<span id="cb18-37">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> logging=4.0046870708465576e-07</span>
<span id="cb18-38">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> typing=2.7157366275787354e-06</span>
<span id="cb18-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> pathlib=1.2516975402832031e-06</span>
<span id="cb18-40">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> ezpz=6.30505383014679e-07</span>
<span id="cb18-41">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch=2.555549144744873e-06</span>
<span id="cb18-42">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch_ddp=2.4745240807533264e-06</span>
<span id="cb18-43">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> wandb=6.44102692604065e-05</span>
<span id="cb18-44">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> total=7.550138980150223e-05</span>
<span id="cb18-45"></span>
<span id="cb18-46"></span>
<span id="cb18-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:39.807221]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb18-48"></span>
<span id="cb18-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[CONFIG]:</span></span>
<span id="cb18-50">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> warmup=0</span>
<span id="cb18-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> log_freq=1</span>
<span id="cb18-52">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> batch_size=64</span>
<span id="cb18-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> input_size=128</span>
<span id="cb18-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> output_size=128</span>
<span id="cb18-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> dtype=torch.float32</span>
<span id="cb18-56">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> device=cuda</span>
<span id="cb18-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> world_size=4</span>
<span id="cb18-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> train_iters=100</span>
<span id="cb18-59"></span>
<span id="cb18-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:41.373173]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:183</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model=Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb18-61">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb18-62">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-63">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-64">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-65">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-66">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-67">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-68"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb18-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.625040]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=1, loss=2039.91, sps=2.252e+04, dt=0.00284196, dtf=0.0009801, dtb=0.001862</span>
<span id="cb18-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.628643]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=2, loss=1424.54, sps=3.272e+04, dt=0.00195628, dtf=0.0005183, dtb=0.001438</span>
<span id="cb18-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.631833]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=3, loss=1159.38, sps=3.331e+04, dt=0.00192147, dtf=0.0006139, dtb=0.001308</span>
<span id="cb18-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.634991]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=4, loss=935.58, sps=3.343e+04, dt=0.00191451, dtf=0.0006113, dtb=0.001303</span>
<span id="cb18-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.638092]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=5, loss=851.468, sps=3.483e+04, dt=0.00183759, dtf=0.0005938, dtb=0.001244</span>
<span id="cb18-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.641232]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=6, loss=785.109, sps=3.409e+04, dt=0.00187757, dtf=0.0005972, dtb=0.00128</span>
<span id="cb18-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.644367]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=7, loss=772.966, sps=3.417e+04, dt=0.00187292, dtf=0.0005868, dtb=0.001286</span>
<span id="cb18-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.647507]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=8, loss=727.854, sps=3.411e+04, dt=0.00187638, dtf=0.0005814, dtb=0.001295</span>
<span id="cb18-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.650561]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=9, loss=725.773, sps=3.546e+04, dt=0.00180485, dtf=0.0005975, dtb=0.001207</span>
<span id="cb18-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.653520]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=10, loss=720.374, sps=3.785e+04, dt=0.00169078, dtf=0.0006108, dtb=0.00108</span>
<span id="cb18-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.656564]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=11, loss=717.926, sps=3.602e+04, dt=0.00177678, dtf=0.0005694, dtb=0.001207</span>
<span id="cb18-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.659555]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=12, loss=692.535, sps=3.682e+04, dt=0.00173814, dtf=0.0005557, dtb=0.001182</span>
<span id="cb18-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.662596]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=13, loss=679.509, sps=3.67e+04, dt=0.00174377, dtf=0.0005531, dtb=0.001191</span>
<span id="cb18-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.665598]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=14, loss=674.778, sps=3.727e+04, dt=0.00171741, dtf=0.0005496, dtb=0.001168</span>
<span id="cb18-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.668593]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=15, loss=673.873, sps=3.666e+04, dt=0.00174556, dtf=0.0005708, dtb=0.001175</span>
<span id="cb18-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.671589]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=16, loss=667.283, sps=3.694e+04, dt=0.00173238, dtf=0.0005453, dtb=0.001187</span>
<span id="cb18-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.674599]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=17, loss=660.292, sps=3.646e+04, dt=0.00175558, dtf=0.0005538, dtb=0.001202</span>
<span id="cb18-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.677592]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=18, loss=660.664, sps=3.696e+04, dt=0.00173169, dtf=0.0005441, dtb=0.001188</span>
<span id="cb18-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.680559]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=19, loss=676.161, sps=3.709e+04, dt=0.00172556, dtf=0.0005668, dtb=0.001159</span>
<span id="cb18-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.683539]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=20, loss=665.099, sps=3.702e+04, dt=0.0017287, dtf=0.0005281, dtb=0.001201</span>
<span id="cb18-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.686527]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=21, loss=626.671, sps=3.7e+04, dt=0.00172989, dtf=0.0005279, dtb=0.001202</span>
<span id="cb18-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.689518]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=22, loss=632.127, sps=3.702e+04, dt=0.00172883, dtf=0.0005085, dtb=0.00122</span>
<span id="cb18-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.692469]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=23, loss=657.324, sps=3.755e+04, dt=0.00170436, dtf=0.0005164, dtb=0.001188</span>
<span id="cb18-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.695563]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=24, loss=617.646, sps=3.558e+04, dt=0.00179856, dtf=0.0005767, dtb=0.001222</span>
<span id="cb18-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.698537]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=25, loss=618.284, sps=3.705e+04, dt=0.00172744, dtf=0.0005522, dtb=0.001175</span>
<span id="cb18-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.701410]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=26, loss=615.418, sps=3.961e+04, dt=0.00161577, dtf=0.0005298, dtb=0.001086</span>
<span id="cb18-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.704427]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=27, loss=599.058, sps=3.648e+04, dt=0.00175461, dtf=0.0005156, dtb=0.001239</span>
<span id="cb18-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.707374]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=28, loss=621.717, sps=3.778e+04, dt=0.00169387, dtf=0.0004899, dtb=0.001204</span>
<span id="cb18-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.710390]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=29, loss=597.588, sps=3.623e+04, dt=0.00176654, dtf=0.0005663, dtb=0.0012</span>
<span id="cb18-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.713386]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=30, loss=598.102, sps=3.71e+04, dt=0.00172484, dtf=0.0005497, dtb=0.001175</span>
<span id="cb18-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.716530]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=31, loss=586.188, sps=3.357e+04, dt=0.00190664, dtf=0.0005618, dtb=0.001345</span>
<span id="cb18-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.719525]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=32, loss=591.646, sps=3.672e+04, dt=0.00174293, dtf=0.000561, dtb=0.001182</span>
<span id="cb18-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.722513]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=33, loss=574.161, sps=3.668e+04, dt=0.00174487, dtf=0.0005502, dtb=0.001195</span>
<span id="cb18-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.725524]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=34, loss=586.41, sps=3.707e+04, dt=0.00172628, dtf=0.0005552, dtb=0.001171</span>
<span id="cb18-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.728594]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=35, loss=574.43, sps=3.605e+04, dt=0.00177526, dtf=0.000576, dtb=0.001199</span>
<span id="cb18-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.731615]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=36, loss=552.77, sps=3.642e+04, dt=0.00175741, dtf=0.0005588, dtb=0.001199</span>
<span id="cb18-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.734574]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=37, loss=567.612, sps=3.748e+04, dt=0.00170768, dtf=0.0005318, dtb=0.001176</span>
<span id="cb18-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.737564]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=38, loss=561.004, sps=3.706e+04, dt=0.00172686, dtf=0.0005489, dtb=0.001178</span>
<span id="cb18-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.740578]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=39, loss=555.718, sps=3.645e+04, dt=0.00175567, dtf=0.0005662, dtb=0.001189</span>
<span id="cb18-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.743565]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=40, loss=543.661, sps=3.708e+04, dt=0.00172613, dtf=0.0005363, dtb=0.00119</span>
<span id="cb18-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.746561]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=41, loss=537.186, sps=3.691e+04, dt=0.00173373, dtf=0.0005346, dtb=0.001199</span>
<span id="cb18-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.749446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=42, loss=545.877, sps=3.998e+04, dt=0.00160083, dtf=0.000533, dtb=0.001068</span>
<span id="cb18-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.752446]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=43, loss=546.533, sps=3.681e+04, dt=0.00173875, dtf=0.0005124, dtb=0.001226</span>
<span id="cb18-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.755384]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=44, loss=545.989, sps=3.796e+04, dt=0.001686, dtf=0.0005054, dtb=0.001181</span>
<span id="cb18-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.758389]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=45, loss=531.344, sps=3.667e+04, dt=0.00174516, dtf=0.0005569, dtb=0.001188</span>
<span id="cb18-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.761470]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=46, loss=515.415, sps=3.69e+04, dt=0.00173432, dtf=0.000551, dtb=0.001183</span>
<span id="cb18-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.764494]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=47, loss=523.498, sps=3.634e+04, dt=0.00176121, dtf=0.0005524, dtb=0.001209</span>
<span id="cb18-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.767522]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=48, loss=515.942, sps=3.625e+04, dt=0.00176562, dtf=0.0005655, dtb=0.0012</span>
<span id="cb18-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.770555]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=49, loss=527.433, sps=3.62e+04, dt=0.00176783, dtf=0.0005579, dtb=0.00121</span>
<span id="cb18-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.773467]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=50, loss=520.038, sps=3.938e+04, dt=0.00162521, dtf=0.0005579, dtb=0.001067</span>
<span id="cb18-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.776470]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=51, loss=507.743, sps=3.68e+04, dt=0.00173934, dtf=0.0005378, dtb=0.001202</span>
<span id="cb18-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.779466]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=52, loss=505.372, sps=3.694e+04, dt=0.00173268, dtf=0.0005321, dtb=0.001201</span>
<span id="cb18-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.782434]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=53, loss=505.824, sps=3.736e+04, dt=0.00171324, dtf=0.0005403, dtb=0.001173</span>
<span id="cb18-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.785426]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=54, loss=498.697, sps=3.751e+04, dt=0.00170619, dtf=0.0005259, dtb=0.00118</span>
<span id="cb18-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.788396]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=55, loss=492.434, sps=3.719e+04, dt=0.00172085, dtf=0.0005036, dtb=0.001217</span>
<span id="cb18-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.791354]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=56, loss=486.032, sps=3.754e+04, dt=0.00170497, dtf=0.0005077, dtb=0.001197</span>
<span id="cb18-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.794333]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=57, loss=487.687, sps=3.803e+04, dt=0.00168299, dtf=0.0005009, dtb=0.001182</span>
<span id="cb18-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.797238]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=58, loss=481.011, sps=3.929e+04, dt=0.00162898, dtf=0.0005554, dtb=0.001074</span>
<span id="cb18-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.800237]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=59, loss=478.058, sps=3.692e+04, dt=0.00173365, dtf=0.0005374, dtb=0.001196</span>
<span id="cb18-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.803250]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=60, loss=476.983, sps=3.666e+04, dt=0.00174587, dtf=0.0005318, dtb=0.001214</span>
<span id="cb18-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.806222]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=61, loss=468.415, sps=3.716e+04, dt=0.00172234, dtf=0.0005256, dtb=0.001197</span>
<span id="cb18-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.809230]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=62, loss=461.661, sps=3.727e+04, dt=0.00171737, dtf=0.0005219, dtb=0.001195</span>
<span id="cb18-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.812204]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=63, loss=465.746, sps=3.688e+04, dt=0.00173519, dtf=0.0005067, dtb=0.001228</span>
<span id="cb18-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.815192]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=64, loss=470.95, sps=3.724e+04, dt=0.00171855, dtf=0.0004994, dtb=0.001219</span>
<span id="cb18-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.818155]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=65, loss=463.301, sps=3.774e+04, dt=0.00169586, dtf=0.0005053, dtb=0.001191</span>
<span id="cb18-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.821161]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=66, loss=450.195, sps=3.68e+04, dt=0.00173904, dtf=0.0005626, dtb=0.001176</span>
<span id="cb18-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.824143]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=67, loss=449.097, sps=3.662e+04, dt=0.00174746, dtf=0.0005578, dtb=0.00119</span>
<span id="cb18-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.827103]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=68, loss=447.465, sps=3.778e+04, dt=0.00169412, dtf=0.0005488, dtb=0.001145</span>
<span id="cb18-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.830071]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=69, loss=444.676, sps=3.835e+04, dt=0.00166873, dtf=0.0005467, dtb=0.001122</span>
<span id="cb18-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.833030]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=70, loss=429.532, sps=3.83e+04, dt=0.00167122, dtf=0.0005362, dtb=0.001135</span>
<span id="cb18-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.836024]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=71, loss=437.085, sps=3.711e+04, dt=0.00172438, dtf=0.0005086, dtb=0.001216</span>
<span id="cb18-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.839009]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=72, loss=436.272, sps=3.71e+04, dt=0.00172525, dtf=0.0005177, dtb=0.001208</span>
<span id="cb18-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.841920]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=73, loss=430.464, sps=3.893e+04, dt=0.00164403, dtf=0.0004874, dtb=0.001157</span>
<span id="cb18-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.844806]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=74, loss=426.483, sps=3.904e+04, dt=0.0016393, dtf=0.000449, dtb=0.00119</span>
<span id="cb18-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.847771]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=75, loss=413.371, sps=3.75e+04, dt=0.0017066, dtf=0.0005185, dtb=0.001188</span>
<span id="cb18-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.850712]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=76, loss=421.381, sps=3.77e+04, dt=0.00169769, dtf=0.000506, dtb=0.001192</span>
<span id="cb18-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.853587]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=77, loss=415.112, sps=3.988e+04, dt=0.0016047, dtf=0.000537, dtb=0.001068</span>
<span id="cb18-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.856557]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=78, loss=413.084, sps=3.729e+04, dt=0.0017161, dtf=0.0005459, dtb=0.00117</span>
<span id="cb18-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.859518]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=79, loss=412.671, sps=3.761e+04, dt=0.00170149, dtf=0.0005066, dtb=0.001195</span>
<span id="cb18-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.862469]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=80, loss=408.688, sps=3.776e+04, dt=0.00169481, dtf=0.0005446, dtb=0.00115</span>
<span id="cb18-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.865521]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=81, loss=400.914, sps=3.674e+04, dt=0.00174196, dtf=0.0005528, dtb=0.001189</span>
<span id="cb18-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.868536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=82, loss=389.823, sps=3.655e+04, dt=0.00175112, dtf=0.000574, dtb=0.001177</span>
<span id="cb18-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.871531]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=83, loss=399.073, sps=3.686e+04, dt=0.00173618, dtf=0.0005504, dtb=0.001186</span>
<span id="cb18-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.874511]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=84, loss=385.773, sps=3.725e+04, dt=0.00171814, dtf=0.0005499, dtb=0.001168</span>
<span id="cb18-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.877492]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=85, loss=400.61, sps=3.739e+04, dt=0.00171182, dtf=0.000546, dtb=0.001166</span>
<span id="cb18-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.880505]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=86, loss=389.813, sps=3.673e+04, dt=0.00174226, dtf=0.0005734, dtb=0.001169</span>
<span id="cb18-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.883515]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=87, loss=385.995, sps=3.694e+04, dt=0.00173256, dtf=0.0005296, dtb=0.001203</span>
<span id="cb18-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.886470]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=88, loss=379.115, sps=3.774e+04, dt=0.00169591, dtf=0.0005467, dtb=0.001149</span>
<span id="cb18-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.889422]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=89, loss=378.738, sps=3.798e+04, dt=0.00168494, dtf=0.0005276, dtb=0.001157</span>
<span id="cb18-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.892414]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=90, loss=365.054, sps=3.675e+04, dt=0.00174164, dtf=0.000513, dtb=0.001229</span>
<span id="cb18-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.895367]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=91, loss=380.372, sps=3.772e+04, dt=0.00169654, dtf=0.000495, dtb=0.001201</span>
<span id="cb18-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.898322]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=92, loss=377.233, sps=3.852e+04, dt=0.00166155, dtf=0.000539, dtb=0.001123</span>
<span id="cb18-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.901288]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=93, loss=366.226, sps=3.788e+04, dt=0.00168959, dtf=0.0005446, dtb=0.001145</span>
<span id="cb18-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.904284]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=94, loss=366.221, sps=3.69e+04, dt=0.00173462, dtf=0.0005535, dtb=0.001181</span>
<span id="cb18-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.907289]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=95, loss=366.673, sps=3.662e+04, dt=0.00174759, dtf=0.0005328, dtb=0.001215</span>
<span id="cb18-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.910260]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=96, loss=362.985, sps=3.716e+04, dt=0.00172234, dtf=0.0005436, dtb=0.001179</span>
<span id="cb18-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.913277]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=97, loss=349.768, sps=3.668e+04, dt=0.00174469, dtf=0.000529, dtb=0.001216</span>
<span id="cb18-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.916293]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=98, loss=363.521, sps=3.675e+04, dt=0.0017416, dtf=0.0005412, dtb=0.0012</span>
<span id="cb18-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.919280]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=99, loss=345.533, sps=3.717e+04, dt=0.00172205, dtf=0.0005134, dtb=0.001209</span>
<span id="cb18-168">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-169">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00284‚î§‚ñò</span></span>
<span id="cb18-171">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-172">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00264‚î§</span></span>
<span id="cb18-174">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-175">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00243‚î§</span></span>
<span id="cb18-177">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00222‚î§</span></span>
<span id="cb18-179">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-180">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span></span>
<span id="cb18-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00201‚î§</span></span>
<span id="cb18-182">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñó</span></span>
<span id="cb18-183">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù‚ñò‚ñó‚ñó‚ññ               ‚ñù</span>
<span id="cb18-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00181‚î§</span>   ‚ñò  ‚ññ         ‚ñó</span>
<span id="cb18-185">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ñò‚ñÑ ‚ññ‚ñÑ‚ññ‚ñÑ‚ñó‚ññ ‚ñó‚ñó ‚ñò ‚ñó‚ñÑ‚ñù‚ññ‚ñó‚ñó‚ññ‚ññ‚ññ‚ñó‚ñó‚ñò‚ñÄ ‚ñÑ    ‚ñó‚ñó ‚ñó  ‚ñÑ   ‚ññ     ‚ñó‚ñó‚ññ ‚ññ‚ññ ‚ññ  ‚ñÑ ‚ññ‚ññ</span>
<span id="cb18-186">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>      ‚ñù  ‚ñù      ‚ñò  ‚ñù ‚ñò    ‚ñò    ‚ññ     ‚ñù‚ñò‚ñÄ‚ñó  ‚ñò‚ñò‚ñù‚ñò ‚ñò‚ñÑ‚ñù  ‚ñò‚ñò‚ñù‚ñò‚ñò ‚ñù‚ñù ‚ñù‚ñó‚ñù‚ñó‚ñò ‚ñù ‚ñù</span>
<span id="cb18-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00160‚î§</span>                  ‚ññ          ‚ñó     ‚ñù     ‚ñò          ‚ñÄ ‚ñó</span>
<span id="cb18-188">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ</span></span>
<span id="cb18-189">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb18-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span>                                 iter</span>
<span id="cb18-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.943086]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dt.txt</span>
<span id="cb18-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dt.txt</span>
<span id="cb18-193">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-194">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb18-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00098‚î§‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb18-196">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-197">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00089‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-199">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-200">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00080‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-202">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00071‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-204">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-205">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-206"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00063‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-207">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù‚ñò‚ñÑ  ‚ñû                                                                ‚îÇ</span>
<span id="cb18-208">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñù‚ñò ‚ññ  ‚ññ  ‚ññ  ‚ñó   ‚ññ   ‚ñó  ‚ñó      ‚ññ                       ‚ñó  ‚ññ         ‚îÇ</span>
<span id="cb18-209"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00054‚î§</span>        ‚ñÄ‚ñù ‚ñû‚ññ    ‚ñù   ‚ñÄ‚ñù‚ñÄ ‚ñò‚ñù ‚ññ‚ñÑ ‚ñù‚ñù‚ñò‚ñù‚ñù‚ññ‚ñó   ‚ñö     ‚ñÄ‚ñò‚ñÑ    ‚ñó‚ñó ‚ñû ‚ñÄ‚ñó ‚ñó  ‚ñó‚ññ‚ñö‚ñó ‚ññ‚îÇ</span>
<span id="cb18-210">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù</span>            ‚ñù‚ñù‚ññ‚ññ ‚ñö       ‚ñò   ‚ññ‚ññ    ‚ñù ‚ñò‚ñÑ  ‚ñù‚ñò‚ñö ‚ññ   ‚ñó‚ñò ‚ñò‚ññ ‚ññ     ‚ñò‚ñù‚ññ    ‚ñò‚ñó‚îÇ</span>
<span id="cb18-211">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                   ‚ñù                    ‚ñù    ‚ñù      ‚ñò           ‚ñù      ‚îÇ</span>
<span id="cb18-212"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00045‚î§</span>                                                    ‚ñó                  ‚îÇ</span>
<span id="cb18-213">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb18-214">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb18-215"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span>                                iter</span>
<span id="cb18-216"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.952631]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dtf.txt</span>
<span id="cb18-217"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dtf.txt</span>
<span id="cb18-218">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-219">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb18-220"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00186‚î§‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb18-221">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-222">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-223"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00173‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-224">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-225">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00160‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-227">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00146‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-229">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñó</span>                                                                      ‚îÇ</span>
<span id="cb18-230">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00133‚î§</span>                     ‚ñó                                                 ‚îÇ</span>
<span id="cb18-232">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù‚ññ ‚ñó‚ññ                                                                 ‚îÇ</span>
<span id="cb18-233">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñû              ‚ñó                                                    ‚îÇ</span>
<span id="cb18-234"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00120‚î§</span>      ‚ññ‚ññ   ‚ñó ‚ñó‚ñó‚ñò‚ñù  ‚ñó‚ññ  ‚ññ‚ñó‚ññ   ‚ññ‚ñò  ‚ññ‚ñÑ ‚ñÑ  ‚ñö ‚ñó‚ñó‚ññ‚ñû‚ñù    ‚ñù‚ññ    ‚ññ     ‚ññ ‚ñö  ‚ñó ‚ñò‚ñÑ‚îÇ</span>
<span id="cb18-235">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        ‚ñÄ‚ñó‚ñò‚ñò‚ñò‚ññ  ‚ñò‚ñù   ‚ñò‚ñù‚ñù  ‚ñÄ‚ñù‚ñò  ‚ñÄ‚ñù    ‚ñù‚ñò ‚ñù     ‚ñò‚ñÄ    ‚ñû‚ñò‚ñò‚ñù ‚ñû‚ñù‚ñö‚ñó‚ññ‚ñó‚ñó   ‚ñò‚ñù  ‚îÇ</span>
<span id="cb18-236">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                ‚ñò‚ñû               ‚ñó‚ñò    ‚îÇ</span>
<span id="cb18-237"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00107‚î§</span>      ‚ñù           ‚ñò          ‚ñó     ‚ñó     ‚ññ            ‚ñó                ‚îÇ</span>
<span id="cb18-238">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb18-239">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb18-240"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span>                                iter</span>
<span id="cb18-241"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:43.962230]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dtb.txt</span>
<span id="cb18-242"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/dtb.txt</span>
<span id="cb18-243">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-244">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb18-245"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2039.9‚î§‚ñò</span>                                                                       ‚îÇ</span>
<span id="cb18-246">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-247">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-248"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1757.5‚î§</span>                                                                        ‚îÇ</span>
<span id="cb18-249">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-250">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-251"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1475.1‚î§‚ñó</span>                                                                       ‚îÇ</span>
<span id="cb18-252">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-253"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1192.7‚î§</span>                                                                        ‚îÇ</span>
<span id="cb18-254">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù                                                                      ‚îÇ</span>
<span id="cb18-255">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb18-256">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">910.3‚î§</span>  ‚ññ                                                                     ‚îÇ</span>
<span id="cb18-257">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ññ                                                                    ‚îÇ</span>
<span id="cb18-258">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñù‚ñù‚ññ‚ñÑ‚ñó                                                                ‚îÇ</span>
<span id="cb18-259">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">627.9‚î§</span>        ‚ñò‚ñÄ‚ñò‚ñÄ‚ñù‚ñò‚ñö‚ñó‚ññ‚ñÑ‚ññ‚ñó                                                    ‚îÇ</span>
<span id="cb18-260">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                   ‚ñò‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñö‚ñù‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ññ                                   ‚îÇ</span>
<span id="cb18-261">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                    ‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñö‚ññ‚ñö‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñó                 ‚îÇ</span>
<span id="cb18-262">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">345.5‚î§</span>                                                      ‚ñò‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñÄ‚ñù‚ñÄ‚ñù‚ñò‚ñû‚ñù‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚îÇ</span>
<span id="cb18-263">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb18-264">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0             74.5             99.0</span>
<span id="cb18-265"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span>                               iter</span>
<span id="cb18-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.011096]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/loss.txt</span>
<span id="cb18-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/loss.txt</span>
<span id="cb18-268">                           <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222144</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-269">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb18-270"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">99.0‚î§</span>                                                                      ‚ñó‚ñó‚ññ‚ñÄ‚îÇ</span>
<span id="cb18-271">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                   ‚ñÑ‚ñù‚ñò‚ñò   ‚îÇ</span>
<span id="cb18-272">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                              ‚ñó‚ññ‚ñû‚ñù‚ñò       ‚îÇ</span>
<span id="cb18-273"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82.7‚î§</span>                                                          ‚ñÑ‚ñó‚ñò‚ñÄ            ‚îÇ</span>
<span id="cb18-274">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                      ‚ññ‚ñÑ‚ñù‚ñò                ‚îÇ</span>
<span id="cb18-275">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                 ‚ñó‚ñó‚ññ‚ñÄ‚ñù                    ‚îÇ</span>
<span id="cb18-276"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">66.3‚î§</span>                                              ‚ñÑ‚ñù‚ñò‚ñò                        ‚îÇ</span>
<span id="cb18-277">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                         ‚ñó‚ññ‚ñû‚ñù‚ñò                            ‚îÇ</span>
<span id="cb18-278"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">50.0‚î§</span>                                     ‚ñÑ‚ñó‚ñò‚ñÄ                                 ‚îÇ</span>
<span id="cb18-279">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                 ‚ññ‚ñÑ‚ñù‚ñò                                     ‚îÇ</span>
<span id="cb18-280">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                            ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                         ‚îÇ</span>
<span id="cb18-281"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33.7‚î§</span>                         ‚ñÑ‚ñù‚ñò‚ñò                                             ‚îÇ</span>
<span id="cb18-282">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                    ‚ñó‚ññ‚ñû‚ñù‚ñò                                                 ‚îÇ</span>
<span id="cb18-283">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                ‚ñÑ‚ñó‚ñò‚ñÄ                                                      ‚îÇ</span>
<span id="cb18-284"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17.3‚î§</span>            ‚ññ‚ñÑ‚ñù‚ñò                                                          ‚îÇ</span>
<span id="cb18-285">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                                              ‚îÇ</span>
<span id="cb18-286">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñÑ‚ñù‚ñò‚ñò                                                                  ‚îÇ</span>
<span id="cb18-287">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0‚î§‚ññ‚ñû‚ñù‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb18-288">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb18-289">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5               50.0              74.5             99.0</span>
<span id="cb18-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span>                              iter</span>
<span id="cb18-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.021040]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/iter.txt</span>
<span id="cb18-292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/iter.txt</span>
<span id="cb18-293">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">23</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">222144</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb18-294">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb18-295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">39979.2‚î§</span>                  ‚ññ          ‚ñù     ‚ñó     ‚ññ            ‚ñù                ‚îÇ</span>
<span id="cb18-296">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                 ‚ñÑ  ‚ñÄ            ‚ñó     ‚îÇ</span>
<span id="cb18-297">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>      ‚ñù  ‚ñó      ‚ññ  ‚ñù      ‚ññ    ‚ñò     ‚ñó‚ññ‚ñó‚ñù   ‚ññ‚ñó‚ñò ‚ñò    ‚ññ‚ññ‚ñó‚ññ‚ñò ‚ñó‚ñó ‚ñù‚ñù‚ñó ‚ñò    ‚îÇ</span>
<span id="cb18-298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">37069.3‚î§</span>        ‚ñö ‚ññ‚ñö‚ñò‚ñÄ‚ñù‚ñò ‚ñù‚ñó  ‚ñò‚ñó‚ñû ‚ññ‚ñù‚ñó‚ñò‚ñò‚ñò‚ñó‚ñù‚ññ‚ññ ‚ñÄ  ‚ñò ‚ñù‚ñó‚ñò‚ñù  ‚ñö  ‚ñù‚ñò     ‚ñù‚ñó‚ñò ‚ññ‚ñò ‚ñò  ‚ñö‚ñù‚ññ‚ñÄ‚îÇ</span>
<span id="cb18-299">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>      ‚ññ‚ñò        ‚ñó   ‚ñò   ‚ñù         ‚ñù                                    ‚îÇ</span>
<span id="cb18-300">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñò                                                                   ‚îÇ</span>
<span id="cb18-301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">34159.4‚î§</span> ‚ñó‚ññ‚ñù‚ñù‚ñò               ‚ñó                                                 ‚îÇ</span>
<span id="cb18-302">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñó</span>                                                                      ‚îÇ</span>
<span id="cb18-303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31249.4‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-304">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-305">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">28339.5‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-307">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-308">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-309"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">25429.6‚î§</span>                                                                       ‚îÇ</span>
<span id="cb18-310">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-311">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb18-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22519.7‚î§‚ññ</span>                                                                      ‚îÇ</span>
<span id="cb18-313">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb18-314">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb18-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span>                                iter</span>
<span id="cb18-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.030585]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/sps.txt</span>
<span id="cb18-317"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/test-dist-plots/train/sps.txt</span></code></pre></div>
<details closed="">
<summary>
<p>PyInstrument Profile:</p>
</summary>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Recorded:</span> 22:21:41  Samples:  2223</span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Duration:</span> 2.668     CPU time: 2.406</span>
<span id="cb19-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">v4.6.2</span></span>
<span id="cb19-4"></span>
<span id="cb19-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Program:</span> /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/deps/ezpz/src/ezpz/test_dist.py</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.668</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  ezpz/test_dist.py:1</span>
<span id="cb19-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 2.667 main  ezpz/test_dist.py:217</span>
<span id="cb19-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 2.106 build_model_and_optimizer  ezpz/test_dist.py:171</span>
<span id="cb19-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 2.092 Adam.__init__  torch/optim/adam.py:15</span>
<span id="cb19-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [147 frames hidden]  torch, transformers, jax, huggingface...</span>
<span id="cb19-12">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.183 _forward_step  ezpz/test_dist.py:231</span>
<span id="cb19-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îú‚îÄ 0.137 DistributedDataParallel._wrapped_call_impl  torch/nn/modules/module.py:1528</span>
<span id="cb19-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ     [6 frames hidden]  torch</span>
<span id="cb19-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ        0.123 Network._call_impl  torch/nn/modules/module.py:1534</span>
<span id="cb19-16">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ        ‚îî‚îÄ 0.123 Network.forward  ezpz/test_dist.py:164</span>
<span id="cb19-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ           ‚îî‚îÄ 0.123 Sequential._wrapped_call_impl  torch/nn/modules/module.py:1528</span>
<span id="cb19-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ                 [7 frames hidden]  torch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>built-in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb19-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.046 calc_loss  ezpz/test_dist.py:168</span>
<span id="cb19-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.164 _backward_step  ezpz/test_dist.py:236</span>
<span id="cb19-21">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îú‚îÄ 0.103 wrapper  torch/optim/optimizer.py:374</span>
<span id="cb19-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îÇ     [5 frames hidden]  torch</span>
<span id="cb19-23">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.060 Tensor.backward  torch/_tensor.py:466</span>
<span id="cb19-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [4 frames hidden]  torch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>built-in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb19-25">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ</span> 0.113 tplot_dict  ezpz/plot.py:136</span>
<span id="cb19-26">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚îî‚îÄ 0.082 show  plotext/_core.py:292</span>
<span id="cb19-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        [5 frames hidden]  plotext</span>
<span id="cb19-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 0.099 Logger.info  logging/__init__.py:1479</span>
<span id="cb19-29">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[6</span> frames hidden]  logging, rich</span>
<span id="cb19-30">            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.099</span> RichHandler.emit  rich/logging.py:126</span>
<span id="cb19-31">            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 0.099 Console.print  ezpz/log/console.py:79</span>
<span id="cb19-32">              <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ</span> 0.099 Console.print  rich/console.py:1624</span>
<span id="cb19-33">                    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[5</span> frames hidden]  rich</span>
<span id="cb19-34"></span>
<span id="cb19-35"></span>
<span id="cb19-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.231519]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:115</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving pyinstrument profile output to: /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/ezpz_pyinstrument_profiles</span>
<span id="cb19-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.232054]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:123</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> PyInstrument profile saved <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span> html<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to:</span>  /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-23-222144.html</span>
<span id="cb19-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.232619]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:131</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> PyInstrument profile saved <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span> text<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to:</span>  /lus/eagle/projects/argonne_tpc/foremans/projects/argonne-lcf/tmp/2024-07-23-221253/Megatron-DeepSpeed/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-23-222144.txt</span>
<span id="cb19-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.761876]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">profile:143</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Finished with pyinstrument profiler. Took: 2.66778s</span>
<span id="cb19-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-23</span> 22:21:44.762534]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:318</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> runtime=6.785542s</span>
<span id="cb19-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz-test-dist.log</span> lines 216-359/359 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">END</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</details></li>
</ul>
<hr>
<details closed="">
<summary>
Deprecated:
</summary>
<ol type="1">
<li><p>Download and source <a href="https://github.com/saforem2/ezpz/blob/main/src/ezpz/bin/utils.sh"><code>ezpz/bin/utils.sh</code></a>:</p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ezpz_utils()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span></span>
<span id="cb20-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb20-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Ls</span> https://raw.githubusercontent.com/saforem2/ezpz/main/src/ezpz/bin/utils.sh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fp</span></span>
<span id="cb20-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fp</span></span>
<span id="cb20-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb20-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_utils</span></span></code></pre></div></li>
<li><p>Use <code>ezpz_setup_python</code> to:</p>
<ol type="1">
<li>Setup base <code>conda</code> environment</li>
<li>Create<sup>2</sup> a virtual environment <em>on top of</em> the base <code>conda</code> environment<sup>3</sup></li>
</ol>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][12:45:49 PM][foremans@x3006c0s13b0n0][~/tmp/foremans/2024-07-15-124441]</span></span>
<span id="cb21-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> ezpz_utils <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_python</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_alcf</span> </span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /home/foremans/tmp/foremans/2024-07-15-124441</span>
<span id="cb21-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> conda_prefix OR virtual_env found in environment...</span>
<span id="cb21-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Setting</span> up conda...</span>
<span id="cb21-7"></span>
<span id="cb21-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nvhpc/23.9"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gcc-native/12.3"</span>.</span>
<span id="cb21-9"></span>
<span id="cb21-10"></span>
<span id="cb21-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-nvhpc/8.5.0"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-gnu/8.5.0"</span>.</span>
<span id="cb21-12"></span>
<span id="cb21-13"></span>
<span id="cb21-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb21-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-mpich/8.1.28</span></span>
<span id="cb21-16"></span>
<span id="cb21-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> conda at: /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb21-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> VIRTUAL_ENV found in environment!</span>
<span id="cb21-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Trying to setup from /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb21-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Using VENV_DIR=/home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb21-21"></span>
<span id="cb21-22">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Creating a new virtual env on top of 2024-04-29 in /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb21-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[python]</span> Using /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/bin/python3</span>
<span id="cb21-24"></span>
<span id="cb21-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz/bin/utils.sh]</span></span>
<span id="cb21-26"></span>
<span id="cb21-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15-124600]</span></span>
<span id="cb21-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> USER=foremans</span>
<span id="cb21-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=polaris</span>
<span id="cb21-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOST=x3006c0s13b0n0</span>
<span id="cb21-31"></span>
<span id="cb21-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_setup_host]</span></span>
<span id="cb21-33">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Using hostfile: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb21-34">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Found in environment:</span>
<span id="cb21-35">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb21-36">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Writing PBS vars to: /home/foremans/.pbsenv</span>
<span id="cb21-37"></span>
<span id="cb21-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_save_pbs_env]</span></span>
<span id="cb21-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Setting:</span>
<span id="cb21-40">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb21-41">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> JOBENV_FILE: /home/foremans/.pbsenv</span>
<span id="cb21-42"></span>
<span id="cb21-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[HOSTS]</span></span>
<span id="cb21-44">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x3006c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb21-45"></span>
<span id="cb21-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DIST</span> INFO]</span>
<span id="cb21-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb21-48">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NHOSTS=1</span>
<span id="cb21-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPU_PER_HOST=4</span>
<span id="cb21-50">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb21-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DIST_LAUNCH=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb21-52"></span>
<span id="cb21-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LAUNCH]:</span></span>
<span id="cb21-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> To launch across all available GPUs, use: launch</span>
<span id="cb21-55">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span></code></pre></div></li>
</ol>
<ol start="3" type="1">
<li><p>Install <code>ezpz</code> into the virtual environment from 2.</p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git+https://github.com/saforem2/ezpz#egg=ezpz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--require-virtualenv</span></span></code></pre></div>
<details closed="">
<summary>
<p>output</p>
</summary>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Looking</span> in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com</span>
<span id="cb23-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Obtaining</span> ezpz from git+https://github.com/saforem2/ezpz#egg=ezpz</span>
<span id="cb23-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cloning</span> https://github.com/saforem2/ezpz to ./venvs/2024-04-29/src/ezpz</span>
<span id="cb23-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Running</span> command git clone <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--filter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blob:none <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> https://github.com/saforem2/ezpz /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/src/ezpz</span>
<span id="cb23-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Resolved</span> https://github.com/saforem2/ezpz to commit d8fabca03038db55a1dc490f801581e980f93a25</span>
<span id="cb23-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> build dependencies ... done</span>
<span id="cb23-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Checking</span> if build backend supports build_editable ... done</span>
<span id="cb23-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Getting</span> requirements to build editable ... done</span>
<span id="cb23-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> backend dependencies ... done</span>
<span id="cb23-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Preparing</span> editable metadata <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span> done</span>
<span id="cb23-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ambivalent in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: hydra-colorlog in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.2.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: hydra-core in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ipython in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.24.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jax in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jaxlib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.26+cuda12.cudnn89</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jaxtyping in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: joblib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ml-dtypes in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.3.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mpi4py in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: omegaconf in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: plotext in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.2.8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Collecting</span> pyinstrument <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Downloading</span> pyinstrument-4.6.2-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span> kB<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: rich in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13.7.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: seaborn in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.13.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sentencepiece in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sh in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tensorboard in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.16.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: torch in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tqdm in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.65.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: wandb in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.16.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: xarray in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: colormaps in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: matplotlib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.8.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: requests in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.31.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: colorlog in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-colorlog-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6.8.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: antlr4-python3-runtime==4.9.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-core-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.9.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: packaging in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-core-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: PyYAML<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.1.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> omegaconf-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: decorator in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.1.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jedi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.16 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.19.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: matplotlib-inline in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.1.7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: prompt-toolkit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3.1.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.41 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.43</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pygments<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.4.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.17.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: stack-data in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.6.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: traitlets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.13.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.14.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: typing-extensions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.6 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.11.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pexpect<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>4.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.9.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: numpy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.22 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.26.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: opt-einsum in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: scipy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.9 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.13.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: typeguard==2.13.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jaxtyping-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.13.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: markdown-it-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.2.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> rich-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: absl-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.4 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: grpcio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.48.2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.62.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: markdown<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.6.8 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: protobuf!=4.24.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.19.6 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.20.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: setuptools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=41.0.0 in ./venvs/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65.5.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: six<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>1.9 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.16.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tensorboard-data-server<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>0.8.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.7.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.7.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: werkzeug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: filelock in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.13.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sympy in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: networkx in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jinja2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: fsspec in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.3.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: Click!=8.0.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=7.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.1.7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.43</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: psutil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.9.8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sentry-sdk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: docker-pycreds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.4.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: setproctitle in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: appdirs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.4.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: gitdb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>5,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.0.11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: parso<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>0.9.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.8.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jedi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.16-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.8.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mdurl~=0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> markdown-it-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.2.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>rich-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.1.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: contourpy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.2.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: cycler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.10 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.12.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: fonttools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.22.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.51.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: kiwisolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.3.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pillow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=8 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pyparsing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.3.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: python-dateutil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.7 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.9.0.post0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pytz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2020.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tzdata<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2022.7 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ptyprocess<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.5 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pexpect<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>4.3-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.7.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: wcwidth in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> prompt-toolkit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3.1.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.41-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: charset-normalizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>4,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: idna<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>4,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.5 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: urllib3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.21.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: certifi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2017.4.17 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: MarkupSafe<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.1.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> werkzeug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: executing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: asttokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.1.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.4.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pure-eval in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mpmath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.19 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> sympy-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: smmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>6,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> gitdb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>5,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.0.1-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Downloading</span> pyinstrument-4.6.2-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">104</span> kB<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb23-101"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> 104.9/104.9 kB 3.1 MB/s eta 0:00:00</span>
<span id="cb23-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Building</span> wheels for collected packages: ezpz</span>
<span id="cb23-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Building</span> editable for ezpz <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span> done</span>
<span id="cb23-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Created</span> wheel for ezpz: filename=ezpz-0.1-py3-none-any.whl size=10104 sha256=f73fbc552c6192f2d1575c08528267c1c70bd4ed2eebab011c692b4cf66fd9cb</span>
<span id="cb23-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Stored</span> in directory: /tmp/pip-ephem-wheel-cache-6xb0tqk8/wheels/b3/57/90/f3324177d75cbc607a034b5b8e66d5b3d35dcf087967430718</span>
<span id="cb23-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Successfully</span> built ezpz</span>
<span id="cb23-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> collected packages: pyinstrument, ezpz</span>
<span id="cb23-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Attempting</span> uninstall: ezpz</span>
<span id="cb23-109">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> existing installation: ezpz 0.1</span>
<span id="cb23-110">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Not</span> uninstalling ezpz at /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages, outside environment /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb23-111">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cant</span> uninstall <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz'</span>. No files were found to uninstall.</span>
<span id="cb23-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Successfully</span> installed ezpz pyinstrument-4.6.2</span>
<span id="cb23-113"></span>
<span id="cb23-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[notice]</span> A new release of pip is available: 24.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> 24.1.2</span>
<span id="cb23-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[notice]</span> To update, run: pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span> pip</span>
<span id="cb23-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9.63s</span> user 1.44s system 60% cpu 18.301s total</span></code></pre></div>
</details></li>
</ol>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][12:44:34 PM][foremans@x3006c0s13b0n0][~/tmp]</span></span>
<span id="cb24-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> dname=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$USER</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tstamp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dname</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dname</span></span>
<span id="cb24-3"></span>
<span id="cb24-4"></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][12:44:45 PM][foremans@x3006c0s13b0n0][~/tmp/foremans/2024-07-15-124441]</span></span>
<span id="cb24-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ezpz_utils()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mktemp</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Ls</span> https://raw.githubusercontent.com/saforem2/ezpz/main/src/ezpz/bin/utils.sh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fp</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fp</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> }</span>
<span id="cb24-7"></span>
<span id="cb24-8"></span>
<span id="cb24-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][12:44:47 PM][foremans@x3006c0s13b0n0][~/tmp/foremans/2024-07-15-124441]</span></span>
<span id="cb24-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> ezpz_utils</span>
<span id="cb24-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /home/foremans/tmp/foremans/2024-07-15-124441</span>
<span id="cb24-12"></span>
<span id="cb24-13"></span>
<span id="cb24-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[üåå][12:45:49 PM][foremans@x3006c0s13b0n0][~/tmp/foremans/2024-07-15-124441]</span></span>
<span id="cb24-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> ezpz_utils <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_python</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ezpz_setup_alcf</span> </span>
<span id="cb24-16"></span>
<span id="cb24-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Using</span> WORKING_DIR: /home/foremans/tmp/foremans/2024-07-15-124441</span>
<span id="cb24-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> conda_prefix OR virtual_env found in environment...</span>
<span id="cb24-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Setting</span> up conda...</span>
<span id="cb24-20"></span>
<span id="cb24-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nvhpc/23.9"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gcc-native/12.3"</span>.</span>
<span id="cb24-22"></span>
<span id="cb24-23"></span>
<span id="cb24-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Lmod</span> is automatically replacing <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-nvhpc/8.5.0"</span> with <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrgEnv-gnu/8.5.0"</span>.</span>
<span id="cb24-25"></span>
<span id="cb24-26"></span>
<span id="cb24-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb24-28">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cray-mpich/8.1.28</span></span>
<span id="cb24-29"></span>
<span id="cb24-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> conda at: /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb24-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> VIRTUAL_ENV found in environment!</span>
<span id="cb24-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Trying to setup from /soft/applications/conda/2024-04-29/mconda3</span>
<span id="cb24-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Using VENV_DIR=/home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb24-34"></span>
<span id="cb24-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-</span> Creating a new virtual env on top of 2024-04-29 in /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb24-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[python]</span> Using /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/bin/python3</span>
<span id="cb24-37"></span>
<span id="cb24-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz/bin/utils.sh]</span></span>
<span id="cb24-39"></span>
<span id="cb24-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15-124600]</span></span>
<span id="cb24-41">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> USER=foremans</span>
<span id="cb24-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=polaris</span>
<span id="cb24-43">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOST=x3006c0s13b0n0</span>
<span id="cb24-44"></span>
<span id="cb24-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_setup_host]</span></span>
<span id="cb24-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Using hostfile: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-47">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Found in environment:</span>
<span id="cb24-48">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-49">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Writing PBS vars to: /home/foremans/.pbsenv</span>
<span id="cb24-50"></span>
<span id="cb24-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[ezpz_save_pbs_env]</span></span>
<span id="cb24-52">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> Setting:</span>
<span id="cb24-53">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE: /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-54">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> JOBENV_FILE: /home/foremans/.pbsenv</span>
<span id="cb24-55"></span>
<span id="cb24-56"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">alias</span> LAUNCH=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mpiexec --verbose --envall -n 4 -ppn 4 --hostfile /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov --cpu-bind depth -d 16'</span></span>
<span id="cb24-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[HOSTS]</span></span>
<span id="cb24-58">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">host:0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> x3006c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-59"></span>
<span id="cb24-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[DIST</span> INFO]</span>
<span id="cb24-61">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-62">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NHOSTS=1</span>
<span id="cb24-63">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPU_PER_HOST=4</span>
<span id="cb24-64">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb24-65">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DIST_LAUNCH=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb24-66"></span>
<span id="cb24-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[LAUNCH]:</span></span>
<span id="cb24-68">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> To launch across all available GPUs, use: launch</span>
<span id="cb24-69">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch</span> = mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb24-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Looking</span> in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com</span>
<span id="cb24-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Obtaining</span> ezpz from git+https://github.com/saforem2/ezpz#egg=ezpz</span>
<span id="cb24-72">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cloning</span> https://github.com/saforem2/ezpz to ./venvs/2024-04-29/src/ezpz</span>
<span id="cb24-73">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Running</span> command git clone <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--filter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blob:none <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--quiet</span> https://github.com/saforem2/ezpz /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/src/ezpz</span>
<span id="cb24-74">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Resolved</span> https://github.com/saforem2/ezpz to commit d8fabca03038db55a1dc490f801581e980f93a25</span>
<span id="cb24-75">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> build dependencies ... done</span>
<span id="cb24-76">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Checking</span> if build backend supports build_editable ... done</span>
<span id="cb24-77">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Getting</span> requirements to build editable ... done</span>
<span id="cb24-78">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> backend dependencies ... done</span>
<span id="cb24-79">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Preparing</span> editable metadata <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span> done</span>
<span id="cb24-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ambivalent in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: hydra-colorlog in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.2.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: hydra-core in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ipython in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.24.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jax in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.26</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jaxlib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.26+cuda12.cudnn89</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jaxtyping in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.28</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: joblib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ml-dtypes in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.3.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mpi4py in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: omegaconf in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: plotext in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.2.8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Collecting</span> pyinstrument <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-93">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Downloading</span> pyinstrument-4.6.2-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">21</span> kB<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: rich in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">13.7.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: seaborn in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.13.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sentencepiece in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sh in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tensorboard in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.16.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: torch in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tqdm in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.65.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: wandb in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.16.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: xarray in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: colormaps in /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: matplotlib in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.8.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: requests in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.31.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: colorlog in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-colorlog-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6.8.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: antlr4-python3-runtime==4.9.<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-core-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.9.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: packaging in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> hydra-core-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">24.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: PyYAML<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.1.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> omegaconf-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">6.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: decorator in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.1.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jedi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.16 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.19.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: matplotlib-inline in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.1.7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: prompt-toolkit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3.1.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.41 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.43</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pygments<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.4.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.17.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: stack-data in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.6.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: traitlets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.13.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.14.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: typing-extensions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.6 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.11.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pexpect<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>4.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.9.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: numpy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.22 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.26.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: opt-einsum in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: scipy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.9 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jax-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.13.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: typeguard==2.13.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jaxtyping-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.13.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: markdown-it-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.2.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> rich-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: absl-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.4 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: grpcio<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.48.2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.62.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: markdown<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.6.8 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: protobuf!=4.24.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.19.6 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.20.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: setuptools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=41.0.0 in ./venvs/2024-04-29/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">65.5.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: six<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>1.9 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.16.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tensorboard-data-server<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>0.8.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.7.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.7.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: werkzeug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: filelock in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.13.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sympy in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.12</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: networkx in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: jinja2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.0.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: fsspec in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.3.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: Click!=8.0.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=7.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">8.1.7</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.43</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: psutil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=5.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.9.8</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: sentry-sdk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: docker-pycreds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.4.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.4.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: setproctitle in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: appdirs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.4.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: gitdb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>5,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.0.11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: parso<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>0.9.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.8.3 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> jedi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.16-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.8.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mdurl~=0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> markdown-it-py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.2.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>rich-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.1.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: contourpy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.2.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: cycler<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.10 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.12.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: fonttools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.22.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4.51.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: kiwisolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.3.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.4.5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pillow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=8 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">10.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pyparsing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.3.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.1.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: python-dateutil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.7 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> matplotlib-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.9.0.post0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pytz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2020.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: tzdata<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2022.7 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pandas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>seaborn-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: ptyprocess<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.5 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> pexpect<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>4.3-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.7.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: wcwidth in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> prompt-toolkit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3.1.0,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.41-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.13</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: charset-normalizer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>4,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: idna<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>4,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.5 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: urllib3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>3,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.21.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: certifi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2017.4.17 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> requests-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ambivalent-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: MarkupSafe<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.1.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> werkzeug<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.1-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>tensorboard-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.1.3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: executing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.2.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: asttokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=2.1.0 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.4.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: pure-eval in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> stack-data-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ipython-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.2.2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: mpmath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=0.19 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> sympy-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>torch-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.3.0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Requirement</span> already satisfied: smmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>6,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=3.0.1 in /soft/applications/conda/2024-04-29/mconda3/lib/python3.11/site-packages <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> gitdb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>5,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=4.0.1-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>GitPython!=3.1.29,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>=1.0.0-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>wandb-<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>ezpz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">5.0.1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Downloading</span> pyinstrument-4.6.2-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">104</span> kB<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-170">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> 104.9/104.9 kB 3.1 MB/s eta 0:00:00</span>
<span id="cb24-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Building</span> wheels for collected packages: ezpz</span>
<span id="cb24-172">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Building</span> editable for ezpz <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyproject.toml</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">...</span> done</span>
<span id="cb24-173">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Created</span> wheel for ezpz: filename=ezpz-0.1-py3-none-any.whl size=10104 sha256=f73fbc552c6192f2d1575c08528267c1c70bd4ed2eebab011c692b4cf66fd9cb</span>
<span id="cb24-174">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Stored</span> in directory: /tmp/pip-ephem-wheel-cache-6xb0tqk8/wheels/b3/57/90/f3324177d75cbc607a034b5b8e66d5b3d35dcf087967430718</span>
<span id="cb24-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Successfully</span> built ezpz</span>
<span id="cb24-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Installing</span> collected packages: pyinstrument, ezpz</span>
<span id="cb24-177">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Attempting</span> uninstall: ezpz</span>
<span id="cb24-178">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> existing installation: ezpz 0.1</span>
<span id="cb24-179">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Not</span> uninstalling ezpz at /home/foremans/.local/polaris/conda/2024-04-29/lib/python3.11/site-packages, outside environment /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29</span>
<span id="cb24-180">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Cant</span> uninstall <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ezpz'</span>. No files were found to uninstall.</span>
<span id="cb24-181"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Successfully</span> installed ezpz pyinstrument-4.6.2</span>
<span id="cb24-182"></span>
<span id="cb24-183"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[notice]</span> A new release of pip is available: 24.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> 24.1.2</span>
<span id="cb24-184"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[notice]</span> To update, run: pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span> pip</span>
<span id="cb24-185"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">9.63s</span> user 1.44s system 60% cpu 18.301s total</span>
<span id="cb24-186"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x3006c0s13b0n0.hsn.cm.polaris.alcf.anl.gov:7919</span>
<span id="cb24-187"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/bin/python3</span>
<span id="cb24-188"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application 5ccc89be-4289-49f5-8b4e-64104021b3c5</span>
<span id="cb24-189"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:24.601903]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INFO'</span> on <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK == 0'</span></span>
<span id="cb24-190"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:24.604160]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:157</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting logging level to <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CRITICAL'</span> on all others <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RANK != 0'</span></span>
<span id="cb24-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:24.604624]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__init__:160</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> To disable this behavior, and log from ALL ranks <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">not</span> recommended<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> set: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export LOG_FROM_ALL_RANKS=1'</span>  in your environment, and re-run.</span>
<span id="cb24-192"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> WARNING require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">unsupported</span> requirement: core</span>
<span id="cb24-193"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ERROR Supported wandb.require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">features</span> can be found at: https://wandb.me/library-require</span>
<span id="cb24-194"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> WARNING require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">unsupported</span> requirement: core</span>
<span id="cb24-195"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ERROR Supported wandb.require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">features</span> can be found at: https://wandb.me/library-require</span>
<span id="cb24-196"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> WARNING require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">unsupported</span> requirement: core</span>
<span id="cb24-197"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ERROR Supported wandb.require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">features</span> can be found at: https://wandb.me/library-require</span>
<span id="cb24-198"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> WARNING require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">unsupported</span> requirement: core</span>
<span id="cb24-199"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wandb:</span> ERROR Supported wandb.require<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">features</span> can be found at: https://wandb.me/library-require</span>
<span id="cb24-200"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.437667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=1/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-201"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.437716]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=3/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-202"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.438619]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=2/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.444402]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb24-204"></span>
<span id="cb24-205"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dist_info]:</span></span>
<span id="cb24-206">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE=cuda</span>
<span id="cb24-207">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DEVICE_ID=cuda:0</span>
<span id="cb24-208">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> DISTRIBUTED_BACKEND=nccl</span>
<span id="cb24-209">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> GPUS_PER_NODE=4</span>
<span id="cb24-210">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTS=<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x3006c0s13b0n0.hsn.cm.polaris.alcf.anl.gov'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-211">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTFILE=/var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-212">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> HOSTNAME=x3006c0s13b0n0.hsn.cm.polaris.alcf.anl.gov</span>
<span id="cb24-213">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LOCAL_RANK=0</span>
<span id="cb24-214">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> MACHINE=Polaris</span>
<span id="cb24-215">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NUM_NODES=1</span>
<span id="cb24-216">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS=4</span>
<span id="cb24-217">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NGPUS_AVAILABLE=4</span>
<span id="cb24-218">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> NODE_ID=0</span>
<span id="cb24-219">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> RANK=0</span>
<span id="cb24-220">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> SCHEDULER=PBS</span>
<span id="cb24-221">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_TOTAL=4</span>
<span id="cb24-222">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> WORLD_SIZE_IN_USE=4</span>
<span id="cb24-223">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> LAUNCH_CMD=mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/2021158.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu-bind</span> depth <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> 16</span>
<span id="cb24-224"></span>
<span id="cb24-225"></span>
<span id="cb24-226"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.447254]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:725</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0/4</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> with backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DDP'</span> + <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nccl'</span> for distributed training.</span>
<span id="cb24-227"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.451604]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:358</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">device=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">local_rank=0/3</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">node=0/0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-228"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.452120]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:364</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using [4 / 4] available <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span> devices !!</span>
<span id="cb24-229"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.452676]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb24-230"></span>
<span id="cb24-231"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[timers_import]:</span></span>
<span id="cb24-232">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> os=1.1026859283447266e-06</span>
<span id="cb24-233">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> logging=4.507601261138916e-07</span>
<span id="cb24-234">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> typing=2.9457733035087585e-06</span>
<span id="cb24-235">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> pathlib=1.2619420886039734e-06</span>
<span id="cb24-236">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> ezpz=6.109476089477539e-07</span>
<span id="cb24-237">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch=3.5976991057395935e-06</span>
<span id="cb24-238">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> torch_ddp=2.3636966943740845e-06</span>
<span id="cb24-239">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> wandb=6.36400654911995e-05</span>
<span id="cb24-240">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> total=7.597357034683228e-05</span>
<span id="cb24-241"></span>
<span id="cb24-242"></span>
<span id="cb24-243"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:26.453718]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:95</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb24-244"></span>
<span id="cb24-245"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[CONFIG]:</span></span>
<span id="cb24-246">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> warmup=0</span>
<span id="cb24-247">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> log_freq=1</span>
<span id="cb24-248">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> batch_size=64</span>
<span id="cb24-249">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> input_size=128</span>
<span id="cb24-250">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> output_size=128</span>
<span id="cb24-251">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> dtype=torch.float32</span>
<span id="cb24-252">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> device=cuda</span>
<span id="cb24-253">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> world_size=4</span>
<span id="cb24-254">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚Ä¢</span> train_iters=100</span>
<span id="cb24-255"></span>
<span id="cb24-256"></span>
<span id="cb24-257"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:28.048558]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:183</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> model=Network<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb24-258">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Sequential<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb24-259">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-260">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1024, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-261">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>512, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-262">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>256, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-263">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Linear<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">in_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out_features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>128, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bias</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>True<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-264">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-265"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-266"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.303706]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=1, loss=1977.36, sps=1.829e+04, dt=0.00349948, dtf=0.00097, dtb=0.00253</span>
<span id="cb24-267"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.307445]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=2, loss=1521.61, sps=3.179e+04, dt=0.00201315, dtf=0.0005266, dtb=0.001487</span>
<span id="cb24-268"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.310480]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=3, loss=1101.45, sps=3.636e+04, dt=0.00176022, dtf=0.0005615, dtb=0.001199</span>
<span id="cb24-269"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.313460]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=4, loss=907.963, sps=3.725e+04, dt=0.00171805, dtf=0.0005335, dtb=0.001185</span>
<span id="cb24-270"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.316456]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=5, loss=842.827, sps=3.698e+04, dt=0.0017307, dtf=0.0005462, dtb=0.001184</span>
<span id="cb24-271"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.319577]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=6, loss=781.918, sps=3.443e+04, dt=0.00185873, dtf=0.0006062, dtb=0.001253</span>
<span id="cb24-272"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.322847]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=7, loss=778.317, sps=3.253e+04, dt=0.00196762, dtf=0.0005706, dtb=0.001397</span>
<span id="cb24-273"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.325813]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=8, loss=746.629, sps=3.746e+04, dt=0.00170848, dtf=0.0005085, dtb=0.0012</span>
<span id="cb24-274"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.328695]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=9, loss=736.385, sps=3.913e+04, dt=0.00163572, dtf=0.0004885, dtb=0.001147</span>
<span id="cb24-275"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.331672]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=10, loss=733.067, sps=3.713e+04, dt=0.00172381, dtf=0.0004742, dtb=0.00125</span>
<span id="cb24-276"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.334841]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=11, loss=729.301, sps=3.342e+04, dt=0.00191528, dtf=0.0003869, dtb=0.001528</span>
<span id="cb24-277"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.338105]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=12, loss=701.243, sps=3.198e+04, dt=0.00200144, dtf=0.0004697, dtb=0.001532</span>
<span id="cb24-278"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.340953]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=13, loss=681.563, sps=4.088e+04, dt=0.00156543, dtf=0.0004341, dtb=0.001131</span>
<span id="cb24-279"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.343843]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=14, loss=685.259, sps=4.053e+04, dt=0.00157891, dtf=0.0004456, dtb=0.001133</span>
<span id="cb24-280"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.346744]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=15, loss=678.99, sps=3.935e+04, dt=0.00162651, dtf=0.0004026, dtb=0.001224</span>
<span id="cb24-281"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.349674]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=16, loss=672.654, sps=3.801e+04, dt=0.00168398, dtf=0.0004565, dtb=0.001227</span>
<span id="cb24-282"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.352400]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=17, loss=660.552, sps=4.319e+04, dt=0.00148184, dtf=0.0003963, dtb=0.001085</span>
<span id="cb24-283"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.355521]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=18, loss=640.175, sps=3.408e+04, dt=0.00187814, dtf=0.0005312, dtb=0.001347</span>
<span id="cb24-284"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.358530]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=19, loss=645.41, sps=3.65e+04, dt=0.00175325, dtf=0.0004639, dtb=0.001289</span>
<span id="cb24-285"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.361515]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=20, loss=649.203, sps=3.675e+04, dt=0.00174155, dtf=0.0004799, dtb=0.001262</span>
<span id="cb24-286"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.364256]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=21, loss=633.891, sps=4.277e+04, dt=0.00149629, dtf=0.000416, dtb=0.00108</span>
<span id="cb24-287"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.367135]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=22, loss=623.202, sps=3.892e+04, dt=0.00164444, dtf=0.0004509, dtb=0.001194</span>
<span id="cb24-288"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.370090]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=23, loss=623.178, sps=3.771e+04, dt=0.00169695, dtf=0.0004252, dtb=0.001272</span>
<span id="cb24-289"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.373119]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=24, loss=626.489, sps=3.69e+04, dt=0.00173444, dtf=0.0004551, dtb=0.001279</span>
<span id="cb24-290"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.375951]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=25, loss=636.674, sps=4.089e+04, dt=0.0015651, dtf=0.0004223, dtb=0.001143</span>
<span id="cb24-291"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.378913]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=26, loss=639.64, sps=3.758e+04, dt=0.00170305, dtf=0.0004532, dtb=0.00125</span>
<span id="cb24-292"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.381808]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=27, loss=605.015, sps=3.874e+04, dt=0.00165192, dtf=0.0004257, dtb=0.001226</span>
<span id="cb24-293"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.384573]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=28, loss=603.894, sps=4.244e+04, dt=0.00150807, dtf=0.0004296, dtb=0.001078</span>
<span id="cb24-294"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.387388]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=29, loss=619.885, sps=4.03e+04, dt=0.00158808, dtf=0.0004196, dtb=0.001168</span>
<span id="cb24-295"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.390148]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=30, loss=589.771, sps=4.21e+04, dt=0.0015203, dtf=0.0004438, dtb=0.001076</span>
<span id="cb24-296"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.392838]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=31, loss=595.523, sps=4.381e+04, dt=0.001461, dtf=0.0004153, dtb=0.001046</span>
<span id="cb24-297"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.395622]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=32, loss=605.537, sps=4.104e+04, dt=0.00155956, dtf=0.0004367, dtb=0.001123</span>
<span id="cb24-298"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.398489]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=33, loss=586.025, sps=3.913e+04, dt=0.00163565, dtf=0.0003743, dtb=0.001261</span>
<span id="cb24-299"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.401355]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=34, loss=577.14, sps=3.877e+04, dt=0.0016506, dtf=0.0004581, dtb=0.001192</span>
<span id="cb24-300"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.404092]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=35, loss=568.886, sps=4.383e+04, dt=0.00146019, dtf=0.0003966, dtb=0.001064</span>
<span id="cb24-301"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.406843]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=36, loss=567.26, sps=4.228e+04, dt=0.00151377, dtf=0.0004537, dtb=0.00106</span>
<span id="cb24-302"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.409591]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=37, loss=574.633, sps=4.226e+04, dt=0.00151457, dtf=0.0003845, dtb=0.00113</span>
<span id="cb24-303"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.412347]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=38, loss=557.928, sps=4.212e+04, dt=0.00151945, dtf=0.000457, dtb=0.001062</span>
<span id="cb24-304"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.415130]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=39, loss=558.186, sps=4.135e+04, dt=0.00154767, dtf=0.0003975, dtb=0.00115</span>
<span id="cb24-305"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.417880]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=40, loss=553.377, sps=4.233e+04, dt=0.00151185, dtf=0.0004556, dtb=0.001056</span>
<span id="cb24-306"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.420583]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=41, loss=542.918, sps=4.394e+04, dt=0.00145645, dtf=0.0003928, dtb=0.001064</span>
<span id="cb24-307"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.423489]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=42, loss=547.64, sps=3.827e+04, dt=0.00167242, dtf=0.0004762, dtb=0.001196</span>
<span id="cb24-308"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.426243]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=43, loss=546.106, sps=4.22e+04, dt=0.00151648, dtf=0.0004665, dtb=0.00105</span>
<span id="cb24-309"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.428998]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=44, loss=535.946, sps=4.209e+04, dt=0.0015204, dtf=0.0004679, dtb=0.001053</span>
<span id="cb24-310"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.431749]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=45, loss=534.731, sps=4.324e+04, dt=0.00148002, dtf=0.0003821, dtb=0.001098</span>
<span id="cb24-311"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.434709]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=46, loss=520.207, sps=3.74e+04, dt=0.00171109, dtf=0.0004486, dtb=0.001263</span>
<span id="cb24-312"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.437524]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=47, loss=527.301, sps=4.191e+04, dt=0.00152713, dtf=0.0004943, dtb=0.001033</span>
<span id="cb24-313"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.440277]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=48, loss=516.108, sps=4.279e+04, dt=0.00149561, dtf=0.0004418, dtb=0.001054</span>
<span id="cb24-314"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.443029]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=49, loss=516.086, sps=4.231e+04, dt=0.00151262, dtf=0.0003899, dtb=0.001123</span>
<span id="cb24-315"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.445895]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=50, loss=508.945, sps=3.922e+04, dt=0.00163198, dtf=0.0004333, dtb=0.001199</span>
<span id="cb24-316"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.448667]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=51, loss=513.235, sps=4.163e+04, dt=0.00153721, dtf=0.0004863, dtb=0.001051</span>
<span id="cb24-317"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.451581]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=52, loss=511.549, sps=3.822e+04, dt=0.00167444, dtf=0.0004698, dtb=0.001205</span>
<span id="cb24-318"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.454412]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=53, loss=510.211, sps=4.042e+04, dt=0.00158328, dtf=0.0004193, dtb=0.001164</span>
<span id="cb24-319"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.457220]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=54, loss=492.431, sps=4.151e+04, dt=0.00154189, dtf=0.0004324, dtb=0.001109</span>
<span id="cb24-320"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.460039]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=55, loss=499.074, sps=4.121e+04, dt=0.00155284, dtf=0.0005013, dtb=0.001052</span>
<span id="cb24-321"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.462836]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=56, loss=490.718, sps=4.108e+04, dt=0.0015581, dtf=0.0004388, dtb=0.001119</span>
<span id="cb24-322"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.465621]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=57, loss=493.223, sps=4.157e+04, dt=0.00153946, dtf=0.0003867, dtb=0.001153</span>
<span id="cb24-323"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.468390]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=58, loss=486.601, sps=4.256e+04, dt=0.00150368, dtf=0.0004462, dtb=0.001057</span>
<span id="cb24-324"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.471148]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=59, loss=473.609, sps=4.326e+04, dt=0.00147947, dtf=0.0004221, dtb=0.001057</span>
<span id="cb24-325"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.473847]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=60, loss=478.577, sps=4.378e+04, dt=0.00146188, dtf=0.0004284, dtb=0.001033</span>
<span id="cb24-326"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.476547]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=61, loss=475.991, sps=4.387e+04, dt=0.00145878, dtf=0.0003923, dtb=0.001066</span>
<span id="cb24-327"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.479447]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=62, loss=471.526, sps=3.859e+04, dt=0.00165854, dtf=0.0004523, dtb=0.001206</span>
<span id="cb24-328"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.482180]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=63, loss=460.986, sps=4.277e+04, dt=0.00149626, dtf=0.0003914, dtb=0.001105</span>
<span id="cb24-329"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.484857]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=64, loss=464.409, sps=4.404e+04, dt=0.00145311, dtf=0.0004247, dtb=0.001028</span>
<span id="cb24-330"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.487652]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=65, loss=458.023, sps=4.104e+04, dt=0.00155961, dtf=0.0003934, dtb=0.001166</span>
<span id="cb24-331"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.490474]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=66, loss=456.718, sps=4.013e+04, dt=0.00159499, dtf=0.000416, dtb=0.001179</span>
<span id="cb24-332"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.493187]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=67, loss=451.993, sps=4.296e+04, dt=0.00148977, dtf=0.000395, dtb=0.001095</span>
<span id="cb24-333"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.495894]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=68, loss=454.66, sps=4.4e+04, dt=0.0014545, dtf=0.000425, dtb=0.001029</span>
<span id="cb24-334"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.498664]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=69, loss=451.727, sps=4.17e+04, dt=0.00153459, dtf=0.0003837, dtb=0.001151</span>
<span id="cb24-335"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.501502]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=70, loss=440.922, sps=4.015e+04, dt=0.00159391, dtf=0.0004272, dtb=0.001167</span>
<span id="cb24-336"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.504271]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=71, loss=442.788, sps=4.322e+04, dt=0.00148083, dtf=0.0004178, dtb=0.001063</span>
<span id="cb24-337"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.507000]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=72, loss=439.069, sps=4.307e+04, dt=0.00148594, dtf=0.0004285, dtb=0.001057</span>
<span id="cb24-338"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.509755]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=73, loss=430.236, sps=4.211e+04, dt=0.00151976, dtf=0.0003829, dtb=0.001137</span>
<span id="cb24-339"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.512494]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=74, loss=428.951, sps=4.318e+04, dt=0.00148219, dtf=0.0004357, dtb=0.001046</span>
<span id="cb24-340"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.515244]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=75, loss=430.417, sps=4.253e+04, dt=0.00150487, dtf=0.0004357, dtb=0.001069</span>
<span id="cb24-341"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.517921]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=76, loss=416.647, sps=4.401e+04, dt=0.00145412, dtf=0.0004374, dtb=0.001017</span>
<span id="cb24-342"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.520610]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=77, loss=422.518, sps=4.468e+04, dt=0.0014323, dtf=0.0003941, dtb=0.001038</span>
<span id="cb24-343"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.523343]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=78, loss=412.028, sps=4.272e+04, dt=0.00149821, dtf=0.0004521, dtb=0.001046</span>
<span id="cb24-344"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.526016]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=79, loss=406.225, sps=4.473e+04, dt=0.00143094, dtf=0.0003893, dtb=0.001042</span>
<span id="cb24-345"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.528730]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=80, loss=402.887, sps=4.382e+04, dt=0.00146036, dtf=0.0004402, dtb=0.00102</span>
<span id="cb24-346"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.531536]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=81, loss=397.311, sps=4.069e+04, dt=0.0015729, dtf=0.000404, dtb=0.001169</span>
<span id="cb24-347"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.534242]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=82, loss=411.916, sps=4.39e+04, dt=0.00145795, dtf=0.0004351, dtb=0.001023</span>
<span id="cb24-348"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.537005]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=83, loss=402.795, sps=4.366e+04, dt=0.00146599, dtf=0.0004252, dtb=0.001041</span>
<span id="cb24-349"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.539805]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=84, loss=391.05, sps=4.1e+04, dt=0.00156095, dtf=0.0004323, dtb=0.001129</span>
<span id="cb24-350"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.542590]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=85, loss=383.782, sps=4.118e+04, dt=0.00155416, dtf=0.000388, dtb=0.001166</span>
<span id="cb24-351"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.545290]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=86, loss=399.543, sps=4.396e+04, dt=0.00145595, dtf=0.0004339, dtb=0.001022</span>
<span id="cb24-352"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.547992]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=87, loss=379.003, sps=4.456e+04, dt=0.00143613, dtf=0.0004131, dtb=0.001023</span>
<span id="cb24-353"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.550837]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=88, loss=372.048, sps=3.998e+04, dt=0.00160092, dtf=0.0004375, dtb=0.001163</span>
<span id="cb24-354"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.553641]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=89, loss=376.187, sps=4.137e+04, dt=0.0015471, dtf=0.0004142, dtb=0.001133</span>
<span id="cb24-355"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.556354]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=90, loss=372.281, sps=4.408e+04, dt=0.00145186, dtf=0.0004239, dtb=0.001028</span>
<span id="cb24-356"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.559101]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=91, loss=370.701, sps=4.252e+04, dt=0.00150523, dtf=0.0004545, dtb=0.001051</span>
<span id="cb24-357"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.561884]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=92, loss=356.074, sps=4.191e+04, dt=0.00152712, dtf=0.0004291, dtb=0.001098</span>
<span id="cb24-358"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.564556]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=93, loss=360.663, sps=4.468e+04, dt=0.00143241, dtf=0.0003938, dtb=0.001039</span>
<span id="cb24-359"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.567287]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=94, loss=374.599, sps=4.296e+04, dt=0.0014897, dtf=0.0004539, dtb=0.001036</span>
<span id="cb24-360"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.570088]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=95, loss=364.476, sps=4.253e+04, dt=0.00150469, dtf=0.0004189, dtb=0.001086</span>
<span id="cb24-361"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.572767]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=96, loss=358.992, sps=4.415e+04, dt=0.00144967, dtf=0.0004295, dtb=0.00102</span>
<span id="cb24-362"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.575567]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=97, loss=354.959, sps=4.092e+04, dt=0.0015641, dtf=0.0004054, dtb=0.001159</span>
<span id="cb24-363"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.578287]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=98, loss=345.644, sps=4.374e+04, dt=0.00146311, dtf=0.0004197, dtb=0.001043</span>
<span id="cb24-364"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.580996]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">test_dist:274</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> iter=99, loss=348.209, sps=4.391e+04, dt=0.00145758, dtf=0.0004263, dtb=0.001031</span>
<span id="cb24-365">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-366">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-367"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00350‚î§‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb24-368">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-369">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-370"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00315‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-371">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-372">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-373"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00281‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-374">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-375"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00247‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-376">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-377">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-378"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00212‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-379">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñó</span>       ‚ññ                                                              ‚îÇ</span>
<span id="cb24-380">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñù  ‚ññ    ‚ññ                                                          ‚îÇ</span>
<span id="cb24-381"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00178‚î§</span> ‚ñó ‚ñù                                                                   ‚îÇ</span>
<span id="cb24-382">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>  ‚ñò‚ñò ‚ñò‚ñù    ‚ññ ‚ñÄ ‚ññ‚ñÄ ‚ñö    ‚ñó     ‚ñó  ‚ñù   ‚ñó       ‚ññ                          ‚îÇ</span>
<span id="cb24-383">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>      ‚ñò ‚ñó‚ñù‚ñò      ‚ñó  ‚ñò‚ññ‚ñó‚ñò   ‚ñó   ‚ññ ‚ññ ‚ñù‚ññ‚ñù‚ññ‚ñÑ‚ñó     ‚ññ‚ñò ‚ñû  ‚ññ    ‚ñó ‚ñó‚ñó ‚ñù‚ñó ‚ñó   ‚ññ ‚îÇ</span>
<span id="cb24-384"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00143‚î§</span>           ‚ñù  ‚ñù    ‚ñù ‚ñù  ‚ñó‚ñò‚ñÄ ‚ñò‚ññ‚ñò‚ñù  ‚ñÄ      ‚ñÄ‚ñù‚ññ‚ñù‚ñó ‚ñù‚ññ ‚ñù‚ñò‚ñù‚ñò‚ñÑ‚ñù‚ññ‚ññ‚ñó‚ñò ‚ññ‚ññ ‚ñû ‚ññ‚ñÄ‚ñó ‚ñö‚îÇ</span>
<span id="cb24-385">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-386">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb24-387"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dt</span>                                 iter</span>
<span id="cb24-388"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.627053]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dt.txt</span>
<span id="cb24-389"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dt.txt</span>
<span id="cb24-390">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-391">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-392"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00097‚î§‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb24-393">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-394">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-395"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00087‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-396">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-397">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-398"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00077‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-399">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-400"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00067‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-401">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-402">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñó                                                                   ‚îÇ</span>
<span id="cb24-403"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00057‚î§</span>    ‚ñó                                                                  ‚îÇ</span>
<span id="cb24-404">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñù ‚ññ                                                                   ‚îÇ</span>
<span id="cb24-405">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù</span> ‚ñò  ‚ññ      ‚ñò                                                          ‚îÇ</span>
<span id="cb24-406"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00047‚î§</span>      ‚ñö ‚ññ    ‚ñó               ‚ñó ‚ññ ‚ñò  ‚ñö  ‚ñò                               ‚îÇ</span>
<span id="cb24-407">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        ‚ñó‚ñó ‚ñò ‚ñò ‚ñò‚ñù ‚ñò  ‚ññ‚ñó‚ñù ‚ñò‚ñù ‚ñò ‚ñò ‚ñó ‚ññ    ‚ñó ‚ññ  ‚ñò       ‚ñó‚ññ‚ññ‚ñù ‚ññ‚ñó  ‚ññ‚ñó ‚ñù  ‚ñò   ‚îÇ</span>
<span id="cb24-408">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>          ‚ññ   ‚ñó ‚ñò‚ñù‚ñù‚ñù‚ñò‚ñó             ‚ñù ‚ñù‚ñò  ‚ñù‚ñù  ‚ñù ‚ññ‚ñò‚ñù‚ñù‚ñò     ‚ñó ‚ñÄ  ‚ññ‚ñó‚ñò‚ñù ‚ñù‚ñù‚ññ‚ñÄ‚îÇ</span>
<span id="cb24-409"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00037‚î§</span>       ‚ñò   ‚ñù           ‚ññ‚ñù ‚ñò‚ñù ‚ñò ‚ñó  ‚ñù     ‚ñù  ‚ñò‚ñù ‚ñò‚ñù ‚ñò  ‚ñò ‚ñù ‚ñò   ‚ñù     ‚ñò    ‚îÇ</span>
<span id="cb24-410">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-411">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb24-412"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtf</span>                                iter</span>
<span id="cb24-413"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.638406]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dtf.txt</span>
<span id="cb24-414"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dtf.txt</span>
<span id="cb24-415">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-416">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-417"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00253‚î§‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb24-418">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-419">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-420"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00228‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-421">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-422">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-423"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00203‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-424">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-425"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00177‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-426">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-427">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-428"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00152‚î§</span>       ‚ññ‚ññ                                                              ‚îÇ</span>
<span id="cb24-429">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù</span>                                                                      ‚îÇ</span>
<span id="cb24-430">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñù       ‚ññ                                                          ‚îÇ</span>
<span id="cb24-431"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00127‚î§</span>             ‚ñÑ  ‚ñÑ      ‚ññ        ‚ñó                                      ‚îÇ</span>
<span id="cb24-432">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñó‚ññ‚ñû ‚ññ‚ñù   ‚ñò‚ñò   ‚ññ  ‚ñÄ ‚ññ  ‚ñó     ‚ñó     ‚ñó‚ñó       ‚ññ  ‚ññ         ‚ñó             ‚îÇ</span>
<span id="cb24-433">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>      ‚ñò ‚ñù‚ñù ‚ñó     ‚ñù    ‚ñó   ‚ñò‚ñù   ‚ñó  ‚ñó  ‚ñù‚ññ‚ñó‚ñù   ‚ñó ‚ñò‚ñó ‚ñÄ  ‚ñò      ‚ñù‚ñù ‚ñù‚ñù ‚ñó ‚ñó ‚ñò ‚îÇ</span>
<span id="cb24-434"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.00102‚î§</span>              ‚ñù    ‚ñù ‚ñÄ  ‚ñù‚ñò‚ñù ‚ñò‚ñò‚ñò‚ñò ‚ññ‚ñò ‚ñò  ‚ñò ‚ñÄ‚ñó‚ñò ‚ñó  ‚ññ ‚ñù‚ñò‚ñù‚ñò‚ñÑ‚ñù‚ñò‚ññ‚ñó‚ñò ‚ññ‚ññ ‚ñû ‚ñò‚ññ‚ñó ‚ñö‚îÇ</span>
<span id="cb24-435">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-436">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb24-437"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/dtb</span>                                iter</span>
<span id="cb24-438"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.648950]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dtb.txt</span>
<span id="cb24-439"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/dtb.txt</span>
<span id="cb24-440">                            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-441">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-442"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1977.4‚î§‚ñò</span>                                                                       ‚îÇ</span>
<span id="cb24-443">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-444">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-445"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1705.4‚î§</span>                                                                        ‚îÇ</span>
<span id="cb24-446">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-447">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ‚ñù</span>                                                                       ‚îÇ</span>
<span id="cb24-448"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1433.5‚î§</span>                                                                        ‚îÇ</span>
<span id="cb24-449">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-450">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-451"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1161.5‚î§</span> ‚ñó                                                                      ‚îÇ</span>
<span id="cb24-452">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                        ‚îÇ</span>
<span id="cb24-453"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">889.5‚î§</span>  ‚ññ                                                                     ‚îÇ</span>
<span id="cb24-454">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñò                                                                    ‚îÇ</span>
<span id="cb24-455">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñù‚ñù‚ñò‚ñÑ‚ñó‚ññ                                                               ‚îÇ</span>
<span id="cb24-456"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">617.6‚î§</span>         ‚ñÄ‚ñò‚ñÄ‚ñó‚ññ‚ñö‚ñó‚ññ‚ñÑ‚ññ‚ñÑ‚ñó ‚ñó                                                 ‚îÇ</span>
<span id="cb24-457">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                     ‚ñò‚ñò‚ñù‚ñò‚ñÄ‚ñù‚ñÄ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ññ‚ññ                                 ‚îÇ</span>
<span id="cb24-458">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                      ‚ñù‚ñù‚ñò‚ñÄ‚ñù‚ñò‚ñÄ‚ññ‚ñö‚ñó‚ññ‚ñÑ‚ñó‚ññ‚ñÑ‚ñó‚ñÑ‚ñó                ‚îÇ</span>
<span id="cb24-459"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">345.6‚î§</span>                                                        ‚ñò‚ñÄ‚ñù‚ñò‚ñÄ‚ñù‚ñÄ‚ñù‚ñò‚ñÄ‚ñó‚ññ‚ñö‚ñó‚ññ‚ñÑ‚îÇ</span>
<span id="cb24-460">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-461">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5              50.0             74.5             99.0</span>
<span id="cb24-462"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/loss</span>                               iter</span>
<span id="cb24-463"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.702717]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/loss.txt</span>
<span id="cb24-464"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/loss.txt</span>
<span id="cb24-465">                           <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-466">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-467"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">99.0‚î§</span>                                                                      ‚ñó‚ñó‚ññ‚ñÄ‚îÇ</span>
<span id="cb24-468">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                   ‚ñÑ‚ñù‚ñò‚ñò   ‚îÇ</span>
<span id="cb24-469">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                              ‚ñó‚ññ‚ñû‚ñù‚ñò       ‚îÇ</span>
<span id="cb24-470"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">82.7‚î§</span>                                                          ‚ñÑ‚ñó‚ñò‚ñÄ            ‚îÇ</span>
<span id="cb24-471">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                      ‚ññ‚ñÑ‚ñù‚ñò                ‚îÇ</span>
<span id="cb24-472">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                 ‚ñó‚ñó‚ññ‚ñÄ‚ñù                    ‚îÇ</span>
<span id="cb24-473"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">66.3‚î§</span>                                              ‚ñÑ‚ñù‚ñò‚ñò                        ‚îÇ</span>
<span id="cb24-474">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                         ‚ñó‚ññ‚ñû‚ñù‚ñò                            ‚îÇ</span>
<span id="cb24-475"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">50.0‚î§</span>                                     ‚ñÑ‚ñó‚ñò‚ñÄ                                 ‚îÇ</span>
<span id="cb24-476">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                 ‚ññ‚ñÑ‚ñù‚ñò                                     ‚îÇ</span>
<span id="cb24-477">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                            ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                         ‚îÇ</span>
<span id="cb24-478"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">33.7‚î§</span>                         ‚ñÑ‚ñù‚ñò‚ñò                                             ‚îÇ</span>
<span id="cb24-479">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                    ‚ñó‚ññ‚ñû‚ñù‚ñò                                                 ‚îÇ</span>
<span id="cb24-480">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                ‚ñÑ‚ñó‚ñò‚ñÄ                                                      ‚îÇ</span>
<span id="cb24-481"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">17.3‚î§</span>            ‚ññ‚ñÑ‚ñù‚ñò                                                          ‚îÇ</span>
<span id="cb24-482">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚ñó‚ñó‚ññ‚ñÄ‚ñù                                                              ‚îÇ</span>
<span id="cb24-483">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>    ‚ñÑ‚ñù‚ñò‚ñò                                                                  ‚îÇ</span>
<span id="cb24-484"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0‚î§‚ññ‚ñû‚ñù‚ñò</span>                                                                      ‚îÇ</span>
<span id="cb24-485">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-486">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5               50.0              74.5             99.0</span>
<span id="cb24-487"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/iter</span>                              iter</span>
<span id="cb24-488"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.714042]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/iter.txt</span>
<span id="cb24-489"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/iter.txt</span>
<span id="cb24-490">                             <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2024</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">07</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">15</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">124630</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb24-491">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span></span>
<span id="cb24-492"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">44725.9‚î§</span>                     ‚ñó  ‚ñó    ‚ññ            ‚ñó‚ññ ‚ñó  ‚ññ     ‚ñû ‚ñò‚ññ‚ñó‚ññ ‚ññ‚ñò ‚ññ ‚ñò ‚ñó ‚ñÑ‚îÇ</span>
<span id="cb24-493">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚ñù  ‚ñó    ‚ñó ‚ññ   ‚ññ‚ñÑ ‚ññ ‚ññ‚ñû  ‚ñÑ      ‚ñû  ‚ñó  ‚ñù  ‚ñù‚ñò‚ñû‚ññ ‚ñó        ‚ñó  ‚ñö   ‚îÇ</span>
<span id="cb24-494">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>        ‚ñó        ‚ñó    ‚ñó    ‚ñù     ‚ñò  ‚ñò ‚ñò‚ñÑ‚ñù     ‚ññ  ‚ñò       ‚ñó ‚ñó‚ñó  ‚ñù ‚ñù   ‚ññ ‚îÇ</span>
<span id="cb24-495"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">40319.7‚î§</span>      ‚ññ  ‚ñù‚ññ         ‚ñò  ‚ññ           ‚ñó ‚ñù         ‚ñò ‚ñù            ‚ñù        ‚îÇ</span>
<span id="cb24-496">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>           ‚ññ   ‚ñò‚ññ ‚ñû    ‚ñù     ‚ñó      ‚ñó       ‚ñò                          ‚îÇ</span>
<span id="cb24-497">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> ‚ñó‚ñò‚ñò ‚ñò‚ñù      ‚ñÑ  ‚ñù               ‚ñù                                      ‚îÇ</span>
<span id="cb24-498"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">35913.4‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-499">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚ñù   ‚ññ    ‚ñò                                                          ‚îÇ</span>
<span id="cb24-500"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">31507.2‚î§‚ñó</span>   ‚ñù   ‚ññ                                                              ‚îÇ</span>
<span id="cb24-501">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-502">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-503"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">27100.9‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-504">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-505">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-506"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">22694.7‚î§</span>                                                                       ‚îÇ</span>
<span id="cb24-507">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-508">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>                                                                       ‚îÇ</span>
<span id="cb24-509"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">18288.4‚î§‚ññ</span>                                                                      ‚îÇ</span>
<span id="cb24-510">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îò</span></span>
<span id="cb24-511">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.0</span>              25.5             50.0              74.5            99.0</span>
<span id="cb24-512"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train/sps</span>                                iter</span>
<span id="cb24-513"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-07-15</span> 12:46:30.724919]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">plot:156</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Appending plot to: /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/sps.txt</span>
<span id="cb24-514"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">text</span> saved in /home/foremans/tmp/foremans/2024-07-15-124441/test-dist-plots/train/sps.txt</span>
<span id="cb24-515"></span>
<span id="cb24-516">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_</span>     ._   __/__   _ _  _  _ _/_   Recorded: 12:46:28  Samples:  2182</span>
<span id="cb24-517"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/_//_///</span> /_\ / //_// / //_<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/ //     Duration: 2.688     CPU time: 2.356</span></span>
<span id="cb24-518"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/   _/                      v4.6.2</span></span>
<span id="cb24-519"></span>
<span id="cb24-520"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Program: /home/foremans/tmp/foremans/2024-07-15-124441/venvs/2024-04-29/src/ezpz/src/ezpz/test_dist.py</span></span>
<span id="cb24-521"></span>
<span id="cb24-522"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2.688 &lt;module&gt;  ezpz/test_dist.py:1</span></span>
<span id="cb24-523"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚îî‚îÄ 2.687 main  ezpz/test_dist.py:217</span></span>
<span id="cb24-524"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 2.104 build_model_and_optimizer  ezpz/test_dist.py:171</span></span>
<span id="cb24-525"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 2.089 Adam.__init__  torch/optim/adam.py:15</span></span>
<span id="cb24-526"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ        [142 frames hidden]  torch, transformers, jax, huggingface...</span></span>
<span id="cb24-527"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 0.199 _backward_step  ezpz/test_dist.py:236</span></span>
<span id="cb24-528"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 0.104 Tensor.backward  torch/_tensor.py:466</span></span>
<span id="cb24-529"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     [4 frames hidden]  torch, &lt;built-in&gt;</span></span>
<span id="cb24-530"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 0.094 wrapper  torch/optim/optimizer.py:374</span></span>
<span id="cb24-531"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ        [6 frames hidden]  torch, &lt;built-in&gt;</span></span>
<span id="cb24-532"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 0.145 tplot_dict  ezpz/plot.py:136</span></span>
<span id="cb24-533"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 0.085 show  plotext/_core.py:292</span></span>
<span id="cb24-534"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     [5 frames hidden]  plotext</span></span>
<span id="cb24-535"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 0.031 &lt;module&gt;  plotext/__init__.py:1</span></span>
<span id="cb24-536"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îú‚îÄ 0.136 _forward_step  ezpz/test_dist.py:231</span></span>
<span id="cb24-537"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îú‚îÄ 0.084 DistributedDataParallel._wrapped_call_impl  torch/nn/modules/module.py:1528</span></span>
<span id="cb24-538"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ     [6 frames hidden]  torch</span></span>
<span id="cb24-539"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ        0.071 Network._call_impl  torch/nn/modules/module.py:1534</span></span>
<span id="cb24-540"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ        ‚îî‚îÄ 0.071 Network.forward  ezpz/test_dist.py:164</span></span>
<span id="cb24-541"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ           ‚îî‚îÄ 0.071 Sequential._wrapped_call_impl  torch/nn/modules/module.py:1528</span></span>
<span id="cb24-542"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îÇ                 [7 frames hidden]  torch, &lt;built-in&gt;</span></span>
<span id="cb24-543"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îÇ  ‚îî‚îÄ 0.052 calc_loss  ezpz/test_dist.py:168</span></span>
<span id="cb24-544"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ‚îî‚îÄ 0.100 Logger.info  logging/__init__.py:1479</span></span>
<span id="cb24-545"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">         [6 frames hidden]  logging, rich</span></span>
<span id="cb24-546"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            0.100 RichHandler.emit  rich/logging.py:126</span></span>
<span id="cb24-547"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            ‚îî‚îÄ 0.098 Console.print  ezpz/log/console.py:79</span></span>
<span id="cb24-548"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">               ‚îî‚îÄ 0.098 Console.print  rich/console.py:1624</span></span>
<span id="cb24-549"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                     [4 frames hidden]  rich</span></span>
<span id="cb24-550"></span>
<span id="cb24-551"></span>
<span id="cb24-552"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-15 12:46:30.921061][INFO][profile:115] - Saving pyinstrument profile output to: /home/foremans/tmp/foremans/2024-07-15-124441/ezpz_pyinstrument_profiles</span></span>
<span id="cb24-553"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-15 12:46:30.921555][INFO][profile:123] - PyInstrument profile saved (as html) to:  /home/foremans/tmp/foremans/2024-07-15-124441/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-15-124630.html</span></span>
<span id="cb24-554"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-15 12:46:30.922034][INFO][profile:131] - PyInstrument profile saved (as text) to:  /home/foremans/tmp/foremans/2024-07-15-124441/ezpz_pyinstrument_profiles/pyinstrument-profile-2024-07-15-124630.txt</span></span>
<span id="cb24-555"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-15 12:46:31.432464][INFO][profile:143] - Finished with pyinstrument profiler. Took: 2.68764s</span></span>
<span id="cb24-556"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[2024-07-15 12:46:31.433122][INFO][test_dist:318] - [0] runtime=6.820802s</span></span>
<span id="cb24-557"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Application 5ccc89be resources: utime=21s stime=21s maxrss=1383056KB inblock=8080 oublock=3456 minflt=659443 majflt=896 nvcsw=192077 nivcsw=672014</span></span></code></pre></div>
</details>



</section>
</section>


</details><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>deepspeed</code>, <code>DDP</code> only support <code>pytorch</code>‚Ü©Ô∏é</p></li>
<li id="fn2"><p>If necessary, otherwise activate if already exists‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Note that the virtual environment will be created at <code>./venvs/${CONDA_NAME}</code>, where <code>${CONDA_NAME}</code> will match the prefix of the active <code>conda</code> environment‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{foreman2024,
  author = {Foreman, Sam},
  title = {üçã \textless Code\textgreater
    ezpz\textless/Code\textgreater{} V1},
  date = {2024-08-23},
  url = {https://samforeman.me/posts/ezpz-at-alcf},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüçã &lt;Code&gt;ezpz&lt;/Code&gt; V1,‚Äù</span>
August. <a href="https://samforeman.me/posts/ezpz-at-alcf">https://samforeman.me/posts/ezpz-at-alcf</a>.
</div></div></section></div> ]]></description>
  <category>ezpz</category>
  <category>ML</category>
  <category>ai4science</category>
  <guid>https://samforeman.me/posts/ezpz-v1/</guid>
  <pubDate>Fri, 23 Aug 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üíÖ How to Make Dope Slides</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/dope-slides/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="quarto-reveal.js" class="level2">
<h2 class="anchored" data-anchor-id="quarto-reveal.js">Quarto ü§ù Reveal.js</h2>
<p>So, after making a promise some time ago on <a href="https://twitter.com/saforem2/status/1689676452235759616?s=20">twitter <i class="fa-brands fa-twitter" aria-label="twitter"></i></a><sup>1</sup>, and having many questions following my talk on <a href="https://github.com/saforem2/parallel-training-slides:">Parallel Training Techniques</a> last week, I‚Äôm finally getting around to writing this up.</p>
<p>The slides are written using <a href="https://quarto.org/">Quarto</a>, a <em>flavor</em> of Markdown, and uses the built-in <a href="https://quarto.org/docs/presentations/revealjs">Quarto + Reveal.js</a> functionality.</p>
<p>For this post, I‚Äôll focus on the slides I presented at last years <a href="https://indico.fnal.gov/event/57249/contributions/271305/">Lattice 2023</a>, shown below:</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="ü™ß [[**MLMC: Machine Learning Monte Carlo**](https://saforem2.github.io/lattice23) @ [_Lattice 2023_](https://indico.fnal.gov/event/57249/contributions/271305/) [07/2023]]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0)!important;border:1px solid rgba(131,131,131,0.2)!important;">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>ü™ß <span class="dim-text"><a href="https://saforem2.github.io/lattice23"><strong>MLMC: Machine Learning Monte Carlo</strong></a> @ <a href="https://indico.fnal.gov/event/57249/contributions/271305/"><em>Lattice 2023</em></a> [07/2023]</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<iframe loading="lazy" allow="picture-in-picture" src="https://saforem2.github.io/lattice23/#/title-slide" title="ü™ß MLMC: Machine Learning Monte Carlo" width="100%" align="center" height="500" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="border-radius:0.25rem;border:none;align:center;">
<p>
Your browser does not support iframes.
</p>
</iframe>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[üèÉ‚Äç‚ôÇÔ∏è Follow Along...]{.dim-text}" style="width:100%;background-color: rgba(0,0,0,0.0)!important;border:1px solid rgba(131,131,131,0.2)!important;">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span class="dim-text">üèÉ‚Äç‚ôÇÔ∏è Follow Along‚Ä¶</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Once you‚Äôve <a href="https://quarto.org/docs/download/">Installed Quarto</a>, you can build these slides yourself by:</p>
<ol type="1">
<li><code>git clone</code> <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/lattice23"><code>saforem2/lattice23</code></a></li>
<li><code>cd lattice23 &amp;&amp; quarto preview</code></li>
</ol>
<p>This will create a <code>docs/</code> directory with the following structure:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">üìÇ</span> docs/</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÇ assets/</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÇ css/</span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÑ index.html</span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÑ lattice23.md</span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÑ search.json</span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ</span> üìÇ site_libs/</span></code></pre></div>
<p>Once you‚Äôve created this, and the <code>docs/index.html</code> file looks how you want, you can add the <code>docs/</code> directory to your GitHub repo:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git add docs</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Create site'</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git push</span></code></pre></div>
<p>Once you‚Äôve enabled the GitHub page, the site will be automatically built and updated alongside the repo.</p>
</div>
</div>
</div>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>Whenever I give a talk, my workflow is typically:</p>
<ol type="1">
<li><p>Create new GitHub repo for it</p></li>
<li><p>Hunt down the GitHub repo from my <em>last</em> talk and<sup>2</sup>:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cp <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> old_talk/<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{_quarto.yml</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">index.qmd</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">references.bib</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">css/</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span> new_talk/</span></code></pre></div></li>
</ol>
<p>Honestly, other than that, 90% of the work is done automatically by <a href="https://quarto.org/">Quarto</a>. The remaining 10% consists of figuring out why my css is broken (see CSS).</p>
<p>The best place to start for learning to make slides with Quarto and Reveal.js is the official documentation:</p>
<ol type="1">
<li><a href="https://quarto.org/docs/presentations/revealjs/">Quarto / Presentations / Revealjs</a>:
<ol type="1">
<li><a href="https://quarto.org/docs/presentations/revealjs/">Reveal Basics</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/presenting.html">Presenting Slides</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/advanced.html">Advanced Reveal</a></li>
<li><a href="https://quarto.org/docs/presentations/revealjs/themes.html">Reveal Themes</a></li>
</ol></li>
</ol>
<ul>
<li><p>The slides are written in <del>markdown</del> <a href="https://quarto.org/">Quarto (<code>.qmd</code>)</a><sup>3</sup>, a <a href="https://pandoc.org/">pandoc</a>-compliant based markup language.</p></li>
<li><p>For a single slide deck, the content will be placed in <code>index.qmd</code> and our directory structure will look something like:</p>
<div class="tight-code">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">üìÇ</span> lattice23/</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÇ assets/            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for images, etc.</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚îî‚îÄ‚îÄ üñºÔ∏è thumbnail.png  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># can be used as social preview image</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÇ css/</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚îú‚îÄ‚îÄ üìÑ callouts.css</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚îú‚îÄ‚îÄ üìÑ dark.scss</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚îî‚îÄ‚îÄ üìÑ default.css</span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üõ†Ô∏è _quarto.yml        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Configuration goes here</span></span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îú‚îÄ‚îÄ</span> üìÑ index.qmd          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quarto document containing slides content</span></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ</span> üìú references.bib     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BibTex references</span></span></code></pre></div>
</div></li>
<li><p>Equations are rendered using <code>$</code> delimiters for inline math and <code>$$</code> for display math<sup>4</sup>.</p></li>
<li><p>We can use <a href="https://pandoc.org/chunkedhtml-demo/8.18-divs-and-spans.html">Divs and Spans</a> from Pandoc.</p>
<ul>
<li><p><strong><code>&lt;span&gt;</code></strong>‚Äôs: are created by wrapping text in square brackets, and will be treated as a <code>&lt;span&gt;</code> with attributes if it is followed immediately by attributes, e.g.:</p>
<ul>
<li><p>Example: <code>[This is *some text*]{.class key="val"}</code></p></li>
<li><p>idk what I‚Äôm doing really, so I mostly find myself doing things like <code>[blue text]{style="color:#1E88E5;"}</code> which produces <span style="color:#1E88E5;">blue text</span>.</p></li>
</ul></li>
<li><p><strong><code>&lt;div&gt;</code></strong>‚Äôs: are created by wrapping text with a line consisting of at least three colons <code>:::</code>.</p>
<ul>
<li><p>Example:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1">::: {#special .sidebar}</span>
<span id="cb5-2">Here is a paragraph.</span>
<span id="cb5-3"></span>
<span id="cb5-4">And another.</span>
<span id="cb5-5">:::</span></code></pre></div></li>
<li><p>We can use either attributes in curly braces or a single unbraced word, which will be treated as a class name.</p></li>
</ul></li>
</ul></li>
</ul>
<section id="install-extensions" class="level3">
<h3 class="anchored" data-anchor-id="install-extensions">üéÅ Install Extensions</h3>
<p>Find the full list of available extensions at <a href="https://quarto.org/docs/extensions/">Quarto Extensions</a></p>
<p>To install various icon sets used in the example slides, we can install the following extensions:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension mcanouil/quarto-iconify      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://icones.js.org/ [&lt;-- Contains rest of icon sets ??]</span></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension shafayetShafee/bsicons       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bootstrap icons</span></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension schochastics/academicicons   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OrcID, Google Scholar, ...</span></span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> quarto install extension quarto-ext/fontawesome       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font Awesome icons</span></span></code></pre></div>
<p>note that these aren‚Äôt necessary for functionality, but provide additional icons that I like to use ü§∑üèª‚Äç‚ôÇÔ∏è</p>
</section>
</section>
<section id="metadata" class="level2">
<h2 class="anchored" data-anchor-id="metadata">Metadata</h2>
<p>The first section of our <a href="https://github.com/saforem2/lattice23/blob/main/index.qmd"><code>index.qmd</code></a> contains the YAML metadata for the Quarto document.</p>
<p>Explicitly, we see this consists of:</p>
<details closed="">
<summary>
Expand for <code>yaml</code>
</summary>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb7-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">revealjs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title-block-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> none</span></span>
<span id="cb7-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slide-number</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> c</span></span>
<span id="cb7-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title-slide-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> default</span></span>
<span id="cb7-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chalkboard</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">buttons</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auto-animate</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reference-location</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> section</span></span>
<span id="cb7-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pause</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">footnotes-hover</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">citations-hover</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">preview-links</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">controls-tutorial</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">controls</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logo</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/saforem2/anl-job-talk/main/docs/assets/anl.svg"</span></span>
<span id="cb7-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">history</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dark</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> css/dark.scss</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]</span></span>
<span id="cb7-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css/default.css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> css/callouts.css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]</span></span>
<span id="cb7-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">self-contained</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">embed-resources</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">self-contained-math</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb7-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">center</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">highlight-style</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"atom-one"</span></span>
<span id="cb7-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">default-image-extension</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> svg</span></span>
<span id="cb7-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">code-line-numbers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb7-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">code-overflow</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> scroll</span></span>
<span id="cb7-30"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html-math-method</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> katex</span></span>
<span id="cb7-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fig-align</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> center</span></span>
<span id="cb7-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mermaid</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-33"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> dark</span></span>
<span id="cb7-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gfm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-35"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">output-file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lattice23.md"</span></span>
<span id="cb7-36"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
</details>
<p>The complete list of Reveal.js options are listed, with descriptions at: <a href="https://quarto.org/docs/reference/formats/presentations/revealjs.html">Quarto ‚Äì Revealjs Options</a></p>
</section>
<section id="title-slide" class="level2">
<h2 class="anchored" data-anchor-id="title-slide">Title Slide</h2>
<ul>
<li><p>Starting with the title slide<sup>5</sup>:</p>
<div id="fig-title" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/title-slide.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Title Slide"><img src="https://samforeman.me/posts/dope-slides/assets/title-slide.png" class="img-fluid figure-img" style="width:66.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <a href="https://saforem2.github.io/lattice23/#/section">Title Slide</a>
</figcaption>
</figure>
</div>
<ul>
<li><p>The full slide contents are included below:</p>
<details closed="">
<summary>
<p>Expand for <code>quarto</code></p>
</summary>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># {.title-slide .centeredslide background-iframe="https://saforem2.github.io/grid-worms-animation/" loading="lazy"}</span></span>
<span id="cb8-2"></span>
<span id="cb8-3">::: {style="background-color: rgba(22,22,22,0.75); border-radius: 10px; text-align:center; padding: 0px; padding-left: 1.5em; padding-right: 1.5em; max-width: min-content; min-width: max-content; margin-left: auto; margin-right: auto; padding-top: 0.2em; padding-bottom: 0.2em; line-height: 1.5em!important;"}</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">MLMC: Machine Learning Monte Carlo</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.style="color:#939393; font-size:1.5em; font-weight:bold;}  </span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">for Lattice Gauge Theory</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{style="color:#777777; font-size:1.2em; font-weight: bold;"}</span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;br&gt;&amp;nbsp;</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{style="padding-bottom: 0.5rem;"}  </span>
<span id="cb8-8">[](https://samforeman.me) Sam Foreman  </span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Xiao-Yong Jin, James C. Osborn</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.dim-text style="font-size:0.8em;"}  </span>
<span id="cb8-10">[[<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> `saforem2/`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/)</span>]{style="border-bottom: 0.5px solid #00ccff;"}<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`{`</span>[<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">`lattice23`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/lattice23)</span>]{style="border-bottom: 0.5px solid #00ccff;"}, [<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">`l2hmc-qcd`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://github.com/saforem2/l2hmc-qcd)</span>]{style="border-bottom: 0.5px solid #00ccff;"}<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`}`</span>]{style="font-size:0.8em;"}</span>
<span id="cb8-11"></span>
<span id="cb8-12">:::</span>
<span id="cb8-13"></span>
<span id="cb8-14">::: footer</span>
<span id="cb8-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">2023-07-31 @ [Lattice 2023](https://indico.fnal.gov/event/57249/contributions/271305/)</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.dim-text style="text-align:left;'}</span>
<span id="cb8-16">:::</span></code></pre></div>
</details></li>
<li><p>For the background, I made a simple animation <i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/grid-worms-animation"><code>saforem2/grid-worms-animation</code></a> that is hosted on GitHub pages as a simple html website</p></li>
<li><p>This static GitHub page is then used as an <a href="https://quarto.org/docs/presentations/revealjs/#iframe-backgrounds">IFrame Background</a> natively in Quarto with Reveal.js</p></li>
<li><p>This is as simple as:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># {.title-slide .centeredslide background-iframe="https://saforem2.github.io/grid-worms-animation/" loading="lazy"}</span></span></code></pre></div></li>
</ul></li>
</ul>
</section>
<section id="single-column-slides" class="level2">
<h2 class="anchored" data-anchor-id="single-column-slides">Single-Column Slides</h2>
<p>Other than the title slide, the remainder of the slides are all relatively straightforward to construct.</p>
<p>For single-column slides, constructing the content is as simple as writing it in Markdown:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Code</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Slide</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Overview</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Background: `{MCMC,HMC}`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#markov-chain-monte-carlo-mcmc)</span></span>
<span id="cb10-4"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Leapfrog Integrator</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#leapfrog-integrator-hmc)</span></span>
<span id="cb10-5"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Issues with HMC</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-issues-with-hmc)</span></span>
<span id="cb10-6"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Can we do better?</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-can-we-do-better)</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">L2HMC: Generalizing MD</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-l2hmc)</span></span>
<span id="cb10-9"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">4D $SU(3)$ Model</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-su3)</span></span>
<span id="cb10-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Results</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-results)</span></span>
<span id="cb10-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">References</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-references)</span></span>
<span id="cb10-12"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">4. </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Extras</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](#sec-extras)</span></span></code></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div style="text-align:center;">
<div id="fig-overview" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/overview.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Overview Slide"><img src="https://samforeman.me/posts/dope-slides/assets/overview.png" class="img-fluid figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: <a href="https://saforem2.github.io/lattice23/#/overview">Overview Slide</a>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="centered-slides" class="level2">
<h2 class="anchored" data-anchor-id="centered-slides">Centered Slides</h2>
<p>We can center all the text on a slide by adding the <code>{.centeredslide}</code> class to the slide header, e.g.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true"><code>index.qmd</code></a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false"><code>style.scss</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb11-2"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">format:</span></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  revealjs:</span></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    theme: [style.scss]</span></span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Title {.centeredslide}</span></span></code></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource scss number-lines code-with-copy"><code class="sourceCode scss"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.centeredslide</span> {</span>
<span id="cb12-2">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">text-align</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">center</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb12-3">}</span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="multi-column-slides" class="level2">
<h2 class="anchored" data-anchor-id="multi-column-slides">Multi-Column Slides</h2>
<p>Side-by-side content (either text or images)</p>
<div class="quarto-layout-panel" style="display: flex; flex-direction: row; margin-top: -0.0em; align-items: start;" data-layout="[ [50,50] ]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mcmc" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcmc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/mcmc.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Markov Chain Monte Carlo"><img src="https://samforeman.me/posts/dope-slides/assets/mcmc.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <a href="https://saforem2.github.io/lattice23/#/markov-chain-monte-carlo-mcmc">Markov Chain Monte Carlo</a>
</figcaption>
</figure>
</div>
</div>
<div class="col1 quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>This slide is horizontally centered<sup>6</sup> and the content consists of two rows split as follows:</p>
<div id="tbl-2col" class="striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-2col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">B</td>
</tr>
<tr class="even">
<td style="text-align: center;">C</td>
<td style="text-align: center;">C</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-2col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Slide layout. First row split into two columns, second row spans full width.
</figcaption>
</figure>
</div>
<ul>
<li><p>In panel A, we have a <code>::: {.callout-note}</code> block followed by a single list element containing a LaTeX equation.</p></li>
<li><p>In panel B we have a standard markdown image</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![](./assets/mcmc.png)</span></span></code></pre></div></li>
<li><p>In panel C we have normal text + math with LaTeX<sup>7</sup> syntax.</p></li>
</ul>
</div>
</div>
</div>
<ul>
<li><p>Note that we additionally have a <code>::: footer</code> element included at the bottom of the slide.</p></li>
<li><p>The code used to generate the slide above is included below:</p>
<details closed="">
<summary>
<p>Expand for<code>quarto</code></p>
</summary>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Markov Chain Monte Carlo (MCMC) {.centeredslide}</span></span>
<span id="cb14-2"></span>
<span id="cb14-3">:::: {.columns}</span>
<span id="cb14-4"></span>
<span id="cb14-5">::: {.column width="50%"}</span>
<span id="cb14-6"></span>
<span id="cb14-7">::: {.callout-note title="Goal" style="text-align:left;!important"}</span>
<span id="cb14-8">Generate **independent** samples $<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\{</span>x_{i}<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\}</span>$, such that<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[^notation]</span></span>
<span id="cb14-9">$$<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\{</span>x_{i}<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\}</span> \sim p(x) \propto e^{-S(x)}$$</span>
<span id="cb14-10">where $S(x)$ is the _action_ (or potential energy)</span>
<span id="cb14-11">:::</span>
<span id="cb14-12"></span>
<span id="cb14-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- </span>Want to calculate observables $\mathcal{O}$:  </span>
<span id="cb14-14">  $\left\langle \mathcal{O}\right\rangle \propto \int \left<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">\mathcal{D}x\right</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>\hspace{4pt} {\mathcal{O}(x)\, p(x)}$</span>
<span id="cb14-15"></span>
<span id="cb14-16">:::</span>
<span id="cb14-17"></span>
<span id="cb14-18">::: {.column width="49%"}</span>
<span id="cb14-19"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![](https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/normal_distribution.dark.svg)</span></span>
<span id="cb14-20">:::</span>
<span id="cb14-21"></span>
<span id="cb14-22">::::</span>
<span id="cb14-23"></span>
<span id="cb14-24">If these were <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">independent</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>{.style="color:#00CCFF;"}, we could approximate:</span>
<span id="cb14-25">$\left\langle\mathcal{O}\right\rangle \simeq \frac{1}{N}\sum^{N}_{n=1}\mathcal{O}(x_{n})$</span>
<span id="cb14-26">$$\sigma_{\mathcal{O}}^{2} = \frac{1}{N}\mathrm{Var}{\left<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">\mathcal{O} (x) \right</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>}\Longrightarrow</span>
<span id="cb14-27">\sigma_{\mathcal{O}} \propto \frac{1}{\sqrt{N}}$$</span>
<span id="cb14-28"></span>
<span id="cb14-29"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[^notation]: </span>Here, $\sim$ means "is distributed according to"</span>
<span id="cb14-30"></span>
<span id="cb14-31">::: footer</span>
<span id="cb14-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> `saforem2/lattice23`</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://saforem2.github.io/lattice23)</span></span>
<span id="cb14-33">:::</span></code></pre></div>
</details></li>
</ul>
</section>
<section id="css" class="level2">
<h2 class="anchored" data-anchor-id="css">üíÖ CSS</h2>
<p>My web developer friend laughs at me, but when something is broken / doesn‚Äôt look right / I want it to look different, I:</p>
<ol type="1">
<li>Pull up Chrome Tools ( ‚åò + ‚å• + I )</li>
<li>Inspect element of interest ( ‚åò + ‚áß + C )</li>
<li>Make changes to the CSS</li>
<li>Save the new rule to my <code>.scss</code> file ü§∑üèª‚Äç‚ôÇÔ∏è</li>
</ol>
<p>I‚Äôm guessing this might be obvious to some people, but it took me a while to figure out how things worked so maybe its helpful for others.</p>
<details closed="">
<summary>
Expand for <code>css</code>
</summary>
<div id="fig-css" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-css-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/css.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Example of selecting an element and making a change to the CSS."><img src="https://samforeman.me/posts/dope-slides/assets/css.png" class="img-fluid figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-css-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Example of selecting an element and making a change to the CSS.
</figcaption>
</figure>
</div>
</details>
</section>
<section id="github-page" class="level2">
<h2 class="anchored" data-anchor-id="github-page">üìÉ GitHub Page</h2>
<p>To enable your GitHub page, you can do the following:</p>
<div id="fig-github-page" class="quarto-float quarto-figure quarto-figure-center anchored" style="text-align:center;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-github-page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/github-pages.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Instructions for building a GitHub page using the docs/ directory off the main branch."><img src="https://samforeman.me/posts/dope-slides/assets/github-pages.png" class="img-fluid figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-github-page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Instructions for building a GitHub page using the <code>docs/</code> directory off the <code>main</code> branch.
</figcaption>
</figure>
</div>
<p>In this case, the repo is:</p>
<p><i class="fa-brands fa-github" aria-label="github"></i> <a href="https://github.com/saforem2/lattice23"><code>saforem2/lattice23</code></a></p>
<p>and the site is published at</p>
<p><a href="https://saforem2.github.io/lattice23">https://saforem2.github.io/lattice23</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">üìì References</h2>
<ul>
<li><a href="https://quarto.org/docs/presentations/revealjs/themes.html">Reveal Themes</a></li>
<li>Using <a href="https://thomasmock.quarto.pub/reports-presentations/#/pandoc-fenced-divs">Pandoc fenced divs</a></li>
<li><a href="https://www.emilhvitfeldt.com/post/slidecraft-colors-fonts/">Slidecraft 101: Colors and Fonts</a></li>
<li><a href="https://thomasmock.quarto.pub/reports-presentations/#/title-slide">Beautiful Reports and Presentations with Quarto</a></li>
<li><a href="https://github.com/grantmcdermott/quarto-revealjs-clean"><i class="fa-brands fa-github" aria-label="github"></i> Quarto Clean Theme</a></li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[‚ù§Ô∏è‚Äçü©π Status]{style=&quot;color: #FF5252;&quot;}" style="width:100%;background-color: rgba(0,0,0,0.0)!important;border:1px solid rgba(131,131,131,0.2)!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span style="color: #FF5252;">‚ù§Ô∏è‚Äçü©π Status</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="5fae6127" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f; font-style: italic">Last Updated</span>: <span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">05</span><span style="color: #f06292; text-decoration-color: #f06292">/</span><span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">04</span><span style="color: #f06292; text-decoration-color: #f06292">/</span><span style="color: #f06292; text-decoration-color: #f06292; font-weight: bold">2025</span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">@</span> <span style="color: #1a8fff; text-decoration-color: #1a8fff; font-weight: bold">11:15:40</span>
</pre>
</div>
</div>
<p align="center">
<a href="https://hits.seeyoufarm.com"><img align="center" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fsamforeman.me%2Fqmd%2Fdope-slides%2F&amp;count_bg=%2300CCFF&amp;title_bg=%23303030&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=hits&amp;edge_flat=false"></a>
</p>
</div>
</div>
</div>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>And countless other people IRL‚Ü©Ô∏é</p></li>
<li id="fn2"><p>One thing I‚Äôve been meaning to do, is clean up all my <code>css/*</code> files and move them all to a single repository, but I‚Äôll save that for another day.‚Ü©Ô∏é</p></li>
<li id="fn3"><p><em>An open-source scientific and technical publishing system</em>‚Ü©Ô∏é</p></li>
<li id="fn4"><p><a href="https://quarto.org/docs/authoring/markdown-basics.html#equations">Equations</a>‚Ü©Ô∏é</p></li>
<li id="fn5"><p>Quarto comes with lightbox support, so you can click on images to display them full screen.‚Ü©Ô∏é</p></li>
<li id="fn6"><p>By adding the <code>{.centeredslide}</code> class to the slide header‚Ü©Ô∏é</p></li>
<li id="fn7"><p>Text surrounded by <code>$</code> will be rendered with LaTeX‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {How to {Make} {Dope} {Slides}},
  date = {2024-08-13},
  url = {https://samforeman.me/posts/dope-slides},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúHow to Make Dope Slides.‚Äù</span> August 13,
2024. <a href="https://samforeman.me/posts/dope-slides">https://samforeman.me/posts/dope-slides</a>.
</div></div></section></div> ]]></description>
  <category>slides</category>
  <category>revealjs</category>
  <category>style</category>
  <guid>https://samforeman.me/posts/dope-slides/</guid>
  <pubDate>Tue, 13 Aug 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üé∞ Deterministic flash-attn</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<blockquote class="blockquote">
<p>[<strong>NOTE</strong>]: For additional details, refer to the <a href="https://api.wandb.ai/links/aurora_gpt/nqjjhzd5">W&amp;B Report</a>.</p>
</blockquote>
<p>Simple tests to confirm the loss is exactly reproducible across independent runs (when launched with the same seed).</p>
<ul>
<li><p>In particular, we set:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1">output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flash_attn_func(q, k, v, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.causal, deterministic<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<p>in all the <code>flash_attn_func(...)</code> calls from <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/main/megatron/model/transformer.py"><code>megatron/model/transformer.py</code></a></p></li>
<li><p>All experiments ran on Polaris @ ALCF, using:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">machine</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Polaris</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">args.zero_stage</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">args.num_layers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">args.micro_batch_size</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">args.optimizer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adamw"</span></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">args.use_flash_attn</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env.DFL_STEM</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"books"</span></span>
<span id="cb2-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env.GRAD_ACC_STEPS</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env.WORLD_SIZE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span></code></pre></div></li>
</ul>
<div id="fig-loss" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/deterministic-flash-attn-loss.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Plot of the loss curve for 3 independent runs with deterministic=True"><img src="https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/assets/deterministic-flash-attn-loss.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Plot of the loss curve for 3 independent runs with <code>deterministic=True</code>
</figcaption>
</figure>
</div>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {üé∞ {Deterministic} `Flash-Attn`},
  date = {2024-06-17},
  url = {https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüé∞ Deterministic `Flash-Attn`.‚Äù</span> June
17, 2024. <a href="https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/">https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/</a>.
</div></div></section></div> ]]></description>
  <category>ALCF</category>
  <category>AuroraGPT</category>
  <category>Aurora</category>
  <category>Megatron-DeepSpeed</category>
  <category>XPU</category>
  <guid>https://samforeman.me/posts/AuroraGPT/determinstic-flash-attn/</guid>
  <pubDate>Mon, 17 Jun 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üì∏ flash-attn on Sunspot</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="update-2024-06-16" class="level2">
<h2 class="anchored" data-anchor-id="update-2024-06-16">Update: 2024-06-16</h2>
<p>After an interactive debug session with Intel, the root behavior of the apparent discrepancy was identified.</p>
<p>In particular, we found that the <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed">ALCF/Megatron-DeepSpeed</a> repo was <strong>NOT</strong> explicitly setting the dropout values to <code>0.0</code> (and so, was using the default values of <code>0.1</code>) for both <code>--attention-dropout</code> and <code>--hidden-dropout</code>.</p>
<p>After making this change, the losses were observed to agree, as can be seen below in</p>
<div id="fig-flash-attn-dropout-fix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-flash-attn-dropout-fix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./assets/flash-attn/flash-attn-dropout-fix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: After correctly setting the dropout values, the loss curves were observed to agree."><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-dropout-fix.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-flash-attn-dropout-fix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: After correctly setting the dropout values, the loss curves were observed to agree.
</figcaption>
</figure>
</div>
</section>
<section id="impact-on-loss-bug" class="level2">
<h2 class="anchored" data-anchor-id="impact-on-loss-bug">üêõ Impact on Loss [Bug?]</h2>
<p>In the <code>q4-drop</code>, it was observed that toggling <code>flash-attn</code> on / off seemed to produce different loss curves (with otherwise <em>identical configs</em>)</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>shared-config.yaml</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="shared-config.yaml" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TP</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PP</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GAS</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">OPT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> adamw</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dtype</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> bf16</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NLAYERS</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MICRO_BATCH</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">WORLD_SIZE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span></code></pre></div>
</div>
<p>This can be seen clearly in the figure below:</p>
<p><a href="./assets/flash-attn/flash-attn-bug-q4-drop-sunspot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-bug-q4-drop-sunspot-1.png" class="img-fluid"></a></p>
<p>This was identified, and to be addressed in upcoming release.</p>
</section>
<section id="llm-framework-release" class="level2">
<h2 class="anchored" data-anchor-id="llm-framework-release">üì¶ LLM Framework Release</h2>
<p>On 05/14/2024, Intel dropped their new LLM frameworks release:</p>
<details closed="">
<summary>
üéÅ <code>frameworks_2024_5_v2</code> Announcement:
</summary>
<p>Hi Venkat,</p>
<p>We have shared the official Q2 release in two different forms :</p>
<p>Manual Setup: <code>/gila/Aurora_deployment/anl_24_q2_release.tar.gz</code></p>
<p>and</p>
<p>Module:</p>
<p><code>module use -a /home/jmitche1/anl_release/2024/q2</code></p>
<p><code>module load frameworks_2024_5_v2</code></p>
<p>&nbsp;Instructions on how to use modules with Q2 build are anl_24_q2_release/README</p>
<ul>
<li><strong>The release includes :</strong>
<ul>
<li>Megatron-DeepSpeed 0.14.2 (with patch)</li>
<li>Intel¬Æ Extension for PyTorch* v2.1.30+xpu</li>
<li>TorchCCL 2.1.300</li>
<li>ONEAPI 2024.1.0.596.PUBLIC_IDP_2024.1.0_723</li>
<li>Agama driver: 803.29</li>
</ul></li>
<li>The release provides following key features:
<ul>
<li>Scaleup Performance improvement from the <code>TorchCCl</code> prototype feature enabled by <code>TORCH_LLM_ALLREDUCE=1</code> &nbsp;<a href="https://urldefense.us/v3/__https://github.com/intel/torch-ccl/releases/tag/v2.1.300*2Bxpu__;JQ!!G_uCfscf7eWS!ZDMnN0Oxp1sCv06MkdlBqFIq0NMAXaCBOtl3fEtBq8Fn4-3iYY5-kPEKr-q4vZIL_i6f2wQbULxAIFJAthJyu3VvNA$">details</a></li>
<li>Auto TP inference support for more workloads</li>
<li>Flash Attention V2 improvement for 256 head dimension support; MiCS support.</li>
<li>Latest Features and Optimizations from DeepSpeed&nbsp;<a href="https://github.com/microsoft/DeepSpeed/releases/tag/v0.14.2">0.14.2</a>&nbsp;and Intel¬Æ Extension for PyTorch*&nbsp;<a href="https://github.com/intel/intel-extension-for-pytorch/tree/v2.1.30*2Bxpu">2.1.30</a>.</li>
</ul></li>
</ul>
<p>Thanks,&nbsp;<br>
Jerome</p>
</details>
<section id="flash-no-flash" class="level3">
<h3 class="anchored" data-anchor-id="flash-no-flash">üì∏ flash ü§ù üì∑ no-flash</h3>
<p>With this new release, Intel observed that the loss curves agreed exactly for <code>flash</code> / no-<code>flash</code>, using the learning rate settings below:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00015</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr_warmup_frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr_decay_iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320000</span></span></code></pre></div>
<p>Testing with Jerome‚Äôs new release:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /home/jmitche1/anl_release/2024/q2</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks_2024_5_v2</span></code></pre></div>
<p>I was able to independently confirm these results, shown in üì∏ <code>flash</code> ü§ù üì∑ <code>no-flash</code> below.</p>
<details closed="">
<summary>
üîó <code>wandb</code> links:
</summary>
<ul>
<li>[üì∏ <code>flash</code>] W&amp;B Run: <a href="https://wandb.ai/aurora_gpt/AuroraGPT/runs/716r5rnq/overview?nw=nwuserforemans">youthful-river-1832</a></li>
<li>[üì∑ no-<code>flash</code>] W&amp;B Run: <a href="https://wandb.ai/aurora_gpt/AuroraGPT/runs/120ln0b4/overview?nw=nwuserforemans">earthy-wave-1830</a></li>
</ul>
</details>
<details closed="">
<summary>
üì∏ <code>flash</code> vs.&nbsp;üì∑ <code>no-flash</code>
</summary>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/flash-attn/flash-attn-sunspot-compare-new-release.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="flash üì∏ ü§ù üì∑ no-flash"><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-sunspot-compare-new-release.png" class="img-fluid figure-img" alt="flash üì∏ ü§ù üì∑ no-flash"></a></p>
<figcaption><code>flash</code> üì∏ ü§ù üì∑ no-<code>flash</code></figcaption>
</figure>
</div>
</details>
</section>
<section id="broken-mpigremlins" class="level3">
<h3 class="anchored" data-anchor-id="broken-mpigremlins">üöß Broken MPI<sup>1</sup></h3>
<p>For whatever reason, things seemed to have spontaneously broken on the night of 2024-04-14 ??</p>
<p>When trying to run experiments the following day (05/15/2024) I was met with this<sup>2</sup>:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Abort</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Fatal error in internal_Init_thread: Other MPI error</span></code></pre></div>
<p>which was discussed further in <a href="https://github.com/pmodels/mpich/pull/7001">this thread</a> on slack.</p>
<p>It seems Subrata also encountered a similar issue [see: <a href="https://cels-anl.slack.com/archives/C047E7ZTUUF/p1715985162970119">slack thread</a>]</p>
<details closed="">
<summary>
‚úÖ <code>mpi4py</code> fix
</summary>
<p>To resolve this</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Abort</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">15</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> Fatal error in internal_Init_thread: Other MPI error</span></code></pre></div>
<p>issue we can simply load the correct modules:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /home/jmitche1/anl_release/2024/q2</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks_2024_5_v2</span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /home/ftartagl/graphics-compute-runtime/modulefiles</span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load graphics-compute-runtime/agama-ci-devel-803.29 </span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load spack-pe-gcc/0.6.1-23.275.2 gcc/12.2.0</span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0</span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load oneapi/release/2024.04.15.001</span></code></pre></div>
<p>For full details see <a href="../../../posts/AuroraGPT/mpi4py-reproducer/index.html">mpi4py-reproducer</a>, and this [<a href="https://cels-anl.slack.com/archives/C05V0SRAVB6/p1715867557424879">slack thread</a>].</p>
</details>
</section>
</section>
<section id="framework-comparison" class="level2">
<h2 class="anchored" data-anchor-id="framework-comparison">üïµüèª‚Äç Framework Comparison</h2>
<p>As I was re-building MPI, and after talking to Jerome, I realized that <em>most</em> of the dependencies are already present in the provided <code>frameworks/</code> modules on Sunspot.</p>
<p>As a simple test, I tried building a new environment built on the base <code>conda</code> environment<sup>3</sup> provided by the<code>frameworks/2023.12.15.001</code> module, which worked without modification and had ) <em>most</em> of what I needed already installed:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb7-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> torch.__version__</span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.0a0+cxx11.abi'</span></span>
<span id="cb7-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span>
<span id="cb7-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> ipex.__version__</span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.10+xpu'</span></span>
<span id="cb7-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpi4py <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MPI</span></code></pre></div>
<p>The remaining dependencies were installed according to the instructions from the <strong>new</strong> release <code>frameworks_2024_5_v2</code>.</p>
<p>Details included below.</p>
<details closed="">
<summary>
üì¶ <code>pip</code> Install Dependencies
</summary>
<p>Unfortunately, the <code>frameworks/**</code> don‚Äôt appear to provide DeepSpeed.</p>
<p>We can create a virtual environment on top of the base conda by</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use frameworks/2023.12.15.001</span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export PBS_O_WORKDIR=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ALCF/helpers.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">setup_venv_from_conda</span></span></code></pre></div>
<p>Once the <code>venv</code> has been created and activated, we can install the remaining dependencies:</p>
<p>To build / install DeepSpeed, along with its required dependencies:</p>
<ul>
<li><p><code>intel-extension-for-deepspeed</code>:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install intel_extension_for_pytorch_deepspeed<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\=\=</span>2.1.30 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://pytorch-extension.intel.com/release-whl/stable/xpu/us/intel-extension-for-pytorch-deepspeed/"</span></span></code></pre></div></li>
<li><p><code>DeepSpeed</code>:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"build deepspeed"</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/microsoft/DeepSpeed.git</span>
<span id="cb10-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> DeepSpeed</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add yizhou_ds https://github.com/YizhouZ/DeepSpeed.git</span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> fetch yizhou_ds</span>
<span id="cb10-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout yizhou/kernel_path</span>
<span id="cb10-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements/requirements.txt</span>
<span id="cb10-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> setup.py develop <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span></code></pre></div></li>
<li><p>Extras:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install transformers datasets python-etcd tensorboardX packaging sentencepiece bitsandbytes tiktoken neural-speed einops intel-extension-for-transformers</span></code></pre></div></li>
</ul>
</details>
<p>Looking around the available modules a bit, I noticed a newer frameworks release (<code>frameworks/2024.04.15.002</code>) that had a newer version of both <code>torch</code> and <code>ipex</code>:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0</span>
<span id="cb12-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks/2024.04.15.002.lua</span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI; print(MPI.__file__)'</span></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /soft/datascience/aurora_nre_models_frameworks-2024.1_preview_u1/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so</span></span></code></pre></div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb13-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> torch.__version__</span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.0.post2+cxx11.abi'</span></span>
<span id="cb13-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> intel_extension_for_pytorch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipex</span>
<span id="cb13-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> ipex.__version__</span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'2.1.30+xpu'</span></span>
<span id="cb13-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;&gt;</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpi4py <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MPI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(MPI.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__file__</span>)</span>
<span id="cb13-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>soft<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>datascience<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>aurora_nre_models_frameworks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2024.1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">_preview_u1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>lib<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>python3<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>site<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>mpi4py<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>MPI.cpython<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x86_64<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>linux<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gnu.so</span></code></pre></div>
<p>The remaining dependencies were installed identically to what was just done previously for the <code>frameworks/2023.12.15.001</code> module.</p>
<p><strong>NOTE</strong>: In the figures below, we denote these two environments as:</p>
<ul>
<li><code>2024.0</code>:
<ul>
<li><code>module load frameworks/2023.12.15.001</code></li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li><code>module use /soft/preview-modulefiles/24.086.0</code></li>
<li><code>module load frameworks/2024.04.15.002.lua</code></li>
</ul></li>
<li><code>anl_24_q2_release</code>:
<ul>
<li><code>eval "$(~/miniconda3/bin/conda shell.zsh hook)"</code></li>
<li><code>conda activate anl_24_q2_release</code></li>
</ul></li>
</ul>
<section id="fix-in-disguise" class="level3">
<h3 class="anchored" data-anchor-id="fix-in-disguise">ü•∏ Fix in Disguise</h3>
<p>Armed now with functional environment(s) for <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed"><code>argonne-lcf/Megatron-DeepSpeed</code></a>, I was able to resume my previous experiments.</p>
<p>From the discussion with Intel, it was hard to understand / reason about <em>why</em> the <code>flash-attn</code> fix would have <em>any</em> dependence on the learning rate schedule (warmup + decay).</p>
<p>If the <code>flash-attn</code> fix works for a particular learning rate schedule, you would reasonably expect that it should work for <em>any</em> learning rate schedule.</p>
<p>An additional source of confusion for me was that the discrepancy in the loss curves (seemingly) disappeared when using the learning rate settings provided by Intel<sup>4</sup>, but not when using the ALCF defaults<sup>5</sup>.</p>
<p>After thinking about it for a bit and trying to reason about possible causes, I wondered if it might not be a mix of multiple different factors:</p>
<ol type="1">
<li>Small learning rate</li>
<li>Very long decay</li>
<li>[maybe ?] somehow dependent on the learning rate warmup fraction
<ol type="1">
<li>preliminary experiments seemed to suggest this was not the case</li>
</ol></li>
</ol>
<p>So, I was curious what would happen if I used the (larger) learning rate value from the ALCF defaults (<code>lr=0.003</code>) with the very long <code>lr-decay-iters: 320000</code> from Intel.</p>
<p>These results are shown below.</p>
<p>In particular, for all three experiments the following learning rate settings were used:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource yml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0003</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-warmup-frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-decay-iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320000</span></span></code></pre></div>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay10000-1.png" class="img-fluid" alt="flash-attn-disguise-decay10000-1"> Looking at this figure ^, it appears that up until the very very end, all three loss curves agree <em>identically</em>.</p>
<p>However, if we look closely at the very end, it looks like there <em>might</em> be a <em>slight</em> difference beginning to appear between the <code>2024.0</code> (brown line) and <code>{anl_24_q2_release, 2024.1}</code> ({dark, light} blue lines, respectively).</p>
<p>Thinking that I might be onto something, I then tried again with a smaller <code>lr-decay-iters: 5000</code>.</p>
<p>This result is shown below:</p>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay5000.png" class="img-fluid" alt="flash-attn-disguise-decay5000"> In particular, we can now more clearly see the difference beginning to appear between the <code>2024.0</code> and <code>2024.1</code> loss curves.</p>
<p>Continuing on, we see this effect become increasingly dramatic with even smaller values of <code>lr-decay-iters</code>:</p>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay-2000.png" class="img-fluid" alt="flash-attn-disguise-decay-2000"> <img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay1500.png" class="img-fluid" alt="flash-attn-disguise-decay1500"></p>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-disguise-decay1000-1.png" class="img-fluid" alt="flash-attn-disguise-decay1000-1"> In each of these experiments, it appears that:</p>
<ul>
<li><code>2024.0</code>:
<ul>
<li>Not impacted by this <code>lr-decay-iters</code> dependence</li>
<li>Continue to decrease for the duration of training</li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li>Impacted by the <code>lr-decay-iters</code> dependence</li>
<li>Plateaus towards the end of training</li>
</ul></li>
</ul>
<details closed="">
<summary>
Older Figs
</summary>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/disguised-fix-2.png" class="img-fluid" alt="disguised-fix-2"> <img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/disguised-fix-1.png" class="img-fluid" alt="disguised-fix-1"></p>
</details>
</section>
<section id="fix" class="level3">
<h3 class="anchored" data-anchor-id="fix">‚úÖ <code>2024.0</code> Fix</h3>
<p><strong>Everything</strong> seems to work with</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load frameworks/2023.12.15.001</span></code></pre></div>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-2024-0-fix.png" class="img-fluid"> <img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/flash-attn-fix-frameworks-comparison.png" class="img-fluid"></p>
</section>
<section id="lr-decay-iters-comparison" class="level3">
<h3 class="anchored" data-anchor-id="lr-decay-iters-comparison">üìä <code>lr-decay-iters</code> Comparison</h3>
<ul>
<li><code>2024.0</code>:
<ul>
<li><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/decay-experiment-2024-0-1.png" class="img-fluid"></li>
</ul></li>
<li><code>2024.1</code>:
<ul>
<li><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/flash-attn/decay-experiment-2024-1.png" class="img-fluid"></li>
</ul></li>
</ul>
</section>
</section>
<section id="lr-decay-iters-dependence" class="level2">
<h2 class="anchored" data-anchor-id="lr-decay-iters-dependence">üìà <code>lr-decay-iters</code> dependence</h2>
<p><a href="./assets/lr-decay-iters-dependence-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/lr-decay-iters-dependence-2.png" class="img-fluid"></a></p>
<p><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/lr-schedule-dependence.png" class="img-fluid"> <img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/lr-decay-iters-dependence-1.png" class="img-fluid"></p>
</section>
<section id="performance-improvement-in-2024.1" class="level2">
<h2 class="anchored" data-anchor-id="performance-improvement-in-2024.1">üèéÔ∏è Performance Improvement in <code>2024.1</code></h2>
<p><a href="./assets/performance-2024-0.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/performance-2024-0.png" class="img-fluid"></a></p>
<p><a href="./assets/performance-2024-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/assets/performance-2024-1.png" class="img-fluid"></a></p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource yml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0003</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-warmup-frac</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lr-decay-iters</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">null</span></span></code></pre></div>



</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Gremlin">Gremlins</a>, likely‚Ü©Ô∏é</p></li>
<li id="fn2"><p>https://github.com/pmodels/mpich/pull/7001‚Ü©Ô∏é</p></li>
<li id="fn3"><p>Explicitly, <code>aurora_nre_models_frameworks-2024.0</code>, abbreviated as <code>2024.0</code>‚Ü©Ô∏é</p></li>
<li id="fn4"><p>Intel used the following learning rate schedule in their experiments <code>yml   lr: 0.00015   lr-warmup-frac: 0.01   lr-decay-iters: 320000</code>‚Ü©Ô∏é</p></li>
<li id="fn5"><p>ALCF used the following learning rate schedule in their experiments‚Ü©Ô∏é</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {üì∏ `Flash-Attn` on {Sunspot}},
  date = {2024-06-17},
  url = {https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüì∏ `Flash-Attn` on Sunspot.‚Äù</span> June 17,
2024. <a href="https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/">https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/</a>.
</div></div></section></div> ]]></description>
  <category>ALCF</category>
  <category>AuroraGPT</category>
  <category>Aurora</category>
  <category>Megatron-DeepSpeed</category>
  <category>XPU</category>
  <guid>https://samforeman.me/posts/AuroraGPT/flash-attn-sunspot/</guid>
  <pubDate>Mon, 17 Jun 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üèéÔ∏è Megatron-DeepSpeed on Intel XPU</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/aurora-gpt/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="install-setup" class="level2">
<h2 class="anchored" data-anchor-id="install-setup">Install / Setup</h2>
<ul>
<li><p>Setup script / history:</p>
<details closed="">
<summary>
<p>Interactive Session</p>
</summary>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export HTTP_PROXY=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export HTTPS_PROXY=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export http_proxy=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export https_proxy=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export DRM_LIB=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/include/libdrm"</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># $ export PATH="${HOME}/miniconda3/bin:$PATH"</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> conda create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> anl_release_q4 python=3.9 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--y</span></span>
<span id="cb1-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> ~/miniconda3/miniconda.sh</span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> bash ~/miniconda3/miniconda.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ~/miniconda3</span>
<span id="cb1-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> eval <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(${HOME}</span> shell.zsh hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> export DRM_LIB=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/include/libdrm"</span></span>
<span id="cb1-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> conda config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels conda-forge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge mpi4py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-deps</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge libssh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> uninstall mpi <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.whl</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module unload oneapi/eng-compiler/2022.12.30.003</span>
<span id="cb1-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module unload intel_compute_runtime/release/agama-devel-551</span>
<span id="cb1-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /soft/modulefiles</span>
<span id="cb1-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module load oneapi/release/2023.12.15.001</span>
<span id="cb1-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use /home/ftartagl/graphics-compute-runtime/modulefiles</span>
<span id="cb1-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module load graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one-liner for modules:</span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># module unload oneapi/eng-compiler/2022.12.30.003 &amp;&amp; module unload intel_compute_runtime/release/agama-devel-551&amp;&amp; module use -a /soft/modulefiles &amp;&amp; module load oneapi/release/2023.12.15.001 &amp;&amp; module use /home/ftartagl/graphics-compute-runtime/modulefiles &amp;&amp; module load graphics-compute-runtime/agama-ci-devel-736.9</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd torch-ccl</span>
<span id="cb1-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ls</span>
<span id="cb1-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> COMPUTE_BACKEND=dpcpp python3 setup.py develop <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span>
<span id="cb1-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ../</span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd intel-extension-for-deepspeed</span>
<span id="cb1-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 setup.py develop <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span>
<span id="cb1-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ../</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd DeepSpeed</span>
<span id="cb1-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> ls</span>
<span id="cb1-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements/requirements.txt</span>
<span id="cb1-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 setup.py develop <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tee</span> build.log</span></code></pre></div>
</details></li>
</ul>
</section>
<section id="running" class="level2">
<h2 class="anchored" data-anchor-id="running">Running</h2>
<section id="using-launch" class="level3">
<h3 class="anchored" data-anchor-id="using-launch">Using <code>launch</code></h3>
<ul>
<li><p>Setup:</p>
<details closed="">
<summary>
<p>Setup</p>
</summary>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> qsub <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> EarlyAppAccess <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> Aurora_Deployment <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> walltime=08:00:00 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> select=2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">qsub:</span> waiting for job 604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov to start</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">qsub:</span> job 604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov ready</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module unload oneapi/eng-compiler/2022.12.30.003 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> unload intel_compute_runtime/release/agama-devel-551<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /soft/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load oneapi/release/2023.12.15.001 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /home/ftartagl/graphics-compute-runtime/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb2-6"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> agama-ci-devel-736.9 successfully loaded:</span>
<span id="cb2-7"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> eval <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/bin/conda</span> shell.zsh hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> conda activate anl_release_q4</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/saforem2/ezpz</span>
<span id="cb2-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ezpz[dev]"</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [</span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">BUG</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">] for some reason, need to run twice ¬Ø\_(„ÉÑ)_/¬Ø</span></span>
<span id="cb2-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source ./ezpz/src/ezpz/bin/savejobenv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ./ezpz/src/ezpz/bin/savejobenv</span></code></pre></div>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Writing PBS vars to /home/foremans/.pbsenv</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> HOSTFILE: /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> NHOSTS: 2</span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> NGPU_PER_HOST: 12 GPUs per host</span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> NGPUS: 24 GPUs total</span>
<span id="cb3-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> [DIST INFO]:</span>
<span id="cb3-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>   ‚Ä¢ Writing Job info to /home/foremans/.pbsenv</span>
<span id="cb3-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ HOSTFILE: /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb3-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NHOSTS: 2</span>
<span id="cb3-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NGPU_PER_HOST: 12</span>
<span id="cb3-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NGPUS = <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> NGPU_PER_HOST<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=</span> 24</span>
<span id="cb3-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Hosts</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb3-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       ‚Ä¢ x4502c0s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov, x4502c0s2b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb3-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Launch</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb3-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ Use: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'launch'</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=mpiexec</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb3-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>       to launch job</span>
<span id="cb3-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> YOU ARE HERE: /home/foremans</span>
<span id="cb3-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> Run <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'source ./bin/getjobenv'</span> in a NEW SHELL to automatically set env vars</span>
<span id="cb3-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span></code></pre></div>
</details>
<details closed="">
<summary>
<p>[WIP] Building out <code>python</code> API</p>
</summary>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz.savejobenv</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'If you dont plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb4-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:185</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.sh</span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:193</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving job env to dot-env <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file</span> in /home/foremans</span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:211</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.json</span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:225</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.yaml</span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:253</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Writing PBS env vars to /home/foremans/PBS-jobs/604319 / jobenv{.sh, .yaml, .json}</span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 10:02:37]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jobs:258</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> jobenv={</span>
<span id="cb4-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BACKEND"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gloo"</span>,</span>
<span id="cb4-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span>,</span>
<span id="cb4-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE_ID"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu:0"</span>,</span>
<span id="cb4-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DISTRIBUTED_BACKEND"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gloo"</span>,</span>
<span id="cb4-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FRAMEWORK"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pytorch"</span>,</span>
<span id="cb4-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPUS_PER_NODE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb4-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTFILE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTNAME"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x4502c0s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTS"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[x4502c0s0b0n0, x4502c0s2b0n0]"</span>,</span>
<span id="cb4-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LAUNCH_CMD"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mpiexec --verbose --envall -n 24 -ppn 12 --hostfile /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LOCAL_RANK"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb4-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MACHINE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aurora"</span>,</span>
<span id="cb4-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NGPUS"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb4-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NGPU_PER_HOST"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"12"</span>,</span>
<span id="cb4-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NHOSTS"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>,</span>
<span id="cb4-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NODE_ID"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb4-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUM_NODES"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2,</span>
<span id="cb4-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_ACCOUNT"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aurora_Deployment"</span>,</span>
<span id="cb4-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_ENVIRONMENT"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_INTERACTIVE"</span>,</span>
<span id="cb4-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_HOOK_RESOURCES"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eJyVUV1vwjAM/EOblHZbgUV54yfs3TKp22bkozgJqP9+LjAJ9jYpD7HvfL5L0Pt0AbQ21VjATmSPMKDzlck0Gq9opBGLOxOspZVriit2Qe5BShoTL2bvsmVaMeTlDpZlpj/AoXIEXjWM0rYyk6x90H1tPza73a7rNq1SejoECKknM3gsepptABdwJGNTmGshKJQLtKp9V03TfMnlremgUUO3lelo55pNq6MDppwqWzJYOTHqKKK2CJbOxKsncTN7FEIWI4VYz5y+hQIzu8SuLMLltK48oD0Oznt5gkz+ppKjvfk8Vex1SQX9YyilL1IVF8io7adScvSpUiV4Dnjv/TPmberZQiaWYDDKdyYY8tXrtTOlQE+NM3rXgwSivORCIZs75eV3+Ady/coN"</span>,</span>
<span id="cb4-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_JOBCOOKIE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6B8C4F9D774B0AA5174EAAFB6E2CC14F"</span>,</span>
<span id="cb4-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_JOBDIR"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans"</span>,</span>
<span id="cb4-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_JOBID"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_JOBNAME"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"STDIN"</span>,</span>
<span id="cb4-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_MOMPORT"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"15003"</span>,</span>
<span id="cb4-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_NODEFILE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_NODENUM"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>,</span>
<span id="cb4-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_HOME"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans"</span>,</span>
<span id="cb4-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_HOST"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aurora-uan-0010.hostmgmt1000.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-39">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_LANG"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en_US.UTF-8"</span>,</span>
<span id="cb4-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_LOGNAME"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"foremans"</span>,</span>
<span id="cb4-41">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_MAIL"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/var/spool/mail/foremans"</span>,</span>
<span id="cb4-42">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_PATH"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/.nvm/versions/node/v21.5.0/bin:/home/foremans/homebrew/bin:/home/foremans/homebrew/sbin:/opt/cray/pals/1.3.2/bin:/opt/cray/libfabric/1.15.2.0/bin:/opt/aurora/23.073.0/support/libraries/intel-compute-samples/2021.27.01:/opt/aurora/23.073.0/support/libraries/khronos/clinfo/default/bin:/opt/aurora/23.073.0/support/tools/gpu_validation:/opt/aurora/23.073.0/intel-gpu-umd/agama-devel-551/compiler/bin:/opt/aurora/23.073.0/intel-gpu-umd/agama-devel-551/driver/bin:/opt/aurora/23.073.0/CNDA/mpich/51.2/mpich-ofi-all-icc-default-pmix-gpu-drop51/bin:/opt/aurora/23.073.0/support/tools/mpi_wrapper_utils:/opt/aurora/23.073.0/oneapi/debugger/2023.0.0/gdb/intel64/bin:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/dpcpp-ct/bin:/opt/aurora/23.073.0/oneapi/advisor/2023.0.0/bin64:/opt/aurora/23.073.0/CNDA/oneapi/vtune/2023.0.0_624810_nda/bin64:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/compiler/linux/bin/intel64:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/compiler/linux/bin:/opt/aurora/23.073.0/oneapi/inspector/2023.0.0/bin64:/opt/cray/pe/gcc/11.2.0/snos/bin:/opt/clmgr/sbin:/opt/clmgr/bin:/opt/sgi/sbin:/opt/sgi/bin:/home/foremans/.local/bin:/home/foremans/bin:/usr/local/bin:/usr/bin:/bin:/opt/c3/bin:/usr/lib/mit/bin:/usr/lib/mit/sbin:/opt/pbs/bin:/sbin:/home/foremans/.local/share/kitty-ssh-kitten/kitty/bin:/home/foremans/.cargo/bin:/home/foremans/.fzf/bin:/home/foremans/.luarocks/bin:/home/foremans/.luarocks/bin"</span>,</span>
<span id="cb4-43">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_QUEUE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EarlyAppAccess"</span>,</span>
<span id="cb4-44">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_SHELL"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/bin/zsh"</span>,</span>
<span id="cb4-45">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_SYSTEM"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linux"</span>,</span>
<span id="cb4-46">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_TZ"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"America/Chicago"</span>,</span>
<span id="cb4-47">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_O_WORKDIR"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans"</span>,</span>
<span id="cb4-48">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_QUEUE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LustreApps"</span>,</span>
<span id="cb4-49">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS_TASKNUM"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>,</span>
<span id="cb4-50">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RANK"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb4-51">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SCHEDULER"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS"</span>,</span>
<span id="cb4-52">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_IN_USE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1,</span>
<span id="cb4-53">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_TOTAL"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb4-54">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jobfile_json"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/PBS-jobs/604319/jobenv.json"</span>,</span>
<span id="cb4-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jobfile_sh"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/PBS-jobs/604319/jobenv.sh"</span>,</span>
<span id="cb4-56">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jobfile_yaml"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/PBS-jobs/604319/jobenv.yaml"</span></span>
<span id="cb4-57"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</details>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> ~/PBS-jobs.log<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/jobenv.sh"</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> which launch</span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">launch:</span> aliased to mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span></code></pre></div></details></li>
<li><p><strong>Take 1</strong>: Crash with</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span></code></pre></div>
<details closed="">
<summary>
<p>Run:</p>
</summary>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 pretrain_llama.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> 4096 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> 5504 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> 24 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> 2048 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> 2048 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> 250000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-impl</span> mmap <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> ./tmp/tokenizer.model <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> 949,50,1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> ccl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> 3e-4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> cosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-lr</span> 3e-5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> 0.1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> 2000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optimizer</span> adam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta1</span> 0.9 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta2</span> 0.95 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> 10000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> 1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--attention-dropout</span> 0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> 0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weightss</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglus</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> rmsnorms <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linears</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> 4s <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-45">    hs4096_gb24_mb1/tensorboard <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-timers-to-tensorboard</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-log-interval</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_documents <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--zero-stage</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span></span>
<span id="cb7-54"></span>
<span id="cb7-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Connected</span> to tcp://x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb7-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Found</span> executable /home/foremans/miniconda3/envs/anl_release_q4/bin/python3</span>
<span id="cb7-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> application 2e559157-da5e-4185-9902-dc8d932e8bb3</span>
<span id="cb7-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'If you dont plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb7-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:13,326] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,177] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb7-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,177] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:637:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb7-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,177] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:652:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=3, local_rank=3, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=9, local_rank=9, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=11, local_rank=11, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=1, local_rank=1, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=2, local_rank=2, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=4, local_rank=4, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=5, local_rank=5, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=6, local_rank=6, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=7, local_rank=7, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=13, local_rank=1, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=8, local_rank=8, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=10, local_rank=10, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=0, local_rank=0, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,889] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:668:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb7-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=15, local_rank=3, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=17, local_rank=5, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=19, local_rank=7, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=21, local_rank=9, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=12, local_rank=0, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=14, local_rank=2, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=16, local_rank=4, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=18, local_rank=6, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=20, local_rank=8, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=22, local_rank=10, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:19,888] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:702:mpi_discovery</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Discovered MPI settings of world_rank=23, local_rank=11, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:20]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:257</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> DistInfo={</span>
<span id="cb7-90">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span>,</span>
<span id="cb7-91">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE_ID"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu:0"</span>,</span>
<span id="cb7-92">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DISTRIBUTED_BACKEND"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gloo"</span>,</span>
<span id="cb7-93">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPUS_PER_NODE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 12,</span>
<span id="cb7-94">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTFILE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/var/spool/pbs/aux/604213.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb7-95">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTNAME"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb7-96">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTS"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"['x4502c1s0b0n0', 'x4502c1s3b0n0']"</span>,</span>
<span id="cb7-97">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LOCAL_RANK"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb7-98">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MACHINE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aurora"</span>,</span>
<span id="cb7-99">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NGPUS"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb7-100">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NODE_ID"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb7-101">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUM_NODES"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 2,</span>
<span id="cb7-102">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RANK"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 0,</span>
<span id="cb7-103">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SCHEDULER"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS"</span>,</span>
<span id="cb7-104">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_IN_USE"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24,</span>
<span id="cb7-105">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_TOTAL"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> 24</span>
<span id="cb7-106"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:20,987] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DeepSpeed</span> C++/CUDA extension op report</span>
<span id="cb7-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NOTE:</span> Ops not installed will be just-in-time <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compiled</span> at</span>
<span id="cb7-112">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">runtime</span> if needed. Op compatibility means that your system</span>
<span id="cb7-113">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">meet</span> the required dependencies to JIT install the op.</span>
<span id="cb7-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span> compiled ops requires ninja</span>
<span id="cb7-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ninja</span> .................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb7-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">op</span> name ................ installed .. compatible</span>
<span id="cb7-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb7-120"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:02:20]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">spawn:38</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> icx <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unused-result</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wsign-compare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DNDEBUG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fwrapv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> /tmp/tmph01efr3s/test.c <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> /tmp/tmph01efr3s/test.o</span>
<span id="cb7-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WARNING:</span> TensorBoard writing requested but is not available <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">are</span> you using PyTorch 1.1.0 or later<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> no TensorBoard logs will be written.</span>
<span id="cb7-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122507</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122510</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122515</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122507</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122508</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122509</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122511</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122512</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122513</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122514</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122516</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122517</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">122518</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141071</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141072</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141073</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141075</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141076</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141078</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141079</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-153"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141081</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-154"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141074</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-155"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141077</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-156"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141080</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-157"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141071</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-158"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-159"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141075</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-160"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-161"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141078</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-162"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-163"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141081</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-164"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-165"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141072</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-166"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-167"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141073</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-168"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-169"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141074</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-170"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-171"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141076</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-172"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-173"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141077</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-174"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-175"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141079</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-176"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-177"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:02:21:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">141080</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-178"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-179"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-180"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-181"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-182"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-183"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-184"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-185"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-186"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-187"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-188"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-189"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-190"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-191"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Traceback</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-192">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 583, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb7-193">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model</span> = main<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-194">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 561, in main</span>
<span id="cb7-195">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">model</span> = pretrain<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-196">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/megatron/training.py"</span>, line 136, in pretrain</span>
<span id="cb7-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torch.distributed.all_reduce</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">start_time_tensor,</span></span>
<span id="cb7-198">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/c10d_logger.py"</span>, line 47, in wrapper</span>
<span id="cb7-199">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-200">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py"</span>, line 2050, in all_reduce</span>
<span id="cb7-201">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">work</span> = group.allreduce<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[tensor],</span> opts<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-202"></span>
<span id="cb7-203"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-204"></span>
<span id="cb7-205"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>/details<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div></details></li>
<li><p><strong>Take 2</strong>: Trying with <code>CCL_ZE_IPC_EXCHANGE=sockets</code> (still no luck)</p>
<details closed="">
<summary>
<p>Run:</p>
</summary>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> CCL_ZE_IPC_EXCHANGE=sockets !!</span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[...]</span></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:03:41:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">123335</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb8-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:03:41:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">123330</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sockets</span> exchange mode is set. It may cause potential problem of <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Too many open file descriptors'</span></span>
<span id="cb8-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:03:41:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">123337</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sockets</span> exchange mode is set. It may cause potential problem of <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Too many open file descriptors'</span></span>
<span id="cb8-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2024:01:23-00:03:41:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">123327</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sockets</span> exchange mode is set. It may cause potential problem of <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Too many open file descriptors'</span></span>
<span id="cb8-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[...]</span></span>
<span id="cb8-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span></code></pre></div>
</details></li>
</ul>
</section>
</section>
<section id="using-deepspeed" class="level2">
<h2 class="anchored" data-anchor-id="using-deepspeed">Using <code>deepspeed</code></h2>
<ul>
<li><p>Setup:</p>
<details closed="">
<summary>
<p>Setup:</p>
</summary>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cat <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PBS_NODEFILE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> hostfile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/$/ slots=12/'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> hostfile</span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> echo <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PATH=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> .deepspeed_env <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LD_LIBRARY_PATH=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${LD_LIBRARY_PATH}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> .deepspeed_env <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http_proxy=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${http_proxy}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> .deepspeed_env <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https_proxy=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${https_proxy}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> .deepspeed_env</span></code></pre></div></details></li>
<li><p>Run:</p>
<ul>
<li><p>Command:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> RANK=0 LOCAL_RANK=0 MASTER_ADDR=localhost deepspeed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> hostfile pretrain_llama.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> 4096 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> 5504 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> 250000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-impl</span> mmap <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> ./tmp/tokenizer.model <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> 949,50,1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> ccl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> 3e-4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> cosine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-lr</span> 3e-5 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> 0.1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> 2000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optimizer</span> adam <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta1</span> 0.9 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta2</span> 0.95 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> 10000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> 1000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> 10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--attention-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weights</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglu</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> rmsnorm <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linear</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-timers-to-tensorboard</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_document <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--zero-stage</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span></span></code></pre></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> RANK=0 LOCAL_RANK=0 MASTER_ADDR=localhost deepspeed <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> hostfile pretrain_llama.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> 4096 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> 5504 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> 32 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> 2048 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> 250000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-impl</span> mmap <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> ./tmp/tokenizer.model <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> 949,50,1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> ccl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> 3e-4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> cosine <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-lr</span> 3e-5 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> 0.1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> 2000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optimizer</span> adam <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta1</span> 0.9 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta2</span> 0.95 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> 10000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> 1000 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> 10 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--attention-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weights</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglu</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> rmsnorm <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linear</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> 4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-timers-to-tensorboard</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-log-interval</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_document <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--zero-stage</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span> </span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">home/foremans/miniconda3/envs/anl_release_q4/bin/deepspeed:4:</span> DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span>
<span id="cb11-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">__import__</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pkg_resources'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.require</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'deepspeed==0.12.3+6ea44d02'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'If you dont plan on using image functionality from `torchvision.io`, you can igno re this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb11-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">warn</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">My</span> guessed rank = 0</span>
<span id="cb11-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:09:56,016] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:10:00,790] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">runner.py:463:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Using IP address of 10.115.53.137 for node x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb11-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:10:00,812] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">runner.py:559:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> deepspeed_env file = .deepspeed_env</span>
<span id="cb11-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:10:00,813] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">runner.py:559:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> deepspeed_env file = .deepspeed_env</span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:10:00,813] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">multinode_runner.py:72:get_cmd</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Running on the following workers: x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb11-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2024-01-23</span> 00:10:00,813] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">runner.py:570:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cmd = pdsh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> 1024 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-w</span> x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov export PYTHONSTARTUP=/etc/pythonstart<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PYTHONPATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/l</span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">us/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed:/soft/compilers/oneapi/2023.12.15.001/oneapi/advisor/2024.0/pythonapi</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/u</span>
<span id="cb11-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr/bin:/soft/tools/gpu_validation:/soft/libraries/khronos/clinfo/master-13ae34-2020.12.14/bin:/soft/libraries/intel-compute-samples/2021.27.01:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/compiler/bin:/soft/libraries/intel-gpu-umd</span></span>
<span id="cb11-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/stable_736_25_20231031/driver/bin:/soft/restricted/CNDA/updates/mpich/52.2/mpich-ofi-all-icc-default-pmix-gpu-drop52/bin:/soft/tools/mpi_wrapper_utils:/soft/compilers/oneapi/2023.12.15.001/oneapi/dpcpp-ct/2024.0/bin:/soft/compilers/oneap</span></span>
<span id="cb11-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">i/2023.12.15.001/oneapi/advisor/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/vtune/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/inspector/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/debugger/2024.0/</span></span>
<span id="cb11-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">opt/debugger/bin:/soft/compilers/oneapi/2023.12.15.001/oneapi/mkl/2024.0/bin:/soft/compilers/oneapi/2023.12.15.001/oneapi/compiler/2024.0/bin:/home/foremans/miniconda3/envs/anl_release_q4/bin:/home/foremans/miniconda3/condabin:/home/forem</span></span>
<span id="cb11-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ans/.nvm/versions/node/v21.5.0/bin:/home/foremans/homebrew/bin:/home/foremans/homebrew/sbin:/opt/cray/pals/1.3.2/bin:/opt/cray/libfabric/1.15.2.0/bin:/opt/cray/pe/gcc/11.2.0/snos/bin:/opt/clmgr/sbin:/opt/clmgr/bin:/opt/sgi/sbin:/opt/sgi/b</span></span>
<span id="cb11-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">in:/home/foremans/.local/bin:/home/foremans/bin:/usr/local/bin:/usr/bin:/bin:/opt/c3/bin:/usr/lib/mit/bin:/usr/lib/mit/sbin:/opt/pbs/bin:/sbin:/home/foremans/.local/share/kitty-ssh-kitten/kitty/bin:/home/foremans/.cargo/bin:/home/foremans</span></span>
<span id="cb11-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/.fzf/bin:/home/foremans/.luarocks/bin</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LD_LIBRARY_PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64/dri:/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64/mfx:/home/ftartagl/graphics-c</span>
<span id="cb11-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ompute-runtime/agama-ci-devel-736.9/usr/lib64/intel-opencl:/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64:/soft/libraries/khronos/loader/master-2022.05.18/lib64:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/</span></span>
<span id="cb11-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compiler/lib64:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/driver/lib64/intel-opencl:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/driver/lib64:/soft/restricted/CNDA/updates/mpich/52.2/mpich-ofi-all-icc-default-pmix-gpu-dr</span></span>
<span id="cb11-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">op52/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ipp/2021.10/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ippcp/2021.9/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dpl/2022.3/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/d</span></span>
<span id="cb11-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ebugger/2024.0/opt/debugger/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ccl/2021.11/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dal/2024.0/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dnnl/2024.0/lib:/soft/compilers/oneapi/2</span></span>
<span id="cb11-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">023.12.15.001/oneapi/tbb/2021.11/lib/intel64/gcc4.8:/soft/compilers/oneapi/2023.12.15.001/oneapi/mkl/2024.0/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/compiler/2024.0/opt/compiler/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/com</span></span>
<span id="cb11-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">piler/2024.0/lib:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/pe/gcc/11.2.0/snos/lib64</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">http_proxy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>http://proxy-01.pub.alcf.anl.gov:3128<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">https_proxy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>http://proxy.alcf.anl.gov:3128<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span>  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /lus/gecko/projects/Aurora_deployment/</span>
<span id="cb11-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_release_q4/bin/python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> deepspeed.launcher.launch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--world_info</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>eyJ4NDUwMmMxczBiMG4wLmhvc3RtZ210MjUwMi5jbS5hdXJvcmEuYWxjZi5hbmwuZ292IjogWzAsI</span>
<span id="cb11-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV0sICJ4NDUwMmMxczNiMG4wLmhvc3RtZ210MjUwMi5jbS5hdXJvcmEuYWxjZi5hbmwuZ292IjogWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV19</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--node_rank</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>%n <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--master_addr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>10.115.53.137 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--master_port</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>29500 pre</span>
<span id="cb11-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">train_llama.py</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensor-model-parallel-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pipeline-model-parallel-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-layers</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'32'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'4096'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ffn-hidden-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'5504'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-attention-heads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'32'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--micro-batch-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global-batch-size</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'24'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seq-length</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'20</span></span>
<span id="cb11-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">48'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-position-embeddings</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2048'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--train-iters</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'250000'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1'</span></span>
<span id="cb11-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--load</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-impl</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mmap'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-type</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GPTSentence</span></span>
<span id="cb11-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PieceTokenizer'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tokenizer-model</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./tmp/tokenizer.model'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--split</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'949,50,1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--distributed-backend</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3e-4'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-decay-style</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cosine'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-lr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3e-5'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--weight-decay</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0.1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clip-grad</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lr-warmup-iters</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2000'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--optimizer</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adam</span></span>
<span id="cb11-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0.9'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--adam-beta2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0.95'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-interval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--save-interval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'10000'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-interval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1000'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--eval-iters</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'10'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bf16</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-query-key-layer-scaling</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--attention-dropout</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hidden-dropout</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--use-rotary-position-embeddings</span></span>
<span id="cb11-35"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--untie-embeddings-and-output-weights</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--swiglu</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--normalization</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rmsnorm'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--disable-bias-linear</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--num-key-value-heads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'4'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/ou</span></span>
<span id="cb11-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">tputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--log-timers-to-tensorboard</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tensorboard-log-interval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--data-path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-</span></span>
<span id="cb11-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">DeepSpeed/dataset/BookCorpusDataset_text_document'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vocab-file</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge-file</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/lus/gecko/projects/Aurora_deployment/f</span></span>
<span id="cb11-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">oremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--zero-stage</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed_config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--deepspeed</span></span>
<span id="cb11-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> Warning: Permanently added <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,10.115.53.138'</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ECDSA</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> the list of known hosts.</span>
<span id="cb11-40"></span>
<span id="cb11-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> /home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>If you don<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'t plan on using image functionality from `torchvision.io</span></span>
<span id="cb11-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?</span></span>
<span id="cb11-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:   warn(</span></span>
<span id="cb11-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">x4502c1s3b0n0: /home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: ''If you don'</span>t plan on using image functionality from <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchvision.io</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span>, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">libjpeg</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> or <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">libpng</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> installed before building <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">torchvision</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> from source<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span></span>
<span id="cb11-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   warn<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:07,853] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:145:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> WORLD INFO DICT: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]}</span>
<span id="cb11-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:151:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> nnodes=2, num_local_procs=12, node_rank=0</span>
<span id="cb11-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:162:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> global_rank_mapping=defaultdict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>class <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'list'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>, <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]}<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:163:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> dist_world_size=24</span>
<span id="cb11-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:165:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7,8,9,10,11</span>
<span id="cb11-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:08,885] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:145:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> WORLD INFO DICT: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]}</span>
<span id="cb11-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:151:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> nnodes=2, num_local_procs=12, node_rank=1</span>
<span id="cb11-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:162:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> global_rank_mapping=defaultdict<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>class <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'list'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>, <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]}<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:163:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> dist_world_size=24</span>
<span id="cb11-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">launch.py:165:main</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7,8,9,10,11</span>
<span id="cb11-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 4</span>
<span id="cb11-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 9</span>
<span id="cb11-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 8</span>
<span id="cb11-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 0</span>
<span id="cb11-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 6</span>
<span id="cb11-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 7</span>
<span id="cb11-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 11</span>
<span id="cb11-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 5</span>
<span id="cb11-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 10</span>
<span id="cb11-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 3</span>
<span id="cb11-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 2</span>
<span id="cb11-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> My guessed rank = 1</span>
<span id="cb11-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 21</span>
<span id="cb11-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 18</span>
<span id="cb11-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 22</span>
<span id="cb11-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 20</span>
<span id="cb11-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 14</span>
<span id="cb11-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 12</span>
<span id="cb11-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 23</span>
<span id="cb11-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 16</span>
<span id="cb11-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 17</span>
<span id="cb11-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 19</span>
<span id="cb11-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 15</span>
<span id="cb11-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> My guessed rank = 13</span>
<span id="cb11-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:14,751] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:19,225] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb11-84"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:19,225] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:637:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb11-85"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:20,891] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:668:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb11-86"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist:257</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> DistInfo={</span>
<span id="cb11-87"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu"</span>,</span>
<span id="cb11-88"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEVICE_ID"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpu:0"</span>,</span>
<span id="cb11-89"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DISTRIBUTED_BACKEND"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gloo"</span>,</span>
<span id="cb11-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPUS_PER_NODE"</span>: 12,</span>
<span id="cb11-91"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTFILE"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/var/spool/pbs/aux/604213.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb11-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTNAME"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb11-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HOSTS"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"['x4502c1s0b0n0', 'x4502c1s3b0n0']"</span>,</span>
<span id="cb11-94"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LOCAL_RANK"</span>: 0,</span>
<span id="cb11-95"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MACHINE"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aurora"</span>,</span>
<span id="cb11-96"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NGPUS"</span>: 24,</span>
<span id="cb11-97"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NODE_ID"</span>: 0,</span>
<span id="cb11-98"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NUM_NODES"</span>: 2,</span>
<span id="cb11-99"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RANK"</span>: 0,</span>
<span id="cb11-100"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SCHEDULER"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PBS"</span>,</span>
<span id="cb11-101"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_IN_USE"</span>: 1,</span>
<span id="cb11-102"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WORLD_SIZE_TOTAL"</span>: 24</span>
<span id="cb11-103"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> }</span>
<span id="cb11-104"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:21,533] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">real_accelerator.py:158:get_accelerator</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Setting ds_accelerator to xpu <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auto</span> detect<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-105"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb11-106"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> DeepSpeed C++/CUDA extension op report</span>
<span id="cb11-107"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb11-108"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> NOTE: Ops not installed will be just-in-time <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">JIT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">compiled</span> at</span>
<span id="cb11-109"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>       runtime if needed. Op compatibility means that your system</span>
<span id="cb11-110"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>       meet the required dependencies to JIT install the op.</span>
<span id="cb11-111"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb11-112"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> JIT compiled ops requires ninja</span>
<span id="cb11-113"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> ninja .................. <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">OKAY</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb11-114"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb11-115"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> op name ................ installed .. compatible</span>
<span id="cb11-116"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--------------------------------------------------</span></span>
<span id="cb11-117"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> [2024-01-23 06:10:21]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">spawn:38</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> gcc <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-pthread</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> /home/foremans/miniconda3/envs/anl_release_q4/compiler_compat <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wno-unused-result</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wsign-compare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-DNDEBUG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fwrapv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Wall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fPIC</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> /tmp/tmptqyph55g/test.c <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> /tmp/tmptqyph55g/test.o</span>
<span id="cb11-118"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:21,671] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:161:init_deepspeed_backend</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> Initialize ccl backend</span>
<span id="cb11-119"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> [2024-01-23 06:10:21,672] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">comm.py:637:init_distributed</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> cdb=None</span>
<span id="cb11-120"></span>
<span id="cb11-121"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[...]</span></span>
<span id="cb11-122"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>fused kernel is only supported in cuda, skip loading fused kernel</span>
<span id="cb11-123"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153241</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-124"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153241</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-125"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153241</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-126"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-127"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153242</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-128"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153242</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-129"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153242</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-130"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-131"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> padded vocab <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">size:</span> 50257<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> 47 dummy tokens <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> size: 50304<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-132"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153237</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-133"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153237</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-134"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">153237</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-135"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-136"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> padded vocab <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">size:</span> 50257<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> 47 dummy tokens <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> size: 50304<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-137"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s0b0n0:</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> padded vocab <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">size:</span> 50257<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">with</span> 47 dummy tokens <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">new</span> size: 50304<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-138"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">129554</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_WARN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-139"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> 2024:01:23-06:12:16:<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">129554</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CCL_ERROR</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-140"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-141"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> RuntimeError: oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-142"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span> Traceback <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb11-143"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 583, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb11-144"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>     model = main<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-145"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 561, in main</span>
<span id="cb11-146"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>     model = pretrain<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb11-147"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/megatron/training.py"</span>, line 136, in pretrain</span>
<span id="cb11-148"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>     torch.distributed.all_reduce<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">start_time_tensor,</span></span>
<span id="cb11-149"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/c10d_logger.py"</span>, line 47, in wrapper</span>
<span id="cb11-150"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>     return func<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*args,</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">**</span>kwargs<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-151"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>   File <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py"</span>, line 2050, in all_reduce</span>
<span id="cb11-152"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4502c1s3b0n0:</span>     work = group.allreduce<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[tensor],</span> opts<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div>
</details></li>
</ul></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {Megatron {DeepSpeed} on `Xpu`},
  date = {2024-06-15},
  url = {https://samforeman.me/qmd/aurora-gpt/megatron-ds-intel.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚ÄúMegatron DeepSpeed on `Xpu`.‚Äù</span> June 15,
2024. <a href="https://samforeman.me/qmd/aurora-gpt/megatron-ds-intel.html">https://samforeman.me/qmd/aurora-gpt/megatron-ds-intel.html</a>.
</div></div></section></div> ]]></description>
  <category>ALCF</category>
  <category>AuroraGPT</category>
  <category>Aurora</category>
  <category>Megatron-DeepSpeed</category>
  <category>XPU</category>
  <guid>https://samforeman.me/posts/AuroraGPT/aurora-gpt/</guid>
  <pubDate>Sat, 15 Jun 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üêõ mpi4py bug on Sunspot</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/mpi4py-reproducer/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<p>Simple reproducer:</p>
<ol type="1">
<li><p>Load my <code>anl_24_q2_release</code> conda environment:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#[08:42:38 AM][foremans@x1922c2s3b0n0][~]</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> eval <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">~/miniconda3/bin/conda</span> shell.zsh hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate anl_24_q2_release</span></code></pre></div></li>
<li><p>Try <code>python3 -c 'from mpi4py import MPI'</code></p>
<ul>
<li>fails ‚ùå</li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:44:41 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI'</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Traceback</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">most</span> recent call last<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb2-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">File</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;string&gt;"</span>, line 1, in <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>module<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ImportError:</span> /home/foremans/miniconda3/envs/anl_24_q2_release/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so: undefined symbol: MPI_Message_c2f</span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[1]</span>    14910 exit 1     python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI'</span></span></code></pre></div></li>
<li><p>Load correct modules:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:44:58 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use /home/ftartagl/graphics-compute-runtime/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load graphics-compute-runtime/agama-ci-devel-803.29 spack-pe-gcc/0.6.1-23.275.2 gcc/12.2.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> use /soft/preview-modulefiles/24.086.0 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load oneapi/release/2024.04.15.001</span>
<span id="cb3-3">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> agama-ci-devel-803.29 successfully loaded:</span>
<span id="cb3-4">     <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">UMD:</span> graphics-compute-runtime/agama-ci-devel-803.29</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Due</span> to MODULEPATH changes, the following have been reloaded:</span>
<span id="cb3-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich-config/collective-tuning/1024</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">The</span> following have been reloaded with a version change:</span>
<span id="cb3-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">intel_compute_runtime/release/agama-devel-736.25</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> intel_compute_runtime/release/775.20     2<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpich/icc-all-pmix-gpu/52.2</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> mpich/icc-all-pmix-gpu/20231026     3<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">oneapi/eng-compiler/2023.12.15.002</span> =<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> oneapi/release/2024.04.15.001</span></code></pre></div></li>
<li><p>Retry with new modules:</p>
<ul>
<li>works ‚úÖ</li>
</ul>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># [08:45:01 AM][foremans@x1922c2s3b0n0][~][anl_24_q2_release]</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from mpi4py import MPI; print(MPI.__file__)'</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/foremans/miniconda3/envs/anl_24_q2_release/lib/python3.9/site-packages/mpi4py/MPI.cpython-39-x86_64-linux-gnu.so</span></span></code></pre></div></li>
</ol>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {üêõ `Mpi4py` Bug on {Sunspot}},
  date = {2024-05-25},
  url = {https://samforeman.me/posts/AuroraGPT/mpi4py-reproducer/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüêõ `Mpi4py` Bug on Sunspot.‚Äù</span> May 25,
2024. <a href="https://samforeman.me/posts/AuroraGPT/mpi4py-reproducer/">https://samforeman.me/posts/AuroraGPT/mpi4py-reproducer/</a>.
</div></div></section></div> ]]></description>
  <category>AuroraGPT</category>
  <guid>https://samforeman.me/posts/AuroraGPT/mpi4py-reproducer/</guid>
  <pubDate>Sat, 25 May 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>üé≤ MCMC + Diffusion Sampling</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/ai-for-physics/diffusion/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<section id="denoising-diffusion-probabilistic-models" class="level2">
<h2 class="anchored" data-anchor-id="denoising-diffusion-probabilistic-models">Denoising Diffusion Probabilistic Models</h2>
</section>
<section id="imports--setup" class="level2">
<h2 class="anchored" data-anchor-id="imports--setup">Imports / Setup</h2>
<div id="f924fcb4-d11e-44c4-acc5-caf9f50ea803" class="cell code" data-execution_count="1" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:25.674067Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:25.673461Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:26.976641Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:26.976187Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:25.674029Z&quot;}" data-jukit_cell_id="ZlqRKELWeh">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> __future__ <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> absolute_import, print_function, annotations, division</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dataclasses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dataclass</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scipy</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> random <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> randrange</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span></code></pre></div>
</div>
<div id="707c54d9-1cee-4452-a9e8-beab67f6bb5e" class="cell code" data-execution_count="2" data-execution="{'iopub.execute_input':'2023-09-21T17:23:27.398552Z','iopub.status.busy':'2023-09-21T17:23:27.398037Z','iopub.status.idle':'2023-09-21T17:23:29.370420Z','shell.execute_reply':'2023-09-21T17:23:29.370048Z','shell.execute_reply.started':'2023-09-21T17:23:27.398512Z'}">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ezpz.dist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> setup_torch</span>
<span id="cb2-2"></span>
<span id="cb2-3">port <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6000</span>)</span>
<span id="cb2-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Using port: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>port<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6">RANK <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> setup_torch(</span>
<span id="cb2-7">    backend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb2-8">    port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>port<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-9">)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Using port: 5561

Using DDP for distributed training

Global Rank: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span> <span style="color: #800080; text-decoration-color: #800080">/</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
</pre>
</div>
<div id="b55dfeab-27a1-4322-af80-44380adbaadf" class="cell code" data-execution_count="3" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:29.371628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:29.371422Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:30.756041Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:30.755862Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:29.371616Z&quot;}" data-jukit_cell_id="ZlqRKELWeh">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib_inline</span>
<span id="cb3-3">matplotlib_inline.backend_inline.set_matplotlib_formats(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'svg'</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.main <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> build_experiment</span>
<span id="cb3-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.rich <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_console</span>
<span id="cb3-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.plot_helpers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_plot_style</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> opinionated</span>
<span id="cb3-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PureMH, MH_Diffusion</span>
<span id="cb3-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.utils.plot_helpers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> set_plot_style</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pandas.io.formats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> style</span>
<span id="cb3-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scipy</span>
<span id="cb3-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb3-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> random <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> randrange</span>
<span id="cb3-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PureMH, MH_Diffusion</span>
<span id="cb3-18"></span>
<span id="cb3-19">set_plot_style()</span>
<span id="cb3-20">console <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_console()</span>
<span id="cb3-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(console.is_jupyter)</span>
<span id="cb3-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> console.is_jupyter:</span>
<span id="cb3-23">    console.is_jupyter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb3-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(console.is_jupyter)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Using device: cpu
Failed to download font: Source Sans Pro, skipping!
Failed to download font: Titillium WebRoboto Condensed, skipping!
True
False
</pre>
</div>
<div id="a6523472-488a-49e9-bfd6-6ca8fb953650" class="cell code" data-execution_count="5" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:30.954621Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:30.954289Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:31.061599Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:31.058688Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:30.954598Z&quot;}">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1">plt.style.use(opinionated.STYLES[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'opinionated_min'</span>])</span>
<span id="cb4-2">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span></code></pre></div>
</div>
</section>
<div id="3c521572" class="cell markdown">
<section id="2d-u1" class="level2">
<h2 class="anchored" data-anchor-id="2d-u1">2D <img src="https://latex.codecogs.com/png.latex?U(1)"></h2>
</section>
</div>
<div id="b853ba57" class="cell code" data-execution_count="6" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:46.575842Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:46.575002Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:46.644400Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:46.644215Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:46.575810Z&quot;}" data-jukit_cell_id="x8zCEYjYIg">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.configs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dict_to_list_of_overrides</span>
<span id="cb5-2"></span>
<span id="cb5-3">seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb5-4">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"seed = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>seed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6">overrides <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb5-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>seed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"float32"</span>,</span>
<span id="cb5-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_wandb"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"init_aim"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dynamics"</span>: {</span>
<span id="cb5-13">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latvolume"</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>],</span>
<span id="cb5-14">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nleapfrog"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb5-15">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nchains"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb5-16">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eps"</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,</span>
<span id="cb5-17">    },</span>
<span id="cb5-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"network"</span>: {</span>
<span id="cb5-19">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_batch_norm"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-20">    },</span>
<span id="cb5-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'annealing_schedule'</span>: {</span>
<span id="cb5-22">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta_init'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb5-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta_final'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb5-24">    },</span>
<span id="cb5-25"></span>
<span id="cb5-26">}</span>
<span id="cb5-27">OVERRIDES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dict_to_list_of_overrides(overrides)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<p>seed = 1675333995</p>
</div>
<div id="5ae7bc5d" class="cell code" data-execution_count="7" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:53.284515Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:53.284077Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:23:53.362789Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:23:53.362643Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:53.284485Z&quot;}" data-jukit_cell_id="iKzpP0xANE">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_timestamp</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> enrich.console <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> get_theme, Console</span>
<span id="cb6-4">console <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Console(theme<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_theme())</span>
<span id="cb6-5"></span>
<span id="cb6-6">OUTDIR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(</span>
<span id="cb6-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'l2hmc-diffusion-2dU1'</span></span>
<span id="cb6-8">).joinpath(get_timestamp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>))</span>
<span id="cb6-9">OUTDIR.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb6-10">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"OUTDIR: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>OUTDIR<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-11"></span>
<span id="cb6-12">date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_timestamp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%Y-%m-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb6-13">PLOTS_DIR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OUTDIR.joinpath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plots'</span>)</span>
<span id="cb6-14">PLOTS_DIR.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb6-15">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving figures to: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>PLOTS_DIR<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">OUTDIR: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>
Saving figures to: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>/plots
</pre>
</div>
<div id="4ca95dea" class="cell code" data-execution_count="8" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:23:55.013350Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:23:55.012634Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:24:09.645580Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:24:09.645178Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:23:55.013316Z&quot;}" data-jukit_cell_id="lHICETmP7j">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#os.environ['MASTER_PORT'] = '5436'</span></span>
<span id="cb7-2"></span>
<span id="cb7-3">exp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> build_experiment(</span>
<span id="cb7-4">    overrides<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb7-5">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>OVERRIDES,</span>
<span id="cb7-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'framework=pytorch'</span>,</span>
<span id="cb7-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'backend=DDP'</span></span>
<span id="cb7-8">    ]</span>
<span id="cb7-9">)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal; margin-bottom:0;">[09/21/23 12:23:55][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:23:55][INFO][dist.py:338] - Global Rank: 0 / 0
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/train
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/eval
[09/21/23 12:23:58][INFO][experiment.py:251] - Creating outputs/2023-09-21-122358/pytorch/hmc
[09/21/23 12:23:58][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:23:58][INFO][dist.py:226] - Caught MASTER_PORT:5561 from environment!
[09/21/23 12:24:06][INFO][trainer.py:441] - Looking for checkpoints in:
 /Users/samforeman/projects/saforem2/l2hmc-qcd/src/l2hmc/checkpoints/U1/2-32-32/nlf-10/xsplit-True/sepnets-True/merge-True/conv-8-16-32-64-128_5-3-3-3-2_2-2-2-2-2/net-16-16-16-16_dp-0.2_bn-False/pytorch
[09/21/23 12:24:06][WARNING][trainer.py:437] - No checkpoints found to load from
[09/21/23 12:24:06][WARNING][trainer.py:437] - Restoring global step from ckpt! self._gstep: 0
[09/21/23 12:24:06][WARNING][trainer.py:437] - Using `torch.optim.Adam` optimizer
[09/21/23 12:24:06][INFO][trainer.py:284] - num_params in model: 958628260
[09/21/23 12:24:09][WARNING][trainer.py:250] - logging with freq 50 for wandb.watch
</pre>
</div>
<div id="de33e6c7" class="cell code" data-execution_count="10" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:24:11.069316Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:24:11.067417Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:24:11.148435Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:24:11.148240Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:24:11.069247Z&quot;}" data-jukit_cell_id="9XP3KbsEEH">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1">state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>)</span>
<span id="cb8-2">xdim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.x.flatten().shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb8-3"></span>
<span id="cb8-4">dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xdim</span>
<span id="cb8-5">low_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.ones(dim)</span>
<span id="cb8-6">high_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.ones(dim)</span>
<span id="cb8-7">sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span></span>
<span id="cb8-8">retrains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb8-9">samples_per_retrain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb8-10">diffusion_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span></code></pre></div>
</div>
<div id="292fced2" class="cell code" data-execution_count="11" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:24:21.526369Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:24:21.525718Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:25:01.413937Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:25:01.413545Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:24:21.526320Z&quot;}" data-jukit_cell_id="KCwuqXXGds" data-scrolled="true">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb9-4">outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>(</span>
<span id="cb9-5">    job_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>,</span>
<span id="cb9-6">    beta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb9-7">    nprint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb9-8">    nchains<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb9-9">    eval_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb9-10">)</span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#hdset = exp.save_dataset(job_type='hmc', nchains=1)</span></span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;">[09/21/23 12:24:21][WARNING][trainer.py:437] - Step size `eps` not specified for HMC! Using default: 0.1000 for generic HMC
[09/21/23 12:24:21][WARNING][trainer.py:437] - x.shape (original): torch.Size([16, 2, 32, 32])
[09/21/23 12:24:21][WARNING][trainer.py:437] - x[:nchains].shape: torch.Size([16, 2, 32, 32])
[09/21/23 12:24:21][INFO][trainer.py:1058] - eps=0.1
beta=6.0
nlog=10
table=<rich.table.table object="" at="" 0x2e1b98520="">
nprint=100
eval_steps=1000
nleapfrog=20


[09/21/23 12:24:24][INFO][trainer.py:1188] - hstep=0 dt=0.024 beta=6.000 loss=3.410 dQsin=0.125 dQint=0.000 energy=1586.502 logprob=1586.502 logdet=0.000 acc=0.472 sumlogdet=0.000 acc_mask=0.500 plaqs=0.909 intQ=0.000 sinQ=0.051
[09/21/23 12:24:27][INFO][trainer.py:1188] - hstep=100 dt=0.026 beta=6.000 loss=2.876 dQsin=0.163 dQint=0.000 energy=1555.800 logprob=1555.800 logdet=0.000 acc=0.593 sumlogdet=0.000 acc_mask=0.688 plaqs=0.912 intQ=-0.125 sinQ=-0.159
[09/21/23 12:24:31][INFO][trainer.py:1188] - hstep=200 dt=0.025 beta=6.000 loss=4.678 dQsin=0.088 dQint=0.063 energy=1569.994 logprob=1569.994 logdet=0.000 acc=0.451 sumlogdet=0.000 acc_mask=0.250 plaqs=0.912 intQ=-0.187 sinQ=-0.149
[09/21/23 12:24:34][INFO][trainer.py:1188] - hstep=300 dt=0.024 beta=6.000 loss=14.041 dQsin=0.094 dQint=0.000 energy=1554.118 logprob=1554.118 logdet=0.000 acc=0.438 sumlogdet=0.000 acc_mask=0.438 plaqs=0.914 intQ=-0.125 sinQ=-0.114
[09/21/23 12:24:38][INFO][trainer.py:1188] - hstep=400 dt=0.024 beta=6.000 loss=-0.739 dQsin=0.199 dQint=0.000 energy=1566.516 logprob=1566.516 logdet=0.000 acc=0.509 sumlogdet=0.000 acc_mask=0.562 plaqs=0.912 intQ=-0.437 sinQ=-0.452
[09/21/23 12:24:41][INFO][trainer.py:1188] - hstep=500 dt=0.045 beta=6.000 loss=1.545 dQsin=0.100 dQint=0.000 energy=1570.837 logprob=1570.837 logdet=0.000 acc=0.448 sumlogdet=0.000 acc_mask=0.562 plaqs=0.911 intQ=0.125 sinQ=0.189
[09/21/23 12:24:45][INFO][trainer.py:1188] - hstep=600 dt=0.025 beta=6.000 loss=3.780 dQsin=0.094 dQint=0.000 energy=1568.012 logprob=1568.012 logdet=0.000 acc=0.463 sumlogdet=0.000 acc_mask=0.500 plaqs=0.913 intQ=0.438 sinQ=0.466
[09/21/23 12:24:50][INFO][trainer.py:1188] - hstep=700 dt=0.023 beta=6.000 loss=-0.902 dQsin=0.113 dQint=0.000 energy=1563.778 logprob=1563.778 logdet=0.000 acc=0.475 sumlogdet=0.000 acc_mask=0.375 plaqs=0.913 intQ=0.688 sinQ=0.628
[09/21/23 12:24:53][INFO][trainer.py:1188] - hstep=800 dt=0.024 beta=6.000 loss=11.416 dQsin=0.061 dQint=0.000 energy=1561.427 logprob=1561.427 logdet=0.000 acc=0.339 sumlogdet=0.000 acc_mask=0.438 plaqs=0.913 intQ=0.813 sinQ=0.755
[09/21/23 12:24:57][INFO][trainer.py:1188] - hstep=900 dt=0.028 beta=6.000 loss=1.114 dQsin=0.127 dQint=0.000 energy=1564.465 logprob=1564.465 logdet=0.000 acc=0.699 sumlogdet=0.000 acc_mask=0.625 plaqs=0.913 intQ=0.938 sinQ=0.893
</rich.table.table></pre>
<div>
<figure class="figure">
<p><a href="assets/diffusion/4291d2280ebb3b7d7fd410b6fbd5a7999b28d1e6.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/4291d2280ebb3b7d7fd410b6fbd5a7999b28d1e6.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="a62b5515-1fbe-4a78-9330-a4e675adc55d" class="cell code" data-execution_count="12" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:25:05.409303Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:25:05.408268Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:25:33.378971Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:25:33.378687Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:25:05.409256Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># %matplotlib inline</span></span>
<span id="cb10-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plot_dataset</span>
<span id="cb10-3">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb10-4">hdataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'history'</span>].get_dataset()</span>
<span id="cb10-5">plot_dataset(hdataset, outdir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PLOTS_DIR, job_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal; margin-bottom:0; margin-bottom: 0;">[09/21/23 12:25:06][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/energy_ridgeplot.svg
[09/21/23 12:25:09][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/logprob_ridgeplot.svg
[09/21/23 12:25:11][INFO][plot_helpers.py:1049] - Saving figure to: l2hmc-diffusion-2dU1/2023-09-21/plots/ridgeplots/svgs/logdet_ridgeplot.svg
</pre>
<div>
<figure class="figure">
<p><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/68eb7a87933506e4ea9f017913c8f1eb3d474f82.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/91f9822f7846afea800b646ef6d7f00adbe10a41.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/c51d8b2dcc6ec0e2de63ff069d3730bb571457b0.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/f4712af7b26ced3d77075d986993d9ed41e01438.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/52754b8f1d67eb90a526f91bf820f0ab6f00f3e6.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/150b885c11a3eb085ac620b73b278b467bf2accf.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/eee837b584211a155df0693c80ab0f74ef3df2d9.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/d7f0c56ea62b31af4a43a53d6eb9d0e46a0d0979.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/79d781dfd4250c92dd76a8d8d3185ef5f4bf0edb.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/ba6c79eb08e2df2807d207201f4260fcfb41a55d.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/be9f0e6e22b1f8d41ba35ef1c2e7c53026cdd606.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/acbf03bb04c361e167eefed84a13de13ef8ee37c.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/c919c93d92e6aec85e840c2ad8cb47eb30a8b015.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/7e5ffe849dbd6a7b8314042e953d762ab9e4286b.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/713d68e5d1fdd22fb92855cc3e25255035f0770c.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/368f5610bb37915389764b0b7392edd577eaf415.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/86fc3f47b8b4020e2b94ff74e79fdb3558c43f80.svg" class="img-fluid figure-img"> <img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/835139501cc9fcf6442be81e0033045b8f33ae74.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div id="80a4cca0-19fd-43aa-83a5-8bd9c18da011" class="cell code" data-execution_count="13" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:26:40.599785Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:26:40.598293Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:07.102561Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:07.101951Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:26:40.599694Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb11-2"></span>
<span id="cb11-3">initial_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb11-4">state_init <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>)</span>
<span id="cb11-5">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state_init.x</span>
<span id="cb11-6">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state_init.beta</span>
<span id="cb11-7"></span>
<span id="cb11-8">NSAMPLES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb11-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(NSAMPLES <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> NSAMPLES)):</span>
<span id="cb11-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb11-11">        console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"step: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb11-12">    x, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((x, beta))</span>
<span id="cb11-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> NSAMPLES)):</span>
<span id="cb11-14">        initial_states.append(x)</span>
<span id="cb11-15"></span>
<span id="cb11-16">initial_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(initial_states).squeeze()</span>
<span id="cb11-17">initial_states_np <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.detach().cpu().numpy()</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">step: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">100</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">200</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">300</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">400</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">500</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">600</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">700</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">800</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">900</span>
step: <span style="color: #2094f3; text-decoration-color: #2094f3">1000</span>
</pre>
</div>
<div id="b3874832-0782-4b49-a025-742be370675d" class="cell code" data-execution_count="14" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:27:37.023220Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:27:37.022568Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:37.170197Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:37.169976Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:27:37.023184Z&quot;}">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1">initial_states_np.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="14">
<pre><code>(999, 16, 2048)</code></pre>
</div>
<div id="46eea215-ac24-46ed-b334-648ab0f082b0" class="cell code" data-execution_count="15" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:27:45.524060Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:27:45.523874Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:27:45.610750Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:27:45.610562Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:27:45.524045Z&quot;}">
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1">x_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states_np.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb14-2">tmp_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ...]</span>
<span id="cb14-3">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>x_<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb14-4">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tmp_<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="font-weight: bold">(</span><span style="color: #2094f3; text-decoration-color: #2094f3">999</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #2094f3; text-decoration-color: #2094f3">999</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">)</span>
</pre>
</div>
<div id="00862566-256a-4e1b-b96f-b289e146ed65" class="cell code" data-execution_count="16" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:28:23.005041Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:28:23.004835Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:28:41.019060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:28:41.018864Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:28:23.005025Z&quot;}">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> savefig</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#x_ = initial_states_np[:100].reshape(-1, 2, 32, 32)</span></span>
<span id="cb15-4">tmp_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ...]</span>
<span id="cb15-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb15-6">sns.kdeplot(</span>
<span id="cb15-7">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tmp_[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].flatten(),</span>
<span id="cb15-8">    y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tmp_[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].flatten(),</span>
<span id="cb15-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax=ax,</span></span>
<span id="cb15-10">    cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>,</span>
<span id="cb15-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax=axes[0],</span></span>
<span id="cb15-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cmap="Blues",</span></span>
<span id="cb15-13">    shade<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb15-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bw_adjust=0.5,</span></span>
<span id="cb15-15">    thresh<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb15-16">)</span>
<span id="cb15-17">ax.set_xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb15-18">ax.set_ylim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb15-19">savefig(</span>
<span id="cb15-20">    <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'hmc_samples-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>NSAMPLES<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>,</span>
<span id="cb15-21">    Path(PLOTS_DIR),</span>
<span id="cb15-22">    tstamp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb15-23">)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre><code>Saving hmc_samples-1000-2023-09-21-122840 to l2hmc-diffusion-2dU1/2023-09-21/plots</code></pre>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/70234c6bf6df3cbd32f9de96e36e740eda0ed20d.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/70234c6bf6df3cbd32f9de96e36e740eda0ed20d.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="544a477a-05cd-4e1f-b11f-5f9d29c61918" class="cell code" data-execution_count="28" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:03:31.911850Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:03:31.910702Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:03:32.065942Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:03:32.065721Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:03:31.911790Z&quot;}">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Diffusion:</span>
<span id="cb17-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb17-3">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb17-4">            noise_steps: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb17-5">            beta_start: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>,</span>
<span id="cb17-6">            beta_end: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>,</span>
<span id="cb17-7">            nchannels: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb17-8">            img_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,</span>
<span id="cb17-9">            device: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span></span>
<span id="cb17-10">    ):</span>
<span id="cb17-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_steps</span>
<span id="cb17-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta_start</span>
<span id="cb17-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta_end</span>
<span id="cb17-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> img_size</span>
<span id="cb17-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> device</span>
<span id="cb17-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.nchannels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nchannels</span>
<span id="cb17-17"></span>
<span id="cb17-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.prepare_noise_schedule().to(device)</span>
<span id="cb17-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta</span>
<span id="cb17-20">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cumprod(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb17-21"></span>
<span id="cb17-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> prepare_noise_schedule(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb17-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.linspace(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_start, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta_end, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps)</span>
<span id="cb17-24"></span>
<span id="cb17-25">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> noise_images(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, x, t):</span>
<span id="cb17-26">        sqrt_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t])[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb17-27">        sqrt_one_minus_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(</span>
<span id="cb17-28">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t]</span>
<span id="cb17-29">        )[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb17-30">        eps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(x)</span>
<span id="cb17-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> sqrt_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sqrt_one_minus_alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> eps, eps</span>
<span id="cb17-32"></span>
<span id="cb17-33">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> sample_timesteps(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n):</span>
<span id="cb17-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.randint(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n,))</span>
<span id="cb17-35"></span>
<span id="cb17-36">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> sample(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, model, n):</span>
<span id="cb17-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># console.print(f"Sampling {n} new images....")</span></span>
<span id="cb17-38">        model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb17-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb17-40">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(</span>
<span id="cb17-41">                (n, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.nchannels, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.img_size)</span>
<span id="cb17-42">            ).to(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device)</span>
<span id="cb17-43">            sample_bar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(</span>
<span id="cb17-44">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">reversed</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps)),</span>
<span id="cb17-45">                position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb17-46">                total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.noise_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb17-47">                dynamic_ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb17-48">            )</span>
<span id="cb17-49">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sample_bar:</span>
<span id="cb17-50">                t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (torch.ones(n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> i).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>().to(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.device)</span>
<span id="cb17-51">                predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x, t)</span>
<span id="cb17-52">                alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb17-53">                alpha_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.alpha_hat[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb17-54">                beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta[t][:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb17-55">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb17-56">                    noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn_like(x)</span>
<span id="cb17-57">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb17-58">                    noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros_like(x)</span>
<span id="cb17-59">                x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb17-60">                    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> torch.sqrt(alpha))</span>
<span id="cb17-61">                    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (</span>
<span id="cb17-62">                        x </span>
<span id="cb17-63">                        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (torch.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha_hat)))</span>
<span id="cb17-64">                        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> predicted_noise</span>
<span id="cb17-65">                    ) </span>
<span id="cb17-66">                    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (torch.sqrt(beta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> noise)</span>
<span id="cb17-67">                )</span>
<span id="cb17-68">        model.train()</span>
<span id="cb17-69">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.pi</span>
<span id="cb17-70">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x</span></code></pre></div>
</div>
<div id="f49c6213-2274-45e5-bc10-01a46e19d7c6" class="cell code" data-execution_count="29" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:03:32.936448Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:03:32.936214Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:03:33.006979Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:03:33.006767Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:03:32.936420Z&quot;}">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1">initial_states.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="29">
<pre><code>torch.Size([999, 16, 2048])</code></pre>
</div>
<div id="dcfb6322-b8d5-4f4a-8c74-6a9e1f9eb2c3" class="cell markdown">
<section id="train-diffusion-model" class="level2">
<h2 class="anchored" data-anchor-id="train-diffusion-model">Train Diffusion Model</h2>
</section>
</div>
<div id="24658ef0-6421-465a-aee3-45cbaa84fe16" class="cell code" data-execution_count="19" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:05.270957Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:05.270198Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:29:05.643233Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:29:05.643039Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:05.270924Z&quot;}">
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision</span>
<span id="cb20-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb20-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb20-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb20-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb20-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision</span>
<span id="cb20-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> T</span>
<span id="cb20-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb20-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb20-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#from fastdownload import FastDownload</span></span>
<span id="cb20-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb20-12"></span>
<span id="cb20-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> save_images(images, path, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb20-14">    grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torchvision.utils.make_grid(images, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span>
<span id="cb20-15">    ndarr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid.permute(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>).numpy()</span>
<span id="cb20-16">    im <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Image.fromarray(ndarr)</span>
<span id="cb20-17">    im.save(path)</span></code></pre></div>
</div>
<div id="bf6c6419-6d67-4e82-800f-19b896dc6a1b" class="cell markdown">
<section id="build-diffusion-model-with-unet-architecure" class="level2">
<h2 class="anchored" data-anchor-id="build-diffusion-model-with-unet-architecure">Build Diffusion Model with UNet Architecure</h2>
</section>
</div>
<div id="d7adbbf1-9a17-459c-ba2b-144605576790" class="cell code" data-execution_count="20" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:33.246111Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:33.245275Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:29:33.647190Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:29:33.646950Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:33.246094Z&quot;}">
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nn</span>
<span id="cb21-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> optim</span>
<span id="cb21-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn.functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> F</span>
<span id="cb21-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tqdm.auto <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm</span>
<span id="cb21-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="cb21-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TensorDataset</span>
<span id="cb21-7"></span>
<span id="cb21-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> savefig</span>
<span id="cb21-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion.modules <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> NoiseScheduler, UNet</span>
<span id="cb21-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.diffusion <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ddpm</span>
<span id="cb21-11"></span>
<span id="cb21-12">DEVICE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span></span>
<span id="cb21-13"></span>
<span id="cb21-14">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb21-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channels_in'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb21-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'channels_out'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb21-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'train_batch_size'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb21-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>,</span>
<span id="cb21-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb21-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'noise_steps'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb21-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,</span>
<span id="cb21-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img_size'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb21-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'retrains'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb21-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'samples_per_retrain'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb21-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion_prob'</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb21-26">}</span>
<span id="cb21-27"></span>
<span id="cb21-28">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> UNet(c_in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, c_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb21-29"></span>
<span id="cb21-30">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>))</span>
<span id="cb21-31">dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(</span>
<span id="cb21-32">    dataset,</span>
<span id="cb21-33">    batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>],</span>
<span id="cb21-34">    shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb21-35">    drop_last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb21-36">)</span>
<span id="cb21-37"></span>
<span id="cb21-38"></span>
<span id="cb21-39">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> optim.AdamW(model.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'learning_rate'</span>])</span>
<span id="cb21-40">mse <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.MSELoss()</span>
<span id="cb21-41">diffusion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Diffusion(</span>
<span id="cb21-42">    noise_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb21-43">    img_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb21-44">    device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>DEVICE,</span>
<span id="cb21-45">    nchannels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb21-46">)</span>
<span id="cb21-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#logger = SummaryWriter(os.path.join("runs", args.run_name))</span></span>
<span id="cb21-48">l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span>
<span id="cb21-49"></span>
<span id="cb21-50">run_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion2dU1'</span></span></code></pre></div>
</div>
<div id="5aed3b53-6261-4e0c-938d-07b0616d0a44" class="cell markdown">
<section id="perform-initial-training-on-hmc-samples" class="level3">
<h3 class="anchored" data-anchor-id="perform-initial-training-on-hmc-samples">Perform initial training on HMC samples</h3>
</section>
</div>
<div id="27fcd372-259b-4be5-830d-167a396aeac1" class="cell code" data-execution_count="21" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T17:29:54.637896Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T17:29:54.634898Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T17:45:06.940844Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T17:45:06.940627Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T17:29:54.637847Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> optim</span>
<span id="cb22-2">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#dataloader = get_data(args)</span></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#model = UNet().to(device)</span></span>
<span id="cb22-5"></span>
<span id="cb22-6">sampled_images_history <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb22-7"></span>
<span id="cb22-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num_epochs'</span>]):</span>
<span id="cb22-9">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Starting epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:"</span>)</span>
<span id="cb22-10">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(dataloader)</span>
<span id="cb22-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, images <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(pbar):</span>
<span id="cb22-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(images, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(images) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb22-13">            images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb22-14">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb22-15">        x_t, noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.noise_images(images, t)</span>
<span id="cb22-16">        predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x_t, t)</span>
<span id="cb22-17">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mse(noise, predicted_noise)</span>
<span id="cb22-18"></span>
<span id="cb22-19">        optimizer.zero_grad()</span>
<span id="cb22-20">        loss.backward()</span>
<span id="cb22-21">        optimizer.step()</span>
<span id="cb22-22"></span>
<span id="cb22-23">        pbar.set_postfix({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'epoch'</span>: epoch, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'batch'</span>: i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MSE'</span>: loss.item()})</span>
<span id="cb22-24">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'epoch: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb22-25">    sampled_images <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample(model, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb22-26">    sampled_images_history.append(sampled_images)</span>
<span id="cb22-27">    sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb22-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#tmp = initial_states.reshape(-1, 2, 32, 32)</span></span>
<span id="cb22-29">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb22-30">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(sampled_images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :, :])</span>
<span id="cb22-31">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(sampled_images[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :, :])</span>
<span id="cb22-32">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb22-33">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb22-34">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb22-35">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb22-36">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb22-37">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb22-38">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb22-39">    plt.show()</span>
<span id="cb22-40">    savefig(fname<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sampled_image_epoch</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, outdir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PLOTS_DIR, tstamp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb22-41">    MODEL_FILE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OUTDIR.joinpath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"models"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"unet-diffusion-epoch</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pt"</span>)</span>
<span id="cb22-42">    MODEL_FILE.parent.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, parents<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb22-43">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Saving model checkpoint to: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>MODEL_FILE<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb22-44">    torch.save(model.state_dict(), MODEL_FILE)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Starting epoch <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>:
</pre>
</div>
<div class="output cell-output cell-output-display">
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"19b415c346b24bef8b60336d7f7bc355"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">epoch: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>, loss: <span style="color: #2094f3; text-decoration-color: #2094f3">0.6023472547531128</span>
</pre>
</div>
<div class="output cell-output cell-output-display">
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eea24504754f4cb9ab4d9925a6225c10"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/e90001ab4bbbe38f50cca429a69bc2b212ed8a4d.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/e90001ab4bbbe38f50cca429a69bc2b212ed8a4d.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="output cell-output cell-output-display">
<pre><code>Saving sampled_image_epoch0-2023-09-21-124506 to l2hmc-diffusion-2dU1/2023-09-21/plots</code></pre>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Saving model checkpoint to: l2hmc-diffusion-2dU1/<span style="color: #2094f3; text-decoration-color: #2094f3">2023</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">09</span>-<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>/models/unet-diffusion-epoch0.pt
</pre>
</div>
<div class="output cell-output cell-output-display">
<p>&lt;Figure size 640x480 with 0 Axes&gt;</p>
</div>
<div id="c4ae942b-4617-4f1e-a837-68e95d6ddabc" class="cell code" data-execution_count="22" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:01:57.860377Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:01:57.859019Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:01:58.250584Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:01:58.250409Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:01:57.860309Z&quot;}">
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb26-2">tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb26-3">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(tmp[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :, :])</span>
<span id="cb26-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(tmp[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :, :])</span>
<span id="cb26-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb26-7">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb26-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb26-9">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb26-10">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb26-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb26-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/85261feb8c9ba70c38f9f40eb69b7b3bc4c670b0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/85261feb8c9ba70c38f9f40eb69b7b3bc4c670b0.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="2637733d-1da9-42e9-b00f-630b6b5d8269" class="cell code" data-execution_count="23" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:10.910463Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:10.910215Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:10.982520Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:10.982237Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:10.910447Z&quot;}">
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1">sampled_images_history_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(sampled_images_history)</span></code></pre></div>
</div>
<div id="2afaff5c-a946-4080-90d7-bbb1af973ce0" class="cell code" data-execution_count="24" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:11.478836Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:11.478478Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:11.546438Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:11.546257Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:11.478818Z&quot;}">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1">sampled_images_history_.shape</span></code></pre></div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="24">
<pre><code>torch.Size([1, 5, 2, 32, 32])</code></pre>
</div>
</div>
<div id="c9397f4d-fbad-4332-b909-c671469b1f7d" class="cell code" data-execution_count="25" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:13.627514Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:13.627140Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:13.825037Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:13.824814Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:13.627490Z&quot;}">
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1">sns.set_context(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'notebook'</span>)</span>
<span id="cb30-2">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb30-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(sampled_images_history_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb30-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(sampled_images_history_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb30-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xticklabels([])</span>
<span id="cb30-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xticklabels([])</span>
<span id="cb30-7">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_yticklabels([])</span>
<span id="cb30-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_yticklabels([])</span>
<span id="cb30-9">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{0}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb30-10">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb30-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion Samples'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/b2807643bf74b33689a17754209e56554bfe1f52.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/b2807643bf74b33689a17754209e56554bfe1f52.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="70324363-7315-4c3f-9304-24c0509bdd6c" class="cell code" data-execution_count="27" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:02:25.159709Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:02:25.158545Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:02:25.258988Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:02:25.258835Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:02:25.159655Z&quot;}">
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(sampled_images_history_.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]):</span>
<span id="cb31-2">    q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.lattice.charges(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sampled_images_history_[idx])</span>
<span id="cb31-3">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>q<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #2094f3; text-decoration-color: #2094f3">0</span>: <span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">Charges</span><span style="font-weight: bold">(</span><span style="color: #7d8697; text-decoration-color: #7d8697">intQ</span>=<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">tensor</span><span style="font-weight: bold">([</span> <span style="color: #2094f3; text-decoration-color: #2094f3">5.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-6.0000e+00</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.5535e-07</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">1.0000e+00</span><span style="font-weight: bold">])</span>, <span style="color: #7d8697; text-decoration-color: #7d8697">sinQ</span>=<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">tensor</span><span style="font-weight: bold">([</span> <span style="color: #2094f3; text-decoration-color: #2094f3">1.6426</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-1.7244</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">-4.4651</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">0.5680</span>,  <span style="color: #2094f3; text-decoration-color: #2094f3">0.7046</span><span style="font-weight: bold">]))</span>
</pre>
</div>
<div id="e8f0fae1-63eb-4522-8342-2d051f4705c4" class="cell markdown">
<section id="hmc-sampling-with-diffusion" class="level2">
<h2 class="anchored" data-anchor-id="hmc-sampling-with-diffusion">HMC Sampling with Diffusion</h2>
</section>
</div>
<div id="1b571b62-b713-4481-a328-fe3d1bcc0030" class="cell code" data-execution_count="32" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:08:36.186462Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:08:36.185269Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:08:36.391707Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:08:36.391500Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:08:36.186399Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for retrain_iter in range(config['retrains']):</span></span>
<span id="cb32-2">state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.random_state(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb32-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.x</span>
<span id="cb32-4"></span>
<span id="cb32-5">histories <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb32-6">samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb32-7">hmc_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb32-8">diffusion_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb32-9"></span>
<span id="cb32-10">global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb32-11">watcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb32-12">update_types <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb32-13">combined_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span></code></pre></div>
</div>
<div id="4deb9af0-c9ca-4314-a393-7a206c15d1e6" class="cell code" data-execution_count="33" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:08:40.518616Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:08:40.518438Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:08:40.627283Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:08:40.625908Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:08:40.518604Z&quot;}">
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1">global_step</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="33">
<pre><code>0</code></pre>
</div>
<div id="d3d35fc8-5067-4d51-8cc0-8136b34669a3" class="cell code" data-execution_count="35" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:09:58.481960Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:09:58.480609Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:28.387917Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:28.387487Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:09:58.481905Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> retrain_iter <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb35-2">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'retrain_iter: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>retrain_iter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb35-3">    ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb35-4">    ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb35-5">    histories[retrain_iter] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb35-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [],</span>
<span id="cb35-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [],</span>
<span id="cb35-8">    }</span>
<span id="cb35-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for idx in range(config['samples_per_retrain']):</span></span>
<span id="cb35-10">    sbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb35-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sbar:</span>
<span id="cb35-12">        t0_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb35-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb35-14">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sample idx: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb35-15">        rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb35-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (retrain_iter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> diffusion_prob:</span>
<span id="cb35-17">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'rand: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rand<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> &lt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>diffusion_prob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb35-18">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample from diffusion model</span></span>
<span id="cb35-19">            x_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample(model, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb35-20">            ll_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.potential_energy(x_, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb35-21">            ll <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.dynamics.potential_energy(x, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>])</span>
<span id="cb35-22">            ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ll_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ll</span>
<span id="cb35-23">            a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(torch.ones_like(ratio), ratio)</span>
<span id="cb35-24">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(a.shape)</span>
<span id="cb35-25">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#u = np.random.uniform()</span></span>
<span id="cb35-26">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#for jdx in range(u.shape[0]):</span></span>
<span id="cb35-27">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    if u[jdx] &lt; a[jdx]:</span></span>
<span id="cb35-28">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#        samples.append(x_[jdx])</span></span>
<span id="cb35-29">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#        diffusion_samples.append(x_[jdx])</span></span>
<span id="cb35-30">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#x = torch.where((u &lt; a), x_, x.reshape_as(x_)).reshape_as(x)</span></span>
<span id="cb35-31">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.where((u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> a)[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>], x_, x.reshape_as(x_))</span>
<span id="cb35-32">            samples.append(x)</span>
<span id="cb35-33">            diffusion_samples.append(x)</span>
<span id="cb35-34">            combined_samples[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x</span>
<span id="cb35-35">            watcher[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span></span>
<span id="cb35-36">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#diffusion_samples.extend(x)</span></span>
<span id="cb35-37">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#samples.extend(x)</span></span>
<span id="cb35-38">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ndiff_acc += </span></span>
<span id="cb35-39">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#if u &lt; a:</span></span>
<span id="cb35-40">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    console.print('Accepted diffusion sample!')</span></span>
<span id="cb35-41">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    console.print(f'{ndiff_acc} / {ndiff_proposed}')</span></span>
<span id="cb35-42">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    ndiff_acc += 1</span></span>
<span id="cb35-43">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    x = x_</span></span>
<span id="cb35-44">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    diffusion_samples.append(x)</span></span>
<span id="cb35-45">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    samples.append(x)</span></span>
<span id="cb35-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb35-47">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Oherwise, HMC</span></span>
<span id="cb35-48">            x, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((x, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'beta'</span>]))</span>
<span id="cb35-49">            hmc_samples.append(x)</span>
<span id="cb35-50">            samples.append(x)</span>
<span id="cb35-51">            combined_samples[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x</span>
<span id="cb35-52">            watcher[global_step] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span></span>
<span id="cb35-53">        smetrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb35-54">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'idx'</span>: idx,</span>
<span id="cb35-55">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'global_step'</span>: global_step,</span>
<span id="cb35-56">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dt'</span>: time.perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0_,</span>
<span id="cb35-57">        }</span>
<span id="cb35-58">        global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb35-59">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#smetrics |= {</span></span>
<span id="cb35-60">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    f'{k}': {torch.tensor(v).mean().item()} for k, v in metrics.items()</span></span>
<span id="cb35-61">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#}</span></span>
<span id="cb35-62">        sbar.set_postfix(smetrics)</span>
<span id="cb35-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train loop</span></span>
<span id="cb35-64">    dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TensorDataset(</span>
<span id="cb35-65">        torch.stack(hmc_samples).reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb35-66">    )</span>
<span id="cb35-67">    dataloader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(</span>
<span id="cb35-68">        dataset,</span>
<span id="cb35-69">        shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb35-70">        drop_last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb35-71">        batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train_batch_size"</span>],</span>
<span id="cb35-72">    )</span>
<span id="cb35-73">    pbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(dataloader)</span>
<span id="cb35-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(pbar):</span>
<span id="cb35-75">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb35-76">            console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Retraining...'</span>)</span>
<span id="cb35-77">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(batch, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(batch) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb35-78">            batch, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch</span>
<span id="cb35-79">        batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb35-80">        t0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb35-81">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(batch.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb35-82">        x_t, noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.noise_images(batch, t)</span>
<span id="cb35-83">        predicted_noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(x_t, t)</span>
<span id="cb35-84">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mse(noise, predicted_noise)</span>
<span id="cb35-85">        optimizer.zero_grad()</span>
<span id="cb35-86">        loss.backward()</span>
<span id="cb35-87">        optimizer.step()</span>
<span id="cb35-88">        t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb35-89">        pbar.set_postfix(</span>
<span id="cb35-90">            {</span>
<span id="cb35-91">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'global_step'</span>: global_step,</span>
<span id="cb35-92">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'retrain_iter'</span>: retrain_iter,</span>
<span id="cb35-93">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'batch'</span>: i,</span>
<span id="cb35-94">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dt'</span>: t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t0,</span>
<span id="cb35-95">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MSE'</span>: loss.item()</span>
<span id="cb35-96">            }</span>
<span id="cb35-97">        )</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">retrain_iter: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb36-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"17132d7ca8624fa387ee9467e4f1fa4d"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">sample idx: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0ed1080fdebd4f7b9aae80db0d36b96b"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Retraining<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">retrain_iter: <span style="color: #2094f3; text-decoration-color: #2094f3">1</span>
</pre>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d0346019e21b4d2a9b624dc59e84015b"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">sample idx: <span style="color: #2094f3; text-decoration-color: #2094f3">0</span>
</pre>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">rand: <span style="color: #2094f3; text-decoration-color: #2094f3">0.05506106760134255</span> &lt; <span style="color: #2094f3; text-decoration-color: #2094f3">0.1</span>
</pre>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c02b09d53ada46a194a47921f0ab3cba"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">rand: <span style="color: #2094f3; text-decoration-color: #2094f3">0.07860283644524213</span> &lt; <span style="color: #2094f3; text-decoration-color: #2094f3">0.1</span>
</pre>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"184df3f1c9714ece9756866b2617ed02"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"model_id"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eaa0d84229c04618b7a2bffe2a4b1739"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_major"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"version_minor"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;">Retraining<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</pre></div>
<div id="a83cf9fb-9c2c-430e-957a-d42eaed79401" class="cell code" data-execution_count="36" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:32.389697Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:32.389127Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:32.627601Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:32.627412Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:32.389644Z&quot;}" data-scrolled="true">
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>.join([<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> samples[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]]))</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2048</span><span style="font-weight: bold">])</span>
<span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">torch.Size</span><span style="font-weight: bold">([</span><span style="color: #2094f3; text-decoration-color: #2094f3">16</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">2</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span>, <span style="color: #2094f3; text-decoration-color: #2094f3">32</span><span style="font-weight: bold">])</span>
</pre>
</div>
<div id="4b0e9e7c-9585-4f50-81c7-4c9dd37e18ce" class="cell code" data-execution_count="37" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:38.701814Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:38.699745Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:38.789521Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:38.789359Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:38.701745Z&quot;}">
<div class="sourceCode" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1">samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> samples])</span>
<span id="cb43-2">samples_.shape</span></code></pre></div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="37">
<pre><code>torch.Size([30, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="bef6ff41-1561-40ce-980c-29014f7efad5" class="cell code" data-execution_count="38" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:12:40.804170Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:12:40.803208Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:12:40.896475Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:12:40.896319Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:12:40.804119Z&quot;}">
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hmc_samples)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="38">
<pre><code>28</code></pre>
</div>
<div id="a2279e49-e463-4a3a-a08e-14b1a636222f" class="cell code" data-execution_count="41" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:00.841115Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:00.840869Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:00.912440Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:00.912247Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:00.841101Z&quot;}">
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(diffusion_samples)</span></code></pre></div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="41">
<pre><code>2</code></pre>
</div>
</div>
<div id="13d3d5cd-df10-40e0-8dff-b1625a3ead57" class="cell code" data-execution_count="43" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:04.231527Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:04.231202Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:04.328804Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:04.328067Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:04.231509Z&quot;}">
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1">hmc_samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hmc_samples])</span>
<span id="cb49-2">diffusion_samples_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(</span>
<span id="cb49-3">    [i.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> diffusion_samples]</span>
<span id="cb49-4">)</span></code></pre></div>
</div>
<div id="7b58ba9e-4a8d-4cdb-a14e-87695db13ec3" class="cell code" data-execution_count="44" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:04.966106Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:04.965159Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:05.068570Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:05.067781Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:04.966070Z&quot;}">
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1">hmc_samples_.shape</span></code></pre></div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="44">
<pre><code>torch.Size([28, 16, 2, 32, 32])</code></pre>
</div>
</div>
<div id="21c844ca-b9dd-4dd4-96cb-c5bb83ad93b5" class="cell code" data-execution_count="45" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:12.549057Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:12.548060Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:12.726595Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:12.726410Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:12.549036Z&quot;}">
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1">diffusion_samples_.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="45">
<pre><code>torch.Size([2, 16, 2, 32, 32])</code></pre>
</div>
<div id="bee61425-74d1-4faa-9447-ef4c6c71a8ba" class="cell code" data-execution_count="46" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:15.683862Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:15.683665Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:15.753128Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:15.752924Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:15.683847Z&quot;}">
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1">samples_.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="46">
<pre><code>torch.Size([30, 16, 2, 32, 32])</code></pre>
</div>
<div id="c637a290-4dc3-42f6-abeb-ee807b991ffd" class="cell code" data-execution_count="47" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:29.661939Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:29.661388Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:29.751394Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:29.751170Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:29.661915Z&quot;}">
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> calc_plaqs(x):</span>
<span id="cb56-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb56-3">        exp.trainer.lattice.plaqs(</span>
<span id="cb56-4">            x[:, idx]</span>
<span id="cb56-5">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb56-6">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb56-7"></span>
<span id="cb56-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> calc_intQ(x):</span>
<span id="cb56-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb56-10">        exp.trainer.lattice.int_charges(</span>
<span id="cb56-11">            x[:, idx]</span>
<span id="cb56-12">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb56-13">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb56-14">    </span>
<span id="cb56-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> calc_sinQ(x):</span>
<span id="cb56-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.stack([</span>
<span id="cb56-17">        exp.trainer.lattice.sin_charges(</span>
<span id="cb56-18">            x[:, idx]</span>
<span id="cb56-19">        ) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(x.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb56-20">    ], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div id="be21453d-5bd3-4f17-b9eb-294adcdf2e6b" class="cell code" data-execution_count="64" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:17:29.078038Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:17:29.076956Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:17:29.288381Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:17:29.288242Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:17:29.077980Z&quot;}">
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1">samples_init_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, initial_states.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>)</span>
<span id="cb57-2">samples_init_.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="64">
<pre><code>torch.Size([999, 16, 2, 32, 32])</code></pre>
</div>
<div id="8542582c-65ae-40b5-b5b9-70292acc2c81" class="cell code" data-execution_count="65" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:17:43.351050Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:17:43.347957Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:17:43.699383Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:17:43.699177Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:17:43.350913Z&quot;}">
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1">metrics_init_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb59-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(samples_init_),</span>
<span id="cb59-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(samples_init_),</span>
<span id="cb59-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(samples_init_)</span>
<span id="cb59-5">}</span>
<span id="cb59-6">    </span>
<span id="cb59-7">metrics_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb59-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(samples_),</span>
<span id="cb59-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(samples_),</span>
<span id="cb59-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(samples_)</span>
<span id="cb59-11">}</span>
<span id="cb59-12"></span>
<span id="cb59-13">metrics_hmc_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb59-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(hmc_samples_),</span>
<span id="cb59-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(hmc_samples_),</span>
<span id="cb59-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(hmc_samples_)</span>
<span id="cb59-17">}</span>
<span id="cb59-18"></span>
<span id="cb59-19">metrics_diffusion_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb59-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>: calc_plaqs(diffusion_samples_),</span>
<span id="cb59-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>: calc_intQ(diffusion_samples_),</span>
<span id="cb59-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sinQ'</span>: calc_sinQ(diffusion_samples_)</span>
<span id="cb59-23">}</span></code></pre></div>
</div>
<div id="21bfb626-a2c1-46db-8f1a-7eb86d81eafc" class="cell code" data-execution_count="49" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:13:32.364043Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:13:32.363212Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:13:32.470577Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:13:32.470322Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:13:32.364002Z&quot;}">
<div class="sourceCode" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1">metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="49">
<pre><code>torch.Size([30, 16])</code></pre>
</div>
<div id="59f33ef8-cfad-41d5-bfdd-0717c8700376" class="cell code" data-execution_count="52" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:14:16.986650Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:14:16.985673Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:14:17.106591Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:14:17.105464Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:14:16.986586Z&quot;}">
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1">console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>.join([<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k, v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> watcher.items()]))</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;"><span style="color: #2094f3; text-decoration-color: #2094f3">0</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">1</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">2</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">3</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">4</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">5</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">6</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">7</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">8</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">9</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">10</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">11</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">12</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">13</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">14</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">15</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">16</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">17</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">18</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">19</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">20</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">21</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">22</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">23</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">24</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">25</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">26</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">27</span>: diffusion
<span style="color: #2094f3; text-decoration-color: #2094f3">28</span>: HMC
<span style="color: #2094f3; text-decoration-color: #2094f3">29</span>: diffusion
</pre>
</div>
<div id="4e5d7c22-e454-4368-ba7e-599f1d68fa19" class="cell code" data-execution_count="54" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:14:41.427638Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:14:41.427237Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:14:41.629492Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:14:41.629312Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:14:41.427623Z&quot;}">
<div class="sourceCode" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb63-2"></span>
<span id="cb63-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>)</span>
<span id="cb63-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb63-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot(metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb63-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax.plot(metrics_hmc1['plaqs'], label='HMC 1')</span></span>
<span id="cb63-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax.plot(metrics_diff_['plaqs'], label='Diffusion')</span></span>
<span id="cb63-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>, bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>))</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/4509936f2dbb7e69226f3d2851bc462cf8046e8e.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/4509936f2dbb7e69226f3d2851bc462cf8046e8e.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="ce6ca162-689d-4673-b093-261e465eefc7" class="cell code" data-execution_count="66" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:18:08.961955Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:18:08.961699Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:18:10.065123Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:18:10.064912Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:18:08.961923Z&quot;}">
<div class="sourceCode" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb64-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_init_.items()):</span>
<span id="cb64-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC (Initial Samples)'</span>)</span>
<span id="cb64-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb64-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb64-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax[idx].legend(loc='best', frameon=True, edgecolor="#838383")</span></span>
<span id="cb64-7"></span>
<span id="cb64-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Initial HMC States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/9d36e3726eb2a63bcae157590b44c3710847442f.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/9d36e3726eb2a63bcae157590b44c3710847442f.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="333d6fce-2124-46c7-809b-e584e2efc057" class="cell code" data-execution_count="68" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:18:30.709489Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:18:30.708639Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:18:31.422559Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:18:31.422402Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:18:30.709448Z&quot;}">
<div class="sourceCode" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb65-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_.items()):</span>
<span id="cb65-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>)</span>
<span id="cb65-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb65-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb65-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = ax[idx].legend(loc='best', frameon=True, edgecolor="#838383")</span></span>
<span id="cb65-7"></span>
<span id="cb65-8">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Combined Samples"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/6ba854aa0d42fd2eae98f6d82c0d6566005c421b.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/6ba854aa0d42fd2eae98f6d82c0d6566005c421b.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="c348510d-9ec3-41c7-b04e-654b5ba0bd3d" class="cell code" data-execution_count="71" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:01.490764Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:01.490310Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:01.844808Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:01.844643Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:01.490733Z&quot;}">
<div class="sourceCode" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb66-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_hmc_.items()):</span>
<span id="cb66-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb66-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb66-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb66-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Generated HMC States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/9d3a4133b6d0c2bf60da7558af21452baab7d5c3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/9d3a4133b6d0c2bf60da7558af21452baab7d5c3.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="20a16129-4648-4c62-9ed4-d6753d425f89" class="cell code" data-execution_count="73" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:03.884288Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:03.884107Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:04.146335Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:04.146166Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:03.884273Z&quot;}">
<div class="sourceCode" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb67-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, (key, val) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(metrics_diffusion_.items()):</span>
<span id="cb67-3">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].plot(val[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb67-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_ylabel(key, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb67-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[idx].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Draw'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb67-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Generated Diffusion States"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.92</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/02d2b941bf240ac2a6659c37519a6e2ebec63b41.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/02d2b941bf240ac2a6659c37519a6e2ebec63b41.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="9f329885-fa42-4e13-bd2c-e6fff4418cdb" class="cell code" data-execution_count="74" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:05.363396Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:05.363028Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:05.494802Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:05.494503Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:05.363383Z&quot;}">
<div class="sourceCode" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> l2hmc.lattice.u1.pytorch.lattice <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plaq_exact</span>
<span id="cb68-2">plaq_exact(torch.tensor(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>))</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="74">
<pre><code>tensor(0.9124)</code></pre>
</div>
<div id="0646c637-546c-49df-876b-4dfb7abb9497" class="cell code" data-execution_count="78" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:41.898242Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:41.898063Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:42.092250Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:42.092113Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:41.898226Z&quot;}">
<div class="sourceCode" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb70-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#_ = plt.hist(metrics_['intQ'].flatten(), color='C0', alpha=0.6, label='Combined', edgecolor='none')</span></span>
<span id="cb70-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb70-4">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb70-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb70-6">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb70-7">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>,</span>
<span id="cb70-8">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb70-9">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb70-10">)</span>
<span id="cb70-11">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb70-12">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb70-13">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb70-14">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb70-15">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>,</span>
<span id="cb70-16">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb70-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb70-18">)</span>
<span id="cb70-19">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#666666'</span>)</span>
<span id="cb70-20">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">Q</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb70-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Topological Charge ($Q$) Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/3f9d006e6a51dac62b80daab5d4bb4ac70596db2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/3f9d006e6a51dac62b80daab5d4bb4ac70596db2.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="f44d12ff-37f7-452e-94d7-6c3f0b28205e" class="cell code" data-execution_count="79" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:47.593614Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:47.593330Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:47.769152Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:47.768975Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:47.593598Z&quot;}">
<div class="sourceCode" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb71-2">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>)</span>
<span id="cb71-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.plot(metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>][:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>)</span>
<span id="cb71-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>, frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#666666'</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb71-5">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">left</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">langle U_{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">\m</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\r</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">ight</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\r</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">angle </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb71-6">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Draw"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/88b5366a0686ecb675259d3e1459d08d6c39e750.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/88b5366a0686ecb675259d3e1459d08d6c39e750.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="c0574a41-5d7e-45d9-97e9-0d81a0a6fa84" class="cell code" data-execution_count="80" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:53.009094Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:53.008705Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:53.084368Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:53.084175Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:53.009076Z&quot;}">
<div class="sourceCode" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1">wloops <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb72-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [</span>
<span id="cb72-3">        exp.trainer.lattice.wilson_loops(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hmc_samples_</span>
<span id="cb72-4">    ],</span>
<span id="cb72-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [</span>
<span id="cb72-6">        exp.trainer.lattice.wilson_loops(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> diffusion_samples_</span>
<span id="cb72-7">    ],</span>
<span id="cb72-8">}</span>
<span id="cb72-9"></span>
<span id="cb72-10">plaqs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb72-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>: [</span>
<span id="cb72-12">        exp.trainer.lattice.plaqs(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hmc_samples_</span>
<span id="cb72-13">    ],</span>
<span id="cb72-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>: [</span>
<span id="cb72-15">        exp.trainer.lattice.plaqs(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> diffusion_samples_</span>
<span id="cb72-16">    ],</span>
<span id="cb72-17">}</span></code></pre></div>
</div>
<div id="a7659697-40bd-489f-9445-1b27a5c79d8e" class="cell code" data-execution_count="81" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:53.670229Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:53.669768Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:53.757525Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:53.757339Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:53.670188Z&quot;}">
<div class="sourceCode" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1">wlhmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(wloops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>]).squeeze()</span>
<span id="cb73-2">wldiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(wloops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>]).squeeze()</span></code></pre></div>
</div>
<div id="63818acf-ed67-4f87-a2c2-065edebd94ba" class="cell code" data-execution_count="82" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:19:54.068148Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:19:54.067480Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:19:54.181682Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:19:54.181151Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:19:54.068106Z&quot;}">
<div class="sourceCode" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1">wlhmc.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="82">
<pre><code>torch.Size([28, 16, 32, 32])</code></pre>
</div>
<div id="3e408fed-abb8-486c-a560-3af19f121179" class="cell code" data-execution_count="85" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:23.993243Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:23.992854Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:24.334498Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:24.334319Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:23.993216Z&quot;}">
<div class="sourceCode" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.tight_layout()</span>
<span id="cb76-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb76-3">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb76-4">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].imshow(wlhmc[idx, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb76-5">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HMC"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb76-6">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].imshow(wldiff[idx, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb76-7">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Diffusion"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb76-8">    _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.suptitle(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">\m</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb76-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ax_ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ax:</span>
<span id="cb76-10">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax_.set_xticklabels([])</span>
<span id="cb76-11">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax_.set_yticklabels([])</span></code></pre></div>
</div>
<div class="flex-container output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/292acc374ca58b3045c07221e75d5ad20d83a646.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/292acc374ca58b3045c07221e75d5ad20d83a646.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="assets/diffusion/3b6a02bc8d6489b5a0147b59009b8a3be270ba14.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/3b6a02bc8d6489b5a0147b59009b8a3be270ba14.svg" class="img-fluid"></a></p>
</div>
<div id="ff7b6cca-0327-4be2-aab6-aaa8df6ce2bc" class="cell code" data-execution_count="87" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:36.056148Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:36.055543Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:36.149377Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:36.149190Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:36.056103Z&quot;}">
<div class="sourceCode" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1">qhmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>]</span>
<span id="cb77-2">qdiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>]</span>
<span id="cb77-3">qhmc.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="87">
<pre><code>torch.Size([28, 16])</code></pre>
</div>
<div id="5230a441-1e1b-4901-b4d0-aacf5413ff35" class="cell code" data-execution_count="88" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:39.115417Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:39.114730Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:39.197664Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:39.197492Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:39.115373Z&quot;}">
<div class="sourceCode" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1">phmc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(plaqs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hmc'</span>]).squeeze()</span>
<span id="cb79-2">pdiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack(plaqs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'diffusion'</span>]).squeeze()</span>
<span id="cb79-3">phmc.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="88">
<pre><code>torch.Size([28, 16])</code></pre>
</div>
<div id="1af88db9-f706-4b58-8e81-a54cf92f144d" class="cell code" data-execution_count="89" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:39.947370Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:39.946997Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:40.026391Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:40.026205Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:39.947336Z&quot;}">
<div class="sourceCode" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1">pdiff.shape</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display execute_result" data-execution_count="89">
<pre><code>torch.Size([2, 16])</code></pre>
</div>
<div id="1eeaeb30-abd1-47e9-8752-42d26873629b" class="cell code" data-execution_count="90" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:20:40.855087Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:20:40.854732Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:20:41.041979Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:20:41.041831Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:20:40.855068Z&quot;}">
<div class="sourceCode" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb83-2"></span>
<span id="cb83-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb83-4">    metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb83-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb83-6">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb83-7">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-8">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-9">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb83-10">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb83-11">)</span>
<span id="cb83-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb83-13">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb83-14">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb83-15">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb83-16">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-18">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb83-19">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb83-20">)</span>
<span id="cb83-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb83-22">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plaqs'</span>].flatten(),</span>
<span id="cb83-23">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>,</span>
<span id="cb83-24">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb83-25">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-26">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-27">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>,</span>
<span id="cb83-28">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb83-29">)</span>
<span id="cb83-30">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">U_{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">\m</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">u}</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb83-31">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(</span>
<span id="cb83-32">    loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>,</span>
<span id="cb83-33">    frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb83-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ncols=2,</span></span>
<span id="cb83-35">    bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>),</span>
<span id="cb83-36">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#838383"</span>,</span>
<span id="cb83-37">)</span>
<span id="cb83-38">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Plaquette Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
</div>
<div class="output cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="assets/diffusion/b8adc3f97c471460069de45c953d36d2a16fc858.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="https://samforeman.me/posts/ai-for-physics/diffusion/assets/diffusion/b8adc3f97c471460069de45c953d36d2a16fc858.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div id="b40d5264-8818-40d6-9b6f-1a8e5c62f8a0" class="cell code" data-execution_count="92" data-execution="{&quot;iopub.execute_input&quot;:&quot;2023-09-21T18:21:00.286255Z&quot;,&quot;iopub.status.busy&quot;:&quot;2023-09-21T18:21:00.285869Z&quot;,&quot;iopub.status.idle&quot;:&quot;2023-09-21T18:21:00.480910Z&quot;,&quot;shell.execute_reply&quot;:&quot;2023-09-21T18:21:00.480726Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2023-09-21T18:21:00.286225Z&quot;}">
<div class="sourceCode" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb84-2"></span>
<span id="cb84-3">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb84-4">    metrics_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb84-5">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>,</span>
<span id="cb84-6">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb84-7">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-8">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-9">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HMC'</span>,</span>
<span id="cb84-10">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb84-11">)</span>
<span id="cb84-12">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb84-13">    metrics_diffusion_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb84-14">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>,</span>
<span id="cb84-15">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb84-16">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-17">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-18">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Diffusion'</span>,</span>
<span id="cb84-19">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb84-20">)</span>
<span id="cb84-21">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.hist(</span>
<span id="cb84-22">    metrics_hmc_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intQ'</span>].flatten(),</span>
<span id="cb84-23">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>,</span>
<span id="cb84-24">    histtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step'</span>,</span>
<span id="cb84-25">    stacked<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-26">    density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-27">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Combined'</span>,</span>
<span id="cb84-28">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb84-29">)</span>
<span id="cb84-30">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$Q_{</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">mathbb</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{Z}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}$'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb84-31">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.legend(</span>
<span id="cb84-32">    loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper left'</span>,</span>
<span id="cb84-33">    frameon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb84-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#ncols=2,</span></span>
<span id="cb84-35">    bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>),</span>
<span id="cb84-36">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#838383"</span>,</span>
<span id="cb84-37">)</span>
<span id="cb84-38">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Charge Distribution'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span></code></pre></div>
</div>
<div id="667c0f58-fbcf-4268-9193-4d475fbbe01b" class="cell code">
<div class="sourceCode" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1">global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb85-2">frames <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb85-3">losses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb85-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Training model..."</span>)</span>
<span id="cb85-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_epochs"</span>]):</span>
<span id="cb85-6">    model.train()</span>
<span id="cb85-7">    progress_bar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tqdm(total<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader))</span>
<span id="cb85-8">    progress_bar.set_description(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb85-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> step, batch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(dataloader):</span>
<span id="cb85-10">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion.sample_timesteps(images.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(device)</span>
<span id="cb85-11"></span>
<span id="cb85-12">        noise <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(batch.shape)</span>
<span id="cb85-13">        timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randint(</span>
<span id="cb85-14">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, noise_scheduler.num_timesteps, (batch.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],)</span>
<span id="cb85-15">        ).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb85-16"></span>
<span id="cb85-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#noisy = noise_scheduler.add_noise(batch, noise, timesteps)</span></span>
<span id="cb85-18">        noisy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.noise_images(batch, timesteps)</span>
<span id="cb85-19">        noise_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(noisy, timesteps)</span>
<span id="cb85-20">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.mse_loss(noise_pred, noise)</span>
<span id="cb85-21">        loss.backward(loss)</span>
<span id="cb85-22"></span>
<span id="cb85-23">        nn.utils.clip_grad_norm_(model.parameters(), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>)</span>
<span id="cb85-24">        optimizer.step()</span>
<span id="cb85-25">        optimizer.zero_grad()</span>
<span id="cb85-26"></span>
<span id="cb85-27">        progress_bar.update(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb85-28">        logs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loss"</span>: loss.detach().item(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"step"</span>: global_step}</span>
<span id="cb85-29">        losses.append(loss.detach().item())</span>
<span id="cb85-30">        progress_bar.set_postfix(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>logs)</span>
<span id="cb85-31">        global_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb85-32">    progress_bar.close()</span>
<span id="cb85-33"></span>
<span id="cb85-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"save_images_step"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_epochs"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb85-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate data with the model to later visualize the learning process</span></span>
<span id="cb85-36">        model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb85-37">        sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_batch_size"</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb85-38">        timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(noise_scheduler)))[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb85-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(timesteps)):</span>
<span id="cb85-40">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, config[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eval_batch_size"</span>])).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb85-41">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb85-42">                residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb85-43">            sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb85-44">        frames.append(sample.numpy())</span></code></pre></div>
</div>
<div id="bca44d4c-aecd-4348-8ad8-be9a404c8946" class="cell code">
<div class="sourceCode" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1">dataset[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
</div>
<div id="169c00d5-8ef2-42df-8f21-7ce08837ede4" class="cell code">
<div class="sourceCode" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader)</span></code></pre></div>
</div>
<div id="8d47bdc2-41a1-4236-8674-090e98f2cd49" class="cell code">
<div class="sourceCode" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1">eval_batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb88-2">num_timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb88-3">plot_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb88-4">noise_scheduler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ddpm.NoiseScheduler(num_timesteps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_timesteps)</span>
<span id="cb88-5">sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(eval_batch_size, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb88-6">timesteps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_timesteps))[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb88-7">samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb88-8">steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb88-9"></span>
<span id="cb88-10">retrains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb88-11">diffusion_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb88-12">samples_per_retrain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span></code></pre></div>
</div>
<div id="11ce1f12-beb8-4d8b-9475-d27c1b91beee" class="cell code">
<div class="sourceCode" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1">eval_batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb89-2">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(timesteps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb89-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb89-4">    residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb89-5">sample_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span></code></pre></div>
</div>
<div id="7db39b1f-807d-4656-a473-fcc818f2d157" class="cell code">
<div class="sourceCode" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1">sample.shape</span></code></pre></div>
</div>
<div id="b7118647-55d6-4605-87cf-c43fbe8d735c" class="cell code">
<div class="sourceCode" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1">residual.shape</span></code></pre></div>
</div>
<div id="77a6735b-f21f-4bc3-adc5-35c075f61bdd" class="cell code">
<div class="sourceCode" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1">sample_.shape</span></code></pre></div>
</div>
<div id="2648c025-75c8-4555-9d75-3c1c6426f3a1" class="cell code">
<div class="sourceCode" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1">diffusion_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb93-2">hmc_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb93-3">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span></span>
<span id="cb93-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> retrain_iter <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(retrains):</span>
<span id="cb93-5">    console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'retrain_iter: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>retrain_iter<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb93-6">    ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb93-7">    ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb93-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(samples_per_retrain):</span>
<span id="cb93-9">        console.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'sample idx: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb93-10">        rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb93-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> rand <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> diffusion_prob:</span>
<span id="cb93-12">            ndiff_proposed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb93-13">            rand_pick <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> randrange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dataloader))</span>
<span id="cb93-14">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#theta_prime = dataset[rand_pick]</span></span>
<span id="cb93-15">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb93-16">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb93-17">                residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb93-18">            sample_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb93-19">            ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb93-20">                log_likelihood_2dU1(sample_, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb93-21">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> log_likelihood_2dU1(sample, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb93-22">            )</span>
<span id="cb93-23">            a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ratio)</span>
<span id="cb93-24">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform()</span>
<span id="cb93-25">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> a:</span>
<span id="cb93-26">                ndiff_acc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb93-27">                sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_</span>
<span id="cb93-28">                diffusion_samples.append(sample)</span>
<span id="cb93-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb93-30">            sample_, metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp.trainer.hmc_step((sample_, beta))</span>
<span id="cb93-31">            hmc_samples.append(sample)</span></code></pre></div>
</div>
<div id="8333621a-2fee-4736-a66c-bc42650d72aa" class="cell code">
<div class="sourceCode" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(tqdm(timesteps)):</span>
<span id="cb94-2">    t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.from_numpy(np.repeat(t, eval_batch_size)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">long</span>()</span>
<span id="cb94-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb94-4">        residual <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(sample, t)</span>
<span id="cb94-5">    sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noise_scheduler.step(residual, t[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], sample)</span>
<span id="cb94-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> plot_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb94-7">        samples.append(sample.numpy())</span>
<span id="cb94-8">        steps.append(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div id="014d60bf-7f4b-48f6-a0e0-20b73392446d" class="cell markdown" data-jp-markdownheadingcollapsed="true">
<section id="alternate" class="level2">
<h2 class="anchored" data-anchor-id="alternate">Alternate</h2>
</section>
</div>
<div id="385670d3-4c8a-40e6-abd8-7adf803d0042" class="cell code">
<div class="sourceCode" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1">diffusion_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DiffusionAlt(img_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span></code></pre></div>
</div>
<div id="88d31f53-1808-4a91-b26d-61b6328b824f" class="cell code">
<div class="sourceCode" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1">image <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb96-2">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> diffusion_.sample_timesteps(image.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span>
<span id="cb96-3">unet(image, t)</span></code></pre></div>
</div>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {üé≤ {MCMC} + {Diffusion} {Sampling}},
  date = {2024-04-15},
  url = {https://samforeman.me/posts/ai-for-physics/diffusion/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüé≤ MCMC + Diffusion Sampling.‚Äù</span> April
15, 2024. <a href="https://samforeman.me/posts/ai-for-physics/diffusion/">https://samforeman.me/posts/ai-for-physics/diffusion/</a>.
</div></div></section></div> ]]></description>
  <category>ai4science</category>
  <category>lqcd</category>
  <category>mcmc</category>
  <category>diffusion</category>
  <guid>https://samforeman.me/posts/ai-for-physics/diffusion/</guid>
  <pubDate>Mon, 15 Apr 2024 05:00:00 GMT</pubDate>
  <media:content url="https://samforeman.me/posts/ai-for-physics/diffusion/assets/qdist.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>üê¢ Starting Up Distributed Training on Aurora</title>
  <dc:creator>Sam Foreman</dc:creator>
  <link>https://samforeman.me/posts/AuroraGPT/startup-times/</link>
  <description><![CDATA[ 

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TC329HJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->




<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[{{< iconify material-symbols attach-email-outline-rounded >}} Application Startup Time]{.dim-text}" style="text-align: left!important; width:100%; border-color: var(--dim-color)!important; background-color: var(--bg-transparent); background: rgba(0,0,0, 0.0)!important;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span class="dim-text"><iconify-icon inline="" icon="material-symbols:attach-email-outline-rounded" aria-label="Icon attach-email-outline-rounded from material-symbols Iconify.design set." title="Icon attach-email-outline-rounded from material-symbols Iconify.design set."></iconify-icon> Application Startup Time</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>Request:</p>
<blockquote class="blockquote">
<p>Hi Sam and Corey,</p>
<p>Thanks for your comments on measuring the application start up time last week.</p>
<p>Typically, we report the throughput performance after the start-up and warm-up during the ‚Äústeady‚Äù state of the training.</p>
<p>We have a few follow-up questions so that we establish a methodology to address the issue brought up by Argonne.</p>
<ol type="1">
<li><p>We can set a few timestamps in the model scripts and job scripts used for the queue submission: Job script:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp A:  </span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>actual <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> command using mpiexec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Inside</span> the model script:  </span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">main()</span>  </span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Timestamp</span> B:  </span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[...]</span></span>
<span id="cb1-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Timestamp</span> C:  </span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">First</span> training steps and onwards.  </span></code></pre></div>
<p>By startup time, do you mean measuring time difference between A and C or B and C?</p></li>
</ol>
</blockquote>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Will the measurement methodology be the same for distributed training?<br>
For examples, we can measure the start-up time for the <code>rank0</code>?</li>
</ol>
</blockquote>
<blockquote class="blockquote">
<ol start="3" type="1">
<li><p>If we need to report the startup time for the DL applications, do we need to collect measurements using the actual Aurora NRE workloads or some small benchmarking test cases?</p>
<p>For example, we can try to recreate the typical start-up scenarios, like library imports, and measure those separately as shown below.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> script:</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp A:</span>
<span id="cb2-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>actual <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> command using mpiexec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp B:</span>
<span id="cb2-6"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb2-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp C</span>
<span id="cb2-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">import</span> IPEX</span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Time</span> stamp D</span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Etc...</span></span></code></pre></div>
<p>If you have any other scenarios, please feel free to suggest.</p></li>
</ol>
</blockquote></li>
</ul>
</div>
</div>
</div>
<section id="response" class="level2">
<h2 class="anchored" data-anchor-id="response">Response</h2>
<ol type="1">
<li><p>In Measuring / Calculating Startup Time,I provide a summary of how the startup time is identified and calculated.</p></li>
<li><p>I‚Äôm not sure exactly I understand</p>
<blockquote class="blockquote">
<p>Will the measurement methodology be the same for distributed training? For examples, we can measure the start-up time for the rank0?</p>
</blockquote>
<p>The startup time is being measured for distributed training (logs only created on <code>RANK = 0</code>)</p></li>
<li><p>I discuss in Minimal Working Example a minimal example that can be used to measure the startup times.</p>
<ul>
<li>This is using a library I‚Äôve been working on, <a href="https://github.com/saforem2/ezpz"><code>ezpz</code></a> that is designed to help simplify the process of setting up / initializing distributed training across many GPUs.</li>
</ul></li>
</ol>
<section id="sec-measurements" class="level3">
<h3 class="anchored" data-anchor-id="sec-measurements">Measuring / Calculating Startup Time</h3>
<ul>
<li><p>The startup timing was identified by parsing the logfiles from existing runs and calculating the difference <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20t%20=%20t_%7B1%7D%20-%20t_%7B0%7D">,</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B0%7D"> is the time stamp at the <em>very</em> beginning of the shell script (defined <a href="https://github.com/argonne-lcf/Megatron-DeepSpeed/blob/657bb3e312e793d7b503f475b59e44c1aee44205/ALCF/train-gpt3.sh#L3">here</a>) which then launches</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mpiexec</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mpi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>args<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> python3 <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">...</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B0%7D"> appears in the logfile as:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-183323 on x3004c0s13b0n0</span></code></pre></div></li>
</ul></li>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B1%7D"> is identified as the timestamp associated with the completion of the first training step</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?t_%7B1%7D"> appears in the logfile as:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:34:13,122] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div></li>
</ul></li>
</ul></li>
<li><p>Below is an example of the bash script use to parse the logfiles and identify these timestamps:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> for f in <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-5</span> logfiles<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job started|step=0\,"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb6-2">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_actCkpt_GPT1T_4L_z1_seqlen2048_mp8_pp2_sp1_nl4_hs25600_gb16_mb1/logs/foremans-x3004c0s13b0n0-nhosts4-ngpu16-2023-11-02-183323.log</span></span>
<span id="cb6-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-183323 on x3004c0s13b0n0</span>
<span id="cb6-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:34:13,122] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-5"></span>
<span id="cb6-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3015c0s37b0n0-nhosts4-ngpu16-2023-11-02-184240.log</span></span>
<span id="cb6-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184240 on x3015c0s37b0n0</span>
<span id="cb6-8"></span>
<span id="cb6-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3015c0s37b0n0-nhosts4-ngpu16-2023-11-02-184259.log</span></span>
<span id="cb6-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184259 on x3015c0s37b0n0</span>
<span id="cb6-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:43:23,385] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-12"></span>
<span id="cb6-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_SP_actCkpt_GPT125M_z0_seqlen2048_mp16_pp1_sp1_nl12_hs768_gb1_mb1/logs/foremans-x3004c0s13b0n0-nhosts4-ngpu16-2023-11-02-184407.log</span></span>
<span id="cb6-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-184407 on x3004c0s13b0n0</span>
<span id="cb6-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-11-02</span> 18:44:32,804] <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">logging.py:96:log_dist</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">0.9,</span> 0.999<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-16"></span>
<span id="cb6-17">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/lus/grand/projects/datascience/foremans/locations/polaris/projects/argonne-lcf/Megatron-DeepSpeed/outputs/gpt_actCkpt_GPT1T_4L_z1_seqlen2048_mp8_pp2_sp1_nl4_hs25600_gb16_mb2/logs/foremans-x3108c0s25b1n0-nhosts2-ngpu8-2023-11-02-192739.log</span></span>
<span id="cb6-18">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Job</span> started at: 2023-11-02-192739 on x3108c0s25b1n0</span></code></pre></div></li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="[{{< iconify octicon stopwatch-16 >}} Startup Times (Perlmutter)]{.dim-text}" style="text-align: left!important; width:100%; border-color: var(--dim-color)!important; background-color: var(--bg-transparent); background: rgba(0, 0, 0, 0.0)!important;">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span><span class="dim-text"><iconify-icon inline="" icon="octicon:stopwatch-16" aria-label="Icon stopwatch-16 from octicon Iconify.design set." title="Icon stopwatch-16 from octicon Iconify.design set."></iconify-icon> Startup Times (Perlmutter)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="tbl-perlmutter-init" class="responsive quarto-float quarto-figure quarto-figure-center anchored" style="font-size: 0.8em;">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-perlmutter-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Startup times on Perlmutter
</figcaption>
<div aria-describedby="tbl-perlmutter-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="caption-top table">
<caption>Startup times on Perlmutter</caption>
<colgroup>
<col style="width: 42%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">****</th>
<th style="text-align: center;"><strong>model_size</strong></th>
<th style="text-align: center;"><strong>world_size</strong></th>
<th style="text-align: center;"><strong>start</strong></th>
<th style="text-align: center;"><strong>stop</strong></th>
<th style="text-align: center;"><strong>t0</strong></th>
<th style="text-align: center;"><strong>t1</strong></th>
<th style="text-align: center;"><strong>dt</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191101.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191101</td>
<td style="text-align: center;">2023-10-05-191215</td>
<td style="text-align: center;">191101</td>
<td style="text-align: center;">191215</td>
<td style="text-align: center;">114</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191400.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191400</td>
<td style="text-align: center;">2023-10-05-191511</td>
<td style="text-align: center;">191400</td>
<td style="text-align: center;">191511</td>
<td style="text-align: center;">111</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008217-nhosts2-ngpu8-2023-10-05-191707.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-05-191707</td>
<td style="text-align: center;">2023-10-05-191817</td>
<td style="text-align: center;">191707</td>
<td style="text-align: center;">191817</td>
<td style="text-align: center;">110</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008553-nhosts2-ngpu8-2023-10-15-114506.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-114506</td>
<td style="text-align: center;">2023-10-15-114616</td>
<td style="text-align: center;">114506</td>
<td style="text-align: center;">114616</td>
<td style="text-align: center;">110</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-133531.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-133531</td>
<td style="text-align: center;">2023-10-15-133745</td>
<td style="text-align: center;">133531</td>
<td style="text-align: center;">133745</td>
<td style="text-align: center;">214</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-135041.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-135041</td>
<td style="text-align: center;">2023-10-15-135255</td>
<td style="text-align: center;">135041</td>
<td style="text-align: center;">135255</td>
<td style="text-align: center;">214</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-140806.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-140806</td>
<td style="text-align: center;">2023-10-15-141236</td>
<td style="text-align: center;">140806</td>
<td style="text-align: center;">141236</td>
<td style="text-align: center;">430</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts2-ngpu8-2023-10-15-143120.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-143120</td>
<td style="text-align: center;">2023-10-15-143655</td>
<td style="text-align: center;">143120</td>
<td style="text-align: center;">143655</td>
<td style="text-align: center;">535</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-154337.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-154337</td>
<td style="text-align: center;">2023-10-15-154446</td>
<td style="text-align: center;">154337</td>
<td style="text-align: center;">154446</td>
<td style="text-align: center;">109</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-154943.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-154943</td>
<td style="text-align: center;">2023-10-15-155317</td>
<td style="text-align: center;">154943</td>
<td style="text-align: center;">155317</td>
<td style="text-align: center;">374</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008268-nhosts2-ngpu8-2023-10-15-162315.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-162315</td>
<td style="text-align: center;">2023-10-15-162441</td>
<td style="text-align: center;">162315</td>
<td style="text-align: center;">162441</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-180714.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-180714</td>
<td style="text-align: center;">2023-10-15-180805</td>
<td style="text-align: center;">180714</td>
<td style="text-align: center;">180805</td>
<td style="text-align: center;">91</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-181733.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-181733</td>
<td style="text-align: center;">2023-10-15-181834</td>
<td style="text-align: center;">181733</td>
<td style="text-align: center;">181834</td>
<td style="text-align: center;">101</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-182228.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-182228</td>
<td style="text-align: center;">2023-10-15-183031</td>
<td style="text-align: center;">182228</td>
<td style="text-align: center;">183031</td>
<td style="text-align: center;">803</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-183345.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-183345</td>
<td style="text-align: center;">2023-10-15-183750</td>
<td style="text-align: center;">183345</td>
<td style="text-align: center;">183750</td>
<td style="text-align: center;">405</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-184442.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-184442</td>
<td style="text-align: center;">2023-10-15-184727</td>
<td style="text-align: center;">184442</td>
<td style="text-align: center;">184727</td>
<td style="text-align: center;">285</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts2-ngpu8-2023-10-15-185952.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-185952</td>
<td style="text-align: center;">2023-10-15-190046</td>
<td style="text-align: center;">185952</td>
<td style="text-align: center;">190046</td>
<td style="text-align: center;">4094</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-191508.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-191508</td>
<td style="text-align: center;">2023-10-15-191608</td>
<td style="text-align: center;">191508</td>
<td style="text-align: center;">191608</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-192404.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-192404</td>
<td style="text-align: center;">2023-10-15-192504</td>
<td style="text-align: center;">192404</td>
<td style="text-align: center;">192504</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-193041.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-193041</td>
<td style="text-align: center;">2023-10-15-193137</td>
<td style="text-align: center;">193041</td>
<td style="text-align: center;">193137</td>
<td style="text-align: center;">96</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-15-193448.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-15-193448</td>
<td style="text-align: center;">2023-10-15-193540</td>
<td style="text-align: center;">193448</td>
<td style="text-align: center;">193540</td>
<td style="text-align: center;">92</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-195802.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-195802</td>
<td style="text-align: center;">2023-10-15-195904</td>
<td style="text-align: center;">195802</td>
<td style="text-align: center;">195904</td>
<td style="text-align: center;">102</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-200019.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-200019</td>
<td style="text-align: center;">2023-10-15-200258</td>
<td style="text-align: center;">200019</td>
<td style="text-align: center;">200258</td>
<td style="text-align: center;">239</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-200902.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-200902</td>
<td style="text-align: center;">2023-10-15-201239</td>
<td style="text-align: center;">200902</td>
<td style="text-align: center;">201239</td>
<td style="text-align: center;">337</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-201524.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-201524</td>
<td style="text-align: center;">2023-10-15-201612</td>
<td style="text-align: center;">201524</td>
<td style="text-align: center;">201612</td>
<td style="text-align: center;">88</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-201834.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-201834</td>
<td style="text-align: center;">2023-10-15-201923</td>
<td style="text-align: center;">201834</td>
<td style="text-align: center;">201923</td>
<td style="text-align: center;">89</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-202402.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-202402</td>
<td style="text-align: center;">2023-10-15-202501</td>
<td style="text-align: center;">202402</td>
<td style="text-align: center;">202501</td>
<td style="text-align: center;">99</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-login12-nhosts4-ngpu16-2023-10-15-202606.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-15-202606</td>
<td style="text-align: center;">2023-10-15-202713</td>
<td style="text-align: center;">202606</td>
<td style="text-align: center;">202713</td>
<td style="text-align: center;">107</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-084033.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-084033</td>
<td style="text-align: center;">2023-10-16-084212</td>
<td style="text-align: center;">84033</td>
<td style="text-align: center;">84212</td>
<td style="text-align: center;">179</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-084628.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-084628</td>
<td style="text-align: center;">2023-10-16-084728</td>
<td style="text-align: center;">84628</td>
<td style="text-align: center;">84728</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-085401.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-085401</td>
<td style="text-align: center;">2023-10-16-085505</td>
<td style="text-align: center;">85401</td>
<td style="text-align: center;">85505</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-090142.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-090142</td>
<td style="text-align: center;">2023-10-16-090305</td>
<td style="text-align: center;">90142</td>
<td style="text-align: center;">90305</td>
<td style="text-align: center;">163</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-16-093404.log</code></td>
<td style="text-align: center;">actCkpt_GPT13B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-16-093404</td>
<td style="text-align: center;">2023-10-16-093504</td>
<td style="text-align: center;">93404</td>
<td style="text-align: center;">93504</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts4-ngpu16-2023-10-16-101437.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-101437</td>
<td style="text-align: center;">2023-10-16-101549</td>
<td style="text-align: center;">101437</td>
<td style="text-align: center;">101549</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-101512.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-101512</td>
<td style="text-align: center;">2023-10-16-101615</td>
<td style="text-align: center;">101512</td>
<td style="text-align: center;">101615</td>
<td style="text-align: center;">103</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-102217.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-102217</td>
<td style="text-align: center;">2023-10-16-102452</td>
<td style="text-align: center;">102217</td>
<td style="text-align: center;">102452</td>
<td style="text-align: center;">235</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-102750.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-102750</td>
<td style="text-align: center;">2023-10-16-103243</td>
<td style="text-align: center;">102750</td>
<td style="text-align: center;">103243</td>
<td style="text-align: center;">493</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008572-nhosts4-ngpu16-2023-10-16-103113.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-103113</td>
<td style="text-align: center;">2023-10-16-103237</td>
<td style="text-align: center;">103113</td>
<td style="text-align: center;">103237</td>
<td style="text-align: center;">124</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-104037.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-104037</td>
<td style="text-align: center;">2023-10-16-104148</td>
<td style="text-align: center;">104037</td>
<td style="text-align: center;">104148</td>
<td style="text-align: center;">111</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-104819.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-104819</td>
<td style="text-align: center;">2023-10-16-110002</td>
<td style="text-align: center;">104819</td>
<td style="text-align: center;">110002</td>
<td style="text-align: center;">5183</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008396-nhosts4-ngpu16-2023-10-16-110119.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-110119</td>
<td style="text-align: center;">2023-10-16-110225</td>
<td style="text-align: center;">110119</td>
<td style="text-align: center;">110225</td>
<td style="text-align: center;">106</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-113715.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-113715</td>
<td style="text-align: center;">2023-10-16-113824</td>
<td style="text-align: center;">113715</td>
<td style="text-align: center;">113824</td>
<td style="text-align: center;">109</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114236.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114236</td>
<td style="text-align: center;">2023-10-16-114338</td>
<td style="text-align: center;">114236</td>
<td style="text-align: center;">114338</td>
<td style="text-align: center;">102</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114610.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114610</td>
<td style="text-align: center;">2023-10-16-114711</td>
<td style="text-align: center;">114610</td>
<td style="text-align: center;">114711</td>
<td style="text-align: center;">101</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-114819.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-114819</td>
<td style="text-align: center;">2023-10-16-114953</td>
<td style="text-align: center;">114819</td>
<td style="text-align: center;">114953</td>
<td style="text-align: center;">134</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008701-nhosts4-ngpu16-2023-10-16-131058.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-16-131058</td>
<td style="text-align: center;">2023-10-16-131203</td>
<td style="text-align: center;">131058</td>
<td style="text-align: center;">131203</td>
<td style="text-align: center;">145</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008576-nhosts1-ngpu4-2023-10-16-151427.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-151427</td>
<td style="text-align: center;">2023-10-16-151600</td>
<td style="text-align: center;">151427</td>
<td style="text-align: center;">151600</td>
<td style="text-align: center;">173</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008576-nhosts1-ngpu4-2023-10-16-152528.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-152528</td>
<td style="text-align: center;">2023-10-16-152640</td>
<td style="text-align: center;">152528</td>
<td style="text-align: center;">152640</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-175717.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-175717</td>
<td style="text-align: center;">2023-10-16-175829</td>
<td style="text-align: center;">175717</td>
<td style="text-align: center;">175829</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-180457.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-180457</td>
<td style="text-align: center;">2023-10-16-180605</td>
<td style="text-align: center;">180457</td>
<td style="text-align: center;">180605</td>
<td style="text-align: center;">148</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-183116.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-183116</td>
<td style="text-align: center;">2023-10-16-183216</td>
<td style="text-align: center;">183116</td>
<td style="text-align: center;">183216</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008224-nhosts1-ngpu4-2023-10-16-183921.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-183921</td>
<td style="text-align: center;">2023-10-16-184033</td>
<td style="text-align: center;">183921</td>
<td style="text-align: center;">184033</td>
<td style="text-align: center;">112</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008237-nhosts1-ngpu4-2023-10-16-215614.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-16-215614</td>
<td style="text-align: center;">2023-10-16-215815</td>
<td style="text-align: center;">215614</td>
<td style="text-align: center;">215815</td>
<td style="text-align: center;">201</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-052944.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-052944</td>
<td style="text-align: center;">2023-10-17-053139</td>
<td style="text-align: center;">52944</td>
<td style="text-align: center;">53139</td>
<td style="text-align: center;">195</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-053529.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-053529</td>
<td style="text-align: center;">2023-10-17-053650</td>
<td style="text-align: center;">53529</td>
<td style="text-align: center;">53650</td>
<td style="text-align: center;">121</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-053910.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-053910</td>
<td style="text-align: center;">2023-10-17-054120</td>
<td style="text-align: center;">53910</td>
<td style="text-align: center;">54120</td>
<td style="text-align: center;">210</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-054238.log</code></td>
<td style="text-align: center;">GPT2_7B</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-054238</td>
<td style="text-align: center;">2023-10-17-054346</td>
<td style="text-align: center;">54238</td>
<td style="text-align: center;">54346</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-060418.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-060418</td>
<td style="text-align: center;">2023-10-17-060600</td>
<td style="text-align: center;">60418</td>
<td style="text-align: center;">60600</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-061514.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-061514</td>
<td style="text-align: center;">2023-10-17-061653</td>
<td style="text-align: center;">61514</td>
<td style="text-align: center;">61653</td>
<td style="text-align: center;">139</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-062102.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-062102</td>
<td style="text-align: center;">2023-10-17-062252</td>
<td style="text-align: center;">62102</td>
<td style="text-align: center;">62252</td>
<td style="text-align: center;">150</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008385-nhosts1-ngpu4-2023-10-17-062445.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-062445</td>
<td style="text-align: center;">2023-10-17-062720</td>
<td style="text-align: center;">62445</td>
<td style="text-align: center;">62720</td>
<td style="text-align: center;">275</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-064643.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-064643</td>
<td style="text-align: center;">2023-10-17-064848</td>
<td style="text-align: center;">64643</td>
<td style="text-align: center;">64848</td>
<td style="text-align: center;">205</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-065806.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-065806</td>
<td style="text-align: center;">2023-10-17-070003</td>
<td style="text-align: center;">65806</td>
<td style="text-align: center;">70003</td>
<td style="text-align: center;">4197</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-075152.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-075152</td>
<td style="text-align: center;">2023-10-17-075502</td>
<td style="text-align: center;">75152</td>
<td style="text-align: center;">75502</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-080059.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-080059</td>
<td style="text-align: center;">2023-10-17-080434</td>
<td style="text-align: center;">80059</td>
<td style="text-align: center;">80434</td>
<td style="text-align: center;">375</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008333-nhosts2-ngpu8-2023-10-17-081404.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-17-081404</td>
<td style="text-align: center;">2023-10-17-081920</td>
<td style="text-align: center;">81404</td>
<td style="text-align: center;">81920</td>
<td style="text-align: center;">516</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008228-nhosts1-ngpu4-2023-10-17-090344.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-090344</td>
<td style="text-align: center;">2023-10-17-090714</td>
<td style="text-align: center;">90344</td>
<td style="text-align: center;">90714</td>
<td style="text-align: center;">370</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008228-nhosts1-ngpu4-2023-10-17-100759.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2023-10-17-100759</td>
<td style="text-align: center;">2023-10-17-100957</td>
<td style="text-align: center;">100759</td>
<td style="text-align: center;">100957</td>
<td style="text-align: center;">198</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-182501.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-182501</td>
<td style="text-align: center;">2023-10-17-184001</td>
<td style="text-align: center;">182501</td>
<td style="text-align: center;">184001</td>
<td style="text-align: center;">1500</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-193736.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-193736</td>
<td style="text-align: center;">2023-10-17-193856</td>
<td style="text-align: center;">193736</td>
<td style="text-align: center;">193856</td>
<td style="text-align: center;">120</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-195432.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-195432</td>
<td style="text-align: center;">2023-10-17-195536</td>
<td style="text-align: center;">195432</td>
<td style="text-align: center;">195536</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-201659.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-201659</td>
<td style="text-align: center;">2023-10-17-201823</td>
<td style="text-align: center;">201659</td>
<td style="text-align: center;">201823</td>
<td style="text-align: center;">164</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-202949.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-202949</td>
<td style="text-align: center;">2023-10-17-203054</td>
<td style="text-align: center;">202949</td>
<td style="text-align: center;">203054</td>
<td style="text-align: center;">105</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008404-nhosts4-ngpu16-2023-10-17-205848.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-17-205848</td>
<td style="text-align: center;">2023-10-17-205952</td>
<td style="text-align: center;">205848</td>
<td style="text-align: center;">205952</td>
<td style="text-align: center;">104</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-213244.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-213244</td>
<td style="text-align: center;">2023-10-17-213406</td>
<td style="text-align: center;">213244</td>
<td style="text-align: center;">213406</td>
<td style="text-align: center;">162</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-213558.log</code></td>
<td style="text-align: center;">GPT1T_1L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-213558</td>
<td style="text-align: center;">2023-10-17-213720</td>
<td style="text-align: center;">213558</td>
<td style="text-align: center;">213720</td>
<td style="text-align: center;">162</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-214900.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-214900</td>
<td style="text-align: center;">2023-10-17-214959</td>
<td style="text-align: center;">214900</td>
<td style="text-align: center;">214959</td>
<td style="text-align: center;">59</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215201.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215201</td>
<td style="text-align: center;">2023-10-17-215309</td>
<td style="text-align: center;">215201</td>
<td style="text-align: center;">215309</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215612.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215612</td>
<td style="text-align: center;">2023-10-17-215726</td>
<td style="text-align: center;">215612</td>
<td style="text-align: center;">215726</td>
<td style="text-align: center;">114</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008577-nhosts8-ngpu32-2023-10-17-215938.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-17-215938</td>
<td style="text-align: center;">2023-10-17-220044</td>
<td style="text-align: center;">215938</td>
<td style="text-align: center;">220044</td>
<td style="text-align: center;">4106</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-110001.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-110001</td>
<td style="text-align: center;">2023-10-18-110143</td>
<td style="text-align: center;">110001</td>
<td style="text-align: center;">110143</td>
<td style="text-align: center;">142</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-110424.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-110424</td>
<td style="text-align: center;">2023-10-18-110550</td>
<td style="text-align: center;">110424</td>
<td style="text-align: center;">110550</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-110821.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-110821</td>
<td style="text-align: center;">2023-10-18-110952</td>
<td style="text-align: center;">110821</td>
<td style="text-align: center;">110952</td>
<td style="text-align: center;">131</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008529-nhosts8-ngpu32-2023-10-18-111345.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-18-111345</td>
<td style="text-align: center;">2023-10-18-111458</td>
<td style="text-align: center;">111345</td>
<td style="text-align: center;">111458</td>
<td style="text-align: center;">113</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008197-nhosts16-ngpu64-2023-10-18-112531.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-112531</td>
<td style="text-align: center;">2023-10-18-112728</td>
<td style="text-align: center;">112531</td>
<td style="text-align: center;">112728</td>
<td style="text-align: center;">197</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-113119.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-113119</td>
<td style="text-align: center;">2023-10-18-113343</td>
<td style="text-align: center;">113119</td>
<td style="text-align: center;">113343</td>
<td style="text-align: center;">224</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-113131.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-113131</td>
<td style="text-align: center;">2023-10-18-113257</td>
<td style="text-align: center;">113131</td>
<td style="text-align: center;">113257</td>
<td style="text-align: center;">126</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-113920.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-113920</td>
<td style="text-align: center;">2023-10-18-114157</td>
<td style="text-align: center;">113920</td>
<td style="text-align: center;">114157</td>
<td style="text-align: center;">237</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008197-nhosts16-ngpu64-2023-10-18-114549.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-114549</td>
<td style="text-align: center;">2023-10-18-114721</td>
<td style="text-align: center;">114549</td>
<td style="text-align: center;">114721</td>
<td style="text-align: center;">172</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-114636.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-114636</td>
<td style="text-align: center;">2023-10-18-114805</td>
<td style="text-align: center;">114636</td>
<td style="text-align: center;">114805</td>
<td style="text-align: center;">169</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-115808.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-115808</td>
<td style="text-align: center;">2023-10-18-120146</td>
<td style="text-align: center;">115808</td>
<td style="text-align: center;">120146</td>
<td style="text-align: center;">4338</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-123039.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-123039</td>
<td style="text-align: center;">2023-10-18-123221</td>
<td style="text-align: center;">123039</td>
<td style="text-align: center;">123221</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008389-nhosts2-ngpu8-2023-10-18-123135.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-18-123135</td>
<td style="text-align: center;">2023-10-18-123300</td>
<td style="text-align: center;">123135</td>
<td style="text-align: center;">123300</td>
<td style="text-align: center;">165</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008244-nhosts4-ngpu16-2023-10-18-123206.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-18-123206</td>
<td style="text-align: center;">2023-10-18-123352</td>
<td style="text-align: center;">123206</td>
<td style="text-align: center;">123352</td>
<td style="text-align: center;">146</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008456-nhosts16-ngpu64-2023-10-18-125022.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-18-125022</td>
<td style="text-align: center;">2023-10-18-125146</td>
<td style="text-align: center;">125022</td>
<td style="text-align: center;">125146</td>
<td style="text-align: center;">124</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-122736.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-122736</td>
<td style="text-align: center;">2023-10-22-122844</td>
<td style="text-align: center;">122736</td>
<td style="text-align: center;">122844</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-123824.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-123824</td>
<td style="text-align: center;">2023-10-22-123945</td>
<td style="text-align: center;">123824</td>
<td style="text-align: center;">123945</td>
<td style="text-align: center;">121</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-130148.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-130148</td>
<td style="text-align: center;">2023-10-22-130256</td>
<td style="text-align: center;">130148</td>
<td style="text-align: center;">130256</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-131746.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-131746</td>
<td style="text-align: center;">2023-10-22-131909</td>
<td style="text-align: center;">131746</td>
<td style="text-align: center;">131909</td>
<td style="text-align: center;">163</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-132700.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-132700</td>
<td style="text-align: center;">2023-10-22-132817</td>
<td style="text-align: center;">132700</td>
<td style="text-align: center;">132817</td>
<td style="text-align: center;">117</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008256-nhosts8-ngpu32-2023-10-22-133459.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-22-133459</td>
<td style="text-align: center;">2023-10-22-133708</td>
<td style="text-align: center;">133459</td>
<td style="text-align: center;">133708</td>
<td style="text-align: center;">249</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008380-nhosts4-ngpu16-2023-10-22-175049.log</code></td>
<td style="text-align: center;">actCkpt_GPT25B</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-22-175049</td>
<td style="text-align: center;">2023-10-22-175230</td>
<td style="text-align: center;">175049</td>
<td style="text-align: center;">175230</td>
<td style="text-align: center;">181</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008649-nhosts4-ngpu16-2023-10-22-192352.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-22-192352</td>
<td style="text-align: center;">2023-10-22-192530</td>
<td style="text-align: center;">192352</td>
<td style="text-align: center;">192530</td>
<td style="text-align: center;">178</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008212-nhosts16-ngpu64-2023-10-23-081527.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-23-081527</td>
<td style="text-align: center;">2023-10-23-081702</td>
<td style="text-align: center;">81527</td>
<td style="text-align: center;">81702</td>
<td style="text-align: center;">175</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008344-nhosts2-ngpu8-2023-10-23-091436.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-23-091436</td>
<td style="text-align: center;">2023-10-23-091610</td>
<td style="text-align: center;">91436</td>
<td style="text-align: center;">91610</td>
<td style="text-align: center;">174</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008197-nhosts32-ngpu128-2023-10-24-102617.log</code></td>
<td style="text-align: center;">GPT1T_32L</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">2023-10-24-102617</td>
<td style="text-align: center;">2023-10-24-102826</td>
<td style="text-align: center;">102617</td>
<td style="text-align: center;">102826</td>
<td style="text-align: center;">209</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts64-ngpu256-2023-10-24-191748.log</code></td>
<td style="text-align: center;">GPT1T_64L</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">2023-10-24-191748</td>
<td style="text-align: center;">2023-10-24-192021</td>
<td style="text-align: center;">191748</td>
<td style="text-align: center;">192021</td>
<td style="text-align: center;">273</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-10-24-201243.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-10-24-201243</td>
<td style="text-align: center;">2023-10-24-201629</td>
<td style="text-align: center;">201243</td>
<td style="text-align: center;">201629</td>
<td style="text-align: center;">386</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-10-26-005401.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-10-26-005401</td>
<td style="text-align: center;">2023-10-26-005811</td>
<td style="text-align: center;">5401</td>
<td style="text-align: center;">5811</td>
<td style="text-align: center;">410</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008192-nhosts32-ngpu128-2023-10-26-082710.log</code></td>
<td style="text-align: center;">GPT1T_32L</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">2023-10-26-082710</td>
<td style="text-align: center;">2023-10-26-083049</td>
<td style="text-align: center;">82710</td>
<td style="text-align: center;">83049</td>
<td style="text-align: center;">339</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008585-nhosts2-ngpu8-2023-10-31-044203.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-10-31-044203</td>
<td style="text-align: center;">2023-10-31-044533</td>
<td style="text-align: center;">44203</td>
<td style="text-align: center;">44533</td>
<td style="text-align: center;">330</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008272-nhosts4-ngpu16-2023-10-31-072717.log</code></td>
<td style="text-align: center;">GPT1T_4L</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2023-10-31-072717</td>
<td style="text-align: center;">2023-10-31-073131</td>
<td style="text-align: center;">72717</td>
<td style="text-align: center;">73131</td>
<td style="text-align: center;">414</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008221-nhosts8-ngpu32-2023-10-31-083055.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-10-31-083055</td>
<td style="text-align: center;">2023-10-31-083545</td>
<td style="text-align: center;">83055</td>
<td style="text-align: center;">83545</td>
<td style="text-align: center;">490</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008196-nhosts16-ngpu64-2023-10-31-100336.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-10-31-100336</td>
<td style="text-align: center;">2023-10-31-100848</td>
<td style="text-align: center;">100336</td>
<td style="text-align: center;">100848</td>
<td style="text-align: center;">512</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008285-nhosts2-ngpu8-2023-11-01-200430.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-11-01-200430</td>
<td style="text-align: center;">2023-11-01-200829</td>
<td style="text-align: center;">200430</td>
<td style="text-align: center;">200829</td>
<td style="text-align: center;">399</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008193-nhosts8-ngpu32-2023-11-01-201702.log</code></td>
<td style="text-align: center;">GPT1T_8L</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">2023-11-01-201702</td>
<td style="text-align: center;">2023-11-01-202131</td>
<td style="text-align: center;">201702</td>
<td style="text-align: center;">202131</td>
<td style="text-align: center;">429</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008240-nhosts16-ngpu64-2023-11-01-210454.log</code></td>
<td style="text-align: center;">GPT1T_16L</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">2023-11-01-210454</td>
<td style="text-align: center;">2023-11-01-211007</td>
<td style="text-align: center;">210454</td>
<td style="text-align: center;">211007</td>
<td style="text-align: center;">553</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>foremans-nid008321-nhosts2-ngpu8-2023-11-02-154438.log</code></td>
<td style="text-align: center;">GPT1T_2L</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2023-11-02-154438</td>
<td style="text-align: center;">2023-11-02-154949</td>
<td style="text-align: center;">154438</td>
<td style="text-align: center;">154949</td>
<td style="text-align: center;">511</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>foremans-nid008192-nhosts128-ngpu512-2023-11-04-001717.log</code></td>
<td style="text-align: center;">GPT1T_128L</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2023-11-04-001717</td>
<td style="text-align: center;">2023-11-04-002124</td>
<td style="text-align: center;">1717</td>
<td style="text-align: center;">2124</td>
<td style="text-align: center;">407</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="minimal-working-example" class="level2">
<h2 class="anchored" data-anchor-id="minimal-working-example">Minimal Working Example</h2>
<ul>
<li><p>As for 3:</p>
<blockquote class="blockquote">
<p>If we need to report the startup time for the DL applications, do we need to collect measurements using the actual Aurora NRE workloads or some small benchmarking test cases? For example, we can try to recreate the typical start-up scenarios, like library imports, and measure those separately as shown below.</p>
</blockquote>
<ul>
<li><p>I‚Äôve been working on a library to help simplify this:</p>
<p><a href="https://github.com/saforem2/ezpz"><iconify-icon inline="" icon="tabler:brand-github" aria-label="Icon brand-github from tabler Iconify.design set." title="Icon brand-github from tabler Iconify.design set."></iconify-icon> <code>ezpz</code></a><br>
<span class="dim-text"><em>Minimal library that handles the initialization of distributed training</em></span></p></li>
</ul></li>
<li><p><label><input type="checkbox" checked="">&nbsp; Working on Aurora, example:</label></p>
<ul>
<li><p>Setup / Install:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># launch job</span></span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> qsub <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> EarlyAppAccess <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> Aurora_Deployment <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> walltime=2:00:00 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> select=4 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I</span></span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load frameworks</span></span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module use <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> /soft/modulefiles <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ignore_cache</span> load frameworks</span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> module load frameworks/.2023.12.15.001</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install `ezpz`</span></span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> git clone https://github.com/saforem2/ezpz</span>
<span id="cb7-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cd ezpz</span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> mkdir <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> venvs/aurora/2023.12.15.001</span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv venvs/aurora/2023.12.15.001 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-site-packages</span></span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source venvs/aurora/2023.12.15.001/bin/activate</span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> pip install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> .</span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print job info and define `launch` alias</span></span>
<span id="cb7-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> source ezpz/src/ezpz/bin/savejobenv</span>
<span id="cb7-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb7-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Hosts</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:</span>
<span id="cb7-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ x4415c6s5b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span>
<span id="cb7-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c6s6b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb7-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c6s7b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb7-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">x4415c7s0b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span></span>
<span id="cb7-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb7-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb7-26"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span> [DIST INFO]:</span>
<span id="cb7-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ Loading job env from: /home/foremans/.pbsenv</span>
<span id="cb7-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ HOSTFILE: /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NHOSTS: 4</span>
<span id="cb7-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NGPU_PER_HOST: 12</span>
<span id="cb7-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ NGPUS <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">NHOSTS</span> x NGPU_PER_HOST<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 48</span>
<span id="cb7-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ DIST_LAUNCH: mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îÇ</span>     ‚Ä¢ Defining alias: launch: aliased to mpiexec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--verbose</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--envall</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ppn</span> 12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hostfile</span> /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb7-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span></code></pre></div></li>
<li><p>Launch with <code>framework=pytorch</code>, <code>backend=DDP</code>:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># launch + startup on all workers with</span></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ‚Ä¢ `framework` ‚àà {`pytorch`, `tensorflow`}</span></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ‚Ä¢ `backend` ‚àà {`horovod`, `deepspeed`, `DDP`}</span></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where `deepspeed` and `DDP` only available for `pytorch`</span></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------</span></span>
<span id="cb8-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> launch python3 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> ezpz framework=pytorch backend=DDP</span>
<span id="cb8-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:24]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:292</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using device=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xpu'</span></span>
<span id="cb8-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:243</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using DDP for distributed training</span>
<span id="cb8-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:26]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">WARNING</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:104</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using backend=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ccl'</span></span>
<span id="cb8-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 1 / 47</span>
<span id="cb8-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 2 / 47</span>
<span id="cb8-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 3 / 47</span>
<span id="cb8-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 4 / 47</span>
<span id="cb8-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 0 / 47</span>
<span id="cb8-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 5 / 47</span>
<span id="cb8-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__.py:49</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> {</span>
<span id="cb8-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_target_"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ezpz.configs.TrainConfig"</span>,</span>
<span id="cb8-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"framework"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pytorch"</span>,</span>
<span id="cb8-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"backend"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DDP"</span>,</span>
<span id="cb8-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ds_config_path"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb8-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"port"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb8-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seed"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb8-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_wandb"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> true,</span>
<span id="cb8-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wandb_project_name"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb8-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"precision"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null,</span>
<span id="cb8-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ngpus"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">:</span> null</span>
<span id="cb8-28"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb8-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 9 / 47</span>
<span id="cb8-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 10 / 47</span>
<span id="cb8-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 11 / 47</span>
<span id="cb8-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 7 / 47</span>
<span id="cb8-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 8 / 47</span>
<span id="cb8-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 6 / 47</span>
<span id="cb8-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 12 / 47</span>
<span id="cb8-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 13 / 47</span>
<span id="cb8-37"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 14 / 47</span>
<span id="cb8-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 15 / 47</span>
<span id="cb8-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 18 / 47</span>
<span id="cb8-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 19 / 47</span>
<span id="cb8-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 20 / 47</span>
<span id="cb8-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 21 / 47</span>
<span id="cb8-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 22 / 47</span>
<span id="cb8-44"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 23 / 47</span>
<span id="cb8-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 24 / 47</span>
<span id="cb8-46"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 25 / 47</span>
<span id="cb8-47"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 26 / 47</span>
<span id="cb8-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 27 / 47</span>
<span id="cb8-49"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 30 / 47</span>
<span id="cb8-50"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 16 / 47</span>
<span id="cb8-51"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 17 / 47</span>
<span id="cb8-52"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 28 / 47</span>
<span id="cb8-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 32 / 47</span>
<span id="cb8-54"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 33 / 47</span>
<span id="cb8-55"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 36 / 47</span>
<span id="cb8-56"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 37 / 47</span>
<span id="cb8-57"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 38 / 47</span>
<span id="cb8-58"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 39 / 47</span>
<span id="cb8-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 43 / 47</span>
<span id="cb8-60"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 46 / 47</span>
<span id="cb8-61"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 29 / 47</span>
<span id="cb8-62"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 47 / 47</span>
<span id="cb8-63"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 31 / 47</span>
<span id="cb8-64"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 34 / 47</span>
<span id="cb8-65"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 35 / 47</span>
<span id="cb8-66"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 42 / 47</span>
<span id="cb8-67"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 41 / 47</span>
<span id="cb8-68"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 44 / 47</span>
<span id="cb8-69"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 45 / 47</span>
<span id="cb8-70"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:35]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:307</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> RANK: 40 / 47</span>
<span id="cb8-71"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:415</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Setting up wandb from rank: 0</span>
<span id="cb8-72"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:47]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:416</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Using: WB PROJECT: ezpz</span>
<span id="cb8-73"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:448</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> RUN: <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">flowing</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">wood</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">-</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">8</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">https://wandb.ai/l2hmc-qcd/ezpz/runs/uya29gm5</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb8-74"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:490</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Running on x4415c6s5b0n0.hostmgmt2415.cm.aurora.alcf.anl.gov</span>
<span id="cb8-75"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:506</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Reading hosts from /var/spool/pbs/aux/297306.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb8-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">__main__.py:57</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Output dir: /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17</span>
<span id="cb8-77"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:519</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> üöÄ flowing-wood-8</span>
<span id="cb8-78"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:520</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> üîó https://wandb.ai/l2hmc-qcd/ezpz/runs/uya29gm5</span>
<span id="cb8-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">CRITICAL</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:521</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> üìÇ/: /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/wandb/run-20231219_133354-uya29gm5/files</span>
<span id="cb8-80"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/ezpz-pt-DDP-xpu.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb8-81"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/__main__.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb8-82"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-17/main_debug.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span>
<span id="cb8-83"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[2023-12-19</span> 13:33:58]<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">INFO</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">][</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">dist.py:563</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> Adding /lus/gecko/projects/Aurora_deployment/foremans/projects/saforem2/ezpz/src/ezpz/outputs/runs/pytorch/DDP/2023-12-19/13-33-16/__main__.log to W<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">B</span> artifact...</span></code></pre></div></li>
</ul></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{foreman2024,
  author = {Foreman, Sam},
  title = {üê¢ {Starting} {Up} {Distributed} {Training} on {Aurora}},
  date = {2024-03-21},
  url = {https://samforeman.me/posts/AuroraGPT/startup-times/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-foreman2024" class="csl-entry quarto-appendix-citeas">
Foreman, Sam. 2024. <span>‚Äúüê¢ Starting Up Distributed Training on
Aurora.‚Äù</span> March 21, 2024. <a href="https://samforeman.me/posts/AuroraGPT/startup-times/">https://samforeman.me/posts/AuroraGPT/startup-times/</a>.
</div></div></section></div> ]]></description>
  <category>AuroraGPT</category>
  <guid>https://samforeman.me/posts/AuroraGPT/startup-times/</guid>
  <pubDate>Thu, 21 Mar 2024 05:00:00 GMT</pubDate>
</item>
</channel>
</rss>
