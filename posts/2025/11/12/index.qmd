---
title: "üßä Cooling Down Checkpoints: Best Practices for Model Evaluation"
date: "2025-11-12"
date-modified: last-modified
description: "Explore effective strategies for evaluating machine learning models using checkpoints, ensuring optimal performance and reliability"
categories:
  - machine-learning
  - model-evaluation
  - checkpoints
  - best-practices
aliases:
  - /posts/cooling-down-checkpoints/index.html
---

## üìâ Simple Experiment to Compare Validation Loss

::: {.light-content}
![Cool Down Comparison](./assets/cooldown.png)
:::

::: {.dark-content}
![Cool Down Comparison](./assets/cooldown-dark.png)
:::

## ‚òÉÔ∏è Cooling Down

- 256 Nodes of Aurora:

  - Cooled down over last 10\%:
    - W&B Run: [volcanic-blaze-4312](https://wandb.ai/aurora_gpt/AuroraGPT/runs/7bjj8vgu/overview?nw=nwuserforemans)

  - Explicit command:

    ```bash
    ROPE_THETA=50000 \
      GRAD_ACC_STEPS=2 \
      MICRO_BATCH=1 \
      USE_ACTIVATION_CHECKPOINTING=0 \
      ZERO_STAGE=0 \
      TRAIN_TOKENS=4673780159710 \
      OPT=sophiag \
      DATA_FILE_LIST=ALCF/data-lists/aurora/olmo-mix-1124.txt \
      LR_DECAY_STYLE=constant \
      LOAD=cooldown-checkpoints/sophiag-global-step-73500/global_step73500 \
      bash train_alcf.sh \
        --no-load-lr-state \
        --lr_constant_plus_cooldown \
        --lr_constant_plus_cooldown_frac 0.10
    ```

## ‚ôªÔ∏è Convert to Universal (Optional)

```bash
TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD=1 python3 ALCF/ds_to_universal.py \
    --input_folder test_rollback/global_step136000 \
    --output_folder test_rollback/global_step136000_universal
```

## üìÑ W&B Report

::: {.column-page}
<iframe loading="lazy" src="https://api.wandb.ai/links/aurora_gpt/dek99dmd"  align="center" frameborder="0" webkitallowfullscreen allowfullscreen style="border:none;height:1024px;width:100%"></iframe>
:::

<!--
::: {.callout-note icon=false title="üìë W&B Report" style="background-color: oklch(from var(#4582ec) calc(l * 1.15) c h / 0.1);"}
See W&B Report: [Cooling Down Checkpoints](https://api.wandb.ai/links/aurora_gpt/dek99dmd) for more details.
-->
<!--
::: {#fig-wandb}
<iframe loading="lazy" src="https://api.wandb.ai/links/aurora_gpt/dek99dmd"  align="center" frameborder="0" webkitallowfullscreen allowfullscreen style="border:none;height:1024px;width:100%"></iframe>
Weights \& Biases Report: [Cooling Down Checkpoints](https://api.wandb.ai/links/aurora_gpt/dek99dmd)
:::

:::
-->

