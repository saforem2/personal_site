<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../posts/l2hmc-qcd/l2hmc/2dU1/index.html" rel="next">
<link href="../../posts/long-sequences/index.html" rel="prev">
<link href="../.././favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script><link href="../.././favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-99.9.9">

  <meta name="author" content="Sam Foreman ">
  <meta name="dcterms.date" content="2024-06-15">
  <title>Sam Foreman ‚Äì üèéÔ∏è Megatron-DeepSpeed on xpu</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <script>

    window.document.addEventListener("DOMContentLoaded", function (_event) {
      const listingTargetEl = window.document.querySelector('#listing-listing .list');
      if (!listingTargetEl) {
        // No listing discovered, do not attach.
        return; 
      }

      const options = {
        valueNames: [{ data: ['index'] },{ data: ['categories'] }],
        
        searchColumns: [],
      };

      window['quarto-listings'] = window['quarto-listings'] || {};
      window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

      if (window['quarto-listing-loaded']) {
        window['quarto-listing-loaded']();
      }
    });

    window.addEventListener('hashchange',() => {
      if (window['quarto-listing-loaded']) {
        window['quarto-listing-loaded']();
      }
    })
    </script>
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XVM2Y822Y1"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XVM2Y822Y1', { 'anonymize_ip': true});
  </script>
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<link rel="alternate" type="application/rss+xml" title="Sam Foreman" href="megatron-ds-intel.xml" data-external="1"><meta property="og:title" content="Sam Foreman">
<meta property="og:description" content="My ramblings about science and computers">
<meta property="og:image" content="https://samforeman.me/posts/aurora-gpt/assets/thumbnail.png">
<meta property="og:site_name" content="Sam Foreman">
<meta property="og:image:height" content="2572">
<meta property="og:image:width" content="4112">
<meta name="twitter:title" content="Sam Foreman">
<meta name="twitter:description" content="My ramblings about science and computers">
<meta name="twitter:image" content="https://samforeman.me/posts/aurora-gpt/assets/thumbnail.png">
<meta name="twitter:creator" content="@saforem2">
<meta name="twitter:site" content="@saforem2">
<meta name="twitter:image-height" content="2572">
<meta name="twitter:image-width" content="4112">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Megatron DeepSpeed on `xpu`">
<meta name="citation_author" content="Sam Foreman">
<meta name="citation_publication_date" content="2024-06-15">
<meta name="citation_cover_date" content="2024-06-15">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-06-15">
<meta name="citation_fulltext_html_url" content="https://samforeman.me/qmd/aurora-gpt/megatron-ds-intel.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=The climate risk &amp;amp;amp; resilience portal (ClimRR) metadata and data dictionary;,citation_author=C. Burdi;,citation_author=Wall. T Branham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://dub.sh/ClimRR-Metadata;">
<meta name="citation_reference" content="citation_title=Progress on $(g-2)_\mu$ from lattice QCD;,citation_author=Hartmut Wittig;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2306.04165;">
<meta name="citation_reference" content="citation_title=Hybrid Monte Carlo;,citation_author=S. Duane;,citation_author=A. D. Kennedy;,citation_author=B. J. Pendleton;,citation_author=D. Roweth;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_doi=10.1016/0370-2693(87)91197-X;,citation_volume=195;,citation_journal_title=Phys. Lett. B;">
<meta name="citation_reference" content="citation_title=Snowmass 2021 Computational Frontier CompF03 Topical Group Report: Machine Learning;,citation_author=Phiala Shanahan;,citation_author=others;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2209.07559;">
<meta name="citation_reference" content="citation_title=Applications of Machine Learning to Lattice Quantum Field Theory;,citation_author=Denis Boyda;,citation_author=others;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2202.05838;,citation_conference_title=Snowmass 2021;">
<meta name="citation_reference" content="citation_title=HMC with Normalizing Flows;,citation_author=Sam Foreman;,citation_author=Taku Izubuchi;,citation_author=Luchang Jin;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_author=Akio Tomiya;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01586;,citation_doi=10.22323/1.396.0073;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=LeapfrogLayers: A Trainable Framework for Effective Topological Sampling;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01582;,citation_doi=10.22323/1.396.0508;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=Deep Learning Hamiltonian Monte Carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;,citation_conference_title=9th International Conference on Learning Representations;">
<meta name="citation_reference" content="citation_title=Energy Justice Analysis of Climate Data with ClimRR;,citation_author=Sam Foreman;,citation_publication_date=2023-08-07;,citation_cover_date=2023-08-07;,citation_year=2023;,citation_fulltext_html_url=https://saforem2.github.io/climate-analysis;,citation_language=en;">
<meta name="citation_reference" content="citation_author=Sam Foreman;,citation_publication_date=2023-08-19;,citation_cover_date=2023-08-19;,citation_year=2023;,citation_fulltext_html_url=https://saforem2.github.io/l2hmc-qcd;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Deep learning hamiltonian monte carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;">
<meta name="citation_reference" content="citation_title=MLMC: Machine learning monte carlo for lattice gauge theory;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James Osborn;,citation_publication_date=00;,citation_cover_date=00;,citation_year=0;,citation_conference_title=40th international symposium on lattice field theory (lattice 2023) (batavia, IL, united states, 07/31/2023 - 08/04/2023);">
<meta name="citation_reference" content="citation_title=Progress on $(g-2)_\mu$ from lattice QCD;,citation_author=Hartmut Wittig;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2306.04165;">
<meta name="citation_reference" content="citation_title=Hybrid Monte Carlo;,citation_author=S. Duane;,citation_author=A. D. Kennedy;,citation_author=B. J. Pendleton;,citation_author=D. Roweth;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_doi=10.1016/0370-2693(87)91197-X;,citation_volume=195;,citation_journal_title=Phys. Lett. B;">
<meta name="citation_reference" content="citation_title=Snowmass 2021 Computational Frontier CompF03 Topical Group Report: Machine Learning;,citation_author=Phiala Shanahan;,citation_author=others;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2209.07559;">
<meta name="citation_reference" content="citation_title=Applications of Machine Learning to Lattice Quantum Field Theory;,citation_author=Denis Boyda;,citation_author=others;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2202.05838;,citation_conference_title=Snowmass 2021;">
<meta name="citation_reference" content="citation_title=LeapfrogLayers: A Trainable Framework for Effective Topological Sampling;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2022-05;,citation_cover_date=2022-05;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01582;,citation_doi=10.22323/1.396.0508;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=HMC with Normalizing Flows;,citation_author=Sam Foreman;,citation_author=Taku Izubuchi;,citation_author=Luchang Jin;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_author=Akio Tomiya;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01586;,citation_doi=10.22323/1.396.0073;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=Deep Learning Hamiltonian Monte Carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;,citation_conference_title=9th International Conference on Learning Representations;">
<meta name="citation_reference" content="citation_title=Mastering language models;,citation_author=Samuel Montgomery;,citation_publication_date=2023-10;,citation_cover_date=2023-10;,citation_year=2023;,citation_fulltext_html_url=https://towardsdatascience.com/mastering-language-models-32e1d891511a;,citation_journal_title=Medium;,citation_publisher=Towards Data Science;">
<meta name="citation_reference" content="citation_title=Harnessing the power of LLMs in practice: A survey on ChatGPT and beyond;,citation_author=Jingfeng Yang;,citation_author=Hongye Jin;,citation_author=Ruixiang Tang;,citation_author=Xiaotian Han;,citation_author=Qizhang Feng;,citation_author=Haoming Jiang;,citation_author=Bing Yin;,citation_author=Xia Hu;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2304.13712;">
<meta name="citation_reference" content="citation_title=Training tips for the transformer model;,citation_author=Martin Popel;,citation_author=Ond≈ôej Bojar;,citation_publication_date=2018-04;,citation_cover_date=2018-04;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.2478%2Fpralin-2018-0002;,citation_issue=1;,citation_doi=10.2478/pralin-2018-0002;,citation_volume=110;,citation_journal_title=The Prague Bulletin of Mathematical Linguistics;,citation_publisher=Charles University in Prague, Karolinum Press;">
<meta name="citation_reference" content="citation_title=Attention is all you need;,citation_author=Ashish Vaswani;,citation_author=Noam Shazeer;,citation_author=Niki Parmar;,citation_author=Jakob Uszkoreit;,citation_author=Llion Jones;,citation_author=Aidan N. Gomez;,citation_author=Lukasz Kaiser;,citation_author=Illia Polosukhin;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://arxiv.org/abs/1706.03762;">
<meta name="citation_reference" content="citation_title=Tree of thoughts: Deliberate problem solving with large language models;,citation_author=Shunyu Yao;,citation_author=Dian Yu;,citation_author=Jeffrey Zhao;,citation_author=Izhak Shafran;,citation_author=Thomas L. Griffiths;,citation_author=Yuan Cao;,citation_author=Karthik Narasimhan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2305.10601;">
<meta name="citation_reference" content="citation_title=GenSLMs: Genome-scale language models reveal SARS-CoV-2 evolutionary dynamics;,citation_abstract=We seek to transform how new and emergent variants of pandemiccausing viruses, specifically SARS-CoV-2, are identified and classified. By adapting large language models (LLMs) for genomic data, we build genome-scale language models (GenSLMs) which can learn the evolutionary landscape of SARS-CoV-2 genomes. By pretraining on over 110 million prokaryotic gene sequences and finetuning a SARS-CoV-2-specific model on 1.5 million genomes, we show that GenSLMs can accurately and rapidly identify variants of concern. Thus, to our knowledge, GenSLMs represents one of the first whole genome scale foundation models which can generalize to other prediction tasks. We demonstrate scaling of GenSLMs on GPU-based supercomputers and AI-hardware accelerators utilizing 1.63 Zettaflops in training runs with a sustained performance of 121 PFLOPS in mixed precision and peak of 850 PFLOPS. We present initial scientific insights from examining GenSLMs in tracking evolutionary dynamics of SARS-CoV-2, paving the path to realizing this on large biological data.Competing Interest StatementThe authors have declared no competing interest.;,citation_author=Maxim Zvyagin;,citation_author=Alexander Brace;,citation_author=Kyle Hippe;,citation_author=Yuntian Deng;,citation_author=Bin Zhang;,citation_author=Cindy Orozco Bohorquez;,citation_author=Austin Clyde;,citation_author=Bharat Kale;,citation_author=Danilo Perez-Rivera;,citation_author=Heng Ma;,citation_author=Carla M. Mann;,citation_author=Michael Irvin;,citation_author=J. Gregory Pauloski;,citation_author=Logan Ward;,citation_author=Valerie Hayot-Sasson;,citation_author=Murali Emani;,citation_author=Sam Foreman;,citation_author=Zhen Xie;,citation_author=Diangen Lin;,citation_author=Maulik Shukla;,citation_author=Weili Nie;,citation_author=Josh Romero;,citation_author=Christian Dallago;,citation_author=Arash Vahdat;,citation_author=Chaowei Xiao;,citation_author=Thomas Gibbs;,citation_author=Ian Foster;,citation_author=James J. Davis;,citation_author=Michael E. Papka;,citation_author=Thomas Brettin;,citation_author=Rick Stevens;,citation_author=Anima Anandkumar;,citation_author=Venkatram Vishwanath;,citation_author=Arvind Ramanathan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.biorxiv.org/content/early/2022/11/23/2022.10.10.511571;,citation_doi=10.1101/2022.10.10.511571;,citation_journal_title=bioRxiv;,citation_publisher=Cold Spring Harbor Laboratory;">
<link rel="alternate" type="application/rss+xml" title="Sam Foreman" href="megatron-ds-intel.xml" data-external="1"><meta property="og:title" content="Sam Foreman">
<meta property="og:description" content="My ramblings about science and computers">
<meta property="og:image" content="https://samforeman.me/posts/aurora-gpt/assets/thumbnail.png">
<meta property="og:site_name" content="Sam Foreman">
<meta property="og:image:height" content="2572">
<meta property="og:image:width" content="4112">
<meta name="twitter:title" content="Sam Foreman">
<meta name="twitter:description" content="My ramblings about science and computers">
<meta name="twitter:image" content="https://samforeman.me/posts/aurora-gpt/assets/thumbnail.png">
<meta name="twitter:creator" content="@saforem2">
<meta name="twitter:site" content="@saforem2">
<meta name="twitter:image-height" content="2572">
<meta name="twitter:image-width" content="4112">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Megatron DeepSpeed on `xpu`">
<meta name="citation_author" content="Sam Foreman">
<meta name="citation_publication_date" content="2024-06-15">
<meta name="citation_cover_date" content="2024-06-15">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-06-15">
<meta name="citation_fulltext_html_url" content="https://samforeman.me/qmd/aurora-gpt/megatron-ds-intel.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=The climate risk &amp;amp;amp; resilience portal (ClimRR) metadata and data dictionary;,citation_author=C. Burdi;,citation_author=Wall. T Branham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://dub.sh/ClimRR-Metadata;">
<meta name="citation_reference" content="citation_title=Progress on $(g-2)_\mu$ from lattice QCD;,citation_author=Hartmut Wittig;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2306.04165;">
<meta name="citation_reference" content="citation_title=Hybrid Monte Carlo;,citation_author=S. Duane;,citation_author=A. D. Kennedy;,citation_author=B. J. Pendleton;,citation_author=D. Roweth;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_doi=10.1016/0370-2693(87)91197-X;,citation_volume=195;,citation_journal_title=Phys. Lett. B;">
<meta name="citation_reference" content="citation_title=Snowmass 2021 Computational Frontier CompF03 Topical Group Report: Machine Learning;,citation_author=Phiala Shanahan;,citation_author=others;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2209.07559;">
<meta name="citation_reference" content="citation_title=Applications of Machine Learning to Lattice Quantum Field Theory;,citation_author=Denis Boyda;,citation_author=others;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2202.05838;,citation_conference_title=Snowmass 2021;">
<meta name="citation_reference" content="citation_title=HMC with Normalizing Flows;,citation_author=Sam Foreman;,citation_author=Taku Izubuchi;,citation_author=Luchang Jin;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_author=Akio Tomiya;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01586;,citation_doi=10.22323/1.396.0073;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=LeapfrogLayers: A Trainable Framework for Effective Topological Sampling;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01582;,citation_doi=10.22323/1.396.0508;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=Deep Learning Hamiltonian Monte Carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;,citation_conference_title=9th International Conference on Learning Representations;">
<meta name="citation_reference" content="citation_title=Energy Justice Analysis of Climate Data with ClimRR;,citation_author=Sam Foreman;,citation_publication_date=2023-08-07;,citation_cover_date=2023-08-07;,citation_year=2023;,citation_fulltext_html_url=https://saforem2.github.io/climate-analysis;,citation_language=en;">
<meta name="citation_reference" content="citation_author=Sam Foreman;,citation_publication_date=2023-08-19;,citation_cover_date=2023-08-19;,citation_year=2023;,citation_fulltext_html_url=https://saforem2.github.io/l2hmc-qcd;,citation_language=en;">
<meta name="citation_reference" content="citation_title=Deep learning hamiltonian monte carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;">
<meta name="citation_reference" content="citation_title=MLMC: Machine learning monte carlo for lattice gauge theory;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James Osborn;,citation_publication_date=00;,citation_cover_date=00;,citation_year=0;,citation_conference_title=40th international symposium on lattice field theory (lattice 2023) (batavia, IL, united states, 07/31/2023 - 08/04/2023);">
<meta name="citation_reference" content="citation_title=Progress on $(g-2)_\mu$ from lattice QCD;,citation_author=Hartmut Wittig;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2306.04165;">
<meta name="citation_reference" content="citation_title=Hybrid Monte Carlo;,citation_author=S. Duane;,citation_author=A. D. Kennedy;,citation_author=B. J. Pendleton;,citation_author=D. Roweth;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_doi=10.1016/0370-2693(87)91197-X;,citation_volume=195;,citation_journal_title=Phys. Lett. B;">
<meta name="citation_reference" content="citation_title=Snowmass 2021 Computational Frontier CompF03 Topical Group Report: Machine Learning;,citation_author=Phiala Shanahan;,citation_author=others;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2209.07559;">
<meta name="citation_reference" content="citation_title=Applications of Machine Learning to Lattice Quantum Field Theory;,citation_author=Denis Boyda;,citation_author=others;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2202.05838;,citation_conference_title=Snowmass 2021;">
<meta name="citation_reference" content="citation_title=LeapfrogLayers: A Trainable Framework for Effective Topological Sampling;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2022-05;,citation_cover_date=2022-05;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01582;,citation_doi=10.22323/1.396.0508;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=HMC with Normalizing Flows;,citation_author=Sam Foreman;,citation_author=Taku Izubuchi;,citation_author=Luchang Jin;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_author=Akio Tomiya;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2112.01586;,citation_doi=10.22323/1.396.0073;,citation_volume=LATTICE2021;,citation_journal_title=PoS;">
<meta name="citation_reference" content="citation_title=Deep Learning Hamiltonian Monte Carlo;,citation_author=Sam Foreman;,citation_author=Xiao-Yong Jin;,citation_author=James C. Osborn;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=https://arxiv.org/abs/2105.03418;,citation_conference_title=9th International Conference on Learning Representations;">
<meta name="citation_reference" content="citation_title=Mastering language models;,citation_author=Samuel Montgomery;,citation_publication_date=2023-10;,citation_cover_date=2023-10;,citation_year=2023;,citation_fulltext_html_url=https://towardsdatascience.com/mastering-language-models-32e1d891511a;,citation_journal_title=Medium;,citation_publisher=Towards Data Science;">
<meta name="citation_reference" content="citation_title=Harnessing the power of LLMs in practice: A survey on ChatGPT and beyond;,citation_author=Jingfeng Yang;,citation_author=Hongye Jin;,citation_author=Ruixiang Tang;,citation_author=Xiaotian Han;,citation_author=Qizhang Feng;,citation_author=Haoming Jiang;,citation_author=Bing Yin;,citation_author=Xia Hu;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2304.13712;">
<meta name="citation_reference" content="citation_title=Training tips for the transformer model;,citation_author=Martin Popel;,citation_author=Ond≈ôej Bojar;,citation_publication_date=2018-04;,citation_cover_date=2018-04;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.2478%2Fpralin-2018-0002;,citation_issue=1;,citation_doi=10.2478/pralin-2018-0002;,citation_volume=110;,citation_journal_title=The Prague Bulletin of Mathematical Linguistics;,citation_publisher=Charles University in Prague, Karolinum Press;">
<meta name="citation_reference" content="citation_title=Attention is all you need;,citation_author=Ashish Vaswani;,citation_author=Noam Shazeer;,citation_author=Niki Parmar;,citation_author=Jakob Uszkoreit;,citation_author=Llion Jones;,citation_author=Aidan N. Gomez;,citation_author=Lukasz Kaiser;,citation_author=Illia Polosukhin;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://arxiv.org/abs/1706.03762;">
<meta name="citation_reference" content="citation_title=Tree of thoughts: Deliberate problem solving with large language models;,citation_author=Shunyu Yao;,citation_author=Dian Yu;,citation_author=Jeffrey Zhao;,citation_author=Izhak Shafran;,citation_author=Thomas L. Griffiths;,citation_author=Yuan Cao;,citation_author=Karthik Narasimhan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2305.10601;">
<meta name="citation_reference" content="citation_title=GenSLMs: Genome-scale language models reveal SARS-CoV-2 evolutionary dynamics;,citation_abstract=We seek to transform how new and emergent variants of pandemiccausing viruses, specifically SARS-CoV-2, are identified and classified. By adapting large language models (LLMs) for genomic data, we build genome-scale language models (GenSLMs) which can learn the evolutionary landscape of SARS-CoV-2 genomes. By pretraining on over 110 million prokaryotic gene sequences and finetuning a SARS-CoV-2-specific model on 1.5 million genomes, we show that GenSLMs can accurately and rapidly identify variants of concern. Thus, to our knowledge, GenSLMs represents one of the first whole genome scale foundation models which can generalize to other prediction tasks. We demonstrate scaling of GenSLMs on GPU-based supercomputers and AI-hardware accelerators utilizing 1.63 Zettaflops in training runs with a sustained performance of 121 PFLOPS in mixed precision and peak of 850 PFLOPS. We present initial scientific insights from examining GenSLMs in tracking evolutionary dynamics of SARS-CoV-2, paving the path to realizing this on large biological data.Competing Interest StatementThe authors have declared no competing interest.;,citation_author=Maxim Zvyagin;,citation_author=Alexander Brace;,citation_author=Kyle Hippe;,citation_author=Yuntian Deng;,citation_author=Bin Zhang;,citation_author=Cindy Orozco Bohorquez;,citation_author=Austin Clyde;,citation_author=Bharat Kale;,citation_author=Danilo Perez-Rivera;,citation_author=Heng Ma;,citation_author=Carla M. Mann;,citation_author=Michael Irvin;,citation_author=J. Gregory Pauloski;,citation_author=Logan Ward;,citation_author=Valerie Hayot-Sasson;,citation_author=Murali Emani;,citation_author=Sam Foreman;,citation_author=Zhen Xie;,citation_author=Diangen Lin;,citation_author=Maulik Shukla;,citation_author=Weili Nie;,citation_author=Josh Romero;,citation_author=Christian Dallago;,citation_author=Arash Vahdat;,citation_author=Chaowei Xiao;,citation_author=Thomas Gibbs;,citation_author=Ian Foster;,citation_author=James J. Davis;,citation_author=Michael E. Papka;,citation_author=Thomas Brettin;,citation_author=Rick Stevens;,citation_author=Anima Anandkumar;,citation_author=Venkatram Vishwanath;,citation_author=Arvind Ramanathan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.biorxiv.org/content/early/2022/11/23/2022.10.10.511571;,citation_doi=10.1101/2022.10.10.511571;,citation_journal_title=bioRxiv;,citation_publisher=Cold Spring Harbor Laboratory;">
</head>
<body class="quarto-light nav-sidebar fullcontent">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/index.html">ü™ß Posts</a></li><li class="breadcrumb-item"><a href="../../posts/aurora-gpt/megatron-ds-intel.html">üèéÔ∏è `Megatron-DeepSpeed` + Intel XPU</a></li></ol></nav>
  <h1 class="title">üèéÔ∏è <code>Megatron-DeepSpeed</code> on <code>xpu</code></h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://samforeman.me"><span class="dim-text">Sam Foreman</span> </a><a href="https://orcid.org/0000-0002-9981-0876"><span class="orcid-green"><i class="ai  ai-orcid"></i></span></a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:foremans@anl.gov">foremans@anl.gov</a>
</div>
        <p class="quarto-title-affiliation">
            <a href="https://alcf.anl.gov/about/people/sam-foreman">
            [ALCF]
            </a>
          </p>
    </div>
</div>

  <p class="date">2024-06-15</p>
</section>
<section id="install-setup" class="slide level2">
<h2>Install / Setup</h2>
<ul>
<li><p>Setup script / history:</p>
<details closed="">
<summary>
<p>Interactive Session</p>
</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a></a><span class="ex">$</span> export HTTP_PROXY=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-2"><a></a><span class="ex">$</span> export HTTPS_PROXY=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-3"><a></a><span class="ex">$</span> export http_proxy=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-4"><a></a><span class="ex">$</span> export https_proxy=http://proxy.alcf.anl.gov:3128</span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a><span class="ex">$</span> export DRM_LIB=<span class="st">"</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span><span class="st">/usr/include/libdrm"</span></span>
<span id="cb1-7"><a></a><span class="co"># $ export PATH="${HOME}/miniconda3/bin:$PATH"</span></span>
<span id="cb1-8"><a></a></span>
<span id="cb1-9"><a></a><span class="ex">$</span> conda create <span class="at">--name</span> anl_release_q4 python=3.9 <span class="at">--y</span></span>
<span id="cb1-10"><a></a><span class="ex">$</span> wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh <span class="at">-O</span> ~/miniconda3/miniconda.sh</span>
<span id="cb1-11"><a></a><span class="ex">$</span> bash ~/miniconda3/miniconda.sh <span class="at">-b</span> <span class="at">-u</span> <span class="at">-p</span> ~/miniconda3</span>
<span id="cb1-12"><a></a><span class="ex">$</span> eval <span class="st">"</span><span class="va">$(${HOME}</span> shell.zsh hook<span class="va">)</span><span class="st">"</span></span>
<span id="cb1-13"><a></a></span>
<span id="cb1-14"><a></a><span class="ex">$</span> export DRM_LIB=<span class="st">"</span><span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span><span class="st">/usr/include/libdrm"</span></span>
<span id="cb1-15"><a></a><span class="ex">$</span> conda config <span class="at">--add</span> channels conda-forge <span class="kw">&amp;&amp;</span> <span class="ex">conda</span> install <span class="at">-c</span> conda-forge mpi4py <span class="at">-y</span> <span class="at">--no-deps</span> <span class="kw">&amp;&amp;</span> <span class="ex">conda</span> install <span class="at">-c</span> conda-forge libssh <span class="at">-y</span> <span class="kw">&amp;&amp;</span> <span class="ex">conda</span> uninstall mpi <span class="at">-y</span> <span class="kw">&amp;&amp;</span> <span class="ex">python3</span> <span class="at">-m</span> pip install <span class="at">-r</span> requirements.txt <span class="kw">&amp;&amp;</span> <span class="ex">python3</span> <span class="at">-m</span> pip install <span class="pp">*</span>.whl</span>
<span id="cb1-16"><a></a></span>
<span id="cb1-17"><a></a><span class="ex">$</span> module unload oneapi/eng-compiler/2022.12.30.003</span>
<span id="cb1-18"><a></a><span class="ex">$</span> module unload intel_compute_runtime/release/agama-devel-551</span>
<span id="cb1-19"><a></a><span class="ex">$</span> module use <span class="at">-a</span> /soft/modulefiles</span>
<span id="cb1-20"><a></a><span class="ex">$</span> module load oneapi/release/2023.12.15.001</span>
<span id="cb1-21"><a></a><span class="ex">$</span> module use /home/ftartagl/graphics-compute-runtime/modulefiles</span>
<span id="cb1-22"><a></a><span class="ex">$</span> module load graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb1-23"><a></a><span class="co"># one-liner for modules:</span></span>
<span id="cb1-24"><a></a><span class="co"># module unload oneapi/eng-compiler/2022.12.30.003 &amp;&amp; module unload intel_compute_runtime/release/agama-devel-551&amp;&amp; module use -a /soft/modulefiles &amp;&amp; module load oneapi/release/2023.12.15.001 &amp;&amp; module use /home/ftartagl/graphics-compute-runtime/modulefiles &amp;&amp; module load graphics-compute-runtime/agama-ci-devel-736.9</span></span>
<span id="cb1-25"><a></a></span>
<span id="cb1-26"><a></a><span class="ex">$</span> cd torch-ccl</span>
<span id="cb1-27"><a></a><span class="ex">$</span> ls</span>
<span id="cb1-28"><a></a><span class="ex">$</span> COMPUTE_BACKEND=dpcpp python3 setup.py develop <span class="kw">|&amp;</span> <span class="fu">tee</span> build.log</span>
<span id="cb1-29"><a></a><span class="ex">$</span> cd ../</span>
<span id="cb1-30"><a></a></span>
<span id="cb1-31"><a></a><span class="ex">$</span> cd intel-extension-for-deepspeed</span>
<span id="cb1-32"><a></a><span class="ex">$</span> python3 setup.py develop <span class="kw">|&amp;</span> <span class="fu">tee</span> build.log</span>
<span id="cb1-33"><a></a><span class="ex">$</span> cd ../</span>
<span id="cb1-34"><a></a></span>
<span id="cb1-35"><a></a><span class="ex">$</span> cd DeepSpeed</span>
<span id="cb1-36"><a></a><span class="ex">$</span> ls</span>
<span id="cb1-37"><a></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install <span class="at">-r</span> requirements/requirements.txt</span>
<span id="cb1-38"><a></a><span class="ex">$</span> python3 setup.py develop <span class="kw">|&amp;</span> <span class="fu">tee</span> build.log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details></li>
</ul>
</section>
<section id="running" class="slide level2">
<h2>Running</h2>
<h3 id="using-launch">Using <code>launch</code></h3>
<ul>
<li><p>Setup:</p>
<details closed="">
<summary>
<p>Setup</p>
</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a></a><span class="ex">$</span> qsub <span class="at">-q</span> EarlyAppAccess <span class="at">-A</span> Aurora_Deployment <span class="at">-l</span> walltime=08:00:00 <span class="at">-l</span> select=2 <span class="at">-I</span></span>
<span id="cb2-2"><a></a><span class="ex">qsub:</span> waiting for job 604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov to start</span>
<span id="cb2-3"><a></a><span class="ex">qsub:</span> job 604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov ready</span>
<span id="cb2-4"><a></a></span>
<span id="cb2-5"><a></a><span class="ex">$</span> module unload oneapi/eng-compiler/2022.12.30.003 <span class="kw">&amp;&amp;</span> <span class="ex">module</span> unload intel_compute_runtime/release/agama-devel-551<span class="kw">&amp;&amp;</span> <span class="ex">module</span> use <span class="at">-a</span> /soft/modulefiles <span class="kw">&amp;&amp;</span> <span class="ex">module</span> load oneapi/release/2023.12.15.001 <span class="kw">&amp;&amp;</span> <span class="ex">module</span> use /home/ftartagl/graphics-compute-runtime/modulefiles <span class="kw">&amp;&amp;</span> <span class="ex">module</span> load graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb2-6"><a></a> <span class="ex">UMD:</span> agama-ci-devel-736.9 successfully loaded:</span>
<span id="cb2-7"><a></a> <span class="ex">UMD:</span> graphics-compute-runtime/agama-ci-devel-736.9</span>
<span id="cb2-8"><a></a></span>
<span id="cb2-9"><a></a><span class="ex">$</span> eval <span class="st">"</span><span class="va">$(</span><span class="ex">/home/foremans/miniconda3/bin/conda</span> shell.zsh hook<span class="va">)</span><span class="st">"</span></span>
<span id="cb2-10"><a></a></span>
<span id="cb2-11"><a></a><span class="ex">$</span> conda activate anl_release_q4</span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a><span class="ex">$</span> git clone https://github.com/saforem2/ezpz</span>
<span id="cb2-14"><a></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install <span class="at">-e</span> <span class="st">"ezpz[dev]"</span></span>
<span id="cb2-15"><a></a><span class="co"># [</span><span class="al">BUG</span><span class="co">] for some reason, need to run twice ¬Ø\_(„ÉÑ)_/¬Ø</span></span>
<span id="cb2-16"><a></a><span class="ex">$</span> source ./ezpz/src/ezpz/bin/savejobenv <span class="kw">&amp;&amp;</span> <span class="bu">source</span> ./ezpz/src/ezpz/bin/savejobenv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a></a><span class="ex">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-2"><a></a><span class="ex">‚îÇ</span> Writing PBS vars to /home/foremans/.pbsenv</span>
<span id="cb3-3"><a></a><span class="ex">‚îÇ</span> HOSTFILE: /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb3-4"><a></a><span class="ex">‚îÇ</span> NHOSTS: 2</span>
<span id="cb3-5"><a></a><span class="ex">‚îÇ</span> NGPU_PER_HOST: 12 GPUs per host</span>
<span id="cb3-6"><a></a><span class="ex">‚îÇ</span> NGPUS: 24 GPUs total</span>
<span id="cb3-7"><a></a><span class="ex">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-8"><a></a><span class="ex">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-9"><a></a><span class="ex">‚îÇ</span> [DIST INFO]:</span>
<span id="cb3-10"><a></a><span class="ex">‚îÇ</span>   ‚Ä¢ Writing Job info to /home/foremans/.pbsenv</span>
<span id="cb3-11"><a></a><span class="ex">‚îÇ</span>     ‚Ä¢ HOSTFILE: /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span>
<span id="cb3-12"><a></a><span class="ex">‚îÇ</span>     ‚Ä¢ NHOSTS: 2</span>
<span id="cb3-13"><a></a><span class="ex">‚îÇ</span>     ‚Ä¢ NGPU_PER_HOST: 12</span>
<span id="cb3-14"><a></a><span class="ex">‚îÇ</span>     ‚Ä¢ NGPUS = <span class="er">(</span><span class="ex">NHOSTS</span> <span class="pp">*</span> NGPU_PER_HOST<span class="kw">)</span> <span class="ex">=</span> 24</span>
<span id="cb3-15"><a></a><span class="ex">‚îÇ</span> <span class="pp">[</span><span class="ss">Hosts</span><span class="pp">]</span>:</span>
<span id="cb3-16"><a></a><span class="ex">‚îÇ</span>       ‚Ä¢ x4502c0s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov, x4502c0s2b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb3-17"><a></a><span class="ex">‚îÇ</span> <span class="pp">[</span><span class="ss">Launch</span><span class="pp">]</span>:</span>
<span id="cb3-18"><a></a><span class="ex">‚îÇ</span>     ‚Ä¢ Use: <span class="st">'launch'</span> <span class="er">(</span><span class="ex">=mpiexec</span> <span class="at">--verbose</span> <span class="at">--envall</span> <span class="at">-n</span> 24 <span class="at">-ppn</span> 12 <span class="at">--hostfile</span> /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov<span class="kw">)</span></span>
<span id="cb3-19"><a></a><span class="ex">‚îÇ</span>       to launch job</span>
<span id="cb3-20"><a></a><span class="ex">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-21"><a></a><span class="ex">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb3-22"><a></a><span class="ex">‚îÇ</span> YOU ARE HERE: /home/foremans</span>
<span id="cb3-23"><a></a><span class="ex">‚îÇ</span> Run <span class="st">'source ./bin/getjobenv'</span> in a NEW SHELL to automatically set env vars</span>
<span id="cb3-24"><a></a><span class="ex">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details closed="">
<summary>
<p>[WIP] Building out <code>python</code> API</p>
</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a></a><span class="ex">$</span> python3 <span class="at">-m</span> ezpz.savejobenv</span>
<span id="cb4-2"><a></a><span class="ex">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st">'If you dont plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb4-3"><a></a>  <span class="ex">warn</span><span class="er">(</span></span>
<span id="cb4-4"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:185</span><span class="pp">]</span> <span class="at">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.sh</span>
<span id="cb4-5"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:193</span><span class="pp">]</span> <span class="at">-</span> Saving job env to dot-env <span class="er">(</span><span class="ex">.env</span><span class="kw">)</span> <span class="fu">file</span> in /home/foremans</span>
<span id="cb4-6"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:211</span><span class="pp">]</span> <span class="at">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.json</span>
<span id="cb4-7"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:225</span><span class="pp">]</span> <span class="at">-</span> Saving job env to /home/foremans/PBS-jobs/604319/jobenv.yaml</span>
<span id="cb4-8"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:253</span><span class="pp">]</span> <span class="at">-</span> Writing PBS env vars to /home/foremans/PBS-jobs/604319 / jobenv{.sh, .yaml, .json}</span>
<span id="cb4-9"><a></a><span class="ex">[2024-01-23</span> 10:02:37]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">jobs:258</span><span class="pp">]</span> <span class="at">-</span> jobenv={</span>
<span id="cb4-10"><a></a>    <span class="st">"BACKEND"</span><span class="ex">:</span> <span class="st">"gloo"</span>,</span>
<span id="cb4-11"><a></a>    <span class="st">"DEVICE"</span><span class="ex">:</span> <span class="st">"xpu"</span>,</span>
<span id="cb4-12"><a></a>    <span class="st">"DEVICE_ID"</span><span class="ex">:</span> <span class="st">"xpu:0"</span>,</span>
<span id="cb4-13"><a></a>    <span class="st">"DISTRIBUTED_BACKEND"</span><span class="ex">:</span> <span class="st">"gloo"</span>,</span>
<span id="cb4-14"><a></a>    <span class="st">"FRAMEWORK"</span><span class="ex">:</span> <span class="st">"pytorch"</span>,</span>
<span id="cb4-15"><a></a>    <span class="st">"GPUS_PER_NODE"</span><span class="ex">:</span> 12,</span>
<span id="cb4-16"><a></a>    <span class="st">"HOSTFILE"</span><span class="ex">:</span> <span class="st">"/var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-17"><a></a>    <span class="st">"HOSTNAME"</span><span class="ex">:</span> <span class="st">"x4502c0s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-18"><a></a>    <span class="st">"HOSTS"</span><span class="ex">:</span> <span class="st">"[x4502c0s0b0n0, x4502c0s2b0n0]"</span>,</span>
<span id="cb4-19"><a></a>    <span class="st">"LAUNCH_CMD"</span><span class="ex">:</span> <span class="st">"mpiexec --verbose --envall -n 24 -ppn 12 --hostfile /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-20"><a></a>    <span class="st">"LOCAL_RANK"</span><span class="ex">:</span> 0,</span>
<span id="cb4-21"><a></a>    <span class="st">"MACHINE"</span><span class="ex">:</span> <span class="st">"Aurora"</span>,</span>
<span id="cb4-22"><a></a>    <span class="st">"NGPUS"</span><span class="ex">:</span> 24,</span>
<span id="cb4-23"><a></a>    <span class="st">"NGPU_PER_HOST"</span><span class="ex">:</span> <span class="st">"12"</span>,</span>
<span id="cb4-24"><a></a>    <span class="st">"NHOSTS"</span><span class="ex">:</span> <span class="st">"2"</span>,</span>
<span id="cb4-25"><a></a>    <span class="st">"NODE_ID"</span><span class="ex">:</span> 0,</span>
<span id="cb4-26"><a></a>    <span class="st">"NUM_NODES"</span><span class="ex">:</span> 2,</span>
<span id="cb4-27"><a></a>    <span class="st">"PBS_ACCOUNT"</span><span class="ex">:</span> <span class="st">"Aurora_Deployment"</span>,</span>
<span id="cb4-28"><a></a>    <span class="st">"PBS_ENVIRONMENT"</span><span class="ex">:</span> <span class="st">"PBS_INTERACTIVE"</span>,</span>
<span id="cb4-29"><a></a>    <span class="st">"PBS_HOOK_RESOURCES"</span><span class="ex">:</span> <span class="st">"eJyVUV1vwjAM/EOblHZbgUV54yfs3TKp22bkozgJqP9+LjAJ9jYpD7HvfL5L0Pt0AbQ21VjATmSPMKDzlck0Gq9opBGLOxOspZVriit2Qe5BShoTL2bvsmVaMeTlDpZlpj/AoXIEXjWM0rYyk6x90H1tPza73a7rNq1SejoECKknM3gsepptABdwJGNTmGshKJQLtKp9V03TfMnlremgUUO3lelo55pNq6MDppwqWzJYOTHqKKK2CJbOxKsncTN7FEIWI4VYz5y+hQIzu8SuLMLltK48oD0Oznt5gkz+ppKjvfk8Vex1SQX9YyilL1IVF8io7adScvSpUiV4Dnjv/TPmberZQiaWYDDKdyYY8tXrtTOlQE+NM3rXgwSivORCIZs75eV3+Ady/coN"</span>,</span>
<span id="cb4-30"><a></a>    <span class="st">"PBS_JOBCOOKIE"</span><span class="ex">:</span> <span class="st">"6B8C4F9D774B0AA5174EAAFB6E2CC14F"</span>,</span>
<span id="cb4-31"><a></a>    <span class="st">"PBS_JOBDIR"</span><span class="ex">:</span> <span class="st">"/home/foremans"</span>,</span>
<span id="cb4-32"><a></a>    <span class="st">"PBS_JOBID"</span><span class="ex">:</span> <span class="st">"604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-33"><a></a>    <span class="st">"PBS_JOBNAME"</span><span class="ex">:</span> <span class="st">"STDIN"</span>,</span>
<span id="cb4-34"><a></a>    <span class="st">"PBS_MOMPORT"</span><span class="ex">:</span> <span class="st">"15003"</span>,</span>
<span id="cb4-35"><a></a>    <span class="st">"PBS_NODEFILE"</span><span class="ex">:</span> <span class="st">"/var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-36"><a></a>    <span class="st">"PBS_NODENUM"</span><span class="ex">:</span> <span class="st">"0"</span>,</span>
<span id="cb4-37"><a></a>    <span class="st">"PBS_O_HOME"</span><span class="ex">:</span> <span class="st">"/home/foremans"</span>,</span>
<span id="cb4-38"><a></a>    <span class="st">"PBS_O_HOST"</span><span class="ex">:</span> <span class="st">"aurora-uan-0010.hostmgmt1000.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb4-39"><a></a>    <span class="st">"PBS_O_LANG"</span><span class="ex">:</span> <span class="st">"en_US.UTF-8"</span>,</span>
<span id="cb4-40"><a></a>    <span class="st">"PBS_O_LOGNAME"</span><span class="ex">:</span> <span class="st">"foremans"</span>,</span>
<span id="cb4-41"><a></a>    <span class="st">"PBS_O_MAIL"</span><span class="ex">:</span> <span class="st">"/var/spool/mail/foremans"</span>,</span>
<span id="cb4-42"><a></a>    <span class="st">"PBS_O_PATH"</span><span class="ex">:</span> <span class="st">"/home/foremans/.nvm/versions/node/v21.5.0/bin:/home/foremans/homebrew/bin:/home/foremans/homebrew/sbin:/opt/cray/pals/1.3.2/bin:/opt/cray/libfabric/1.15.2.0/bin:/opt/aurora/23.073.0/support/libraries/intel-compute-samples/2021.27.01:/opt/aurora/23.073.0/support/libraries/khronos/clinfo/default/bin:/opt/aurora/23.073.0/support/tools/gpu_validation:/opt/aurora/23.073.0/intel-gpu-umd/agama-devel-551/compiler/bin:/opt/aurora/23.073.0/intel-gpu-umd/agama-devel-551/driver/bin:/opt/aurora/23.073.0/CNDA/mpich/51.2/mpich-ofi-all-icc-default-pmix-gpu-drop51/bin:/opt/aurora/23.073.0/support/tools/mpi_wrapper_utils:/opt/aurora/23.073.0/oneapi/debugger/2023.0.0/gdb/intel64/bin:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/dpcpp-ct/bin:/opt/aurora/23.073.0/oneapi/advisor/2023.0.0/bin64:/opt/aurora/23.073.0/CNDA/oneapi/vtune/2023.0.0_624810_nda/bin64:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/compiler/linux/bin/intel64:/opt/aurora/23.073.0/CNDA/oneapi/compiler/trunk-20230201/compiler/linux/bin:/opt/aurora/23.073.0/oneapi/inspector/2023.0.0/bin64:/opt/cray/pe/gcc/11.2.0/snos/bin:/opt/clmgr/sbin:/opt/clmgr/bin:/opt/sgi/sbin:/opt/sgi/bin:/home/foremans/.local/bin:/home/foremans/bin:/usr/local/bin:/usr/bin:/bin:/opt/c3/bin:/usr/lib/mit/bin:/usr/lib/mit/sbin:/opt/pbs/bin:/sbin:/home/foremans/.local/share/kitty-ssh-kitten/kitty/bin:/home/foremans/.cargo/bin:/home/foremans/.fzf/bin:/home/foremans/.luarocks/bin:/home/foremans/.luarocks/bin"</span>,</span>
<span id="cb4-43"><a></a>    <span class="st">"PBS_O_QUEUE"</span><span class="ex">:</span> <span class="st">"EarlyAppAccess"</span>,</span>
<span id="cb4-44"><a></a>    <span class="st">"PBS_O_SHELL"</span><span class="ex">:</span> <span class="st">"/bin/zsh"</span>,</span>
<span id="cb4-45"><a></a>    <span class="st">"PBS_O_SYSTEM"</span><span class="ex">:</span> <span class="st">"Linux"</span>,</span>
<span id="cb4-46"><a></a>    <span class="st">"PBS_O_TZ"</span><span class="ex">:</span> <span class="st">"America/Chicago"</span>,</span>
<span id="cb4-47"><a></a>    <span class="st">"PBS_O_WORKDIR"</span><span class="ex">:</span> <span class="st">"/home/foremans"</span>,</span>
<span id="cb4-48"><a></a>    <span class="st">"PBS_QUEUE"</span><span class="ex">:</span> <span class="st">"LustreApps"</span>,</span>
<span id="cb4-49"><a></a>    <span class="st">"PBS_TASKNUM"</span><span class="ex">:</span> <span class="st">"1"</span>,</span>
<span id="cb4-50"><a></a>    <span class="st">"RANK"</span><span class="ex">:</span> 0,</span>
<span id="cb4-51"><a></a>    <span class="st">"SCHEDULER"</span><span class="ex">:</span> <span class="st">"PBS"</span>,</span>
<span id="cb4-52"><a></a>    <span class="st">"WORLD_SIZE_IN_USE"</span><span class="ex">:</span> 1,</span>
<span id="cb4-53"><a></a>    <span class="st">"WORLD_SIZE_TOTAL"</span><span class="ex">:</span> 24,</span>
<span id="cb4-54"><a></a>    <span class="st">"jobfile_json"</span><span class="ex">:</span> <span class="st">"/home/foremans/PBS-jobs/604319/jobenv.json"</span>,</span>
<span id="cb4-55"><a></a>    <span class="st">"jobfile_sh"</span><span class="ex">:</span> <span class="st">"/home/foremans/PBS-jobs/604319/jobenv.sh"</span>,</span>
<span id="cb4-56"><a></a>    <span class="st">"jobfile_yaml"</span><span class="ex">:</span> <span class="st">"/home/foremans/PBS-jobs/604319/jobenv.yaml"</span></span>
<span id="cb4-57"><a></a><span class="er">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a></a><span class="ex">$</span> source <span class="st">"</span><span class="va">$(</span><span class="fu">tail</span> <span class="at">-1</span> ~/PBS-jobs.log<span class="va">)</span><span class="st">/jobenv.sh"</span></span>
<span id="cb5-2"><a></a><span class="ex">$</span> which launch</span>
<span id="cb5-3"><a></a><span class="ex">launch:</span> aliased to mpiexec <span class="at">--verbose</span> <span class="at">--envall</span> <span class="at">-n</span> 24 <span class="at">-ppn</span> 12 <span class="at">--hostfile</span> /var/spool/pbs/aux/604319.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details></li>
<li><p><strong>Take 1</strong>: Crash with</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a></a><span class="ex">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details closed="">
<summary>
<p>Run:</p>
</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a></a><span class="ex">$</span> launch python3 pretrain_llama.py <span class="dt">\</span></span>
<span id="cb7-2"><a></a>    <span class="at">--tensor-model-parallel-size</span> 1 <span class="dt">\</span></span>
<span id="cb7-3"><a></a>    <span class="at">--pipeline-model-parallel-size</span> 1 <span class="dt">\</span></span>
<span id="cb7-4"><a></a>    <span class="at">--num-layers</span> 32 <span class="dt">\</span></span>
<span id="cb7-5"><a></a>    <span class="at">--hidden-size</span> 4096 <span class="dt">\</span></span>
<span id="cb7-6"><a></a>    <span class="at">--ffn-hidden-size</span> 5504 <span class="dt">\</span></span>
<span id="cb7-7"><a></a>    <span class="at">--num-attention-heads</span> 32 <span class="dt">\</span></span>
<span id="cb7-8"><a></a>    <span class="at">--micro-batch-size</span> 1 <span class="dt">\</span></span>
<span id="cb7-9"><a></a>    <span class="at">--global-batch-size</span> 24 <span class="dt">\</span></span>
<span id="cb7-10"><a></a>    <span class="at">--seq-length</span> 2048 <span class="dt">\</span></span>
<span id="cb7-11"><a></a>    <span class="at">--max-position-embeddings</span> 2048 <span class="dt">\</span></span>
<span id="cb7-12"><a></a>    <span class="at">--train-iters</span> 250000 <span class="dt">\</span></span>
<span id="cb7-13"><a></a>    <span class="at">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="dt">\</span></span>
<span id="cb7-14"><a></a>    <span class="at">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="dt">\</span></span>
<span id="cb7-15"><a></a>    <span class="at">--data-path</span> <span class="dt">\</span></span>
<span id="cb7-16"><a></a>    <span class="at">--data-impl</span> mmap <span class="dt">\</span></span>
<span id="cb7-17"><a></a>    <span class="at">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="dt">\</span></span>
<span id="cb7-18"><a></a>    <span class="at">--tokenizer-model</span> ./tmp/tokenizer.model <span class="dt">\</span></span>
<span id="cb7-19"><a></a>    <span class="at">--split</span> 949,50,1 <span class="dt">\</span></span>
<span id="cb7-20"><a></a>    <span class="at">--distributed-backend</span> ccl <span class="dt">\</span></span>
<span id="cb7-21"><a></a>    <span class="at">--lr</span> 3e-4 <span class="dt">\</span></span>
<span id="cb7-22"><a></a>    <span class="at">--lr-decay-style</span> cosine <span class="dt">\</span></span>
<span id="cb7-23"><a></a>    <span class="at">--min-lr</span> 3e-5 <span class="dt">\</span></span>
<span id="cb7-24"><a></a>    <span class="at">--weight-decay</span> 0.1 <span class="dt">\</span></span>
<span id="cb7-25"><a></a>    <span class="at">--clip-grad</span> 1 <span class="dt">\</span></span>
<span id="cb7-26"><a></a>    <span class="at">--lr-warmup-iters</span> 2000 <span class="dt">\</span></span>
<span id="cb7-27"><a></a>    <span class="at">--optimizer</span> adam <span class="dt">\</span></span>
<span id="cb7-28"><a></a>    <span class="at">--adam-beta1</span> 0.9 <span class="dt">\</span></span>
<span id="cb7-29"><a></a>    <span class="at">--adam-beta2</span> 0.95 <span class="dt">\</span></span>
<span id="cb7-30"><a></a>    <span class="at">--log-interval</span> 1 <span class="dt">\</span></span>
<span id="cb7-31"><a></a>    <span class="at">--save-interval</span> 10000 <span class="dt">\</span></span>
<span id="cb7-32"><a></a>    <span class="at">--eval-interval</span> 1000 <span class="dt">\</span></span>
<span id="cb7-33"><a></a>    <span class="at">--eval-iters</span> 10 <span class="dt">\</span></span>
<span id="cb7-34"><a></a>    <span class="at">--bf16</span> <span class="dt">\</span></span>
<span id="cb7-35"><a></a>    <span class="at">--no-query-key-layer-scaling</span> <span class="dt">\</span></span>
<span id="cb7-36"><a></a>    <span class="at">--attention-dropout</span> 0 <span class="dt">\</span></span>
<span id="cb7-37"><a></a>    <span class="at">--hidden-dropout</span> 0 <span class="dt">\</span></span>
<span id="cb7-38"><a></a>    <span class="at">--use-rotary-position-embeddings</span> <span class="dt">\</span></span>
<span id="cb7-39"><a></a>    <span class="at">--untie-embeddings-and-output-weightss</span> <span class="dt">\</span></span>
<span id="cb7-40"><a></a>    <span class="at">--swiglus</span> <span class="dt">\</span></span>
<span id="cb7-41"><a></a>    <span class="at">--normalization</span> rmsnorms <span class="dt">\</span></span>
<span id="cb7-42"><a></a>    <span class="at">--disable-bias-linears</span> <span class="dt">\</span></span>
<span id="cb7-43"><a></a>    <span class="at">--num-key-value-heads</span> 4s <span class="dt">\</span></span>
<span id="cb7-44"><a></a>    <span class="at">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_ <span class="dt">\</span></span>
<span id="cb7-45"><a></a>    hs4096_gb24_mb1/tensorboard <span class="dt">\</span></span>
<span id="cb7-46"><a></a>    <span class="at">--log-timers-to-tensorboard</span> <span class="dt">\</span></span>
<span id="cb7-47"><a></a>    <span class="at">--tensorboard-log-interval</span> 1 <span class="dt">\</span></span>
<span id="cb7-48"><a></a>    <span class="at">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_documents <span class="dt">\</span></span>
<span id="cb7-49"><a></a>    <span class="at">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="dt">\</span></span>
<span id="cb7-50"><a></a>    <span class="at">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="dt">\</span></span>
<span id="cb7-51"><a></a>    <span class="at">--zero-stage</span><span class="op">=</span>3 <span class="dt">\</span></span>
<span id="cb7-52"><a></a>    <span class="at">--deepspeed_config</span><span class="op">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="dt">\</span></span>
<span id="cb7-53"><a></a>    <span class="at">--deepspeed</span></span>
<span id="cb7-54"><a></a></span>
<span id="cb7-55"><a></a><span class="ex">Connected</span> to tcp://x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov:7919</span>
<span id="cb7-56"><a></a><span class="ex">Found</span> executable /home/foremans/miniconda3/envs/anl_release_q4/bin/python3</span>
<span id="cb7-57"><a></a><span class="ex">Launching</span> application 2e559157-da5e-4185-9902-dc8d932e8bb3</span>
<span id="cb7-58"><a></a><span class="ex">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st">'If you dont plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb7-59"><a></a>  <span class="ex">warn</span><span class="er">(</span></span>
<span id="cb7-60"><a></a><span class="ex">[2024-01-23</span> 00:02:13,326] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb7-61"><a></a><span class="ex">[2024-01-23</span> 00:02:19,177] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:161:init_deepspeed_backend</span><span class="pp">]</span> Initialize ccl backend</span>
<span id="cb7-62"><a></a><span class="ex">[2024-01-23</span> 00:02:19,177] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:637:init_distributed</span><span class="pp">]</span> cdb=None</span>
<span id="cb7-63"><a></a><span class="ex">[2024-01-23</span> 00:02:19,177] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:652:init_distributed</span><span class="pp">]</span> Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...</span>
<span id="cb7-64"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=3, local_rank=3, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-65"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=9, local_rank=9, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-66"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=11, local_rank=11, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-67"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=1, local_rank=1, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-68"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=2, local_rank=2, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-69"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=4, local_rank=4, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-70"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=5, local_rank=5, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-71"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=6, local_rank=6, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-72"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=7, local_rank=7, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-73"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=13, local_rank=1, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-74"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=8, local_rank=8, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-75"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=10, local_rank=10, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-76"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=0, local_rank=0, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-77"><a></a><span class="ex">[2024-01-23</span> 00:02:19,889] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:668:init_distributed</span><span class="pp">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb7-78"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=15, local_rank=3, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-79"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=17, local_rank=5, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-80"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=19, local_rank=7, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-81"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=21, local_rank=9, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-82"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=12, local_rank=0, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-83"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=14, local_rank=2, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-84"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=16, local_rank=4, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-85"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=18, local_rank=6, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-86"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=20, local_rank=8, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-87"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=22, local_rank=10, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-88"><a></a><span class="ex">[2024-01-23</span> 00:02:19,888] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:702:mpi_discovery</span><span class="pp">]</span> Discovered MPI settings of world_rank=23, local_rank=11, world_size=24, master_addr=10.115.53.137, master_port=29500</span>
<span id="cb7-89"><a></a><span class="ex">[2024-01-23</span> 00:02:20]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">dist:257</span><span class="pp">]</span> <span class="at">-</span> DistInfo={</span>
<span id="cb7-90"><a></a>    <span class="st">"DEVICE"</span><span class="ex">:</span> <span class="st">"xpu"</span>,</span>
<span id="cb7-91"><a></a>    <span class="st">"DEVICE_ID"</span><span class="ex">:</span> <span class="st">"xpu:0"</span>,</span>
<span id="cb7-92"><a></a>    <span class="st">"DISTRIBUTED_BACKEND"</span><span class="ex">:</span> <span class="st">"gloo"</span>,</span>
<span id="cb7-93"><a></a>    <span class="st">"GPUS_PER_NODE"</span><span class="ex">:</span> 12,</span>
<span id="cb7-94"><a></a>    <span class="st">"HOSTFILE"</span><span class="ex">:</span> <span class="st">"/var/spool/pbs/aux/604213.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb7-95"><a></a>    <span class="st">"HOSTNAME"</span><span class="ex">:</span> <span class="st">"x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb7-96"><a></a>    <span class="st">"HOSTS"</span><span class="ex">:</span> <span class="st">"['x4502c1s0b0n0', 'x4502c1s3b0n0']"</span>,</span>
<span id="cb7-97"><a></a>    <span class="st">"LOCAL_RANK"</span><span class="ex">:</span> 0,</span>
<span id="cb7-98"><a></a>    <span class="st">"MACHINE"</span><span class="ex">:</span> <span class="st">"Aurora"</span>,</span>
<span id="cb7-99"><a></a>    <span class="st">"NGPUS"</span><span class="ex">:</span> 24,</span>
<span id="cb7-100"><a></a>    <span class="st">"NODE_ID"</span><span class="ex">:</span> 0,</span>
<span id="cb7-101"><a></a>    <span class="st">"NUM_NODES"</span><span class="ex">:</span> 2,</span>
<span id="cb7-102"><a></a>    <span class="st">"RANK"</span><span class="ex">:</span> 0,</span>
<span id="cb7-103"><a></a>    <span class="st">"SCHEDULER"</span><span class="ex">:</span> <span class="st">"PBS"</span>,</span>
<span id="cb7-104"><a></a>    <span class="st">"WORLD_SIZE_IN_USE"</span><span class="ex">:</span> 24,</span>
<span id="cb7-105"><a></a>    <span class="st">"WORLD_SIZE_TOTAL"</span><span class="ex">:</span> 24</span>
<span id="cb7-106"><a></a><span class="er">}</span></span>
<span id="cb7-107"><a></a><span class="ex">[2024-01-23</span> 00:02:20,987] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb7-108"><a></a><span class="ex">--------------------------------------------------</span></span>
<span id="cb7-109"><a></a><span class="ex">DeepSpeed</span> C++/CUDA extension op report</span>
<span id="cb7-110"><a></a><span class="ex">--------------------------------------------------</span></span>
<span id="cb7-111"><a></a><span class="ex">NOTE:</span> Ops not installed will be just-in-time <span class="er">(</span><span class="ex">JIT</span><span class="kw">)</span> <span class="ex">compiled</span> at</span>
<span id="cb7-112"><a></a>      <span class="ex">runtime</span> if needed. Op compatibility means that your system</span>
<span id="cb7-113"><a></a>      <span class="ex">meet</span> the required dependencies to JIT install the op.</span>
<span id="cb7-114"><a></a><span class="ex">--------------------------------------------------</span></span>
<span id="cb7-115"><a></a><span class="ex">JIT</span> compiled ops requires ninja</span>
<span id="cb7-116"><a></a><span class="ex">ninja</span> .................. <span class="pp">[</span><span class="ss">OKAY</span><span class="pp">]</span></span>
<span id="cb7-117"><a></a><span class="ex">--------------------------------------------------</span></span>
<span id="cb7-118"><a></a><span class="ex">op</span> name ................ installed .. compatible</span>
<span id="cb7-119"><a></a><span class="ex">--------------------------------------------------</span></span>
<span id="cb7-120"><a></a><span class="ex">[2024-01-23</span> 00:02:20]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">spawn:38</span><span class="pp">]</span> <span class="at">-</span> icx <span class="at">-Wno-unused-result</span> <span class="at">-Wsign-compare</span> <span class="at">-DNDEBUG</span> <span class="at">-fwrapv</span> <span class="at">-O2</span> <span class="at">-Wall</span> <span class="at">-fPIC</span> <span class="at">-O2</span> <span class="at">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at">-fPIC</span> <span class="at">-O2</span> <span class="at">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at">-fPIC</span> <span class="at">-c</span> /tmp/tmph01efr3s/test.c <span class="at">-o</span> /tmp/tmph01efr3s/test.o</span>
<span id="cb7-121"><a></a><span class="ex">WARNING:</span> TensorBoard writing requested but is not available <span class="er">(</span><span class="ex">are</span> you using PyTorch 1.1.0 or later<span class="pp">?</span><span class="kw">)</span><span class="ex">,</span> no TensorBoard logs will be written.</span>
<span id="cb7-122"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122507</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-123"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122510</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-124"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122515</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-125"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-126"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122507</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-127"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-128"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122508</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-129"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-130"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122509</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-131"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-132"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122511</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-133"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-134"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122512</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-135"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-136"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122513</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-137"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-138"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122514</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-139"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-140"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122516</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-141"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-142"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122517</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-143"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-144"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">122518</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-145"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-146"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141071</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-147"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141072</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-148"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141073</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-149"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141075</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-150"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141076</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-151"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141078</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-152"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141079</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-153"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141081</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-154"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141074</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-155"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141077</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-156"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141080</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb7-157"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141071</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-158"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-159"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141075</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-160"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-161"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141078</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-162"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-163"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141081</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-164"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-165"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141072</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-166"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-167"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141073</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-168"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-169"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141074</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-170"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-171"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141076</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-172"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-173"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141077</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-174"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-175"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141079</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-176"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-177"><a></a><span class="ex">2024:01:23-00:02:21:</span><span class="er">(</span><span class="ex">141080</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb7-178"><a></a><span class="ex">to</span> get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-179"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-180"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-181"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-182"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-183"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-184"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-185"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-186"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-187"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-188"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-189"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-190"><a></a><span class="op">&gt;</span>fused <span class="ex">kernel</span> is only supported in cuda, skip loading fused kernel</span>
<span id="cb7-191"><a></a><span class="ex">Traceback</span> <span class="er">(</span><span class="ex">most</span> recent call last<span class="kw">)</span><span class="bu">:</span></span>
<span id="cb7-192"><a></a>  <span class="ex">File</span> <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 583, in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb7-193"><a></a>    <span class="ex">model</span> = main<span class="er">(</span><span class="kw">)</span></span>
<span id="cb7-194"><a></a>  <span class="ex">File</span> <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 561, in main</span>
<span id="cb7-195"><a></a>    <span class="ex">model</span> = pretrain<span class="er">(</span></span>
<span id="cb7-196"><a></a>  <span class="ex">File</span> <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/megatron/training.py"</span>, line 136, in pretrain</span>
<span id="cb7-197"><a></a>    <span class="ex">torch.distributed.all_reduce</span><span class="er">(</span><span class="ex">start_time_tensor,</span></span>
<span id="cb7-198"><a></a>  <span class="ex">File</span> <span class="st">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/c10d_logger.py"</span>, line 47, in wrapper</span>
<span id="cb7-199"><a></a>    <span class="cf">return</span> <span class="ex">func</span><span class="er">(</span><span class="ex">*args,</span> <span class="pp">**</span>kwargs<span class="kw">)</span></span>
<span id="cb7-200"><a></a>  <span class="ex">File</span> <span class="st">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py"</span>, line 2050, in all_reduce</span>
<span id="cb7-201"><a></a>    <span class="ex">work</span> = group.allreduce<span class="er">(</span><span class="ex">[tensor],</span> opts<span class="kw">)</span></span>
<span id="cb7-202"><a></a></span>
<span id="cb7-203"><a></a><span class="ex">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb7-204"><a></a></span>
<span id="cb7-205"><a></a><span class="op">&lt;</span>/details<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details></li>
<li><p><strong>Take 2</strong>: Trying with <code>CCL_ZE_IPC_EXCHANGE=sockets</code> (still no luck)</p>
<details closed="">
<summary>
<p>Run:</p>
</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a></a><span class="ex">$</span> CCL_ZE_IPC_EXCHANGE=sockets !!</span>
<span id="cb8-2"><a></a><span class="ex">[...]</span></span>
<span id="cb8-3"><a></a><span class="ex">2024:01:23-00:03:41:</span><span class="er">(</span><span class="ex">123335</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb8-4"><a></a><span class="ex">2024:01:23-00:03:41:</span><span class="er">(</span><span class="ex">123330</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">sockets</span> exchange mode is set. It may cause potential problem of <span class="st">'Too many open file descriptors'</span></span>
<span id="cb8-5"><a></a><span class="ex">2024:01:23-00:03:41:</span><span class="er">(</span><span class="ex">123337</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">sockets</span> exchange mode is set. It may cause potential problem of <span class="st">'Too many open file descriptors'</span></span>
<span id="cb8-6"><a></a><span class="ex">2024:01:23-00:03:41:</span><span class="er">(</span><span class="ex">123327</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">sockets</span> exchange mode is set. It may cause potential problem of <span class="st">'Too many open file descriptors'</span></span>
<span id="cb8-7"><a></a><span class="ex">[...]</span></span>
<span id="cb8-8"><a></a><span class="ex">RuntimeError:</span> oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details></li>
</ul>
</section>
<section id="using-deepspeed" class="slide level2">
<h2>Using <code>deepspeed</code></h2>
<ul>
<li><p>Setup:</p>
<details closed="">
<summary>
<p>Setup:</p>
</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a></a><span class="ex">$</span> cat <span class="va">$PBS_NODEFILE</span> <span class="op">&gt;</span> hostfile <span class="kw">;</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">'s/$/ slots=12/'</span> <span class="at">-i</span> hostfile</span>
<span id="cb9-2"><a></a><span class="ex">$</span> echo <span class="st">"PATH=</span><span class="va">${PATH}</span><span class="st">"</span> <span class="op">&gt;&gt;</span> .deepspeed_env <span class="kw">;</span> <span class="bu">echo</span> <span class="st">"LD_LIBRARY_PATH=</span><span class="va">${LD_LIBRARY_PATH}</span><span class="st">"</span> <span class="op">&gt;&gt;</span> .deepspeed_env <span class="kw">;</span> <span class="bu">echo</span> <span class="st">"http_proxy=</span><span class="va">${http_proxy}</span><span class="st">"</span> <span class="op">&gt;&gt;</span> .deepspeed_env <span class="kw">;</span> <span class="bu">echo</span> <span class="st">"https_proxy=</span><span class="va">${https_proxy}</span><span class="st">"</span> <span class="op">&gt;&gt;</span> .deepspeed_env</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></details></li>
<li><p>Run:</p>
<ul>
<li><p>Command:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a></a>  <span class="ex">$</span> RANK=0 LOCAL_RANK=0 MASTER_ADDR=localhost deepspeed <span class="at">--hostfile</span> hostfile pretrain_llama.py <span class="at">--tensor-model-parallel-size</span> 1 <span class="at">--pipeline-model-parallel-size</span> 1 <span class="at">--num-layers</span> 32 <span class="at">--hidden-size</span> 4096 <span class="at">--ffn-hidden-size</span> 5504 <span class="at">--num-attention-heads</span> 32 <span class="at">--micro-batch-size</span> 1 <span class="at">--global-batch-size</span> 24 <span class="at">--seq-length</span> 2048 <span class="at">--max-position-embeddings</span> 2048 <span class="at">--train-iters</span> 250000 <span class="at">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at">--data-path</span> <span class="at">--data-impl</span> mmap <span class="at">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="at">--tokenizer-model</span> ./tmp/tokenizer.model <span class="at">--split</span> 949,50,1 <span class="at">--distributed-backend</span> ccl <span class="at">--lr</span> 3e-4 <span class="at">--lr-decay-style</span> cosine <span class="at">--min-lr</span> 3e-5 <span class="at">--weight-decay</span> 0.1 <span class="at">--clip-grad</span> 1 <span class="at">--lr-warmup-iters</span> 2000 <span class="at">--optimizer</span> adam <span class="at">--adam-beta1</span> 0.9 <span class="at">--adam-beta2</span> 0.95 <span class="at">--log-interval</span> 1 <span class="at">--save-interval</span> 10000 <span class="at">--eval-interval</span> 1000 <span class="at">--eval-iters</span> 10 <span class="at">--bf16</span> <span class="at">--no-query-key-layer-scaling</span> <span class="at">--attention-dropout</span> 0 <span class="at">--hidden-dropout</span> 0 <span class="at">--use-rotary-position-embeddings</span> <span class="at">--untie-embeddings-and-output-weights</span> <span class="at">--swiglu</span> <span class="at">--normalization</span> rmsnorm <span class="at">--disable-bias-linear</span> <span class="at">--num-key-value-heads</span> 4 <span class="at">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard <span class="at">--log-timers-to-tensorboard</span> <span class="at">--tensorboard-log-interval</span> 1 <span class="at">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_document <span class="at">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="at">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="at">--zero-stage</span><span class="op">=</span>3 <span class="at">--deepspeed_config</span><span class="op">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at">--deepspeed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Output:</p>
<details closed="">
<summary>
<p>Output</p>
</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a></a><span class="ex">$</span> RANK=0 LOCAL_RANK=0 MASTER_ADDR=localhost deepspeed <span class="at">--hostfile</span> hostfile pretrain_llama.py <span class="at">--tensor-model-parallel-size</span> 1 <span class="at">--pipeline-model-parallel-size</span> 1 <span class="at">--num-layers</span> 32 <span class="at">--hidden-size</span> 4096 <span class="at">--ffn-hidden-size</span> 5504 <span class="at">--num-attention-heads</span> 32 <span class="at">--micro-batch-size</span> 1 <span class="at">--global-batch-size</span> 24 <span class="at">--seq-length</span> 2048 <span class="at">--max-position-embeddings</span> 2048 <span class="at">--train-iters</span> 250000 <span class="at">--save</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at">--load</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1 <span class="at">--data-path</span> <span class="at">--data-impl</span> mmap <span class="at">--tokenizer-type</span> GPTSentencePieceTokenizer <span class="at">--tokenizer-model</span> ./tmp/tokenizer.model <span class="at">--split</span> 949,50,1 <span class="at">--distributed-backend</span> ccl <span class="at">--lr</span> 3e-4 <span class="at">--lr-decay-style</span> cosine <span class="at">--min-lr</span> 3e-5 <span class="at">--weight-decay</span> 0.1 <span class="at">--clip-grad</span> 1 <span class="at">--lr-warmup-iters</span> 2000 <span class="at">--optimizer</span> adam <span class="at">--adam-beta1</span> 0.9 <span class="at">--adam-beta2</span> 0.95 <span class="at">--log-interval</span> 1 <span class="at">--save-interval</span> 10000 <span class="at">--eval-interval</span> 1000 <span class="at">--eval-iters</span> 10 <span class="at">--bf16</span> <span class="at">--no-query-key-layer-scaling</span> <span class="at">--attention-dropout</span> 0 <span class="at">--hidden-dropout</span> 0 <span class="at">--use-rotary-position-embeddings</span> <span class="at">--untie-embeddings-and-output-weights</span> <span class="at">--swiglu</span> <span class="at">--normalization</span> rmsnorm <span class="at">--disable-bias-linear</span> <span class="at">--num-key-value-heads</span> 4 <span class="at">--tensorboard-dir</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/outputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard <span class="at">--log-timers-to-tensorboard</span> <span class="at">--tensorboard-log-interval</span> 1 <span class="at">--data-path</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/BookCorpusDataset_text_document <span class="at">--vocab-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json <span class="at">--merge-file</span> /lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt <span class="at">--zero-stage</span><span class="op">=</span>3 <span class="at">--deepspeed_config</span><span class="op">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at">--deepspeed</span> </span>
<span id="cb11-2"><a></a></span>
<span id="cb11-3"><a></a><span class="ex">home/foremans/miniconda3/envs/anl_release_q4/bin/deepspeed:4:</span> DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span>
<span id="cb11-4"><a></a>  <span class="ex">__import__</span><span class="er">(</span><span class="st">'pkg_resources'</span><span class="kw">)</span><span class="ex">.require</span><span class="er">(</span><span class="st">'deepspeed==0.12.3+6ea44d02'</span><span class="kw">)</span></span>
<span id="cb11-5"><a></a><span class="ex">/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13:</span> UserWarning: Failed to load image Python extension: <span class="st">'If you dont plan on using image functionality from `torchvision.io`, you can igno re this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?'</span></span>
<span id="cb11-6"><a></a>  <span class="ex">warn</span><span class="er">(</span></span>
<span id="cb11-7"><a></a><span class="ex">My</span> guessed rank = 0</span>
<span id="cb11-8"><a></a><span class="ex">[2024-01-23</span> 00:09:56,016] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb11-9"><a></a><span class="ex">[2024-01-23</span> 00:10:00,790] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">runner.py:463:main</span><span class="pp">]</span> Using IP address of 10.115.53.137 for node x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb11-10"><a></a><span class="ex">[2024-01-23</span> 00:10:00,812] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">runner.py:559:main</span><span class="pp">]</span> deepspeed_env file = .deepspeed_env</span>
<span id="cb11-11"><a></a><span class="ex">[2024-01-23</span> 00:10:00,813] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">runner.py:559:main</span><span class="pp">]</span> deepspeed_env file = .deepspeed_env</span>
<span id="cb11-12"><a></a><span class="ex">[2024-01-23</span> 00:10:00,813] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">multinode_runner.py:72:get_cmd</span><span class="pp">]</span> Running on the following workers: x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov</span>
<span id="cb11-13"><a></a><span class="ex">[2024-01-23</span> 00:10:00,813] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">runner.py:570:main</span><span class="pp">]</span> cmd = pdsh <span class="at">-S</span> <span class="at">-f</span> 1024 <span class="at">-w</span> x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov export PYTHONSTARTUP=/etc/pythonstart<span class="kw">;</span> <span class="bu">export</span> <span class="va">PYTHONPATH</span><span class="op">=</span>/l</span>
<span id="cb11-14"><a></a><span class="ex">us/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed:/soft/compilers/oneapi/2023.12.15.001/oneapi/advisor/2024.0/pythonapi</span><span class="kw">;</span> <span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span>/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/u</span>
<span id="cb11-15"><a></a><span class="ex">sr/bin:/soft/tools/gpu_validation:/soft/libraries/khronos/clinfo/master-13ae34-2020.12.14/bin:/soft/libraries/intel-compute-samples/2021.27.01:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/compiler/bin:/soft/libraries/intel-gpu-umd</span></span>
<span id="cb11-16"><a></a><span class="ex">/stable_736_25_20231031/driver/bin:/soft/restricted/CNDA/updates/mpich/52.2/mpich-ofi-all-icc-default-pmix-gpu-drop52/bin:/soft/tools/mpi_wrapper_utils:/soft/compilers/oneapi/2023.12.15.001/oneapi/dpcpp-ct/2024.0/bin:/soft/compilers/oneap</span></span>
<span id="cb11-17"><a></a><span class="ex">i/2023.12.15.001/oneapi/advisor/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/vtune/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/inspector/2024.0/bin64:/soft/compilers/oneapi/2023.12.15.001/oneapi/debugger/2024.0/</span></span>
<span id="cb11-18"><a></a><span class="ex">opt/debugger/bin:/soft/compilers/oneapi/2023.12.15.001/oneapi/mkl/2024.0/bin:/soft/compilers/oneapi/2023.12.15.001/oneapi/compiler/2024.0/bin:/home/foremans/miniconda3/envs/anl_release_q4/bin:/home/foremans/miniconda3/condabin:/home/forem</span></span>
<span id="cb11-19"><a></a><span class="ex">ans/.nvm/versions/node/v21.5.0/bin:/home/foremans/homebrew/bin:/home/foremans/homebrew/sbin:/opt/cray/pals/1.3.2/bin:/opt/cray/libfabric/1.15.2.0/bin:/opt/cray/pe/gcc/11.2.0/snos/bin:/opt/clmgr/sbin:/opt/clmgr/bin:/opt/sgi/sbin:/opt/sgi/b</span></span>
<span id="cb11-20"><a></a><span class="ex">in:/home/foremans/.local/bin:/home/foremans/bin:/usr/local/bin:/usr/bin:/bin:/opt/c3/bin:/usr/lib/mit/bin:/usr/lib/mit/sbin:/opt/pbs/bin:/sbin:/home/foremans/.local/share/kitty-ssh-kitten/kitty/bin:/home/foremans/.cargo/bin:/home/foremans</span></span>
<span id="cb11-21"><a></a><span class="ex">/.fzf/bin:/home/foremans/.luarocks/bin</span><span class="kw">;</span> <span class="bu">export</span> <span class="va">LD_LIBRARY_PATH</span><span class="op">=</span>/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64/dri:/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64/mfx:/home/ftartagl/graphics-c</span>
<span id="cb11-22"><a></a><span class="ex">ompute-runtime/agama-ci-devel-736.9/usr/lib64/intel-opencl:/home/ftartagl/graphics-compute-runtime/agama-ci-devel-736.9/usr/lib64:/soft/libraries/khronos/loader/master-2022.05.18/lib64:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/</span></span>
<span id="cb11-23"><a></a><span class="ex">compiler/lib64:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/driver/lib64/intel-opencl:/soft/libraries/intel-gpu-umd/stable_736_25_20231031/driver/lib64:/soft/restricted/CNDA/updates/mpich/52.2/mpich-ofi-all-icc-default-pmix-gpu-dr</span></span>
<span id="cb11-24"><a></a><span class="ex">op52/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ipp/2021.10/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ippcp/2021.9/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dpl/2022.3/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/d</span></span>
<span id="cb11-25"><a></a><span class="ex">ebugger/2024.0/opt/debugger/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/ccl/2021.11/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dal/2024.0/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/dnnl/2024.0/lib:/soft/compilers/oneapi/2</span></span>
<span id="cb11-26"><a></a><span class="ex">023.12.15.001/oneapi/tbb/2021.11/lib/intel64/gcc4.8:/soft/compilers/oneapi/2023.12.15.001/oneapi/mkl/2024.0/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/compiler/2024.0/opt/compiler/lib:/soft/compilers/oneapi/2023.12.15.001/oneapi/com</span></span>
<span id="cb11-27"><a></a><span class="ex">piler/2024.0/lib:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/pe/gcc/11.2.0/snos/lib64</span><span class="kw">;</span> <span class="bu">export</span> <span class="va">http_proxy</span><span class="op">=</span>http://proxy-01.pub.alcf.anl.gov:3128<span class="kw">;</span> <span class="bu">export</span> <span class="va">https_proxy</span><span class="op">=</span>http://proxy.alcf.anl.gov:3128<span class="kw">;</span>  <span class="bu">cd</span> /lus/gecko/projects/Aurora_deployment/</span>
<span id="cb11-28"><a></a><span class="ex">foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed</span><span class="kw">;</span> <span class="ex">/home/foremans/miniconda3/envs/anl_release_q4/bin/python3</span> <span class="at">-u</span> <span class="at">-m</span> deepspeed.launcher.launch <span class="at">--world_info</span><span class="op">=</span>eyJ4NDUwMmMxczBiMG4wLmhvc3RtZ210MjUwMi5jbS5hdXJvcmEuYWxjZi5hbmwuZ292IjogWzAsI</span>
<span id="cb11-29"><a></a><span class="ex">DEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV0sICJ4NDUwMmMxczNiMG4wLmhvc3RtZ210MjUwMi5jbS5hdXJvcmEuYWxjZi5hbmwuZ292IjogWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV19</span> <span class="at">--node_rank</span><span class="op">=</span>%n <span class="at">--master_addr</span><span class="op">=</span>10.115.53.137 <span class="at">--master_port</span><span class="op">=</span>29500 pre</span>
<span id="cb11-30"><a></a><span class="ex">train_llama.py</span> <span class="at">--tensor-model-parallel-size</span> <span class="st">'1'</span> <span class="at">--pipeline-model-parallel-size</span> <span class="st">'1'</span> <span class="at">--num-layers</span> <span class="st">'32'</span> <span class="at">--hidden-size</span> <span class="st">'4096'</span> <span class="at">--ffn-hidden-size</span> <span class="st">'5504'</span> <span class="at">--num-attention-heads</span> <span class="st">'32'</span> <span class="at">--micro-batch-size</span> <span class="st">'1'</span> <span class="at">--global-batch-size</span> <span class="st">'24'</span> <span class="at">--seq-length</span> <span class="st">'20</span></span>
<span id="cb11-31"><a></a><span class="st">48'</span> <span class="at">--max-position-embeddings</span> <span class="st">'2048'</span> <span class="at">--train-iters</span> <span class="st">'250000'</span> <span class="at">--save</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1'</span></span>
<span id="cb11-32"><a></a><span class="ex">--load</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/checkpoints/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1'</span> <span class="at">--data-path</span> <span class="at">--data-impl</span> <span class="st">'mmap'</span> <span class="at">--tokenizer-type</span> <span class="st">'GPTSentence</span></span>
<span id="cb11-33"><a></a><span class="st">PieceTokenizer'</span> <span class="at">--tokenizer-model</span> <span class="st">'./tmp/tokenizer.model'</span> <span class="at">--split</span> <span class="st">'949,50,1'</span> <span class="at">--distributed-backend</span> <span class="st">'ccl'</span> <span class="at">--lr</span> <span class="st">'3e-4'</span> <span class="at">--lr-decay-style</span> <span class="st">'cosine'</span> <span class="at">--min-lr</span> <span class="st">'3e-5'</span> <span class="at">--weight-decay</span> <span class="st">'0.1'</span> <span class="at">--clip-grad</span> <span class="st">'1'</span> <span class="at">--lr-warmup-iters</span> <span class="st">'2000'</span> <span class="at">--optimizer</span> <span class="st">'adam</span></span>
<span id="cb11-34"><a></a><span class="st">'</span> <span class="at">--adam-beta1</span> <span class="st">'0.9'</span> <span class="at">--adam-beta2</span> <span class="st">'0.95'</span> <span class="at">--log-interval</span> <span class="st">'1'</span> <span class="at">--save-interval</span> <span class="st">'10000'</span> <span class="at">--eval-interval</span> <span class="st">'1000'</span> <span class="at">--eval-iters</span> <span class="st">'10'</span> <span class="at">--bf16</span> <span class="at">--no-query-key-layer-scaling</span> <span class="at">--attention-dropout</span> <span class="st">'0'</span> <span class="at">--hidden-dropout</span> <span class="st">'0'</span> <span class="at">--use-rotary-position-embeddings</span></span>
<span id="cb11-35"><a></a> <span class="ex">--untie-embeddings-and-output-weights</span> <span class="at">--swiglu</span> <span class="at">--normalization</span> <span class="st">'rmsnorm'</span> <span class="at">--disable-bias-linear</span> <span class="at">--num-key-value-heads</span> <span class="st">'4'</span> <span class="at">--tensorboard-dir</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/ou</span></span>
<span id="cb11-36"><a></a><span class="st">tputs/LLAMA_7B_LLAMA_7B_z3_seqlen_mp1_pp1_sp24_nl32_hs4096_gb24_mb1/tensorboard'</span> <span class="at">--log-timers-to-tensorboard</span> <span class="at">--tensorboard-log-interval</span> <span class="st">'1'</span> <span class="at">--data-path</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-</span></span>
<span id="cb11-37"><a></a><span class="st">DeepSpeed/dataset/BookCorpusDataset_text_document'</span> <span class="at">--vocab-file</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-vocab.json'</span> <span class="at">--merge-file</span> <span class="st">'/lus/gecko/projects/Aurora_deployment/f</span></span>
<span id="cb11-38"><a></a><span class="st">oremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/dataset/gpt2-merges.txt'</span> <span class="at">--zero-stage</span><span class="op">=</span>3 <span class="at">--deepspeed_config</span><span class="op">=</span>/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/deepspeed.json <span class="at">--deepspeed</span></span>
<span id="cb11-39"><a></a><span class="ex">x4502c1s3b0n0:</span> Warning: Permanently added <span class="st">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov,10.115.53.138'</span> <span class="er">(</span><span class="ex">ECDSA</span><span class="kw">)</span> <span class="ex">to</span> the list of known hosts.</span>
<span id="cb11-40"><a></a></span>
<span id="cb11-41"><a></a><span class="ex">x4502c1s0b0n0:</span> /home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: <span class="st">''</span>If you don<span class="st">'t plan on using image functionality from `torchvision.io</span></span>
<span id="cb11-42"><a></a><span class="st">`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?</span></span>
<span id="cb11-43"><a></a><span class="st">x4502c1s0b0n0:   warn(</span></span>
<span id="cb11-44"><a></a><span class="st">x4502c1s3b0n0: /home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: ''If you don'</span>t plan on using image functionality from <span class="kw">`</span><span class="ex">torchvision.io</span><span class="kw">`</span>, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have <span class="kw">`</span><span class="ex">libjpeg</span><span class="kw">`</span> or <span class="kw">`</span><span class="ex">libpng</span><span class="kw">`</span> installed before building <span class="kw">`</span><span class="ex">torchvision</span><span class="kw">`</span> from source<span class="pp">?</span></span>
<span id="cb11-45"><a></a><span class="ex">x4502c1s3b0n0:</span>   warn<span class="er">(</span></span>
<span id="cb11-46"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:07,853] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb11-47"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:145:main</span><span class="pp">]</span> WORLD INFO DICT: {<span class="st">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]}</span>
<span id="cb11-48"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:151:main</span><span class="pp">]</span> nnodes=2, num_local_procs=12, node_rank=0</span>
<span id="cb11-49"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:162:main</span><span class="pp">]</span> global_rank_mapping=defaultdict<span class="er">(</span><span class="op">&lt;</span>class <span class="st">'list'</span><span class="op">&gt;</span>, <span class="ex">{</span><span class="st">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span><span class="ex">:</span> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]}<span class="kw">)</span></span>
<span id="cb11-50"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:163:main</span><span class="pp">]</span> dist_world_size=24</span>
<span id="cb11-51"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:08,419] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:165:main</span><span class="pp">]</span> Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7,8,9,10,11</span>
<span id="cb11-52"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:08,885] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb11-53"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:145:main</span><span class="pp">]</span> WORLD INFO DICT: {<span class="st">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]}</span>
<span id="cb11-54"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:151:main</span><span class="pp">]</span> nnodes=2, num_local_procs=12, node_rank=1</span>
<span id="cb11-55"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:162:main</span><span class="pp">]</span> global_rank_mapping=defaultdict<span class="er">(</span><span class="op">&lt;</span>class <span class="st">'list'</span><span class="op">&gt;</span>, <span class="ex">{</span><span class="st">'x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span><span class="ex">:</span> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], <span class="st">'x4502c1s3b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov'</span>: [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]}<span class="kw">)</span></span>
<span id="cb11-56"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:163:main</span><span class="pp">]</span> dist_world_size=24</span>
<span id="cb11-57"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:09,452] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">launch.py:165:main</span><span class="pp">]</span> Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7,8,9,10,11</span>
<span id="cb11-58"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 4</span>
<span id="cb11-59"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 9</span>
<span id="cb11-60"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 8</span>
<span id="cb11-61"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 0</span>
<span id="cb11-62"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 6</span>
<span id="cb11-63"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 7</span>
<span id="cb11-64"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 11</span>
<span id="cb11-65"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 5</span>
<span id="cb11-66"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 10</span>
<span id="cb11-67"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 3</span>
<span id="cb11-68"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 2</span>
<span id="cb11-69"><a></a><span class="ex">x4502c1s0b0n0:</span> My guessed rank = 1</span>
<span id="cb11-70"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 21</span>
<span id="cb11-71"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 18</span>
<span id="cb11-72"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 22</span>
<span id="cb11-73"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 20</span>
<span id="cb11-74"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 14</span>
<span id="cb11-75"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 12</span>
<span id="cb11-76"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 23</span>
<span id="cb11-77"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 16</span>
<span id="cb11-78"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 17</span>
<span id="cb11-79"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 19</span>
<span id="cb11-80"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 15</span>
<span id="cb11-81"><a></a><span class="ex">x4502c1s3b0n0:</span> My guessed rank = 13</span>
<span id="cb11-82"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:14,751] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb11-83"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:19,225] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:161:init_deepspeed_backend</span><span class="pp">]</span> Initialize ccl backend</span>
<span id="cb11-84"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:19,225] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:637:init_distributed</span><span class="pp">]</span> cdb=None</span>
<span id="cb11-85"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:20,891] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:668:init_distributed</span><span class="pp">]</span> Initializing TorchBackend in DeepSpeed with backend ccl</span>
<span id="cb11-86"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:21]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">dist:257</span><span class="pp">]</span> <span class="at">-</span> DistInfo={</span>
<span id="cb11-87"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"DEVICE"</span>: <span class="st">"xpu"</span>,</span>
<span id="cb11-88"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"DEVICE_ID"</span>: <span class="st">"xpu:0"</span>,</span>
<span id="cb11-89"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"DISTRIBUTED_BACKEND"</span>: <span class="st">"gloo"</span>,</span>
<span id="cb11-90"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"GPUS_PER_NODE"</span>: 12,</span>
<span id="cb11-91"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"HOSTFILE"</span>: <span class="st">"/var/spool/pbs/aux/604213.aurora-pbs-0001.hostmgmt.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb11-92"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"HOSTNAME"</span>: <span class="st">"x4502c1s0b0n0.hostmgmt2502.cm.aurora.alcf.anl.gov"</span>,</span>
<span id="cb11-93"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"HOSTS"</span>: <span class="st">"['x4502c1s0b0n0', 'x4502c1s3b0n0']"</span>,</span>
<span id="cb11-94"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"LOCAL_RANK"</span>: 0,</span>
<span id="cb11-95"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"MACHINE"</span>: <span class="st">"Aurora"</span>,</span>
<span id="cb11-96"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"NGPUS"</span>: 24,</span>
<span id="cb11-97"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"NODE_ID"</span>: 0,</span>
<span id="cb11-98"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"NUM_NODES"</span>: 2,</span>
<span id="cb11-99"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"RANK"</span>: 0,</span>
<span id="cb11-100"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"SCHEDULER"</span>: <span class="st">"PBS"</span>,</span>
<span id="cb11-101"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"WORLD_SIZE_IN_USE"</span>: 1,</span>
<span id="cb11-102"><a></a><span class="ex">x4502c1s0b0n0:</span>     <span class="st">"WORLD_SIZE_TOTAL"</span>: 24</span>
<span id="cb11-103"><a></a><span class="ex">x4502c1s0b0n0:</span> }</span>
<span id="cb11-104"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:21,533] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">real_accelerator.py:158:get_accelerator</span><span class="pp">]</span> Setting ds_accelerator to xpu <span class="er">(</span><span class="ex">auto</span> detect<span class="kw">)</span></span>
<span id="cb11-105"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="at">--------------------------------------------------</span></span>
<span id="cb11-106"><a></a><span class="ex">x4502c1s0b0n0:</span> DeepSpeed C++/CUDA extension op report</span>
<span id="cb11-107"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="at">--------------------------------------------------</span></span>
<span id="cb11-108"><a></a><span class="ex">x4502c1s0b0n0:</span> NOTE: Ops not installed will be just-in-time <span class="er">(</span><span class="ex">JIT</span><span class="kw">)</span> <span class="ex">compiled</span> at</span>
<span id="cb11-109"><a></a><span class="ex">x4502c1s0b0n0:</span>       runtime if needed. Op compatibility means that your system</span>
<span id="cb11-110"><a></a><span class="ex">x4502c1s0b0n0:</span>       meet the required dependencies to JIT install the op.</span>
<span id="cb11-111"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="at">--------------------------------------------------</span></span>
<span id="cb11-112"><a></a><span class="ex">x4502c1s0b0n0:</span> JIT compiled ops requires ninja</span>
<span id="cb11-113"><a></a><span class="ex">x4502c1s0b0n0:</span> ninja .................. <span class="pp">[</span><span class="ss">OKAY</span><span class="pp">]</span></span>
<span id="cb11-114"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="at">--------------------------------------------------</span></span>
<span id="cb11-115"><a></a><span class="ex">x4502c1s0b0n0:</span> op name ................ installed .. compatible</span>
<span id="cb11-116"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="at">--------------------------------------------------</span></span>
<span id="cb11-117"><a></a><span class="ex">x4502c1s0b0n0:</span> [2024-01-23 06:10:21]<span class="pp">[</span><span class="ss">INFO</span><span class="pp">][</span><span class="ss">spawn:38</span><span class="pp">]</span> <span class="at">-</span> gcc <span class="at">-pthread</span> <span class="at">-B</span> /home/foremans/miniconda3/envs/anl_release_q4/compiler_compat <span class="at">-Wno-unused-result</span> <span class="at">-Wsign-compare</span> <span class="at">-DNDEBUG</span> <span class="at">-fwrapv</span> <span class="at">-O2</span> <span class="at">-Wall</span> <span class="at">-fPIC</span> <span class="at">-O2</span> <span class="at">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at">-fPIC</span> <span class="at">-O2</span> <span class="at">-isystem</span> /home/foremans/miniconda3/envs/anl_release_q4/include <span class="at">-fPIC</span> <span class="at">-c</span> /tmp/tmptqyph55g/test.c <span class="at">-o</span> /tmp/tmptqyph55g/test.o</span>
<span id="cb11-118"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:21,671] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:161:init_deepspeed_backend</span><span class="pp">]</span> Initialize ccl backend</span>
<span id="cb11-119"><a></a><span class="ex">x4502c1s3b0n0:</span> [2024-01-23 06:10:21,672] <span class="pp">[</span><span class="ss">INFO</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">comm.py:637:init_distributed</span><span class="pp">]</span> cdb=None</span>
<span id="cb11-120"><a></a></span>
<span id="cb11-121"><a></a><span class="ex">[...]</span></span>
<span id="cb11-122"><a></a><span class="ex">x4502c1s0b0n0:</span> <span class="op">&gt;</span>fused kernel is only supported in cuda, skip loading fused kernel</span>
<span id="cb11-123"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153241</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-124"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153241</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-125"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153241</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-126"><a></a><span class="ex">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-127"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153242</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-128"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153242</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-129"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153242</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-130"><a></a><span class="ex">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-131"><a></a><span class="ex">x4502c1s3b0n0:</span>  <span class="op">&gt;</span> padded vocab <span class="er">(</span><span class="ex">size:</span> 50257<span class="kw">)</span> <span class="ex">with</span> 47 dummy tokens <span class="er">(</span><span class="ex">new</span> size: 50304<span class="kw">)</span></span>
<span id="cb11-132"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153237</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">did</span> not find MPI-launcher specific variables, switch to ATL/OFI, to force enable ATL/MPI set CCL_ATL_TRANSPORT=mpi</span>
<span id="cb11-133"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153237</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-134"><a></a><span class="ex">x4502c1s0b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">153237</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-135"><a></a><span class="ex">x4502c1s0b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-136"><a></a><span class="ex">x4502c1s0b0n0:</span>  <span class="op">&gt;</span> padded vocab <span class="er">(</span><span class="ex">size:</span> 50257<span class="kw">)</span> <span class="ex">with</span> 47 dummy tokens <span class="er">(</span><span class="ex">new</span> size: 50304<span class="kw">)</span></span>
<span id="cb11-137"><a></a><span class="ex">x4502c1s0b0n0:</span>  <span class="op">&gt;</span> padded vocab <span class="er">(</span><span class="ex">size:</span> 50257<span class="kw">)</span> <span class="ex">with</span> 47 dummy tokens <span class="er">(</span><span class="ex">new</span> size: 50304<span class="kw">)</span></span>
<span id="cb11-138"><a></a><span class="ex">x4502c1s3b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">129554</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_WARN</span><span class="kw">|</span> <span class="ex">could</span> not get local_idx/count from environment variables, trying to get them from ATL</span>
<span id="cb11-139"><a></a><span class="ex">x4502c1s3b0n0:</span> 2024:01:23-06:12:16:<span class="er">(</span><span class="ex">129554</span><span class="kw">)</span> <span class="kw">|</span><span class="ex">CCL_ERROR</span><span class="kw">|</span> <span class="ex">global.cpp:150</span> getenv_local_coord: condition global_data::env<span class="er">(</span><span class="kw">)</span><span class="ex">.ze_ipc_exchange</span> == ccl::ze::ipc_exchange_mode::sockets failed</span>
<span id="cb11-140"><a></a><span class="ex">x4502c1s3b0n0:</span> to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-141"><a></a><span class="ex">x4502c1s3b0n0:</span> RuntimeError: oneCCL: global.cpp:150 getenv_local_coord: EXCEPTION: to get local_idx/count from ATL, set CCL_ZE_IPC_EXCHANGE=sockets explicitly</span>
<span id="cb11-142"><a></a><span class="ex">x4502c1s3b0n0:</span> Traceback <span class="er">(</span><span class="ex">most</span> recent call last<span class="kw">)</span><span class="bu">:</span></span>
<span id="cb11-143"><a></a><span class="ex">x4502c1s3b0n0:</span>   File <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 583, in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb11-144"><a></a><span class="ex">x4502c1s3b0n0:</span>     model = main<span class="er">(</span><span class="kw">)</span></span>
<span id="cb11-145"><a></a><span class="ex">x4502c1s3b0n0:</span>   File <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/pretrain_llama.py"</span>, line 561, in main</span>
<span id="cb11-146"><a></a><span class="ex">x4502c1s3b0n0:</span>     model = pretrain<span class="er">(</span></span>
<span id="cb11-147"><a></a><span class="ex">x4502c1s3b0n0:</span>   File <span class="st">"/lus/gecko/projects/Aurora_deployment/foremans/anl_24_release_q4/llm.devkit/Megatron-DeepSpeed/megatron/training.py"</span>, line 136, in pretrain</span>
<span id="cb11-148"><a></a><span class="ex">x4502c1s3b0n0:</span>     torch.distributed.all_reduce<span class="er">(</span><span class="ex">start_time_tensor,</span></span>
<span id="cb11-149"><a></a><span class="ex">x4502c1s3b0n0:</span>   File <span class="st">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/c10d_logger.py"</span>, line 47, in wrapper</span>
<span id="cb11-150"><a></a><span class="ex">x4502c1s3b0n0:</span>     return func<span class="er">(</span><span class="ex">*args,</span> <span class="pp">**</span>kwargs<span class="kw">)</span></span>
<span id="cb11-151"><a></a><span class="ex">x4502c1s3b0n0:</span>   File <span class="st">"/home/foremans/miniconda3/envs/anl_release_q4/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py"</span>, line 2050, in all_reduce</span>
<span id="cb11-152"><a></a><span class="ex">x4502c1s3b0n0:</span>     work = group.allreduce<span class="er">(</span><span class="ex">[tensor],</span> opts<span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details></li>
</ul></li>
</ul>


<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/samforeman\.me");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

<div class="quarto-listing quarto-listing-container-table" id="listing-listing">
<div class="listing-actions-group">
    <div class="input-group input-group-sm quarto-listing-filter">
      <span class="input-group-text"><i class="bi bi-search"></i></span>
      <input type="text" class="search form-control" placeholder="Filter">
    </div>
</div>
<table class="quarto-listing-table table">
<thead>
<tr>
</tr>
</thead>
<tbody class="list">
</tbody>
</table>
<div class="listing-no-matching d-none">
No matching items
</div>
</div><div class="quarto-listing quarto-listing-container-table" id="listing-listing"></div><footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/saforem2/personal_site/blob/main/posts/aurora-gpt/megatron-ds-intel.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/saforem2/personal_site/edit/main/posts/aurora-gpt/megatron-ds-intel.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/saforem2/personal_site/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>